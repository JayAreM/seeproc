<?php

	class Sheets extends MySQLDatabase {
		
		function createPerfectProcessTime($tnType) {

			$sheet = '';
			$headerTitle = '';
			$endStatus = '';
			$addtlWhere = '';
			$bg = '';
			$color = '';
			if($tnType == 'PR') {
				$headerTitle = 'Purchase Request';
				$endStatus = 'For P.O';
				$addtlWhere = " AND substr(TrackingNumber,1,2) = 'PR'";
				$bg ="background-color:rgb(31, 173, 45);";
				$color ="rgb(31, 173, 45);";
			}elseif($tnType == 'PO') {
				$headerTitle = 'Purchase Order';
				$endStatus = 'Waiting for Delivery';
				$addtlWhere = '';
				$bg ="background-color:rgb(35, 148, 200);";
				$color ="rgb(35, 148, 200);";
			}elseif($tnType == 'PX') {
				$headerTitle = 'Payment';
				$endStatus = 'Check Released';
				$addtlWhere = '';
				$bg ="background-color:rgb(204, 155, 57);";
				$color ="rgb(204, 155, 57);";
			}

			$sql = "SELECT Quarter, round(avg(diff)) as aveg, round(sum(diff)) as sumdiff, count(diff) as cnt FROM (
						SELECT 
						a.TrackingNumber, a.Status, a.DateEncoded, a.DateModified, DATEDIFF(substr(a.DateModified,1,10),substr(a.DateEncoded,1,10)) as diff,
						CASE
						WHEN a.PR_Month < 4  THEN 1
						WHEN a.PR_Month < 7  THEN 2
						WHEN a.PR_Month < 10  THEN 3
						ELSE 4
						END as Quarter
						FROM vouchercurrent a
						WHERE 
						a.TrackingType = '".$tnType."' 
						and a.Status = '".$endStatus."' 
						and a.TrackingNumber NOT IN (SELECT TrackingNumber FROM voucherhistory WHERE substr(Status, 1, 7) = 'Pending' ".$addtlWhere." GROUP BY TrackingNumber) 
						group by TrackingNumber order by Quarter
					) c group by Quarter;";

			$record = $this->query($sql);

			$rows = $this->num_rows($record);
			$sheet .= '	<table border="0" cellpadding="0" style="border-spacing:0px; margin:0px auto; min-width:600px; border:1px solid '.$color.';">
							<tr>
								<td colspan="3" style="'.$bg.' color:white; padding:0px 20px; font-size:18px;">'.$headerTitle.'</td>
							</tr>
							<tr>
								<td colspan="3" style="padding:5px 0px;"></td>
							</tr>
							<tr>
								<td style="width:33.33%; text-align:center; vertical-align:top;">Quarter</td>
								<td style="width:33.33%; text-align:center; vertical-align:top;">Transaction</td>
								<td style="width:33.33%; text-align:center; vertical-align:top;">Average Time<span style="color:gray; font-size:12px; display:block;">(in days)</span></td>
							</tr>';
			
			$totalDays = 0;
			while ($data = $this->fetch_array($record)) {
				$qtr = $data['Quarter'];
				$avg = $data['aveg'];
				$cnt = $data['cnt'];

				$totalDays += $avg;

				$sheet .= '	<tr>
								<td style="text-align:center;">'.$qtr.'</td>
								<td style="text-align:center;">'.$cnt.'</td>
								<td style="text-align:center;">'.$avg.'</td>
							</tr>';
			}

			$totAvg = round($totalDays/$rows);
			$sheet .= '	<tr>
							<td style="text-align:center;"></td>
							<td style="text-align:center;"></td>
							<td style="text-align:center;">
								<span style="border-top:1px solid silver; font-size:32px; padding:0px 15px;">'.$totAvg.'</span>
							</td>
						</tr>';

			$sheet .= '	</table>';

			return $sheet.'*j*'.$totAvg;
			
		}

		function createProcessTime($transaction,$labelTransaction,$status){
			
			if($transaction =="PR"){
				$bg ="background-color:rgb(31, 173, 45);";
				$color ="rgb(31, 173, 45);";
			}else if($transaction =="PO"){
				$bg ="background-color:rgb(35, 148, 200);";
				$color ="rgb(35, 148, 200);";
			}else{
				$bg ="background-color:rgb(204, 155, 57);";
				$color ="rgb(204, 155, 57);";
			}
			
			
			$sql ="Select * from(select a.Quarter,count(1) as Transaction,round(avg(CalendarDays)) as Average from(
					SELECT TrackingNumber,
					case 
						when PR_Month >= 1 and PR_Month <= 3 then 1
						when PR_Month >= 4 and PR_Month <= 6 then 2
						when PR_Month >= 7 and PR_Month <= 9 then 3
						else 4
					end as Quarter
					,substr(DateEncoded,1,10) as Created, substr(DateModified,1,10) as Updated,Status,
					(TO_DAYS(SUBSTR(`DateModified`, 1, 10)) - TO_DAYS(SUBSTR(`DateEncoded`, 1, 10))) AS CalendarDays 
					FROM vouchercurrent 
					where trackingtype = '" . $transaction . "' and status = '" . $status . "' 
					group by trackingnumber order by TrackingNumber  desc) a 
					group by Quarter) a left join
					( select sum(b.Count) as Pending,Quarter
						 from 
						 (select case 
							when PR_Month >= 1 and PR_Month <= 3 then 1
							when PR_Month >= 4 and PR_Month <= 6 then 2
							when PR_Month >= 7 and PR_Month <= 9 then 3
							else 4
						end as Quarter,TrackingNumber,TrackingType from vouchercurrent where trackingtype = '" . $transaction . "' and status = '" . $status . "'  and PR_Month >= 1  group by TrackingNumber) a 
						 left join 
						 (select TrackingNumber ,count(1) as Count from voucherhistory where substr(Status,1,10) = 'Pending at' group by TrackingNumber) b on a.TrackingNumber = b.TrackingNumber where Count > 0 
						 group by Quarter) b on a.Quarter = b.Quarter
					
					";
				 
			$record = $this->query($sql);
			$sheet = '<table style ="text-align:center;margin:0 auto;width:600px;border-spacing:0;margin-bottom:10px;" border ="0">';
			
			$sheet .= '<tr style ="font-size:18px;">
							<td colspan ="100%" style ="text-align:left;padding:0px 20px;' . $bg . ';color:white;">' . $labelTransaction . '</td>
						</tr>';
			$sheet .= '<tr style ="font-size:14px;">';
			$sheet .= '<tr style ="font-size:32px;"><td  colspan ="100%" style ="border:1px solid '.$color . 'border-top:0px;border-bottom:0px;padding:5px;"></td></tr>';
			$sheet .= '<td style ="border-left:1px solid ' . $color . 'vertical-align:top;">Quarter</td>';
			$sheet .= '<td style ="vertical-align:top;">Transaction</td>';
			$sheet .= '<td style ="vertical-align:top;">Pending</td>';
			
			$sheet .= '<td style ="border-right:1px solid ' . $color . 'vertical-align:top;line-height:16px;">Average Time<br/><span style ="color:grey;font-size:12px;">(in days)</span></td>';
			$sheet .= '</tr>';
			
			$total = 0;	
			$totalPending = 0;
			$i=0;
			while($data = $this->fetch_array($record)){
				$i++;
				$quarter = $data['Quarter'];
				$trans = $data['Transaction'];
				$average = $data['Average'];
				$pending = $data['Pending'];
				$total += $average;
				$totalPending += $pending;
				$sheet .= '<tr style ="">';
				$sheet .= '<td style ="border-left:1px solid ' . $color . '">' . $quarter . '</td>';
				$sheet .= '<td>' . $trans . '</td>';
				$sheet .= '<td>' . $pending . '</td>';
				$sheet .= '<td style ="border-right:1px solid ' . $color . '">' . $average . ' </td>';
				$sheet .= '</tr>';
			}
			$totalAve = $total / $i;
			$sheet .= '<tr style ="font-size:32px;"><td  colspan ="3" style ="border-left:1px solid ' . $color . '"></td><td style ="border-right:1px solid ' . $color . '"><div style ="display:inline-block;border-top:1px solid silver;padding:0 15px;"> ' . round($totalAve) . '</div></td></tr>';
			$sheet .= '<tr style ="font-size:32px;"><td  colspan ="100%" style ="border:1px solid '.$color . 'border-top:0px;"></td></tr>';
			
			$sheet .= '</table>';
			
			return array('sheet' => $sheet, 'total' => round($totalAve), 'totalPending' => round($totalPending));
			//return $sheet;
		}
		function createTopPemeRank($type,$quarter,$labelType){
			$case = '';
			if($quarter == 1){
				$case = 'and (PR_Month >= 1 and PR_Month <= 3)';
				$labelQtr = '1st Quarter';
			}else if($quarter == 2){
				$case = 'and (PR_Month >= 4 and PR_Month <= 6)';
				$labelQtr = '2nd Quarter';
			}else if($quarter == 3){
				$case = 'and (PR_Month >= 7 and PR_Month <= 9)';
				$labelQtr = '3rd Quarter';
			}else if($quarter == 4){
				$case = 'and PR_Month >= 10';
				$labelQtr = '4th Quarter';
			}else{
				$case = 'and (PR_Month >= 1 and PR_Month <= 12)';
				$labelQtr = 'All Quarters';
			}
			
			$case1 = " status in " . $type;
		
			$sql = "select *  from(
					select b.Name,sum(a.Count) as Pending  from(select a.TrackingNumber,a.Office,b.Count,b.Status from(select Office,TrackingNumber  from vouchercurrent 
						where $case1 $case group by TrackingNumber) a
					left join (select TrackingNumber,count(1) as Count,Status  from voucherhistory where substr(Status,1,10) = 'Pending at' group by TrackingNumber) b
					on a.TrackingNumber  = b.TrackingNumber where Count > 0) a
					left join office b on  a.Office = b.Code
					group by Name order by Pending desc
					) a";
			
			$record = $this->query($sql);
			
			
			$qtr = substr($labelQtr,0,1);
			if(!is_numeric($qtr)){
				$qtr = 5;
			}
			$i = 0;
			$x = 1;
			$sheet = '<table id ="topTable' . $qtr . '" class ="topTable" style ="background-color:white;padding:20px 25px;width:100%;" border = "0">';
			$sheet .= '<tr ><th colspan ="100%" style ="padding-left:0;padding-bottom:10px;">
							<table style ="width:100%;text-align:left;line-height:14px;" border ="0">
								<tr style =""><th colspan ="100%" style ="padding:0;text-align:left;font-family:Anton;font-size:24px;line-height:24px;color:rgb(92, 112, 90);">
								Pending Metrics Ranking<span style ="color:rgb(192, 82, 82);"> (PEMERANK)</span></th></tr>
								<tr style =""><th colspan ="100%" style ="padding:0;border:0;font-size:14px;"> Top offices with the most pending ' . $labelType . ' transactions
								in ' . $labelQtr . '</spn></th></tr>
							</table>	
					  </th></tr>';
			$sheet .= '<tr style ="background-color:rgb(250, 243, 240);">';
			$sheet .= '<th ></th>';
			$sheet .= '<th style ="text-align:left;font-weight:bold;" >Office</th>';
			$sheet .= '<th style ="font-weight:bold;">Pending</th>';
			$sheet .= '<th style ="width:1px;font-weight:bold;">Rank</th>';
			$sheet .='</tr>';
			$sheet .= '<tr><th colspan ="100%" style ="border-top:1px solid silver;"></th></tr>';
			$total = 0;
			$lastPending = 0;
			while($data = $this->fetch_array($record)){
				$pending  =  $data['Pending'];
				if($lastPending != $pending){
					$i++;
				}
				$officeName  =  strtoupper($data['Name']);
				
				$total += $pending;
				$sheet .= '<tr style = "">';
				$sheet .= '<td style ="width:1px;color:grey;">' . $x++ . '</td>';
				$sheet .= '<td style ="text-align:left;font-size:14px;">' . $officeName . '</td>';
				$sheet .= '<td style ="">' . $pending . '</td>';
				$sheet .= '<td style = "padding:0;font-size:16px;vertical-align:middle;background-colo1r:rgb(224, 226, 222)"><div style ="width:100%;height:100%;padding:10px 0px;">' . $i . '</div></td>';
				$sheet .= '</tr>';
				$lastPending = $pending;
			}
			$sheet .= '<tr style = "">';
			$sheet .= '<td colspan ="3"></span>';
			$sheet .= '<td style = "border-top:1px solid silver;text-align:center;font-weight:bold;" >' . $total .  '</td>';
			$sheet .= '</table>';
			return $sheet;
		}
		function createToppendingOfficeList($type,$quarter,$stat,$labelType,$office){
			$case = '';
			if($quarter == 1){
				$case = 'and (PR_Month >= 1 and PR_Month <= 3)';
				$labelQtr = '1st Quarter';
			}else if($quarter == 2){
				$case = 'and (PR_Month >= 4 and PR_Month <= 6)';
				$labelQtr = '2nd Quarter';
			}else if($quarter == 3){
				$case = 'and (PR_Month >= 7 and PR_Month <= 9)';
				$labelQtr = '3rd Quarter';
			}else if($quarter == 4){
				$case = 'and PR_Month >= 10';
				$labelQtr = '4th Quarter';
			}else{
				$case = 'and (PR_Month >= 1 and PR_Month <= 12)';
				$labelQtr = 'All Quarters';
			}
			
			$case1 = " status in " . $type;
		
			$sql = "select *  from(
					select b.Name,sum(a.Count) as Pending  from(select a.TrackingNumber,a.Office,b.Count,b.Status from(select Office,TrackingNumber  from vouchercurrent 
						where $case1 $case group by TrackingNumber) a
					left join (select TrackingNumber,count(1) as Count,Status  from voucherhistory where Status = '" . $stat . "' group by TrackingNumber) b
					on a.TrackingNumber  = b.TrackingNumber where Count > 0) a
					left join office b on  a.Office = b.Code
					group by Name order by Pending desc
					) a";
			
			$record = $this->query($sql);
			
			
			$qtr = substr($labelQtr,0,1);
			if(!is_numeric($qtr)){
				$qtr = 5;
			}
			$i = 1;
			$sheet = '<table id ="topTable' . $qtr . '" class ="topTable" style ="background-color:white;padding:20px 25px;width:100%;" border = "0">';
			$sheet .= '<tr ><th colspan ="100%" style ="padding-left:0;padding-bottom:10px;">
							<table style ="width:100%;text-align:left;line-height:14px;" >
								<tr style =""><th colspan ="100%" style ="padding:0;text-align:left;font-family:Anton;font-size:24px;line-height:24px;color:rgb(92, 112, 90);">
								Pending Metrics Ranking<span style ="color:rgb(192, 82, 82);"> (PEMERANK)</span></th></tr>
								<tr style =""><th colspan ="100%" style ="padding:0;border:0;font-size:14px;"> Top offices with the most pending ' . $labelType . ' transactions in
								' . $labelQtr . '</th></tr>
							</table>	
					  </th></tr>';
			$sheet .= '<tr style ="background-color:rgb(250, 243, 240);">';
			$sheet .= '<th style ="width:1px;font-weight:bold;">Rank</th>';
			$sheet .= '<th style ="text-align:left;font-weight:bold;" >Office</th>';
			$sheet .= '<th style ="font-weight:bold;">Pending</th>';
			$sheet .='</tr>';
			$sheet .= '<tr><th colspan ="100%" style ="border-top:1px solid silver;"></th></tr>';
			$total = 0;
			
			while($data = $this->fetch_array($record)){
				$officeName  =  strtoupper($data['Name']);
				$pending  =  $data['Pending'];
				$total += $pending;
				$sheet .= '<tr style = "">';
				$sheet .= '<td style = "padding:0;font-size:16px;vertical-align:middle;background-colo1r:rgb(224, 226, 222)"><div style ="width:100%;height:100%;padding:10px 0px;">' . $i++ . '</div></td>';
				$sheet .= '<td style ="text-align:left;font-size:14px;">' . $officeName . '</td>';
				$sheet .= '<td style ="">' . $pending . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr style = "">';
			$sheet .= '<td colspan ="2"></span>';
			$sheet .= '<td style = "border-top:1px solid silver;text-align:center;font-weight:bold;" >' . $total .  '</td>';
			$sheet .= '</table>';
			return $sheet;
		}
		
		function createTopPending($quarter,$type,$labelType){
			return  '<div style ="width:1000px;margin:0 auto;">
						<div>' . $this->createTopPendingMenu() . '</div> 
						<div id = "topPendingContainer">' .  $this->createTopPendingData($labelType,$quarter,$type) . '</div>
					 </div>';
		}
		function createTopPendingMenu(){
			$sheetTopMenu = '<table style ="width:100%;border-spacing:2;font-size:12px; " border ="0">
								<tr>
									<td></td>
									<td style ="width:1px;font-family:arial;padding:0px 5px;background-col1or:rgb(214, 216, 210);text-align:right;font-weight:bold;">Transaction</td>
									<td style ="width:1px;background: linear-gradient(to right,rgb(222, 225, 219) ,transparent);">
										<table id  ="tableTopPendingTransaction" border ="0" style ="border-spacing:0;border-spacing:0;font-size:14px;">
											<tr style = "white-space:nowrap; ">
												<td><input id ="chkTopPendingPR" value ="PR" type ="checkbox" checked/></td><td><label for ="chkTopPendingPR">PR&nbsp;</label></td>
												<td><input id ="chkTopPendingPO" value ="PO" type ="checkbox"/></td><td><label for ="chkTopPendingPO">PO&nbsp;&nbsp;</label></td>
												<td><input id ="chkTopPendingPX" value ="PX" type ="checkbox"/></td><td><label for ="chkTopPendingPX">Payment</label></td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td></td>
									<td style ="width:1px;font-family:arial;padding:0px 5px;text-align:right;back1ground-color:rgb(214, 216, 210);font-weight:bold;">Quarter</td>
									<td style ="width:1px;background: linear-gradient(to right,rgb(246, 251, 243) ,transparent);">
										<table id  ="tableTopPendingQuarter" border ="0" style ="border-spacing:0;border-spacing:0;font-size:14px;">
											<tr>';
									 $sheetTopMenu .= '<td><input id ="chkTopPendingFirst" type ="checkbox" checked onclick ="selectTopPendingQuarter(this,1)"/></td><td><label for ="chkTopPendingFirst">1st</label></td>';
									 $sheetTopMenu .= '<td><input id ="chkTopPendingSecond" type ="checkbox" onclick ="selectTopPendingQuarter(this,2)"/></td><td><label for ="chkTopPendingSecond">2nd</label></td>
												<td><input id ="chkTopPendingThird" type ="checkbox" onclick ="selectTopPendingQuarter(this,3)"/></td><td><label for ="chkTopPendingThird">3rd</label></td>
												<td><input id ="chkTopPendingFourth" type ="checkbox" onclick ="selectTopPendingQuarter(this,4)"/></td><td><label for ="chkTopPendingFourth">4th</label></td>
												<td><input id ="chkTopPendingAll" type ="checkbox" onclick ="selectTopPendingQuarter(this,5)"/></td><td><label for ="chkTopPendingAll">All</label></td>
											</tr>
										</table>
									</td>
								</tr>
							  </table>';
			return $sheetTopMenu;
		}
		function createTopPendingData($labelType,$quarter,$type){
			$case = '';
			if($quarter == 1){
				$case = 'and (PR_Month >= 1 and PR_Month <= 3)';
				$labelQtr = '1st Quarter';
			}else if($quarter == 2){
				$case = 'and (PR_Month >= 4 and PR_Month <= 6)';
				$labelQtr = '2nd Quarter';
			}else if($quarter == 3){
				$case = 'and (PR_Month >= 7 and PR_Month <= 9)';
				$labelQtr = '3rd Quarter';
			}else if($quarter == 4){
				$case = 'and PR_Month >= 10';
				$labelQtr = '4th Quarter';
			}else{
				$case = 'and (PR_Month >= 1 and PR_Month <= 12)';
				$labelQtr = 'All Quarters';
			}
			
			$case1 = " status in " . $type;
		
			
			$sql = "select a.*,b.Office from(
					select a.Pending,sum(Count) as Count,TrackingType from( select a.Status,b.Status as Pending, b.Count,TrackingType from 
					(select Office,TrackingNumber,TrackingType,Status,DateEncoded from vouchercurrent where $case1  $case group by TrackingNumber) a 
					left join (select * ,count(1) as Count from voucherhistory where substr(Status,1,10) = 'Pending at' group by Status,TrackingNumber) b 
					on a.TrackingNumber = b.TrackingNumber where Count > 0 ) a group by Pending) 
					a left join status  b on a.Pending = b.Status and a.TrackingType = b.Type order by Count Desc";		
					
	
			$record = $this->query($sql);
			
			
			$qtr = substr($labelQtr,0,1);
			if(!is_numeric($qtr)){
				$qtr = 5;
			}
			$i = 1;
			$sheet = '<table id ="topPendingTable' . $qtr . '" class ="topTable" style ="background-color:white;padding:20px 25px;width:100%;" border ="0" >';
			$sheet .= '<tr ><th colspan ="100%" style ="padding-left:0;">
							<table style ="width:100%;margin-bottom:10px;" >
								<tr style =""><th colspan ="100%" style ="border:0;text-align:center;font-family:Anton;font-size:26px;line-height:20px;color:rgb(92, 112, 90);">Procurement Pending Metrics</th></tr>
								<tr style =""><th colspan ="100%" style ="text-align:center;border:0;">
									<span style ="font-weight:bold;color:rgb(92, 112, 90);font-size:18px;">' . $labelType . '</span>,
									<span style ="border:0;font-weight:bold;color:rgb(235, 14, 14);">' . $labelQtr . '</span></th></tr>
							</table>	
					  </th></tr>';
			$sheet .= '<tr style ="background-color:rgb(192, 82, 82);color:white;">';
			$sheet .= '<th style ="width:1px;">No</th>';
			$sheet .= '<th style ="text-align:left;" >Office</th>';
			$sheet .= '<th style ="text-align:left;" >Status</th>';
			$sheet .= '<th style ="text-align:center;" >Count</th>';
			$sheet .='</tr>';
			$total = 0;
			while($data = $this->fetch_array($record)){
				$officeName  =  strtoupper($data['Office']);
				$count =  $data['Count'];
				$pendingStatus =  $data['Pending'];
				$total  += $count;
				$sheet .= '<tr onclick ="showPendingOfficeList(this, \''. $pendingStatus .'\')">';
				$sheet .= '<td style = "padding:0;font-size:12px;color:grey;vertical-align:middle;"><div style ="width:100%;height:100%;padding:10px 0px;color:red;">' . $i++ . '</div></td>';
				$sheet .= '<td style ="text-align:left;font-size:14px;">' . $officeName . '</td>';
				$sheet .= '<td style ="text-align:left;">' . $pendingStatus . '</td>';
				$sheet .= '<td style ="text-align:center;">' . $count . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr><th colspan ="3"></th><th style ="text-align:center;font-size:22px;border-top:1px solid silver;font-weight:bold;" onclick ="showPemerankALL()">' . $total . '</th></tr>';
			$sheet .= '<tr><th colspan ="100%" id ="topPendingOfficeList' . $qtr . '"></th></tr>';
			$sheet .= '</table>';
			
			return $sheet;
		}
		function createToppendingEfficiencyClick($quarter,$type,$labelType){
			return  $this->createTopPendingData($labelType,$quarter,$type);	 
		}
		function createTopEfficiencyClick($quarter,$type,$labelType,$account){
			return  $this->createTopData($labelType,$quarter,$type,$account);	 
		}
		function createTopEfficiency($quarter,$type,$labelType,$account){
			return  '<div style ="width:1000px;margin:0 auto;">
						<div>' . $this->createTopMenu() . '</div> 
						<div id = "topContainer">' .  $this->createTopData($labelType,$quarter,$type,$account) . '</div>
					 </div>';
		}
		function createTopMenu(){
			$sheetTopMenu = '<table style ="width:100%;border-spacing:2;font-size:12px; " border ="0">
								<tr>
									<td></td>
									<td style ="width:1px;font-family:arial;padding:0px 5px;background-col1or:rgb(214, 216, 210);text-align:right;font-weight:bold;">Account</td>
									<td style ="width:1px;background: linear-gradient(to right,rgb(222, 225, 219) ,transparent);">
										<table id  ="tableTopType" border ="0" style ="border-spacing:0;border-spacing:0;font-size:14px;">
											<tr style = "white-space:nowrap; ">
												<td><input id ="chkTopType1" value ="1" type ="checkbox" checked/></td><td><label for ="chkTopType1">City</label></td>
												<td style ="padding-left:21px;"><input id ="chkTopType2" value ="2" type ="checkbox"/></td><td style ="padding-left:4px;"><label for ="chkTopType2">Nat\'l</label></td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td></td>
									<td style ="width:1px;font-family:arial;padding:0px 5px;background-col1or:rgb(214, 216, 210);text-align:right;font-weight:bold;">Transaction</td>
									<td style ="width:1px;background: linear-gradient(to right,rgb(222, 225, 219) ,transparent);">
										<table id  ="tableTopTransaction" border ="0" style ="border-spacing:0;border-spacing:0;font-size:14px;">
											<tr style = "white-space:nowrap; ">
												<td><input id ="chkTopPR" value ="PR" type ="checkbox" checked/></td><td><label for ="chkTopPR">PR&nbsp;</label></td>
												<td style ="padding-left:24px;"><input id ="chkTopPO" value ="PO" type ="checkbox"/></td><td style ="padding-left:4px;"><label for ="chkTopPO">PO&nbsp;&nbsp;</label></td>
												<td style ="padding-left:30px;"><input id ="chkTopPX" value ="PX" type ="checkbox"/></td><td><label for ="chkTopPX">Payment</label></td>
											</tr>
										</table>
									</td>
								</tr>
								<tr>
									<td></td>
									<td style ="width:1px;font-family:arial;padding:0px 5px;text-align:right;back1ground-color:rgb(214, 216, 210);font-weight:bold;">Quarter</td>
									<td style ="width:1px;background: linear-gradient(to right,rgb(246, 251, 243) ,transparent);">
										<table id  ="tableTopQuarter" border ="0" style ="border-spacing:0;border-spacing:0;font-size:14px;">
											<tr>';
									 $sheetTopMenu .= '<td><input id ="chkTopFirst" type ="checkbox" checked onclick ="selectTopQuarter(this,1)"/></td><td><label for ="chkTopFirst">1st</label></td>';
									 $sheetTopMenu .= '<td><input id ="chkTopSecond" type ="checkbox" onclick ="selectTopQuarter(this,2)"/></td><td><label for ="chkTopSecond">2nd</label></td>
												<td style ="padding-left:13px;"><input id ="chkTopThird" type ="checkbox" onclick ="selectTopQuarter(this,3)"/></td><td><label for ="chkTopThird">3rd</label></td>
												<td><input id ="chkTopFourth" type ="checkbox" onclick ="selectTopQuarter(this,4)"/></td><td><label for ="chkTopFourth">4th</label></td>
												<td ><input id ="chkTopAll" type ="checkbox" onclick ="selectTopQuarter(this,5)"/></td><td><label for ="chkTopAll">All</label></td>
											</tr>
										</table>
									</td>
								</tr>
							  </table>';
			return $sheetTopMenu;
		}
		function createTopDataxxx($labelType,$quarter,$type,$account){
			$case = '';
			
			if($quarter == 1){
				$case = 'and (PR_Month >= 1 and PR_Month <= 3)';
				$labelQtr = '1st Quarter';
			}else if($quarter == 2){
				$case = 'and (PR_Month >= 4 and PR_Month <= 6)';
				$labelQtr = '2nd Quarter';
			}else if($quarter == 3){
				$case = 'and (PR_Month >= 7 and PR_Month <= 9)';
				$labelQtr = '3rd Quarter';
			}else if($quarter == 4){
				$case = 'and PR_Month >= 10';
				$labelQtr = '4th Quarter';
			}else{
				$case = 'and (PR_Month >= 1 and PR_Month <= 12)';
				$labelQtr = 'All Quarters';
			}
			
			$case1 = " status in " . $type;
			$case2 = " OfficeType in (" . $account .")";
			
		
			$sql = "select *,sum(NoPending) as AllTransaction,(sum(NoPending) - NoPending) as Pending, round(((NoPending / sum(NoPending)) * 100)) as EfficiencyRate from(
				select a.*,count(1) as NoPending ,c.Name as OfficeName,c.OfficeType  from(select Office,TrackingNumber,Status,DateEncoded from vouchercurrent where $case1  $case
							 group by TrackingNumber) a
				left join (
								select TrackingNumber as HistoryTracking ,Status as HistoryStatus,DateModified,if (TrackingNumber,1,0) as Pending 
				                from voucherhistory where substr(Status,1,10) = 'Pending at' group by TrackingNumber
				    ) b
				on a.TrackingNumber = b.HistoryTracking 
				left join (select * from citydoc2023.office ) c
				on a.Office = c.Code where $case2
				group by Office, Pending) a 
				
				group by Office order by EfficiencyRate desc,AllTransaction desc";
			
			$record = $this->query($sql);
			
			
			$qtr = substr($labelQtr,0,1);
			if(!is_numeric($qtr)){
				$qtr = 5;
			}
			$i = 1;
			$sheet = '<table id ="topTable' . $qtr . '" class ="topTable" style ="background-color:white;padding:20px 25px;width:100%;" >';
			$sheet .= '<tr ><th colspan ="100%" style ="padding-left:0;">
							<table style ="width:100%;margin-bottom:10px;" >
								<tr style =""><th colspan ="100%" style ="border:0;text-align:center;font-family:Anton;font-size:26px;line-height:20px;color:rgb(92, 112, 90);">
									Office Procurement Efficiency Ranking <span style ="font-family:oswald;font-weight:bold;">(OPERANK)</span></th></tr>
								<tr style =""><th colspan ="100%" style ="text-align:center;border:0;">
									<span style ="font-weight:bold;color:rgb(92, 112, 90);font-size:18px;">' . $labelType . '</span>,
									<span style ="border:0;font-weight:bold;color:rgb(67, 187, 7);">' . $labelQtr . '</span></th></tr>
							</table>	
					  </th></tr>';
			$sheet .= '<tr style ="background-color:rgb(37, 165, 7);color:white;">';
			$sheet .= '<th style ="width:1px;">No</th>';
			$sheet .= '<th style ="text-align:left;" >Office</th>';
			$sheet .= '<th>Transaction</th>';
			$sheet .= '<th>No Pending</th>';
			$sheet .= '<th>With Pending</th>';
			$sheet .= '<th colspan = "2" style= "background-color:rgb(38, 53, 1);">Efficiency</th>';

			
			$sheet .= '<th style ="background-color:rgb(203, 197, 20);">Rank</th>';
			$sheet .='</tr>';
			//$sheet .= '<tr><td colspan ="6" style ="padding:5px;"></td><td></td></tr>';
			$lastCount = 0;
			$lastEff = 1;
			
			$rank = 1;
			$bg ='';
			
			$pad = 'padding:4px 0px;';
			while($data = $this->fetch_array($record)){
				$officeName  =  strtoupper($data['OfficeName']);
				$eff =  $data['EfficiencyRate'];
				$all =  $data['AllTransaction'];
				$pending  =  $data['Pending'];
				$no  =  $data['NoPending'];
				
				
				if($lastCount > 0){
					if($lastEff == $eff ){
						if($lastCount != $no){
							$rank++;
						}
					}else{
						$rank++;
					}
				}
				if($rank % 2 == 1){
					$bg = 'background-color:rgb(243, 242, 239);';
				
					$bg1 = 'background-color:rgb(219, 217, 203);color:black;';
					
				}else{
					$bg = 'background-color:rgb(233, 239, 226);';
					$bg1 = 'background-color:rgb(212, 228, 194);color:black;';
				}
				if($eff == 100){
					if($rank <= 10){
						$rnkStyle ='font-size:22px;font-family:nor;font-weight:bold;';
					}else{
						$rnkStyle = '';
						$pad = 'padding:9px 0px;';
					}
				}else{
					if($rank <= 10){
						$rnkStyle ='font-size:22px;font-family:nor;font-weight:bold;';	
						$pad = 'padding:4px 0px;';
					}else{
						$rnkStyle = '';
						$bg = 'background-color:white;';
						$bg1 ='background-color:white;';
						$pad = 'padding:8px 0px;';
					}
				}
				
				$sheet .= '<tr style = "' . $bg . '">';
				$sheet .= '<td style = "padding:0;font-size:12px;color:grey;vertical-align:middle;background-color:rgb(224, 226, 222)"><div style ="width:100%;height:100%;padding:10px 0px;">' . $i++ . '</div></td>';
				$sheet .= '<td style ="text-align:left;font-size:14px;">' . $officeName . '</td>';
				$sheet .= '<td style ="">' . $all . '</td>';
				$sheet .= '<td >' . $no . '</td>';
				$sheet .= '<td >' . $pending . '</td>';
				
				$sheet .= '<td style ="padding-right:0;"><div style ="width:150px;border:1px solid silver;">
										 	<div style ="width:' . $eff . '%;background-color:rgb(167, 198, 27);height:15px;"></div>
										 </div></td>';
				$sheet .= '<td style ="text-align:right;font-size:arial;padding:0;padding-right:20px;">' . $eff . '<span style ="font-size:12px;">%</span></td>';
				$sheet .= '<td style ="' . $bg1 . ';padding:0px;"><div style ="width:100%;height:100%;' . $pad . $rnkStyle . ';">' . $rank . '</div></td>';
				$sheet .= '</tr>';
				
				$lastCount = $all;
				$lastEff = $eff;
				$br = 'border-bottom:1px solid rgb(216, 215, 196);';
			}
			$sheet .= '</table>';
			return $sheet;
		}

		function createTopDataxxx2($labelType,$quarter,$type,$account){
			$case = '';
			
			if($quarter == 1){
				$case = 'and (PR_Month >= 1 and PR_Month <= 3)';
				$labelQtr = '1st Quarter';
			}else if($quarter == 2){
				$case = 'and (PR_Month >= 4 and PR_Month <= 6)';
				$labelQtr = '2nd Quarter';
			}else if($quarter == 3){
				$case = 'and (PR_Month >= 7 and PR_Month <= 9)';
				$labelQtr = '3rd Quarter';
			}else if($quarter == 4){
				$case = 'and PR_Month >= 10';
				$labelQtr = '4th Quarter';
			}else{
				$case = 'and (PR_Month >= 1 and PR_Month <= 12)';
				$labelQtr = 'All Quarters';
			}
			
			$case1 = " status in " . $type;
			$case2 = " OfficeType in (" . $account .")";
			
			$sql = "select *,sum(NoPending) as AllTransaction,
							 if(sum(NoPending) = NoPending,0,NoPending) as NoPending,
							 if(sum(NoPending) = NoPending,NoPending,sum(NoPending) - NoPending) as Pending, 
							 if(sum(NoPending) = NoPending,0,round(((NoPending / sum(NoPending)) * 100))) as EfficiencyRate 
							 from(
				select a.*,count(1) as NoPending , c.Name as OfficeName,c.OfficeType  from
							(select Office,TrackingNumber,Status,DateEncoded from vouchercurrent where $case1  $case group by TrackingNumber) a
				left join 
							(select TrackingNumber as HistoryTracking ,Status as HistoryStatus,DateModified,if (TrackingNumber,1,0) as Pending 
							from voucherhistory where substr(Status,1,10) = 'Pending at' and TrackingNumber != '' group by TrackingNumber
				    ) b
				on a.TrackingNumber = b.HistoryTracking 
				left join (select * from office ) c
				on a.Office = c.Code where $case2
				group by Office, Pending) a 
				
				group by Office order by EfficiencyRate desc,AllTransaction desc";
				
				
			/*$sql = "select *,sum(NoPending) as AllTransaction,(sum(NoPending) - NoPending) as Pending, round(((NoPending / sum(NoPending)) * 100)) as EfficiencyRate from(
				select a.*,count(1) as NoPending ,c.Name as OfficeName,c.OfficeType  from(select Office,TrackingNumber,Status,DateEncoded from vouchercurrent where $case1  $case
							 group by TrackingNumber) a
				left join (
								select TrackingNumber as HistoryTracking ,Status as HistoryStatus,DateModified,if (TrackingNumber,1,0) as Pending 
				                from voucherhistory where substr(Status,1,10) = 'Pending at' and TrackingNumber != '' group by TrackingNumber
				    ) b
				on a.TrackingNumber = b.HistoryTracking 
				left join (select * from office ) c
				on a.Office = c.Code where $case2
				group by Office, Pending) a 
				
				group by Office order by EfficiencyRate desc,AllTransaction desc";*/
			
			$record = $this->query($sql);
			
			
			$qtr = substr($labelQtr,0,1);
			if(!is_numeric($qtr)){
				$qtr = 5;
			}
			$i = 1;
			$sheet = '<table id ="topTable' . $qtr . '" class ="topTable" style ="background-color:white;padding:20px 25px;width:100%;" >';
			$sheet .= '<tr ><th colspan ="100%" style ="padding-left:0;">
							<table style ="width:100%;margin-bottom:10px;" >
								<tr style =""><th colspan ="100%" style ="border:0;text-align:center;font-family:Anton;font-size:26px;line-height:20px;color:rgb(92, 112, 90);">
									Office Procurement Efficiency Ranking <span style ="font-family:oswald;font-weight:bold;">(OPERANK)</span></th></tr>
								<tr style =""><th colspan ="100%" style ="text-align:center;border:0;">
									<span style ="font-weight:bold;color:rgb(92, 112, 90);font-size:18px;">' . $labelType . '</span>,
									<span style ="border:0;font-weight:bold;color:rgb(67, 187, 7);">' . $labelQtr . '</span></th></tr>
							</table>	
					  </th></tr>';
			$sheet .= '<tr style ="background-color:rgb(37, 165, 7);color:white;">';
			$sheet .= '<th style ="width:1px;">No</th>';
			$sheet .= '<th style ="text-align:left;" >Office</th>';
			$sheet .= '<th>Transaction</th>';
			$sheet .= '<th>No Pending</th>';
			$sheet .= '<th>With Pending</th>';
			$sheet .= '<th colspan = "2" style= "background-color:rgb(38, 53, 1);">Efficiency</th>';

			
			$sheet .= '<th style ="background-color:rgb(203, 197, 20);">Rank</th>';
			$sheet .='</tr>';
			//$sheet .= '<tr><td colspan ="6" style ="padding:5px;"></td><td></td></tr>';
			$lastCount = 0;
			$lastEff = 1;
			
			$rank = 1;
			$bg ='';
			
			$pad = 'padding:4px 0px;';
			while($data = $this->fetch_array($record)){
				$officeName  =  strtoupper($data['OfficeName']);
				$eff =  $data['EfficiencyRate'];
				$all =  $data['AllTransaction'];
				$pending  =  $data['Pending'];
				$no  =  $data['NoPending'];
				
				if($lastCount > 0){
					if($lastEff == $eff ){
						if($lastCount != $no){
							$rank++;
						}
					}else{
						$rank++;
					}
				}
				if($rank % 2 == 1){
					$bg = 'background-color:rgb(243, 242, 239);';
				
					$bg1 = 'background-color:rgb(219, 217, 203);color:black;';
					
				}else{
					$bg = 'background-color:rgb(233, 239, 226);';
					$bg1 = 'background-color:rgb(212, 228, 194);color:black;';
				}
				if($eff == 100){
					if($rank <= 10){
						$rnkStyle ='font-size:22px;font-family:nor;font-weight:bold;';
					}else{
						$rnkStyle = '';
						$pad = 'padding:9px 0px;';
					}
				}else{
					if($rank <= 10){
						$rnkStyle ='font-size:22px;font-family:nor;font-weight:bold;';	
						$pad = 'padding:4px 0px;';
					}else{
						$rnkStyle = '';
						$bg = 'background-color:white;';
						$bg1 ='background-color:white;';
						$pad = 'padding:8px 0px;';
					}
				}
				
				$sheet .= '<tr style = "' . $bg . '">';
				$sheet .= '<td style = "padding:0;font-size:12px;color:grey;vertical-align:middle;background-color:rgb(224, 226, 222)"><div style ="width:100%;height:100%;padding:10px 0px;">' . $i++ . '</div></td>';
				$sheet .= '<td style ="text-align:left;font-size:14px;">' . $officeName . '</td>';
				$sheet .= '<td style ="">' . $all . '</td>';
				$sheet .= '<td >' . $no . '</td>';
				$sheet .= '<td >' . $pending . '</td>';
				
				$sheet .= '<td style ="padding-right:0;"><div style ="width:150px;border:1px solid silver;">
										 	<div style ="width:' . $eff . '%;background-color:rgb(167, 198, 27);height:15px;"></div>
										 </div></td>';
				$sheet .= '<td style ="text-align:right;font-size:arial;padding:0;padding-right:20px;">' . $eff . '<span style ="font-size:12px;">%</span></td>';
				$sheet .= '<td style ="' . $bg1 . ';padding:0px;"><div style ="width:100%;height:100%;' . $pad . $rnkStyle . ';">' . $rank . '</div></td>';
				$sheet .= '</tr>';
				
				$lastCount = $all;
				$lastEff = $eff;
				$br = 'border-bottom:1px solid rgb(216, 215, 196);';
			}
			$sheet .= '</table>';
			return $sheet;
		}

		function createTopData($labelType,$quarter,$type,$account){
			$case = '';
			
			if($quarter == 1){
				$case = 'and (PR_Month >= 1 and PR_Month <= 3)';
				$labelQtr = '1st Quarter';
			}else if($quarter == 2){
				$case = 'and (PR_Month >= 4 and PR_Month <= 6)';
				$labelQtr = '2nd Quarter';
			}else if($quarter == 3){
				$case = 'and (PR_Month >= 7 and PR_Month <= 9)';
				$labelQtr = '3rd Quarter';
			}else if($quarter == 4){
				$case = 'and PR_Month >= 10';
				$labelQtr = '4th Quarter';
			}else{
				$case = 'and (PR_Month >= 1 and PR_Month <= 12)';
				$labelQtr = 'All Quarters';
			}
			
			$case1 = " status in " . $type;
			$case2 = " OfficeType in (" . $account .")";
			
		
			$sql = "SELECT 
						vc.Office,
						o.Name AS OfficeName,
						o.OfficeType,
						COUNT(vc.TrackingNumber) AS AllTransaction,
						SUM(CASE WHEN vh.HistoryTracking IS NULL THEN 1 ELSE 0 END) AS NoPending,
						SUM(CASE WHEN vh.HistoryTracking IS NOT NULL THEN 1 ELSE 0 END) AS Pending,
						IF(COUNT(vc.TrackingNumber) = 0, 0, ROUND((SUM(CASE WHEN vh.HistoryTracking IS NULL THEN 1 ELSE 0 END) / COUNT(vc.TrackingNumber)) * 100)) AS EfficiencyRate
						FROM 
							(SELECT Office, TrackingNumber, Status, DateEncoded 
							FROM vouchercurrent 
							WHERE $case1 $case 
							GROUP BY TrackingNumber, Office) vc
						LEFT JOIN 
							(SELECT TrackingNumber AS HistoryTracking, Status AS HistoryStatus, DateModified 
							FROM voucherhistory 
							WHERE SUBSTR(Status, 1, 10) = 'Pending at' AND TrackingNumber != '' 
							GROUP BY TrackingNumber) vh 
						ON vc.TrackingNumber = vh.HistoryTracking
						LEFT JOIN 
							(SELECT Code, Name, OfficeType 
							FROM office) o 
						ON vc.Office = o.Code 
						WHERE $case2
					GROUP BY vc.Office, o.Name, o.OfficeType 
				ORDER BY EfficiencyRate DESC, AllTransaction DESC;";


			
			$record = $this->query($sql);
			
			// echo $sql;
			$qtr = substr($labelQtr,0,1);
			if(!is_numeric($qtr)){
				$qtr = 5;
			}
			$i = 1;
			$sheet = '<table id ="topTable' . $qtr . '" class ="topTable" style ="background-color:white;padding:20px 25px;width:100%;" >';
			$sheet .= '<tr ><th colspan ="100%" style ="padding-left:0;">
							<table style ="width:100%;margin-bottom:10px;" >
								<tr style =""><th colspan ="100%" style ="border:0;text-align:center;font-family:Anton;font-size:26px;line-height:20px;color:rgb(92, 112, 90);">
									Office Procurement Efficiency Ranking <span style ="font-family:oswald;font-weight:bold;">(OPERANK)</span></th></tr>
								<tr style =""><th colspan ="100%" style ="text-align:center;border:0;">
									<span style ="font-weight:bold;color:rgb(92, 112, 90);font-size:18px;">' . $labelType . '</span>,
									<span style ="border:0;font-weight:bold;color:rgb(67, 187, 7);">' . $labelQtr . '</span></th></tr>
							</table>	
					  </th></tr>';
			$sheet .= '<tr style ="background-color:rgb(37, 165, 7);color:white;">';
			$sheet .= '<th style ="width:1px;">No</th>';
			$sheet .= '<th style ="text-align:left;" >Office</th>';
			$sheet .= '<th>Transaction</th>';
			$sheet .= '<th>No Pending</th>';
			$sheet .= '<th>With Pending</th>';
			$sheet .= '<th colspan = "2" style= "background-color:rgb(38, 53, 1);">Efficiency</th>';

			
			$sheet .= '<th style ="background-color:rgb(203, 197, 20);">Rank</th>';
			$sheet .='</tr>';
			//$sheet .= '<tr><td colspan ="6" style ="padding:5px;"></td><td></td></tr>';
			$lastCount = 0;
			$lastEff = 1;
			
			$rank = 1;
			$bg ='';
			
			$pad = 'padding:4px 0px;';

			 $totalTransactions = 0;
			 $totalNoPending = 0;
			 $totalPending = 0;
			 $totalEfficiency = 0;
			 $recordCount = 0;

			while($data = $this->fetch_array($record)){
				$officeName  =  strtoupper($data['OfficeName']);
				$eff =  $data['EfficiencyRate'];
				$all =  $data['AllTransaction'];
				$pending  =  $data['Pending'];
				$no  =  $data['NoPending'];

				 // Accumulate totals
				 $totalTransactions += $all;
				 $totalNoPending += $no;
				 $totalPending += $pending;
				 $totalEfficiency += $eff;
				 $recordCount++;
				
				
				if($lastCount > 0){
					if($lastEff == $eff ){
						if($lastCount != $no){
							$rank++;
						}
					}else{
						$rank++;
					}
				}
				if($rank % 2 == 1){
					$bg = 'background-color:rgb(243, 242, 239);';
				
					$bg1 = 'background-color:rgb(219, 217, 203);color:black;';
					
				}else{
					$bg = 'background-color:rgb(233, 239, 226);';
					$bg1 = 'background-color:rgb(212, 228, 194);color:black;';
				}
				if($eff == 100){
					if($rank <= 10){
						$rnkStyle ='font-size:22px;font-family:nor;font-weight:bold;';
					}else{
						$rnkStyle = '';
						$pad = 'padding:9px 0px;';
					}
				}else{
					if($rank <= 10){
						$rnkStyle ='font-size:22px;font-family:nor;font-weight:bold;';	
						$pad = 'padding:4px 0px;';
					}else{
						$rnkStyle = '';
						$bg = 'background-color:white;';
						$bg1 ='background-color:white;';
						$pad = 'padding:8px 0px;';
					}
				}
				
				$sheet .= '<tr style = "' . $bg . '">';
				$sheet .= '<td style = "padding:0;font-size:12px;color:grey;vertical-align:middle;background-color:rgb(224, 226, 222)"><div style ="width:100%;height:100%;padding:10px 0px;">' . $i++ . '</div></td>';
				$sheet .= '<td style ="text-align:left;font-size:14px;">' . $officeName . '</td>';
				$sheet .= '<td style ="">' . $all . '</td>';
				$sheet .= '<td >' . $no . '</td>';
				$sheet .= '<td >' . $pending . '</td>';
				
				$sheet .= '<td style ="padding-right:0;"><div style ="width:150px;border:1px solid silver;">
										 	<div style ="width:' . $eff . '%;background-color:rgb(167, 198, 27);height:15px;"></div>
										 </div></td>';
				$sheet .= '<td style ="text-align:right;font-size:arial;padding:0;padding-right:20px;">' . $eff . '<span style ="font-size:12px;">%</span></td>';
				$sheet .= '<td style ="' . $bg1 . ';padding:0px;"><div style ="width:100%;height:100%;' . $pad . $rnkStyle . ';">' . $rank . '</div></td>';
				$sheet .= '</tr>';
				
				$lastCount = $all;
				$lastEff = $eff;
				$br = 'border-bottom:1px solid rgb(216, 215, 196);';
			}
	
		 $averageEfficiency = round(($totalNoPending / $totalTransactions) * 100);

		 $sheet .= '<tr style="background-color:rgb(38, 53, 1);color:white; font-size:22px; pointer-events: none;">
                     <td colspan="2" style="text-align:right;">Total</td>
                     <td>' . $totalTransactions . '</td>
                     <td>' . $totalNoPending . '</td>
                     <td>' . $totalPending . '</td>
                     <td style="padding-right:0;">
                         <div style="width:150px;border:1px solid silver;">
                             <div style="width:' . $averageEfficiency . '%;background-color:rgb(167, 198, 27);height:15px;"></div>
                         </div>
                     </td>
                     <td style="text-align:right;font-size:arial;padding:0;padding-right:20px;">' . $averageEfficiency . '<span style="font-size:12px;">%</span></td>
                     <td></td>
                   </tr>';
		 $sheet .= '</table>';
		 $sheet .= '<div>'. $sql . '</div>';
		 

			return $sheet;
		}

		function createCalendarUsers($year,$month,$regulatoryOffice){
			
			$sql ="SELECT Office,Color FROM status where Office != '' and Type in ('PR','PO','PX') and Office != 'Implementing Agency' group by office ";
			$record = $this->query($sql);
			
			$regColor = [];
			$rTable ='<table id  ="regulatoryTable" style ="margin-bottom:-1px;font-size:12px;font-family:arial;width:95%;color:silver;border:0;padding:0;border-spacing:0;" border ="0"><tr >';
			while($data = $this->fetch_array($record)){
			 	$office = $data['Office'];
			 	$color = $data['Color'];
			 	$regColor[$office] = $color;
			 	if($office == $regulatoryOffice){
					$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatoryUsers(this)">' . $office . '</th>';
				}else{
					$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatoryUsers(this)">' . $office . '</th>';
				}
			}
			if($regulatoryOffice == "-"){
				$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatoryUsers(this)">ALL</th>';
			}else{
				$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatoryUsers(this)">ALL</th>';
			}
			
			$rTable .='</tr></table>';  
			
			if($regulatoryOffice == '-'){
				$case = ' c.RegulatoryOffice != "" ';
			}else{
				$case = ' c.RegulatoryOffice = "' . $regulatoryOffice . '"';
			}
		
			$month = $two_digit_number = sprintf('%02d', $month);
			$monthNameDisplay = $month_name = date("F", mktime(0, 0, 0, $month, 1));
			
			$searchDate = $year . '-' . $month; 
			
			$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
			$sheetDayName = '';
			$sheetDayNum = '';
			$weekEnd = [];
			for ($day = 1; $day <= $days_in_month; $day++) {
			    $timestamp = mktime(0, 0, 0, $month, $day, $year);
			    $dayName = date('D', $timestamp);
			    $dayNumber = date('j', $timestamp);
				
				$class = "headerWeekdays";
				$class1 = "headerWeekdays1";
			    if($dayName == "Sat" || $dayName == "Sun"){
					$class = "headerWeekend";
					$class1 = "headerWeekend1";
				}
			    $sheetDayName .= '<th class ="' . $class1 . '">' . $dayName . '</th>';
			    $sheetDayNum .=  '<td class ="' . $class . '">' . $dayNumber . '</td>';
			}
			
			$sheetMonth = '<th colspan ="100%"><table style ="width:97%;"><tr>';
			for($i = 1; $i <= 12; $i++){
				 $timestamp = mktime(0, 0, 0, $i, 1);
				 $monthName = date('M', $timestamp);
				 $iMonth = $two_digit_number = sprintf('%02d', $i);
				 $class ="headerMonth";
				 if($iMonth == $month){
				 	 $class ="headerMonthSelected";
				 }
				 $sheetMonth .=  "<th class ='" . $class . "' style ='' onclick ='selectmonthUsers(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
			}
			$sheetMonth .= '</tr></table></th>';
			$sheet = '<table id  ="tableCalendar" style ="margin:0 auto;" border ="0">';
			
			
			$sheet .= '<tr><th rowspan ="3" colspan ="3" style ="font-size:42px; font-weight: normal;font-family:anton;border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '
						</th> ' . $sheetMonth . '</tr>';
			$sheet .= '<tr><th colspan ="100%" style ="border-right:1px solid rgb(234, 233, 195);padding:0;background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . $rTable . '</th></tr>';		
			$sheet .= '<tr></td>' . $sheetDayName . '<td rowspan ="2" colspan ="3" style ="padding:0px 10px;background-color:rgb(38, 39, 38);" class ="rowTotal"></td></tr>';
			$sheet .= '<tr><td colspan ="2" style ="color:white;text-align:left;padding-left:27px;background-color:rgb(86, 184, 219);">Office / Document</td>
						   <td style ="color:white;background-color:rgb(86, 184, 219);text-align:left;padding-left:5px;">Status</td>' . $sheetDayNum . '</tr>';
			
		
		
			
			$sql = "select a.*,count(1) as Count,b.Name as Office, c.RegulatoryOffice from( SELECT Office, 
					Case when TrackingType = 'PR' Then 'Purchase Request' when TrackingType = 'PO' Then 'Payment' else DocumentType end as Document, Status,substr(DateModified,9,2) as Day 
					FROM vouchercurrent where substr(DateModified,1,7) = '" .  $searchDate . "' and (substr(status,1,16) = 'Pending Released' or substr(status,1,10) = 'Pending at') group by TrackingNumber) a 
					left join office b on a.Office = b.Code 
					left join (Select Office as RegulatoryOffice,Status from status where  substr(status,1,16) = 'Pending Released' or substr(status,1,10) = 'Pending at' group by Status ) c
					on a.Status = c.Status
					where " . $case . "
					group by a.Office,a.Status,Document,Day order by b.Name, Document,a.Status,Day asc";
			
			
			$sheetData = '';
			$record = $this->query($sql);
			$lastDocument = '';
			$lastOffice = '';
			$lastStatus = '';
			$lastDay = 0;
			$first  = 0;
			$rowTotal =0;
			$dayCount = 0;
			$i =1;
			while($data = $this->fetch_array($record)){
				$office = $data['Office'];
				
				$status = $data['Status'];
				$fontColor = "";
				if(preg_match("/Pending at/",trim($status))){
					$fontColor = "color:rgb(221, 39, 72);";
				}
				
				
				$document =  ucwords(strtolower($data['Document']));
				$count = $data['Count'];
				$day = $data['Day'];
				$dateTd = $searchDate . '-' . $day;
				$par  = $status .'*' . $document . '*' . $dateTd;
				if($lastOffice != $office  || $lastDocument != $document  || $lastStatus != $status ){
					
					if($first == 0){
						if($lastOffice != $office){
							$sheetData .= '<tr class ="trCalendar"><td colspan ="3" class ="calendarRegulatory" style ="border-right:1px solid rgb(233, 239, 243);"><div class = "numUsers" >' . $i++ . '</div>' . $office . '</td>';
							$sheetData .= $this->loopTDall($days_in_month,$searchDate);
							$sheetData .= '</tr>';
							
						}
						
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}else{
						if($lastOffice != $office){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
						}else{
							if($lastDocument != $document ){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
							}else{
								if($lastStatus != $status ){
									$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
								    $arr = explode("**",$arr);
								    $dayCount = $arr[1];
									$sheetData .= $arr[0];
									$dayCount = -1;
								}
							}	
						}
						$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
						$rowTotal = 0;
						$sheetData .= '</tr>';
						$dayCount++;
						if($lastOffice != $office){
							$sheetData .= '<tr class ="trCalendar" ><td colspan ="3" class ="calendarRegulatory" style ="border-right:1px solid rgb(233, 239, 243);"><div class = "numUsers" >' . $i++ . '</div>' . $office . '</td>';
							$sheetData .= $this->loopTDall($days_in_month,$searchDate);
							$sheetData .= '</tr>';
						}
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}
	
					$sheetData .= '<td colspan ="2" class ="calendarDocument" >' . $document. '</td>';
					$sheetData .= '<td  class ="calendarStatus" style ="border-right:1px solid rgba(101, 114, 97,.1);' . $fontColor . '">' . $status . '</td>';
					
					$arr = $this->loopTD($day,$dayCount,$searchDate);
				    $arr = explode("**",$arr);
				    $dayCount = $arr[1];
					$sheetData .= $arr[0];

					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarUsers(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarUsers(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}else{
					
					$arr = $this->loopTD($day - $lastDay,$dayCount,$searchDate);
					$arr = explode("**",$arr);
					$sheetData .= $arr[0];
					$dayCount = $arr[1];
					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarUsers(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarUsers(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}
				
				$rowTotal += $count;
				$lastOffice = $office;
				$lastStatus = $status;
				$lastDocument = $document;
				$lastDay = $day;
				$first = 1;	
			}
			if($rowTotal > 0){
				$arr = $this->loopTD($days_in_month - $day +1,$dayCount,$searchDate);
				$arr = explode("**",$arr);
				$sheetData .= $arr[0];
				$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
			}
			$sheetData .= '</tr>';
			$sheetData .= '<tr><th id = "calendarContainerUsers" colspan ="100%" style ="padding:10px;background-color:white;background: linear-gradient(to top,white,rgb(224, 228, 229));"></th></tr>';
			$sheet .= $sheetData;
			$sheet .= '</table>';
			echo $sheet;
			
		}
		
		function createCalendarLogs($year,$month,$regulatoryOffice){
			
			$sql ="SELECT Office,Color FROM status where Office != '' and Type in ('PR','PO','PX') and Office != 'Implementing Agency' group by office ";
			$record = $this->query($sql);
			
			$regColor = [];
			$rTable ='<table id  ="regulatoryTable" style ="margin-bottom:-1px;font-size:12px;font-family:arial;width:95%;color:silver;border:0;padding:0;border-spacing:0;" border ="0"><tr >';
			while($data = $this->fetch_array($record)){
			 	$office = $data['Office'];
			 	$color = $data['Color'];
			 	$regColor[$office] = $color;
			 	if($office == $regulatoryOffice){
					$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatoryLogs(this)">' . $office . '</th>';
				}else{
					$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatoryLogs(this)">' . $office . '</th>';
				}
			}
			if($regulatoryOffice == "-"){
				$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatory(this)">ALL</th>';
			}else{
				$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatory(this)">ALL</th>';
			}
			
			$rTable .='</tr></table>';  
			
			if($regulatoryOffice == '-'){
				$case = ' Office != "" ';
			}else{
				$case = ' Office = "' . $regulatoryOffice . '"';
			}
		
			//$month = '08'; // February
			$month = $two_digit_number = sprintf('%02d', $month);
			$monthNameDisplay = $month_name = date("F", mktime(0, 0, 0, $month, 1));
			$year = 2023;
			//$dateModified = $year . '-' . $month;
			$searchDate = $year . '-' . $month; 
			
			$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
			$sheetDayName = '';
			$sheetDayNum = '';
			$weekEnd = [];
			$statusSum = [];
			$officeSum = [];
			for ($day = 1; $day <= $days_in_month; $day++) {
				$statusSum[$day] = 0;
				$officeSum[$day] = 0;
			    $timestamp = mktime(0, 0, 0, $month, $day, $year);
			    $dayName = date('D', $timestamp);
			    $dayNumber = date('j', $timestamp);
				
				$class = "headerWeekdays";
				$class1 = "headerWeekdays1";
			    if($dayName == "Sat" || $dayName == "Sun"){
					$class = "headerWeekend";
					$class1 = "headerWeekend1";
				}
			    $sheetDayName .= '<th class ="' . $class1 . '">' . $dayName . '</th>';
			    $sheetDayNum .=  '<td class ="' . $class . '">' . $dayNumber . '</td>';
			}
			
			$sheetMonth = '<th colspan ="100%"><table style ="width:97%;"><tr>';
			for($i = 1; $i <= 12; $i++){
				 $timestamp = mktime(0, 0, 0, $i, 1);
				 $monthName = date('M', $timestamp);
				 $iMonth = $two_digit_number = sprintf('%02d', $i);
				 $class ="headerMonth";
				 if($iMonth == $month){
				 	 $class ="headerMonthSelected";
				 }
				 $sheetMonth .=  "<th class ='" . $class . "' style ='' onclick ='selectmonthLogs(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
			}
			$sheetMonth .= '</tr></table></th>';
			$sheet = '<table id  ="tableCalendarLogs" style ="margin:0 auto;" border ="0">';
			
			
			$sheet .= '<tr><th rowspan ="3" colspan ="3" style ="font-size:42px; font-weight: normal;font-family:anton;border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '
						</th> ' . $sheetMonth . '</tr>';
			$sheet .= '<tr><th colspan ="100%" style ="border-right:1px solid rgb(234, 233, 195);padding:0;background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . $rTable . '</th></tr>';		
			$sheet .= '<tr></td>' . $sheetDayName . '<td rowspan ="2" colspan ="3" style ="padding:0px 10px;background-color:rgb(38, 39, 38);" class ="rowTotal"></td></tr>';
			$sheet .= '<tr><td colspan ="2" style ="color:white;text-align:left;padding-left:27px;background-color:rgb(86, 184, 219);">Office / Document</td>
						   <td style ="color:white;background-color:rgb(86, 184, 219);text-align:left;padding-left:5px;">Status</td>' . $sheetDayNum . '</tr>';
			
			
			$statList = "'GSO Received','Pending at GSO','Inventory','Inspected'";
			$statList = "'CTO Received','Pending at CTO'";
			$statList = "'Admin Received','Pending at Admin'";
			$statList = "'CBO Received','Pending at CBO'";
			
			$statList = "'CAO Received','CBO Received','Pending at CBO'";
			$statList = "'CTO Received','GSO Received','Admin Received','Pending at Admin','Forwarded to Admin - Administration'";
			$statList = "'CTO Received','Pending at CTO'";		
			$statList = "'CAO Received','CBO Received','Admin Received','CTO Received','GSO Received','BAC Received',
					 'Pending at CBO','Pending at GSO','Pending at CAO','Pending at CTO','Pending at Admin','Pending at BAC','Forwarded to Admin - Administration'";
			
			$sql ="select a.*,b.Office,b.OfficeCode from(
					select *,count(1) as Count from(select a.*,b.TrackingType, Case 
											when b.TrackingType  = 'PR' Then 'Purchase Request' 
										    when b.TrackingType  = 'PO' Then 'Purchase Order'
										    else
												b.DocumentType
										    End
										    as Document from(SELECT TrackingNumber,Status,substr(DateModified,9,2) as Day FROM voucherhistory
					where substr(DateModified,1,7) = '" . $searchDate . "' and Status in(" . $statList . ") and TrackingNumber != '') a
					left join (select TrackingNumber,DateModified,DocumentType,TrackingType from vouchercurrent group by TrackingNumber ) b on a.TrackingNumber = b.TrackingNumber) c
					group by Status,Day,Document
					) a left join (select * from status where Status in(" . $statList . ") 
					
					
					group by Status) b on a.Status = b.Status where " . $case . "
					order by Office,status,Document,Day
					
					 ";
					 
					
			
			$sheetData = '';
			$record = $this->query($sql);
			$lastDocument = '';
			$lastOffice = '';
			$lastStatus = '';
			$lastDay = 0;
			$first  = 0;
			$rowTotal =0;
			$dayCount = 0;
			while($data = $this->fetch_array($record)){
				$office = $data['Office'];
				$officeCode = $data['OfficeCode'];
				$status = $data['Status'];
				$statusLabel = $status;
				if($status == 'Forwarded to Admin - Administration'){
					$statusLabel = 'Check for Signature';
				}
				$fontColor = "";
				if(preg_match("/Pending/",trim($status))){
					$fontColor = "color:rgb(221, 39, 72);";
				}
				
				
				$document =  ucwords(strtolower($data['Document']));
				$count = $data['Count'];
				
				$day = $data['Day'];
				
				
				$dateTd = $searchDate . '-' . $day;
				$par  = $status .'*' . $document . '*' . $dateTd;
				if($lastOffice != $office  || $lastDocument != $document  || $lastStatus != $status ){
					
					if($first == 0){
						if($lastOffice != $office){
							$sheetData .= '<tr class ="trCalendar"><td colspan ="3" class ="calendarRegulatory" style ="border-right:1px solid rgb(233, 239, 243);"><div class = "num" style = "background-color:' . $regColor[$office] . '"></div>' . $office . '</td>';
							$sheetData .= $this->loopTDall($days_in_month,$searchDate);
							$sheetData .= '</tr>';
						}
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}else{
						if($lastOffice != $office){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								
								$dayCount = -1;
						}else{
							if($lastDocument != $document ){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
							}else{
								if($lastStatus != $status ){
									$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
								    $arr = explode("**",$arr);
								    $dayCount = $arr[1];
								    
									$sheetData .= $arr[0];
									
									$dayCount = -1;
								}
							}	
						}
						$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
						//total sa count
						/*if($lastStatus != $status ){
							$arrTotal =  $this->loopTotal($days_in_month,$statusSum,$lastStatus);
							$sheetData .= $arrTotal['sheet'];
							$statusSum = $arrTotal['arrSum'];
						}*/
						
						
						$rowTotal = 0;
						$sheetData .= '</tr>';
						
						$dayCount++;
						if($lastOffice != $office){
							//total ni sa count
							/*$arrTotal =  $this->loopTotalOffice($days_in_month,$officeSum,'Workload');
							$sheetData .= $arrTotal['sheet'];
							$officeSum = $arrTotal['arrSum'];*/
							
							$sheetData .= '<tr class ="trCalendar" ><td colspan ="3" class ="calendarRegulatory" style ="border-right:1px solid rgb(233, 239, 243);"><div class = "num" style = "background-color:' . $regColor[$office] . '"></div>' . $office . '</td>';
							$sheetData .= $this->loopTDall($days_in_month,$searchDate);
							$sheetData .= '</tr>';
						}
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}
	
					$sheetData .= '<td colspan ="2" class ="calendarDocument" >' . $document. '</td>';
					$sheetData .= '<td  class ="calendarStatus" style ="border-right:1px solid rgba(101, 114, 97,.1); white-space:nowrap; ' . $fontColor . '">' . $statusLabel . '</td>';
					
					$arr = $this->loopTD($day,$dayCount,$searchDate);
				    $arr = explode("**",$arr);
				    $dayCount = $arr[1];
					$sheetData .= $arr[0];

					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarLogs(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarLogs(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}else{
					
					$arr = $this->loopTD($day - $lastDay,$dayCount,$searchDate);
					$arr = explode("**",$arr);
					$sheetData .= $arr[0];
					$dayCount = $arr[1];
					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarLogs(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarLogs(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}
				$statusSum[abs($day)] += $count;
				$officeSum[abs($day)] += $count;
				$rowTotal += $count;
				$lastOffice = $office;
				$lastStatus = $status;
				$lastDocument = $document;
				$lastDay = $day;
				$first = 1;	
			}
			if($rowTotal > 0){
				$arr = $this->loopTD($days_in_month - $day +1,$dayCount,$searchDate);
				$arr = explode("**",$arr);
				$sheetData .= $arr[0];
				$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
			}
			$sheetData .= '</tr>';
			
			/*$arrTotal =  $this->loopTotal($days_in_month,$statusSum,$status);
			$sheetData .= $arrTotal['sheet'];*/
			//total ni sa count
			$arrTotal =  $this->loopTotalOffice($days_in_month,$officeSum,'Total');
			$sheetData .= $arrTotal['sheet'];
			
			
			$sheetData .= '<tr><th id = "calendarContainerLogs" colspan ="100%" style ="padding:10px;background-color:white;background: linear-gradient(to top,white,rgb(224, 228, 229));"></th></tr>';
			$sheet .= $sheetData;
			$sheet .= '</table>';
			echo $sheet;
			
		}
		function createCalendarDetails($record){
			$sheetHeader ='';
			$sheetRowHeader = '';
			$sheet = '';
			$i =1;
			while($data = $this->fetch_array($record)){
				
				$tn = $data['TrackingNumber'];
				$claimant =$data['Claimant'];
				$document = $data['DocumentType'];
				$year = $data['Year'];
				$trackingType = $data['TrackingType'];
				$amount = $data['Amount'];
				$multiple = $data['TotalAmountMultiple'];
				$poAmount = $data['PO_Amount'];
				$officeName = ucwords(strtolower($data['OfficeName']));
				$category = $data['PR_CategoryCode'];
				$quarter = $this->numberToQuarter($data['PR_Month']);
				$description = '';
				if($trackingType == "PR"){
					$document = "Purchase Request";
					if($multiple > 0){
						$amount = $multiple;
					}
					$description = $data['Description'];
				}else if($trackingType == "PO"){
					$document = "Purchase Order";
					if($multiple > 0){
						$amount = $multiple;
					}else{
						$amount = $poAmount;
					}
					$description = $data['Description'];
				}
				$status = $data['Status'];
				$dateModified = $data['DateModified'];
				
				
				if($sheetHeader == ""){
					$sheetHeader .= '<tr style ="background: linear-gradient(to right,white,rgb(224, 228, 229));">';
					$sheetHeader .= '<td colspan ="100%" style ="padding:15px 10px;">';
					$sheetHeader .= '<table style ="line-height:10px;">';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;width:100px;">Doctrack</td><td style ="font-weight:bold;text-align:left;">' . $year . '</td></tr>';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;">Transaction</td><td style ="font-weight:bold;text-align:left;">' . $document . '</td></tr>';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;">Status</td><td style ="font-weight:bold;text-align:left;">' . $status . '</td></tr>';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;">Updated</td><td style ="font-weight:bold;text-align:left;">' . substr($dateModified,0,10) . '</td></tr>';
					$sheetHeader .= '</table>';					
					$sheetHeader .= '</tr>';
					
					$sheetRowHeader = '<tr style ="background-color:rgb(253, 248, 248);">';
					$sheetRowHeader .= '<th style ="background-color:rgb(179, 188, 180);"></th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">TN</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Office</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Claimant</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Quarter</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Category</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Description</th>';
					$sheetRowHeader .= '<th style ="text-align:right;background-color:rgb(212, 216, 212);">Amount</th>';
					$sheetRowHeader .= '<th style ="text-align:center;background-color:rgb(212, 216, 212);">Time Updated</th>';
					$sheetRowHeader .= '</tr>';
					
					
				}
				$sheet .= '<tr class ="trCalendarDetails" onclick = "clickCalendarTR(this)">';
				$sheet .= '<td style = "font-size:10px;text-align:center;background-color:rgb(218, 222, 215);">' . $i++ . '</td>';
				$sheet .= '<td onclick ="showCalendarPerTN(this)">' . $tn . '</td>';
				$sheet .= '<td>' . $officeName . '</td>';
				$sheet .= '<td>' . $claimant . '</td>';
				$sheet .= '<td>' . $quarter . '</td>';
				$sheet .= '<td>' . $category . '</td>';
			    $sheet .= '<td>' . $description . '</td>';
				$sheet .= '<td style ="text-align:right;">' . number_format($amount,2) . '</td>';
				$sheet .= '<td style ="text-align:center;">' . substr($dateModified,10) . '</td>';
				$sheet .= '</tr>';
			}

			$table  = '<table id ="tableCalendarDetails" border ="0" style ="margin:0 auto;margin-top:20px; margin-bottom:10px; width:100%;background-color:rgb(236, 239, 243);box-shadow:0px 0px 10px 2px silver;">' . $sheetHeader . $sheetRowHeader . $sheet . '</table>';
			return $table;
		}

		function createCalendarDetailsJay($record){
			$sheetHeader ='';
			$sheetRowHeader = '';
			$sheet = '';
			$i =1;
			while($data = $this->fetch_array($record)){
				
				$tn = $data['TrackingNumber'];
				$claimant =$data['Claimant'];
				$document = $data['DocumentType'];
				$year = $data['Year'];
				$trackingType = $data['TrackingType'];
				$amount = $data['Amount'];
				$multiple = $data['TotalAmountMultiple'];
				$poAmount = $data['PO_Amount'];
				$officeName = ucwords(strtolower($data['OfficeName']));
				$category = $data['PR_CategoryCode'];
				$quarter = $this->numberToQuarter($data['PR_Month']);
				$description = '';
				if($trackingType == "PR"){
					$document = "Purchase Request";
					if($multiple > 0){
						$amount = $multiple;
					}
					$description = $data['Description'];
				}else if($trackingType == "PO"){
					$document = "Purchase Order";
					if($multiple > 0){
						$amount = $multiple;
					}else{
						$amount = $poAmount;
					}
					$description = $data['Description'];
				}
				$status = $data['Status'];
				$dateModified = $data['DateModified'];
				
				
				if($sheetHeader == ""){
					$sheetHeader .= '<tr style ="background: linear-gradient(to right,white,rgb(224, 228, 229));">';
					$sheetHeader .= '<td colspan ="100%" style ="padding:15px 10px;">';
					$sheetHeader .= '<table style ="line-height:10px;">';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;width:100px;">Doctrack</td><td style ="font-weight:bold;text-align:left;">' . $year . '</td></tr>';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;">Transaction</td><td style ="font-weight:bold;text-align:left;">' . $document . '</td></tr>';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;">Status</td><td style ="font-weight:bold;text-align:left;"> All </td></tr>';
					$sheetHeader .= '<tr><td style ="text-align:right;padding-right:10px;">Updated</td><td style ="font-weight:bold;text-align:left;">' . substr($dateModified,0,10) . '</td></tr>';
					$sheetHeader .= '</table>';					
					$sheetHeader .= '</tr>';
					
					$sheetRowHeader = '<tr style ="background-color:rgb(253, 248, 248);">';
					$sheetRowHeader .= '<th style ="background-color:rgb(179, 188, 180);"></th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">TN</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Office</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Claimant</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Status</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Quarter</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Category</th>';
					$sheetRowHeader .= '<th style ="background-color:rgb(212, 216, 212);">Description</th>';
					$sheetRowHeader .= '<th style ="text-align:right;background-color:rgb(212, 216, 212);">Amount</th>';
					$sheetRowHeader .= '<th style ="text-align:center;background-color:rgb(212, 216, 212);">Time Updated</th>';
					$sheetRowHeader .= '</tr>';
					
					
				}
				$sheet .= '<tr class ="trCalendarDetails" onclick = "clickCalendarTR(this)">';
				$sheet .= '<td style = "font-size:10px;text-align:center;background-color:rgb(218, 222, 215);">' . $i++ . '</td>';
				$sheet .= '<td onclick ="showCalendarPerTN(this)">' . $tn . '</td>';
				$sheet .= '<td>' . $officeName .'</td>';
				$sheet .= '<td>' . $claimant . '</td>';
				$sheet .= '<td>' . $status .'</td>';
				$sheet .= '<td>' . $quarter . '</td>';
				$sheet .= '<td>' . $category . '</td>';
			    $sheet .= '<td>' . $description . '</td>';
				$sheet .= '<td style ="text-align:right;">' . number_format($amount,2) . '</td>';
				$sheet .= '<td style ="text-align:center;">' . substr($dateModified,10) . '</td>';
				$sheet .= '</tr>';
			}

			$table  = '<table id ="tableCalendarDetails" border ="0" style ="margin:0 auto;margin-top:20px; margin-bottom:10px; width:100%;background-color:rgb(236, 239, 243);box-shadow:0px 0px 10px 2px silver;">' . $sheetHeader . $sheetRowHeader . $sheet . '</table>';
			return $table;
		}
		function createCalendar($year,$month,$regulatoryOffice){
			
			$sql ="SELECT Office,Color FROM status where Office != '' and Type in ('PR','PO','PX') and Office != 'Implementing Agency' group by office ";
			$record = $this->query($sql);
			
			$regColor = [];
			$rTable ='<table id  ="regulatoryTable" style ="margin-bottom:-1px;font-size:12px;font-family:arial;width:95%;color:silver;border:0;padding:0;border-spacing:0;" border ="0"><tr >';
			while($data = $this->fetch_array($record)){
			 	$office = $data['Office'];
			 	$color = $data['Color'];
			 	$regColor[$office] = $color;
			 	if($office == $regulatoryOffice){
					$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatory(this)">' . $office . '</th>';
				}else{
					$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatory(this)">' . $office . '</th>';
				}
			}
			if($regulatoryOffice == "-"){
				$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatory(this)">ALL</th>';
			}else{
				$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatory(this)">ALL</th>';
			}
			
			$rTable .='</tr></table>';  
			
			if($regulatoryOffice == '-'){
				$case = ' Office != "" ';
			}else{
				$case = ' Office = "' . $regulatoryOffice . '"';
			}
			//$month = '08'; // February
			$month = $two_digit_number = sprintf('%02d', $month);
			$monthNameDisplay = $month_name = date("F", mktime(0, 0, 0, $month, 1));
			$year = 2023;
			//$dateModified = $year . '-' . $month;
			$searchDate = $year . '-' . $month; 
			
			$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
			$sheetDayName = '';
			$sheetDayNum = '';
			$weekEnd = [];
			for ($day = 1; $day <= $days_in_month; $day++) {
			    $timestamp = mktime(0, 0, 0, $month, $day, $year);
			    $dayName = date('D', $timestamp);
			    $dayNumber = date('j', $timestamp);
				
				$class = "headerWeekdays";
				$class1 = "headerWeekdays1";
			    if($dayName == "Sat" || $dayName == "Sun"){
					$class = "headerWeekend";
					$class1 = "headerWeekend1";
				}
			    $sheetDayName .= '<th class ="' . $class1 . '">' . $dayName . '</th>';
			    $sheetDayNum .=  '<td class ="' . $class . '">' . $dayNumber . '</td>';
			}
			
			$sheetMonth = '<th colspan ="100%"><table style ="width:97%;"><tr>';
			for($i = 1; $i <= 12; $i++){
				 $timestamp = mktime(0, 0, 0, $i, 1);
				 $monthName = date('M', $timestamp);
				 $iMonth = $two_digit_number = sprintf('%02d', $i);
				 $class ="headerMonth";
				 if($iMonth == $month){
				 	 $class ="headerMonthSelected";
				 }
				 $sheetMonth .=  "<th class ='" . $class . "' style ='' onclick ='selectmonth(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
			}
			$sheetMonth .= '</tr></table></th>';
			$sheet = '<table id  ="tableCalendar" style ="margin:0 auto;" border ="0">';
			
			
			$sheet .= '<tr><th rowspan ="3" colspan ="3" style ="font-size:42px; font-weight: normal;font-family:anton;border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '
						</th> ' . $sheetMonth . '</tr>';
			$sheet .= '<tr><th colspan ="100%" style ="border-right:1px solid rgb(234, 233, 195);padding:0;background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . $rTable . '</th></tr>';		
			$sheet .= '<tr></td>' . $sheetDayName . '<td rowspan ="2" colspan ="3" style ="padding:0px 10px;background-color:rgb(38, 39, 38);" class ="rowTotal"></td></tr>';
			$sheet .= '<tr><td colspan ="2" style ="color:white;text-align:left;padding-left:27px;background-color:rgb(86, 184, 219);">Office / Document</td>
						   <td style ="color:white;background-color:rgb(86, 184, 219);text-align:left;padding-left:5px;">Status</td>' . $sheetDayNum . '</tr>';
			
		
			$sql = "select b.*,c.Office,c.OfficeCode from(
					select *,count(1) as Count from(
					SELECT  Case 
						when TrackingType  = 'PR' Then 'Purchase Request' 
					    when TrackingType  = 'PO' Then 'Purchase Order'
					    else
							DocumentType
					    End
					    as Document ,Status,substr(DateModified,9,2) as Day
					FROM vouchercurrent 
					where  Status in 
					('CAO Received','CBO Received','Admin Received','CTO Received','GSO Received','BAC Received',
					 'Pending at CBO','Pending at GSO','Pending at CAO','Pending at CTO','Pending at Admin','Pending at BAC','Forwarded to Admin - Administration','Forwarded to Admin - Operation'
					) 
					and substr(DateModified,1,7) = '" . $searchDate . "' 
					group by TrackingNumber) a group by status,Document,Day) 
					b left join (select * from status group by Status)  c
					on b.Status = c.Status
					where " . $case . "
					order by Office,Status,Document, Day asc
					 ";
			
			$sheetData = '';
			$record = $this->query($sql);
			$lastDocument = '';
			$lastOffice = '';
			$lastStatus = '';
			$lastDay = 0;
			$first  = 0;
			$rowTotal =0;
			$dayCount = 0;
			while($data = $this->fetch_array($record)){
				$office = $data['Office'];
				$officeCode = $data['OfficeCode'];
				$status = $data['Status'];
				$fontColor = "";
				if(preg_match("/Pending/",trim($status))){
					$fontColor = "color:rgb(221, 39, 72);";
				}
				
				
				$document =  ucwords(strtolower($data['Document']));
				$count = $data['Count'];
				$day = $data['Day'];
				$dateTd = $searchDate . '-' . $day;
				$par  = $status .'*' . $document . '*' . $dateTd;
				if($lastOffice != $office  || $lastDocument != $document  || $lastStatus != $status ){
					
					if($first == 0){
						if($lastOffice != $office){
							$sheetData .= '<tr class ="trCalendar"><td colspan ="3" class ="calendarRegulatory" style ="border-right:1px solid rgb(233, 239, 243);"><div class = "num" style = "background-color:' . $regColor[$office] . '"></div>' . $office . '</td>';
							$sheetData .= $this->loopTDall($days_in_month,$searchDate);
							$sheetData .= '</tr>';
							
						}
						
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}else{
						if($lastOffice != $office){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
						}else{
							if($lastDocument != $document ){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
							}else{
								if($lastStatus != $status ){
									$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
								    $arr = explode("**",$arr);
								    $dayCount = $arr[1];
									$sheetData .= $arr[0];
									$dayCount = -1;
								}
							}	
						}
						$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
						$rowTotal = 0;
						$sheetData .= '</tr>';
						$dayCount++;
						if($lastOffice != $office){
							$sheetData .= '<tr class ="trCalendar" ><td colspan ="3" class ="calendarRegulatory" style ="border-right:1px solid rgb(233, 239, 243);"><div class = "num" style = "background-color:' . $regColor[$office] . '"></div>' . $office . '</td>';
							$sheetData .= $this->loopTDall($days_in_month,$searchDate);
							$sheetData .= '</tr>';
						}
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}
	
					$sheetData .= '<td colspan ="2" class ="calendarDocument" >' . $document. '</td>';
					$sheetData .= '<td  class ="calendarStatus" style ="border-right:1px solid rgba(101, 114, 97,.1);' . $fontColor . '">' . $status . '</td>';
					
					$arr = $this->loopTD($day,$dayCount,$searchDate);
				    $arr = explode("**",$arr);
				    $dayCount = $arr[1];
					$sheetData .= $arr[0];

					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendar(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendar(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}else{
					
					$arr = $this->loopTD($day - $lastDay,$dayCount,$searchDate);
					$arr = explode("**",$arr);
					$sheetData .= $arr[0];
					$dayCount = $arr[1];
					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendar(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendar(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}
				
				$rowTotal += $count;
				$lastOffice = $office;
				$lastStatus = $status;
				$lastDocument = $document;
				$lastDay = $day;
				$first = 1;	
			}
			if($rowTotal > 0){
				$arr = $this->loopTD($days_in_month - $day +1,$dayCount,$searchDate);
				$arr = explode("**",$arr);
				$sheetData .= $arr[0];
				$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
			}
			$sheetData .= '</tr>';
			$sheetData .= '<tr><th id = "calendarContainer" colspan ="100%" style ="padding:10px;background-color:white;background: linear-gradient(to top,white,rgb(224, 228, 229));"></th></tr>';
			$sheet .= $sheetData;
			$sheet .= '</table>';
			echo $sheet;
			
		}
		function loopTotalOffice($limit,$sumArray,$status){
			$sheetData = "<tr><td colspan ='3' style ='padding:5px; border:0;text-align:right;font-size:12px;letter-spacing:1px;'>" . strtoupper($status) . "</td>";
			$total = 0;
			for($x = 1; $x <= $limit; $x++ ){
				$sheetData .= '<td style ="padding: 5px;border-top:1px solid rgb(146, 146, 109);background-color:rgb(173, 188, 152);">' . $this->zeroToEmpty($sumArray[$x])   . '</td>';
				$total += $sumArray[$x];
				$sumArray[$x] = 0;
			}
			$sheetData .= '<td style ="padding:5px;;border-top:1px solid rgb(146, 146, 109);background-color:rgb(117, 124, 111);color:white;">' . $this->zeroToEmpty($total)  . '</td>';
			$sheetData .= "</tr>";
			return array('sheet' => $sheetData, 'arrSum' => $sumArray);
		}
		function loopTotal($limit,$statusSum,$status){
			$sheetData = "<tr ><td colspan ='3' style ='padding:20px 5px;padding-top:5px;padding-right:10px; border:0;text-align:right;font-size:12px;letter-spacing:1px;'>" . strtoupper($status) . "</td>";
			$total = 0;
			for($x = 1; $x <= $limit; $x++ ){
				$sheetData .= '<td style ="padding:20px 5px;padding-top:5px;border:0;border-top:1px solid silver;">' . $this->zeroToEmpty($statusSum[$x])   . '</td>';
				$total += $statusSum[$x];
				$statusSum[$x] = 0;
			}
			$sheetData .= '<td style ="padding:20px 5px;padding-top:5px;border:0;border-top:1px solid grey;">' . $this->zeroToEmpty($total)  . '</td>';
			$sheetData .= "</tr>";
			return array('sheet' => $sheetData, 'arrSum' => $statusSum);
		}
		function is_weekend($date) {
		    $timestamp = strtotime($date);
		    $day_of_week = date('w', $timestamp);
		    return ($day_of_week == 0 || $day_of_week == 6);
		}
		function loopTD($limit,$dayCount,$searchDate){
			$x = 0;
			$tds = '';
			for($i = 1 ; $i < $limit; $i++){
				++$dayCount;
				$date = $searchDate . '-' . $dayCount;
				if($this->is_weekend($date)){
					$tds .= '<td class = "weekend"></td>';
				}else{
					$tds .= '<td class = "weekdays"></td>';
				}
				
				$x = 1;
				if( $i == ($limit-1)){
					$dayCount++;
				}
			}
			if($x == 0){
				$dayCount++;
			}
			return $tds . "**" . $dayCount;
		}
		function loopTDall($limit,$searchDate){
			$tds = '';
			for($i = 1 ; $i <= $limit; $i++){
				$date = $searchDate . '-' . $i;
				if($this->is_weekend($date)){
					$tds .= '<td class = "weekend"></td>';
				}else{
					$tds .= '<td class = "weekdays"></td>';
				}
			}
			$tds .= '<td class ="rowTotal"></td>';
			return $tds;
		}
		
		function createSupplierStatus($office){
			if($office == 'All'){
				$case = ' Office != "" ';
			}else{
				$case = " Office = '" . $office . "'";
			}
			$sql ="Select  a.*,b.Count as PaymentMade, b.Total as PaymentTotal,c.Count as PaymentReleased, c.Total as PaymentReleasedTotal from(
					select Claimant,Count(1) as PO_Made, sum(total) as Total from(
					SELECT TrackingNumber,Claimant,if(TotalAMountMultiple > 0,TotalAMountMultiple,PO_Amount) as  Total FROM vouchercurrent where " . $case . " and trackingtype = 'PO' 
					and status != 'Cancelled'
					group by TrackingNumber) a group by Claimant order by PO_Made desc) a

					left join 

					(select Claimant,Count(1) as Count, sum(total) as Total from(
					SELECT TrackingNumber,Claimant,if(TotalAMountMultiple > 0,TotalAMountMultiple,Amount) as  Total FROM vouchercurrent where " . $case . " and trackingtype = 'PX' 
					and status != 'Cancelled'
					group by TrackingNumber) a group by Claimant order by Count desc) b

					on a.Claimant = b.Claimant


					left join
					(select Claimant,Count(1) as Count, sum(total) as Total from(
					SELECT TrackingNumber,Claimant,if(TotalAMountMultiple > 0,TotalAMountMultiple,Amount) as  Total FROM vouchercurrent where " . $case . " and trackingtype = 'PX' 
					and status = 'Check Released'
					group by TrackingNumber) a group by Claimant order by Count desc) c

					on a.Claimant = c.Claimant order by a.Total desc";		
		
			$record = $this->query($sql);
			$sheet = '<table border = "0" id ="tableSupplier"   style ="width:1200px;border-spacing:0px;text-align:center;background-color:white;padding:20px;margin:20px auto; ">';
			$sheet .= '<tr><td colspan ="100%" style ="text-align:left;font-size:22px;font-family:anton;color:rgb(0, 0, 0);">Supplier Transactions</td></tr>';
			$sheet .= '<tr style ="color:white;">
							<td></td>
							<td>Supplier</td>
							<td colspan ="2" style ="background-color:rgb(32, 75, 115);">PO Transactions</td>
							<td style ="width:35px;background-color:white;"></td>
							<td colspan ="4" style ="background-color:rgb(184, 139, 2);">Payment Made</td>
							<td style ="width:35px;background-color:white;"></td>
							<td colspan ="4" style ="background-color:rgb(237, 138, 9);">Payment Released</td>
					   <tr>';
			$sheet .= '<tr style ="background-color:rgb(47, 67, 74);">
							<td style ="background-color:rgb(255, 255, 255);"></td>
							<td style ="background-color:rgb(255, 255, 255);"></td>
							<td  style ="background-color:rgb(228, 235, 238);padding:5px;"></td>
							<td style ="background-color:rgb(244, 250, 251);border-right:1px solid rgb(228, 235, 238);"></td>
							
							<td style ="background-color:white;"></td>
							<td colspan ="" style ="background-color:rgb(237, 235, 214);border-bottom:1px solid white;"></td>
							<td style ="background-color:rgb(245, 245, 240);border-bottom:1px solid white;"></td>
							<td style ="background-color:rgb(245, 245, 240);border-bottom:1px solid white;"></td>
							<td style ="background-color:rgb(245, 245, 240);border-bottom:1px solid white;border-right:1px solid rgb(237, 235, 214);"></td>
							
							<td style ="background-color:white;"></td>
							<td colspan ="" style ="background-color:rgb(246, 237, 228);border-bottom:1px solid white;"></td>
							<td style ="background-color:rgb(245, 245, 240);border-bottom:1px solid white;"></td>
							<td style ="background-color:rgb(245, 245, 240);border-bottom:1px solid white;"></td>
							<td style ="background-color:rgb(245, 245, 240);border-bottom:1px solid white;"></td>
					   <tr>';
			
			$i = 1;
			$ctrMade = 0;
			$totalMade = 0;
			$totalPO = 0;
			$totalReleased = 0;
			while($data = $this->fetch_array($record)){
				$poMade = $data['PO_Made'];
				$claimant = ucwords(strtolower(utf8_encode($data['Claimant'])));
				$poTotal = $data['Total'];
				
				$totalPO += $poTotal;
				
				$paymentMade = $data['PaymentMade'];
				$paymentTotal = $data['PaymentTotal'];
				$percentMade = 0;
				$percentMadeWidth = 0;
				$percentColor = "background-color:rgb(199, 144, 34)";
				$diplayProgress ='display:none;';
				if($paymentTotal > 0){
					$diplayProgress = 'display:inline-block;';	
					$percentMade = round(($paymentTotal / $poTotal) * 100);
					$ctrMade++;
					
					$percentMadeWidth = $percentMade;
					if($percentMade > 100){
						$percentMadeWidth = 100;
						$percentColor = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
					}
					$totalMade += $paymentTotal;
				}
				$paymentReleased = $data['PaymentReleased'];
				
				$paymentReleasedTotal = $data['PaymentReleasedTotal'];
				$percentReleased = 0;
				
				
				$percentMadeReleaseWidth = 0;
				$diplayProgressRelease ='display:none;';
				$percentColorRelease ="background-color:rgb(253, 121, 13)";
				if($paymentReleasedTotal > 0){
					$diplayProgressRelease = 'display:inline-block;';	
					$percentReleased = round(($paymentReleasedTotal / $poTotal) * 100);
					$percentMadeReleaseWidth = $percentReleased;
					if($percentReleased > 100){
						$percentMadeReleaseWidth = 100;
						$percentColorRelease = "background: linear-gradient(to right, rgb(165, 16, 30) ,rgba(255, 0, 0,.9));";
					}
					$totalReleased += $paymentReleasedTotal;
				}
				$sheet .= '<tr>';
				$sheet .= '<td style ="padding:0px 5px;font-size:12px;color:grey;vertical-align:top;padding-top:3px;">' . $i++ . '</td>';
				$sheet .= '<td style ="text-align:left;vertical-align:top;">' . $claimant . '</td>';
				$sheet .= '<td style ="padding:0px 10px;background-color:rgb(228, 235, 238);border-bottom:1px solid white;">' . $poMade . '</td>';
				$sheet .= '<td style ="text-align:right;padding-left:15px;background-color:rgb(244, 250, 251);border-bottom:1px solid white;padding:0px 15px;border-right:1px solid rgb(228, 235, 238);">' . number_format($poTotal,2) . '</td>';
				$sheet .= '<td ></td>';
				
				$sheet .= '<td style ="padding:0px 15px;background-color:rgb(237, 235, 214);border-bottom:1px solid white;">' . $this->zeroToNothing($paymentMade) . '</td>';
				$sheet .= '<td  style ="text-align:right;border-bottom:1px solid white;padding:0px 15px;background-color:rgba(235, 235, 226,.5);">' . $this->zeroToNothing(number_format($paymentTotal,2)) . '</td>';
				$sheet .= '<td  style ="border-bottom:1px solid white;background-color:rgba(235, 235, 226,.5);">
								<div style ="height:18px;background-color:rgb(224, 222, 203);width:100px;' . $diplayProgress . '">
									<div style ="height:18px;width:' . $percentMadeWidth .'%;' . $percentColor . '"></div>
								</div>
							</td>';
				$sheet .= '<td style ="border-right:1px solid rgb(237, 235, 214);padding:0px 10px;text-align:right;white-space: nowrap; font-size:14px;border-bottom:1px solid white;background-color:rgba(235, 235, 226,.5);">' . $this->zeroToNothing($percentMade) . '<span style ="' . $diplayProgress . '">%</span></td>';
				$sheet .= '<td style =""></td>'; 
				
				$sheet .= '<td style ="padding:0px 15px;background-color:rgb(246, 237, 228);border-bottom:1px solid white;">' . $this->zeroToNothing($paymentReleased) . '</td>';
				$sheet .= '<td  style ="text-align:right;border-bottom:1px solid white;padding:0px 15px;background-color:rgba(235, 235, 226,.5);">' . $this->zeroToNothing(number_format($paymentReleasedTotal,2)) . '</td>';
				$sheet .= '<td  style ="border-bottom:1px solid white;background-color:rgba(235, 235, 226,.5);">
								<div style ="height:18px;background-color:rgb(224, 222, 203);width:100px;' . $diplayProgressRelease . '">
									<div style ="height:18px;width:' . $percentMadeReleaseWidth .'%;' . $percentColorRelease . '"></div>
								</div>
							</td>';
				$sheet .= '<td  style ="border-right:1px solid rgb(246, 237, 228); padding:0px 10px;white-space: nowrap;text-align:right;font-size:14px;border-bottom:1px solid white;background-color:rgba(235, 235, 226,.5);">' .  $this->zeroToNothing($percentReleased) . '<span style ="' . $diplayProgressRelease . '">%</td>';
				
				$sheet .= '</tr>';
			}
			$aveMade = round(($totalMade  / $totalPO) * 100); 
			$aveReleased = round(($totalReleased  / $totalPO) * 100); 
			$sheet .= '<tr style ="font-weight:bold;">
							<td colspan ="2"></td>
							<td colspan ="2" style ="border-top:1px solid rgb(228, 235, 238);text-align:right;padding:15px;">' . number_format($totalPO,2) . '</td>
							<td ></td>
							<td colspan ="4" style ="border-top:1px solid rgb(237, 235, 214);text-align:right;padding:10px;">' . number_format($totalMade,2) . '</td>
							<td style =""></td>
							<td colspan ="4" style ="border-top:1px solid rgb(237, 235, 214);text-align:right;padding:10px;">' . number_format($totalReleased,2) . '</td>
					   </tr>';
			$sheet .= '<tr>
							<td colspan ="2"></td>
							<td colspan ="2" style ="border-top:1px solid rgb(228, 235, 238);"></td>
							<td ></td>
							<td colspan ="4" style ="border-top:1px solid rgb(237, 235, 214);text-align:right;padding:10px;font-family:anton;font-size:34px;color:rgb(163, 95, 5);">' . $aveMade . '<span style ="font-family:oswald;">%</span></td>
							<td style =""></td>
							<td colspan ="4" style ="border-top:1px solid rgb(237, 235, 214);text-align:right;padding:10px;font-family:anton;font-size:34px;color:rgb(247, 83, 13);">' . $aveReleased . '<span style ="font-family:oswald;">%</span></td>
							
					   </tr>';
			$sheet .= '</table>';
			return $sheet;		
			
		}
		
		function summaryModeOfProcurement($office){
			if($office == 'All'){
				$case = ' Office != "" ';
			}else{
				$case = " Office = '" . $office . "'";
			}
			$sql = "select count(Mode) as Counter ,b.Type, b.Number from(
					SELECT TrackingNumber,ModeOfProcurement as Mode FROM vouchercurrent where TrackingType = 'PO' and " . $case . " and modeofprocurement > 0 group by TrackingNumber) a 
					left join citydoc.modeofprocurement b
					on a.Mode = b.Number group by Mode order by b.Type asc";
			$record = $this->query($sql);
			$sheetMode = '<table border = "0" style ="width:400px;text-align:center;margin:0px auto;border-spacing:0;">';
			$sheetMode .= '<tr ><td style ="font-size:18px;font-family:anton;color:black; text-align:left;" colspan ="2">
									<span>PO MODE OF PROCUREMENT</span></td></tr>';
			$sheetMode .= '<tr style ="background-color:rgb(47, 67, 74);color:white;font-weight:bold;"><td style ="text-align:left;padding:2px;padding-left:15px;" >Type</td>';
			$sheetMode .= '<td style ="width:10px;" >Total</td></tr>';
			$sheetMode .= '<tr  style ="background-color:rgb(235, 235, 230);"><td colspan ="100%" style ="padding:2px;border-left:1px solid rgb(175, 171, 146);border-right:1px solid rgb(175, 171, 146);"></td></tr>';
			while($data = $this->fetch_array($record)){
				
				$count = $data['Counter'];
				$mode = $data['Type'];
				$modeNumber = $data['Number'];
				$sheetMode .= '<tr  style ="background-color:rgb(235, 235, 230);">';
				$sheetMode .= '<td  style= "text-align:left;padding-left:15px;border-left:1px solid rgb(175, 171, 146);white-space: nowrap;"  >' . $mode . '</td>';
				$sheetMode .= "<td class  ='summaryCount' style ='border-right:1px solid rgb(175, 171, 146);' onclick = 'fetchTrackingByMode(\"" . $modeNumber . "*" . $office . "\")'>" . $count . "</td>";
				$sheetMode .= '</tr>';
				
			}
			$sheetMode .= '<tr><td colspan ="100%" style ="padding:4px;border:1px solid rgb(175, 171, 146);border-top:0;background-color:rgb(235, 235, 230);"></td></tr>';
			$sheetMode .= '</table>';
			return $sheetMode;	
		}
		function summaryMillions($office){
			if($office == 'All'){
				$case = ' Office != "" ';
			}else{
				$case = " Office = '" . $office . "'";
			}
			$sql = "select *,CASE
						WHEN Total >= 5000000  THEN 5
						WHEN Total >= 4000000 and Total < 5000000 THEN 4
						WHEN Total >= 3000000 and Total < 4000000 THEN 3
						WHEN Total >= 2000000 and Total < 3000000 THEN 2
						WHEN Total >= 1000000 and Total < 2000000 THEN 1
						ELSE 0
					END as TotalRange,count(TrackingNumber) as Count

					 from(
					SELECT TrackingNumber, if(TotalAmountMultiple > 0,TotalAmountMultiple,Amount) as Total 
					FROM vouchercurrent where TrackingType ='PR' and " . $case . "  and Status != 'Cancelled' group by TrackingNumber) a group by totalRange";
			$record1 = $this->query($sql);
			$sheetMillions = '<table border = "0" style ="width:100%;text-align:center;border-spacing:0;">';
			$sheetMillions .= '<tr><td style ="color:black;font-size:18px;text-align:left;font-family:Anton;" colspan ="2">
									<span>PR AMOUNT RANGE</span></td></tr>';
			$sheetMillions .= '<tr style ="background-color:rgb(47, 67, 74);color:white;font-weight:bold;"><td style ="text-align:left;padding:2px;padding-left:15px;" >Total</td>';
			$sheetMillions .= '<td style ="width:100px;" >Transactions</td></tr>';
			$sheetMillions .= '<tr  style ="background-color:rgb(235, 235, 230);"><td colspan ="100%" style ="padding:5px;border-left:1px solid rgb(175, 171, 146);border-right:1px solid rgb(175, 171, 146);"></td></tr>';
			while($data = $this->fetch_array($record1)){
				
				$range = $data['TotalRange'];
				$countMillions = $data['Count'];
				if($range  == 0){
					$rangeText =  '1 Million below';
				}else if($range == 5){
					$rangeText = $range .' Million and above';
				}else{
					$rangeText = $range .' Million range';
				}
				
				$sheetMillions .= '<tr  style ="background-color:rgb(235, 235, 230);">';
				$sheetMillions .= '<td  style= "text-align:left;padding-left:15px;border-left:1px solid rgb(175, 171, 146);white-space: nowrap;"  >' . $rangeText . '</td>';
				$sheetMillions .= "<td class  ='summaryCount' style ='width:100px;border-right:1px solid rgb(175, 171, 146);' onclick = 'fetchTrackingByMillions(\"" . $range . "*" . $office . "\")'>" . $countMillions . "</td>";
				$sheetMillions .= '</tr>';
				
			}
			$sheetMillions .= '<tr><td colspan ="100%" style ="padding:4px;border:1px solid rgb(175, 171, 146);border-top:0;background-color:rgb(235, 235, 230);"></td></tr>';
			$sheetMillions .= '</table>';
			return $sheetMillions;	
		}
		function summaryPX($office){
			if($office == 'All'){
				$case = ' Office != "" ';
			
			}else{
				$case = " Office = '" . $office . "'";
			}
			
			$sql = "select a.*,b.PXReleasedCount,b.TotalReleasedAmount from ( select Claimant,count(Id) as PXAllCount,sum(PXAllAmount) as TotalAllPX from( SELECT Id,TrackingNumber, Claimant, if(TotalAmountMultiple > 0, TotalAmountMultiple,Amount) as PXAllAmount
					FROM vouchercurrent where TrackingType = 'PX' and " .  $case . " and Status != 'Cancelled' group by TrackingNumber) as a group by Claimant) a
					 left join
					 ( select Claimant,count(Id) as PXReleasedCount,sum(PXReleasedAmount) as TotalReleasedAmount from( SELECT Id,TrackingNumber, Claimant, if(TotalAmountMultiple > 0, TotalAmountMultiple,Amount) as PXReleasedAmount FROM vouchercurrent 
					where TrackingType = 'Px' and " .  $case . " and Status = 'Check Released' group by TrackingNumber) as a group by Claimant) b on a.Claimant = b.Claimant";
		
			$record = $this->query($sql);
			$sheetPX = '<table id ="tableSummaryPR" border ="0" style ="width:100%;margin:0px auto;border-spacing:0px;">';
			$sheetPX .= '<tr><td colspan ="100%" style ="font-size:22px;font-family:anton;color:rgb(199, 144, 34);">Payment Vouchers</td></tr>';
			$sheetPX .= '<tr style ="background-color:rgb(223, 216, 188);">
							<th style =""></th>
							<th style ="padding:0px 10px;text-align:left;">Supplier</th>
							<th style ="padding:0px 10px;text-align:right;">Amount</th>
							<th style ="padding:0px 10px;width:10px;">PX</th>
							
							
							<th  style ="padding:0px 10px;text-align:right;" colspan ="2">Check Claimed</th>
							<th style ="padding:0px 10px;text-align:center;" colspan ="2">Status</th>
						</tr>';
			$sheetPX .= '<tr style =""><th colspan ="100%" style ="padding:5px;"></th></tr>'; 
			$i = 1;
			$e = 0;
			
			$tA =0;
			$tB = 0;
			$tX = 0;
			$tY = 0;
			
			while($data = $this->fetch_array($record)){
				$claimant =  $data['Claimant'];
				$a = $data['PXAllCount'];
				$b = $data['TotalAllPX'];
				
				$x = $data['PXReleasedCount'];
				$y = $data['TotalReleasedAmount'];
				$tA += $a;
				$tX += $x;
				
				$tB += $b;
				$tY += $y;
				
				$percentLabel ='';
				if($x >0){
					$percent = round(($x / $a) * 100);
					$percentLabel = $percent . '<span>%</span>';
				}else{
					$percent = 0;
					$percentLabel ='<span style ="color:red;"></span>';
				} 
				$sheetPX .= '<tr class ="trSummaryPR">';
				$sheetPX .= '	<td style ="padding:0px 2px;font-size:12px;color:grey;vertical-align:middle;">' . $i++ . '</td>';
				
				$sheetPX .= '	<td style ="text-align:left;padding:0px 10px;">' . utf8_encode($claimant) . '</td>';
				$sheetPX .= "	<td style ='text-align:right;padding:0px 10px;' >" . number_format($b,2) . "</td>";
				$sheetPX .= "	<td style ='text-align:center;padding:0px 10px;' onclick ='fetchTrackingBySupplierPY(\"" . str_replace("'",'v@l',utf8_encode($claimant)) . "#*" . $office . "#*1\")'>" . $a . "</td>";
				
				$sheetPX .= "	<td style ='text-align:right;padding:0px 10px;' >" . $this->zeroToNothing(number_format($y,2)) . "</td>";
				$sheetPX .= "	<td style ='text-align:center;padding:0px 10px;width:10px;'  onclick ='fetchTrackingBySupplierAllPY(\"" . str_replace("'",'v@l',utf8_encode($claimant)) . "#*" . $office . "#*2\")' >" . $x . "</td>";
				
				$sheetPX .= '	<td style ="text-align:center;width:150px;vertical-align:middle;">
									<div style ="width:100%;background-color:rgba(131, 120, 95,.2);height:18px;">
									<div style ="height:18px;background-color:rgb(199, 144, 34);  width:' . $percent . '%;">&nbsp;</div></div>
								</td>';
				$sheetPX .= '	<td style ="text-align:right;padding:0px 5px;font-size:14px;width:10px;">' . $percentLabel . '</td>';
				$sheetPX .= '</tr>';
			}
			if($tX >0){
				$percent = round(($tX / $tA) * 100);
				$percentLabel = $percent . '<span style ="font-family:arial;font-size:22px;">%</span>';
			}else{
				$percent = 0;
				$percentLabel ='<span></span>';
			} 
			
			$sheetPX .= '<tr style =""><th colspan ="100%" style ="padding:5px;"></th></tr>'; 
			$sheetPX .= '<tr>';
			$sheetPX .= '	<td colspan ="100%" style ="border-top:1px solid rgb(165, 161, 124);padding:2px;"></td></tr>';
			$sheetPX .= '<tr style ="font-size:22px;font-family:anton;color:rgb(26, 41, 5);">';
			$sheetPX .= '<td colspan ="2"></td>';
			$sheetPX .= '	<td style ="text-align:right;padding:0px 10px;color:rgb(66, 66, 64);">' . number_format($tB,2) . '</td>';
			$sheetPX .= "<td style ='cursor:pointer;text-align:center;padding:0px 10px;vertical-align:top;color:rgb(196, 106, 2);' onclick ='fetchTrackingBySupplierAllTotalPY(\"" . $office . "*1\")'>" . $tA . "</td>";
			
			$sheetPX .= '	<td style ="text-align:right;padding:0px 10px;color:rgb(66, 66, 64);">' . number_format($tY,2) . '</td>';
			$sheetPX .= "<td style ='cursor:pointer;text-align:center;padding:0px 10px;vertical-align:top;color:rgb(196, 106, 2);' onclick ='fetchTrackingBySupplierAllOngoingPY(\"" . $office . "*2\")'>"  . $tX . "</td>";
			$sheetPX .= '<td style ="text-align:center;width:150px;vertical-align:top;padding-top:5px;">
									<div style ="width:100%;background-color:rgba(131, 120, 95,.2);height:20px;">
									<div style ="height:20px;background-color:rgb(194, 117, 28);  width:' . $percent . '%;">&nbsp;</div></div>
								</td>';
			$sheetPX .= '	<td style ="text-align:right;padding:10px 20px;padding-right:0px;font-size:42px;font-family:Anton;line-height:22px;color:rgb(194, 117, 28);">' . $percentLabel . '</td>';
			$sheetPX .= '</tr>';
			
			return $sheetPX .= '</table>';
		}
		function summaryPO($office){
			if($office == 'All'){
				$case = ' Office != "" ';
			
			}else{
				$case = " Office = '" . $office . "'";
				
			}
			
			$sql = "  select a.*,b.PX,b.TotalPX from
					  (
					  select Claimant,count(Id) as PO,sum(TotalPO) as TotalPO from(
					  SELECT  Id,TrackingNumber, Claimant,  if(TotalAmountMultiple > 0, TotalAmountMultiple,PO_Amount) as TotalPO
					  FROM vouchercurrent where TrackingType = 'PO' and  " . $case . " and Status != 'Cancelled' group by TrackingNumber) as a group by Claimant) a
					  left join
					  (
					  select Claimant,count(Id) as PX,sum(TotalPX) as TotalPX from(
					  SELECT  Id,TrackingNumber, Claimant,  if(TotalAmountMultiple > 0, TotalAmountMultiple,PO_Amount) as TotalPX
					  FROM vouchercurrent where TrackingType = 'PO' and  " . $case . " and Status = 'Waiting for Delivery' group by TrackingNumber) as a group by Claimant) b
					  
					  on a.Claimant = b.Claimant";
		
			$record = $this->query($sql);
			$sheetPO = '<table id ="tableSummaryPR" border ="0" style ="width:100%;margin:0px auto;border-spacing:0px;">';
			$sheetPO .= '<tr><td colspan ="100%" style ="font-size:22px;font-family:anton;color:rgb(63, 129, 160);">Purchase Order Suppliers</td></tr>';
			$sheetPO .= '<tr style ="background-color:rgb(195, 211, 216);">
							<th style =""></th>
							<th style ="padding:0px 10px;text-align:left;">Supplier</th>
							<th style ="padding:0px 10px;text-align:right;">Amount</th>
							<th style ="padding:0px 10px;width:10px;">PO</th>
							
							
							<th  style ="padding:0px 10px;text-align:right;" colspan ="2">Waiting for Deliver</th>
							<th style ="padding:0px 10px;text-align:center;" colspan ="2">Status</th>
						</tr>';
			$sheetPO .= '<tr style =""><th colspan ="100%" style ="padding:5px;"></th></tr>'; 
			$i = 1;
			$totalAll = 0;
			$totalPO =0;
			$totalPX = 0;
			$totalAmountPX = 0;
			$totalAmountPO = 0;
			
			while($data = $this->fetch_array($record)){
				$claimant =  $data['Claimant'];
				$po = $data['PO'];
				$px = $data['PX'];
				$amountPO = $data['TotalPO'];
				$amountPX = $data['TotalPX'];
				
				$totalAmountPO += $amountPO;
				$totalAmountPX += $amountPX;
				
				$totalAll += $po;
				$totalPO += $po;
				$totalPX += $px;
				$percentLabel ='';
				if($px >0){
					$percent = round(($px / $po) * 100);
					$percentLabel = $percent . '<span >%</span>';
				}else{
					$percent = 0;
					$percentLabel ='<span style ="color:red;"></span>';
				} 
				
				$sheetPO .= '<tr class ="trSummaryPR">';
				$sheetPO .= '	<td style ="padding:0px 2px;font-size:12px;color:grey;vertical-align:middle;">' . $i++ . '</td>';
				
				$sheetPO .= '	<td style ="text-align:left;padding:0px 10px;">' . utf8_encode($claimant) . '</td>';
				$sheetPO .= "	<td style ='text-align:right;padding:0px 10px;' >" . number_format($amountPO,2) . "</td>";
				$sheetPO .= "	<td style ='text-align:center;padding:0px 10px;' onclick ='fetchTrackingBySupplier(\"" . str_replace("'",'v@l',utf8_encode($claimant)) . "#*" . $office . "#*1\")'>" . $po . "</td>";
				
				$sheetPO .= "	<td style ='text-align:right;padding:0px 10px;' >" . $this->zeroToNothing(number_format($amountPX,2)) . "</td>";
				$sheetPO .= "	<td style ='text-align:center;padding:0px 10px;width:10px;'  onclick ='fetchTrackingBySupplierAll(\"" . str_replace("'",'v@l', $claimant) . "#*" . $office . "#*2\")' >" . $px . "</td>";
				
				$sheetPO .= '	<td style ="text-align:center;width:150px;">
									<div style ="width:100%;background-color:rgba(56, 187, 248,.2);height:18px;">
									<div style ="height:18px;background-color:rgb(63, 129, 160);  width:' . $percent . '%;">&nbsp;</div></div>
								</td>';
				$sheetPO .= '<td style ="text-align:right;padding:0px 5px;font-size:14px;width:10px;">' . $percentLabel . '</td>';
				$sheetPO .= '</tr>';
			}
			if($totalPX >0){
				$percent = round(($totalPX / $totalPO) * 100);
				$percentLabel = $percent . '<span style ="font-family:arial;font-size:22px;">%</span>';
			}else{
				$percent = 0;
				$percentLabel ='<span></span>';
			} 
			$sheetPO .= '<tr style =""><th colspan ="100%" style ="padding:5px;"></th></tr>'; 
			$sheetPO .= '<tr>';
			$sheetPO .= '	<td colspan ="100%" style ="border-top:1px solid rgb(165, 161, 124);padding:2px;"></td></tr>';
			$sheetPO .= '<tr style ="font-size:22px;font-family:anton;color:rgb(26, 41, 5);">';
			$sheetPO .= '<td colspan ="2"></td>';
			$sheetPO .= '	<td style ="text-align:right;padding:0px 10px;color:rgb(66, 66, 64);">' . number_format($totalAmountPO,2) . '</td>';
			$sheetPO .= "<td style ='cursor:pointer;text-align:center;padding:0px 10px;color:rgb(42, 80, 116);' onclick ='fetchTrackingBySupplierAllTotal(\"" . $office . "*1\")'>" . $totalPO . "</td>";
			
			$sheetPO .= '	<td style ="text-align:right;padding:0px 10px;color:rgb(66, 66, 64);">' . number_format($totalAmountPX,2) . '</td>';
			$sheetPO .= "<td style ='cursor:pointer;text-align:center;padding:0px 10px;color:rgb(42, 80, 116);' onclick ='fetchTrackingBySupplierAllOngoing(\"" . $office . "*2\")'>"  . $totalPX . "</td>";
			$sheetPO .= '<td style ="text-align:center;width:150px;vertical-align:top;padding-top:5px;">
									<div style ="width:100%;background-color:rgba(56, 187, 248,.2);height:20px;">
									<div style ="height:20px;background-color:rgb(21, 93, 161);  width:' . $percent . '%;">&nbsp;</div></div>
								</td>';
			$sheetPO .= '	<td style ="text-align:right;padding:10px 20px;padding-right:0px;font-size:42px;font-family:Anton;line-height:22px;color:rgb(21, 93, 161);">' . $percentLabel . '</td>';
			$sheetPO .= '</tr>';
			
			return $sheetPO .= '</table>';
		}
		function summaryPR($office){
			if($office == 'All'){
				$case = ' Office != "" ';
			}else{
				$case = " Office = '" . $office . "'";
				
			}
			$sql ="select x.Cat,x.Description,x.Total,x.Count as PR,y.Count as 'Awarded', y.TotalForPO from(
					select Cat , b.Description,sum(Total) as Total,Count(a.Id) as Count from(select Id,PR_CategoryCode as Cat,
						if(TotalAmountMultiple > 0, TotalAmountMultiple,Amount) as Total
					 from vouchercurrent where  PR_CategoryCode !='' and PR_CategoryCode != 'No Cat' and PR_CategoryCode != 'CAT 99' and TrackingType ='PR' and Status != 'Cancelled' and " . $case . "
					group by trackingnumber) a 
					left join ppmpcategories b
					on a.Cat = b.Code
					group by Cat) x left join
					(select Cat,count(Id) as Count,sum(TotalPR) as TotalForPO from(
					select Id,PR_CategoryCode as Cat, if(TotalAmountMultiple > 0, TotalAmountMultiple,Amount) as TotalPR from vouchercurrent where TrackingType ='PR' and Status = 'For P.O' and " . $case . "
					group by trackingnumber) a group by Cat) y
					on x.Cat = y.Cat";
					
			$record = $this->query($sql);
			$sheetPR = '<table id ="tableSummaryPR" border ="0" style ="width:100%;margin:0px auto;border-spacing:0px;">';
			$sheetPR .= '<tr><td colspan ="100%" style ="font-size:22px;font-family:anton;color:rgb(92, 112, 90);">Purchase Request Categories</td></tr>';
			$sheetPR .= '<tr style ="background-color:rgb(208, 212, 194);">
							<th style =""></th>
							<th style ="text-align:left;">Category</th>
							<th style ="text-align:right;padding-right:10px;">Total Amount</th>
							<th style ="padding:0px 10px;width:10px;">PR</th>
							
							
							<th colspan ="2"style ="padding:0px 10px;width:10px;text-align:right;">Awarded</th>
							<th style ="padding:0px 10px;text-align:center;" colspan ="2">Status</th>
						</tr>';
			$sheetPR .= '<tr style =""><th colspan ="100%" style ="padding:5px;"></th></tr>';
			$i = 1;
			$totalAll = 0;
			$totalPR =0;
			$totalAwarded = 0;		
			$totalAmountAwarded = 0;			
			while($data = $this->fetch_array($record)){
				$cat = $data['Cat'];
				$desc = $data['Description'];
				$total = $data['Total'];
				$awarded = $data['Awarded'];
				$awardedTotal = $data['TotalForPO'];
				$totalAmountAwarded +=$awardedTotal;
				$pr = $data['PR'];
				
				$totalAll += $total;
				$totalAwarded += $awarded;
				$totalPR += $pr;
				if($awarded >0){
					$percent = round(($awarded / $pr) * 100);
					$percentLabel = $percent . '<span>%</span>';
				}else{
					$percent = 0;
					$percentLabel ='<span></span>';
				}
				
				$sheetPR .= '<tr class ="trSummaryPR">';
				$sheetPR .= '	<td style ="padding:0px 5px;font-size:12px;color:grey;vertical-align:middle;">' . $i++ . '</td>';
				$sheetPR .= '	<td style ="padding-right:20px;">' . $desc . '</td>';
				$sheetPR .= '	<td style ="text-align:right;padding:0px 10px;">' . number_format($total,2) . '</td>';
				$sheetPR .= "	<td style ='text-align:center;padding:0px 10px;' onclick ='fetchTrackingByCategory(\"" . $cat . "*1*" . $office . "\")'>" . $pr . "</td>";
				$sheetPR .= '	<td style ="text-align:right;padding:0px 10px;">' .$this->zeroToNothing( number_format($awardedTotal,2)) . '</td>';
				
				
				$sheetPR .= "	<td style ='text-align:center;' onclick ='fetchTrackingByCategory(\"" . $cat . "*2*" . $office . "\")'>" . $awarded . "</td>";
				$sheetPR .= '	<td style ="text-align:center;width:150px;vertical-align:middle;">
									<div style ="width:100%;background-color:rgba(147, 169, 135,.3);height:18px;">
									<div style ="height:18px;background-color:rgb(92, 112, 90);  width:' . $percent . '%;">&nbsp;</div></div>
								</td>';
				$sheetPR .= '	<td style ="text-align:right;padding:0px 5px;font-size:14px;width:10px;">' . $percentLabel . '</td>';
				$sheetPR .= '</tr>';
			}
			if($totalAwarded >0){
				$percent = round(($totalAwarded / $totalPR) * 100);
				$percentLabel = $percent . '<span style ="font-family:arial;font-size:22px;">%</span>';
			}else{
				$percent = 0;
				$percentLabel ='<span></span>';
			}
			$sheetPR .= '<tr style =""><th colspan ="100%" style ="padding:5px;"></th></tr>'; 
			$sheetPR .= '<tr>';
			$sheetPR .= '	<td colspan ="100%" style ="border-top:1px solid rgb(165, 161, 124);padding:2px;"></td></tr>';
			$sheetPR .= '<tr style ="font-size:22px;font-family:anton;color:rgb(26, 41, 5);">';
			$sheetPR .= '<td colspan ="2"></td>';
			$sheetPR .= '<td style ="text-align:right;padding:0px 10px;color:rgb(66, 66, 64);">' . number_format($totalAll,2) . '</td>';
			$sheetPR .= "<td style ='text-align:center;padding:0px 10px;color:rgb(24, 90, 14);cursor:pointer;'  onclick ='fetchTrackingByPR(\""."3*" . $office . "\")'>" . $totalPR . "</td>";
			$sheetPR .= '<td style ="text-align:right;padding:0px 10px;color:rgb(66, 66, 64);">' . number_format($totalAmountAwarded,2) . '</td>';
			$sheetPR .= "<td style ='text-align:center;padding:0px 10px;color:rgb(24, 90, 14);cursor:pointer;' onclick ='fetchTrackingByPR(\""."4*" . $office . "\")'>" . $totalAwarded . "</td>";
			$sheetPR .= '<td style ="text-align:center;width:150px;padding-top:5px;">
									<div style ="width:100%;background-color:rgba(147, 169, 135,.3);height:20px;">
									<div style ="height:20px;background-color:rgb(25, 102, 14);  width:' . $percent . '%;">&nbsp;</div></div>
								</td>';
			$sheetPR .= '	<td style ="text-align:right;padding:10px 20px;padding-right:0px;font-size:42px;font-family:Anton;line-height:22px;color:rgb(25, 102, 14);">' . $percentLabel . '</td>';
			$sheetPR .= '</tr>';
			
			return $sheetPR .= '</table>';
			
		}
		function summaryQuarter($office,$type,$statusLast){
			if($office == 'All'){
				$case = ' Office != "" ';
			}else{
				$case = " Office = '" . $office . "'";
			}
			$sql = "select b.*,c.PO from(
							select a.*,count(a.Quarter) as Count from(
							SELECT 
									distinct TrackingNumber,
									CASE
										WHEN PR_Month < 4  THEN 1
										WHEN PR_Month < 7  THEN 2
										WHEN PR_Month < 10  THEN 3
										ELSE 4
									END as Quarter
							 FROM vouchercurrent where trackingtype ='" . $type . "' and " . $case . "  and Status != 'Cancelled'
							) a 
							group by a.Quarter) b
							left join
							(select a.*,count(a.Quarter) as PO from(
							SELECT 
									distinct TrackingNumber,
									CASE
										WHEN PR_Month < 4  THEN 1
										WHEN PR_Month < 7  THEN 2
										WHEN PR_Month < 10  THEN 3
										ELSE 4
									END as Quarter
							 FROM vouchercurrent where trackingtype ='" . $type . "' and " . $case . "  and Status ='" . $statusLast . "'
							) a group by a.Quarter) c
							on b.Quarter = c.Quarter";					
				$recordQuarter = $this->query($sql);		
				
				if($type == 'PR'){
					$typeRem = 'For P.O';
				}else if($type =='PO'){
					$typeRem = 'Approved';
				}else{
					$typeRem = 'Paid';
				}
				
				if($type =="PR"){
					$hColor = "rgb(208, 212, 194)";
					$divOuter = "rgb(216, 223, 202)";
					$divInner ="rgb(92, 112, 90)";
					$divInnerTotal ="rgb(25, 102, 14)";
					$label ="Purchase Request Quarterly ";
				}else if($type =="PO"){
					$hColor = "rgb(195, 211, 216)";
					$divOuter = "rgb(209, 235, 234)";
					$divInner ="rgb(63, 129, 160)";
					
					$divInnerTotal ="rgb(21, 93, 161)";
					$label ="Purchase Order Quarterly ";
				}else if($type =="PX"){
					$hColor = "rgb(223, 216, 188)";
					$divOuter = "rgb(224, 222, 203)";
					$divInner ="rgb(199, 144, 34)";
					$divInnerTotal ="rgb(194, 117, 28)";
					$label ="Payment Quarterly ";
				}
							
				$sheetQuarters = '<table border = "0" style ="width:100%;text-align:center;margin:0 auto;border-spacing:0;">';
				$sheetQuarters .= '<tr style =""><td style ="text-align:left; padding:5px 0px;font-family:anton;font-size:18px;" colspan ="5">';
				$sheetQuarters .= '<span style ="color:gray;">' . strtoupper($label) . ' </span></td></tr>';
				
				
				
				$sheetQuarters .= '<tr style ="font-weight:bold;background-color:' . $hColor . ';"><td style ="padding:0px 10px;" >Qtr</td>';
				$sheetQuarters .= '<td style ="padding:0px 10px;" >' . $type . '</td>';
				$sheetQuarters .= '<td style ="white-space: nowrap;padding:0px 10px;" >' . $typeRem  .'</td>
				                   <td style ="" ></td>
				                   <td style ="" ></td>
								</tr>';
				
				$sheetQuarters .= '<tr><td colspan ="100%" style ="padding:5px;"></td></tr>';
				$qtrTotal = 0;
				$qtrPOtotal = 0;
				$percentAll = 0;
				while($data = $this->fetch_array($recordQuarter)){
						
					$quarter = $data['Quarter'];
					$count = $data['Count'];
					
					$foPO = $data['PO'];
					$qtrTotal += $count;
					$qtrPOtotal += $foPO;
					
					$percent = round(($foPO / $count) * 100);
					
					if($qtrTotal > 0){
						$percentAll = round(($qtrPOtotal / $qtrTotal) * 100);
					}
					
					$sheetQuarters .= '<tr>';
					$sheetQuarters .= "<td class = 'summaryCount' style= 'text-align:center;font-weight:bold;' onclick = 'fetchTrackingByQuarter(\"" . $quarter . "*" . $office . "*1*" . $type . "\")' > " . $quarter . "</td>";
					$sheetQuarters .= "<td class  ='summaryCount' style ='padding:0px 10px;'  onclick = 'fetchTrackingByQuarter(\"" . $quarter . "*" . $office . "*2*" . $type . "\")'>" . $count . "</td>";
					$sheetQuarters .= "<td class  ='summaryCount' style ='padding:0px 10px;' onclick = 'fetchTrackingByQuarter(\"" . $quarter . "*" . $office . "*3*" . $type . "\")'>" . $foPO . "</td>";
					$sheetQuarters .= '<td style ="vertical-align:middle;padding: 0px 10px;">
									  		<div style ="background-color:' . $divOuter . ';width:120px;border:0px solid rgb(29, 56, 19);">
									  			<div style ="height:15px;background-color:' . $divInner . ';width:' . $percent . '%;"></div>	
									  		</div>	
									   </td>';
					$sheetQuarters .= '<td style= "text-align:right;padding:0px 10px;font-size:14px;"> ' . $percent . '%</td>';
					$sheetQuarters .= '</tr>';
				}
				$sheetQuarters .= '<tr><td colspan ="100%" style ="padding-top:5px;">
								<div style ="border-top:1px solid rgba(29, 56, 19,.3);padding:2px;width:99%;float:right;"></div></td></tr>';
				
				$sheetQuarters .= '<tr style ="background-color:rgba(244, 242, 238,.3);font-family:anton;"><td style= ""></td>
									<td style = "vertical-align:top;font-size:22px;color:rgb(66, 66, 64);">' . $qtrTotal . '</td>
									<td style = "vertical-align:top;font-size:22px;color:rgb(66, 66, 64);">' . $qtrPOtotal . '</td>
									<td style ="vertical-align:top;padding: 0px 10px;padding-top:8px;">
									  		<div style ="background-color:' . $divOuter . ';width:120px">
									  			<div style ="height:18px;background-color:' .$divInnerTotal . ';width:' . $percentAll . '%;"></div>	
									  		</div>	
									</td>
									';
				$sheetQuarters .= '<td class = "" style= "text-align:right;font-size:32px;vertical-align:top;line-height:38px;padding-top:5px;color:' . $divInnerTotal . '"> ' . $percentAll . '<span style ="font-weight:normal;font-size:20px;font-family:arial;">%</span></td></tr>';
					
				$sheetQuarters .= '<tr><td colspan ="100%" style ="padding:5px;border-top:0;"></td></tr>';
				$sheetQuarters .= '</tr></table>';
				
				return $sheetQuarters;
		}
		function summaryBudget($grandTotal){
			$sheetSummaryFundsTable = '<table border = "0" style ="margin:0 auto;"><tr>';
				$sheetSummaryFunds = '';
				
				$i = 1;
				$sheetSummaryFundsTable .= '<tr ><td colspan = "3" style ="text-align:center;font-family:anton;font-size:22px;color:rgb(32, 50, 4);padding-bottom:20px;padding-top:20px;">Budget Summary</td></tr>';	
				foreach ($grandTotal as $key => $x){
					$ppmp =  $x['PPMP'];
					$pr =  $x['PR'];
					$diff = ($ppmp - $pr);
					$percent =  round(($diff / $ppmp) * 100);
					
					
					$sheetSummaryFunds .= '<table border = "0" style ="margin:20px auto;">';
					
					$sheetSummaryFunds .= '<tr style ="display:none;" >';
					$sheetSummaryFunds .= '<td id ="gTotal' . $i  . '" colspan = "2">' .  $ppmp . '*' . $pr .  '</td>';
					$sheetSummaryFunds .= '</tr>';
					
					
					
					$sheetSummaryFunds .= '<tr ><td colspan = "2" style ="font-weight:normal;text-align:center;font-family:nor;font-size:16px;color:rgb(32, 50, 4);">' . $key . '</td></tr>';
					
					$sheetSummaryFunds .= '<tr >';
					$sheetSummaryFunds .= '<td colspan = "2" style ="padding:0px 40px;"><canvas style ="" id="myCanvas' . $i . '" width="300" height="300"></canvas></td>';
					$sheetSummaryFunds .= '</tr>';
					
					$sheetSummaryFunds .= '<tr><td colspan ="100%">';
					
					$sheetSummaryFunds .= '<table border ="0" style ="text-align:right;margin:0 auto;border-spacing:0px;padding-right:40px;"><tr >';
					$sheetSummaryFunds .= '<td style ="vertical-align:middle;line-height:22px;">PPMP</td>
											<td style = "vertical-align:middle;"><span style ="border-radius:3px;margin:0px 4px;background-color:rgb(54, 162, 235); width:15px;height:15px;display:inline-block;"></span></td>
											<td style ="padding-left:10px;letter-spacing:1px;font-size:18px;">' . number_format($ppmp,2) . '</td>';
					$sheetSummaryFunds .= '</tr>';
					
					
					$sheetSummaryFunds .= '<tr>';
					$sheetSummaryFunds .= '<td>Purchase Request</td>
										  <td style = "vertical-align:middle;"><span style ="border-radius:3px;margin:0px 4px;background-color:rgb(255, 99, 132); width:15px;height:15px;display:inline-block;"></span></td>
										  <td style ="padding-left:10px;letter-spacing:1px;font-size:18px;">' . number_format($pr,2) . '</td>';
					$sheetSummaryFunds .= '</tr>';
					
					$sheetSummaryFunds .= '<tr>';
					$sheetSummaryFunds .= '<td colspan ="3" style ="text-align:right;padding-left:10px;border-top:1px solid silver;letter-spacing:1px;font-weight:bold;font-size:20px;">' . number_format($diff,2) . '</td>';
					$sheetSummaryFunds .= '</tr></table></td></tr></table>';
					
					$sheetSummaryFundsTable .= '<td>' . $sheetSummaryFunds . '</td>';
					$sheetSummaryFunds ='';
					 $i++;
				}
				$sheetSummaryFundsTable .= '</tr></table>';
				
				return $sheetSummaryFundsTable;
		}
		
		
		function summaryBreakdown($recordSummary,$office){
			
			
			if($office == 'All'){
				$case1 = ' OfficeCode != "" ';
				$case2 = ' Office != "" ';
			}else{
				$case1 = " OfficeCode = '" . $office . "'";
				$case2 = " Office = '" . $office . "'";
			}

			
			
			$summaryFund = '<table style = "margin:0 auto;border-spacing:0px;border:1px solid silver;padding:20px;box-shadow:0px 0px 20px 10px silver;background-color:white;padding-bottom:80px;" border = "0">';
			$summaryFund .= '<tr ><td colspan = "100%" style ="text-align:center;font-family:anton;font-size:22px;color:rgb(32, 50, 4);padding-bottom:0px;padding-top:60px;">Budget Breakdown</td></tr>';
			$summaryFund .= '<tr ><td colspan = "100%" style ="height:1px; text-align:center;padding-bottom:20px;line-height:12px;font-size:12px;font-family:nor;letter-spacing:1px;">( PPMP - PR Charged )</td></tr>';			
			$oldFund = '';
			$oldProgram = '';
			$oldType = '';
			$programCtr = 1;
			$totalPPMP = 0;
			$totalPR = 0;
			$grandTotal = [];
			$test = '';
			while($data = $this->fetch_array($recordSummary)){
				
				$fund =$data['Fund'];
				$program =$data['Name'];
				$programCode =$data['Code'];
				
				$account = $data['Title'];
				$ppmp =$data['PPMP'];
				$pr =$data['PR'];
				$type =$data['AccountType'];
				$balance = $data['Balance'];
				$expenseCode = $data['ExpenseCode'];
				$diff = ($totalPPMP - $totalPR);
				$percent = round(($pr / $ppmp) * 100);

				if($diff > 0){
					$percentTotal =  round(($totalPR / $totalPPMP) * 100);
				}else if($diff < 0){
					$percentTotal =  round(($totalPR / $totalPPMP) * 100);
				}else{
					if($diff == 0){
						$percentTotal =  100;
					}
				}
				
				if($balance < 0 ){
					$balanceColor = "rgb(189, 12, 95);";
				}else{
					$balanceColor = "black;";
				}
				$totalColor = "";
				if($programCtr > 1 ){
					
					if($diff < 0){
						$totalColor = "red;";
					}else{
						$totalColor = "rgb(143, 103, 35);";
					}
					//$percentColorTotal = "background: linear-gradient(to left, rgb(1, 177, 24) ,rgb(95, 174, 78));";
					$percentColorTotal ="background-color:rgb(141, 184, 47);";
					if($program == $oldProgram){
						if($oldType != $type){
							
							$percentTotalWidth = $percentTotal;
							if($percentTotal > 100){
								$percentColorTotal = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
								$percentTotalWidth = 100;
								
							}else if($percentTotal <= 0){
								$percentTotalWidth = 100;
								
								if($diff < 0){
									$percentColorTotal = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
									
								}else{
									$percentColorTotal = "background: linear-gradient(to left, green ,rgb(99, 194, 88));";
									
								}
								$percentTotal = 100;
								if($totalPR == 0){
									$percentColorTotal = "background: none;";
									$percentTotal = '0';
								}
							}
							
							//-------------------------------------------------------------------------------------------------------------------------------------------------change type
							$summaryFund .='<tr>';
							$summaryFund .='<td colspan ="2"></td><td class ="summaryBudgetTotal" >' . number_format($totalPPMP,2) . '</td>';
							$summaryFund .='<td class ="summaryBudgetTotal" >' .$this->zeroToNothing(number_format($totalPR,2)) . '</td>';
							$summaryFund .='<td class ="summaryBudgetTotal" style ="color:' . $totalColor . '">' . number_format(($diff),2) . '</td>';
							
							$summaryFund .='<td class ="summaryBudgetTotal" style ="color:' . $totalColor . '; vertical-align:middle;width:200px;padding:0;">
												<div style ="width:100%;background-color:rgb(233, 238, 214);height:18px;display:' . $percentShow . '">
												<div style ="height:18px;' . $percentColorTotal .  ';  width:' . $percentTotalWidth . '%;">&nbsp;</div></div>
												</td>';
							$summaryFund .='<td class ="summaryBudgetTd" style ="border:0;text-align:center;vertical-align:middle;font-size:14px;padding:0;">
												<div style ="' . $percentBGColor .  '; font-size:14px;padding:0px 5px;">' .  $percentTotal . ' %</div>
										   </td>';
							$summaryFund .= '<tr>';
							$totalPPMP = 0;		
							$totalPR = 0;		
						}
					}else{
						$percentTotalWidth = $percentTotal;
						if($percentTotal > 100){
							$percentColorTotal = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
							$percentTotalWidth = 100;
							
						}else if($percentTotal <= 0){
							$percentTotalWidth = 100;
							
							if($diff < 0){
								$percentColorTotal = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
							}else{
								//$percentColorTotal = "background: linear-gradient(to left, green ,rgb(99, 194, 88));";
								$percentColorTotal ="background-color:rgb(141, 184, 47);";
							}
							$percentTotal = 100;
							if($totalPR == 0){
								$percentColorTotal = "background: none;";
								$percentTotal = '0';
							}
						}
						//--------------------------------------------------------------------------------------------------------------------------------------------------------------change program
						$summaryFund .='<tr>';
						$summaryFund .='<td colspan ="2"></td><td class ="summaryBudgetTotal">' . number_format($totalPPMP,2) . '</td>';
						$summaryFund .='<td class ="summaryBudgetTotal">' . $this->zeroToNothing(number_format($totalPR,2)) . '</td>';
						$summaryFund .='<td class ="summaryBudgetTotal" style ="color:' . $totalColor . '">' .  number_format(($diff),2) . '</td>';
						$summaryFund .='<td class ="summaryBudgetTotal" style ="color:' . $totalColor . '; vertical-align:middle;width:200px;padding:0;">
												<div style ="width:100%;background-color:rgba(216, 223, 202,.5);height:18px;display:' . $percentShow . '">
												<div style ="height:18px;' . $percentColorTotal .  ';  width:' . $percentTotalWidth . '%;">&nbsp;</div></div>
											</td>';
						$summaryFund .='<td class ="summaryBudgetTd" style ="border:0;text-align:center;vertical-align:middle;font-size:14px;padding:0;">
											<div style ="' . $percentBGColor .  'font-size:14px;padding:0px 5px;">' .  $percentTotal . ' %</div>
									   </td>';
						$summaryFund .= '<tr>';
						$totalPPMP = 0;		
						$totalPR = 0;	
					}
				}
				$totalPPMP += $ppmp;
				$totalPR += $pr;
				
				if(isset($grandTotal[$fund])){
					$grandTotal[$fund]['PPMP'] = ($grandTotal[$fund]['PPMP'] + $ppmp);
					$grandTotal[$fund]['PR'] = ($grandTotal[$fund]['PR'] + $pr);
				}else{
					$grandTotal[$fund]['PPMP'] = floatval($ppmp);
					$grandTotal[$fund]['PR'] = floatval($pr);
				}
				if($fund != $oldFund){
					$summaryFund .='<tr style ="">';
					if($oldProgram != ''){
						$summaryFund .='<td colspan ="100%" style ="font-family:anton;color:rgb(92, 112, 90);font-size:22px;padding:10px 0px;padding-top:100px;">' . $fund . '</td>';
					}else{
						$summaryFund .='<td colspan ="100%" style ="font-family:anton;color:rgb(92, 112, 90);font-size:22px;padding:10px 0px;">' . $fund . '</td>';
					}
					$summaryFund .= '<tr>';
					
				}
				if($program != $oldProgram){
					if($oldFund != '' and  $fund != ''){
						if($fund == $oldFund){
							$summaryFund .='<tr><td colspan ="100%" style ="padding:40px;"></td></tr>';
						}
					}

					$summaryFund .='<tr><td colspan="100%;" style ="padding:10px;"></td></tr>';
					$summaryFund .='<tr style ="background-color:rgb(238, 237, 235);font-weight:bold;background: linear-gradient(to right, rgb(212, 219, 194) ,rgba(234, 239, 230,.3));"> ';
					$summaryFund .='<td style ="text-align:center;padding:0px 10px;font-size:12px;color:white; vertical-align:middle;background-color:rgb(57, 102, 5);">' . $programCtr++ . '</td>';
					$summaryFund .='<td  style ="padding-left:10px;max-width:500px;"><span style ="color:rgb(163, 106, 35);">' . $programCode . '</span>  ' . $program . '</td>';
					$summaryFund .='<td  style ="text-align:center;">PPMP</td>';
					$summaryFund .='<td style ="text-align:center;" >PR</td>';
					$summaryFund .='<td style ="text-align:center;" >Balance</td>';
					$summaryFund .='<td style ="text-align:center;">PR Charged</td>';
					$summaryFund .='<td ></td>';
					$summaryFund .= '<tr>';
					$oldType = '';
					
				}
				if($oldType != $type){
					$summaryFund .='<tr style ="">';
					$summaryFund .='<td colspan ="100%" style ="padding-left:60px;padding-top:15px;font-weight:bold;color:rgb(57, 102, 5);">' . $type . '</td>';
					
					$summaryFund .= '<tr>';
				}
				$summaryFund .='<tr class ="trBudgetBreakdown" onclick ="fetchBudgetBreakdown(this)">';
				$summaryFund .='<td><span style= "display:none;">'  . $office . '*'. $programCode . '*' .  $expenseCode . '*' . $fund . '*' . $program .  '</span></td>';
				$summaryFund .='<td class ="summaryBudgetTd"   style ="padding-left:80px;">' . $account . '</td>';
				$summaryFund .='<td class ="summaryBudgetTd">' .  number_format($ppmp,2) . '</td>';
				$summaryFund .='<td class ="summaryBudgetTd">' . $this->zeroToNothing(number_format($pr,2)) . '</td>';
				$summaryFund .='<td class ="summaryBudgetTd" style ="color:' . $balanceColor . '">'  . $this->zeroToNothing(number_format($balance,2)) . '</td>';
				$percentDisplay = $percent;
				$percentColor = "background: linear-gradient(to left, rgb(136, 185, 130) ,rgba(136, 185, 130,.5));";
				$percentShow = 'block';
				$percentBGColor = "";
				if($percent > 100){
					$percentDisplay = 100;
					$percentColor = "background: linear-gradient(to left, rgba(165, 16, 30,.4) ,rgba(250, 0, 0,.4));";
					$percentBGColor = "background-color:none;color:red;";
				}else if($percent <= 0){
					$percentShow ="block";
				}
				$summaryFund .='<td class ="summaryBudgetTd" style ="border:0;;vertical-align:middle;padding-right:0px;">
						<div style ="background-color:rgba(216, 223, 202,.5);height:15px;display:' . $percentShow . '">
						<div style ="height:15px;' . $percentColor .  ' width:' . $percentDisplay . '%;">&nbsp;</div></div></td>';
				if($percent <= 0){
					$summaryFund .='<td></td>';
				}else{
					$summaryFund .='<td class ="summaryBudgetTd" style ="border:0;text-align:center;vertical-align:middle;font-size:14px;padding:0;">
										<div style ="' . $percentBGColor .  'font-size:12px;padding:0px 5px;">' .  $percent . ' %</div>
									</td>';
				}
				$summaryFund .='</tr>';
				$oldFund = $fund;
				$oldProgram = $program;
				$oldType = $type;	
			}
			$percentTotal =  round(($totalPR / $totalPPMP) * 100);
			$percentTotalWidth = $percentTotal;
			if($percentTotal > 100){
				$percentColorTotal = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
				$percentTotalWidth = 100;
			}else if($percentTotal <= 0){
				$percentTotalWidth = 100;
				
				if($diff < 0){
					$percentColorTotal = "background: linear-gradient(to right, rgb(165, 16, 30) ,red);";
				}else{
					$percentColorTotal = "background: linear-gradient(to left, green ,red);";
				}
				$percentTotal = '100';
			}
			if($totalPR == 0){
					$percentColorTotal = '';
					$percentTotal = 0;
			}
			
			
			$summaryFund .='<tr>';
			$summaryFund .='<td colspan ="2"></td><td class ="summaryBudgetTotal">' . number_format($totalPPMP,2) . '</td>';
			$summaryFund .='<td class ="summaryBudgetTotal">' . $this->zeroToNothing(number_format($totalPR,2)) . '</td>';
			$summaryFund .='<td class ="summaryBudgetTotal">' . number_format(($totalPPMP - $totalPR),2) . '</td>';
			$summaryFund .='<td class ="summaryBudgetTotal" style ="color:' . $totalColor . '; vertical-align:middle;width:200px;padding:0;">
									<div style ="width:100%;background-color:rgba(216, 223, 202,.5);height:18px;display:' . $percentShow . '">
									<div style ="height:18px;' . $percentColorTotal .  ' width:' . $percentTotalWidth . '%;">&nbsp;</div></div>
								</td>';
			$summaryFund .='<td class ="summaryBudgetTd" style ="border:0;text-align:center;vertical-align:middle;font-size:14px;padding:0;">
								<div style ="' . $percentBGColor .  'font-size:14px;padding:0px 5px;">' .  $percentTotal . ' %</div>
						   </td>';
			$summaryFund .= '<tr>';
			$summaryFund .='</table>';
			return array('data' => $grandTotal, 'text' => $summaryFund);
		}
		function summaryTransaction($office){
			if($office == 'All'){
				$case = " a.Office != '' ";
				$case2 = " Office != '' ";
			}else{
				$case = " a.Office = '" . $office . "'";
				$case2 = " Office != '' ";
			}
			$sql = "SELECT TrackingType,a.Status, Count(distinct TrackingNumber) as Ctr
						from vouchercurrent
						a left join status B ON a.status = b.status and a.TrackingType = b.Type 
						where " . $case . " and a.status != 'Cancelled'  and TrackingType not in('PY','NF','IP')
						group by TrackingType,Status  order by a.TrackingType, b.OrderStat";
				$recordHeader = $this->query($sql);
				
				$sheetSummaryPR = '<table border ="0" style ="width:200px;margin:0 auto;border-spacing:0;">';
				$sheetSummaryPO = '<table border ="0" style ="width:200px;margin:0 auto;border-spacing:0;">';
				$sheetSummaryPX = '<table border ="0" style ="width:200px;margin:0 auto;border-spacing:0;">';
				
				$prTotal = 0;
				$prPieValues ='';
				$prPieStatus = '';
				
				$poTotal = 0;
				$poPieValues ='';
				$poPieStatus = '';
				
				$pxTotal = 0;
				$pxPieValues ='';
				$pxPieStatus = '';
				
				$lastStatusPR = 0;
				$lastStatusPO = 0;
				$lastStatusPX = 0;
				
				while($data = $this->fetch_array($recordHeader)){
					$type = $data['TrackingType'];
					$status = $data['Status'];
					$count = $data['Ctr'];
					
					if($type == 'PR'){
						if(preg_match('/Pending/i',$status)){
							$pColor = 'Red';
						}else{
							$pColor = 'Black';
						}
						//if($status)
						$sheetSummaryPR .= '<tr>';
						$sheetSummaryPR .= '<td style ="vertical-align:middle;width:60%;" class = "summaryStatus">' . $status . '</td>';
						
						$sheetSummaryPR .= "<td class = 'summaryCount' style ='color:" . $pColor . "; text-align:right;' onclick = 'fetchTrackingByStatus(\"" . $status . "*PR"  . "\")'>" . $count . "</td><td></td>";
						
						$sheetSummaryPR .= '<tr>';
						$prTotal += $count;
						$prPieValues .= $count . '*';
						$prPieStatus .= $status . '*';
						if($status =="For P.O"){
							$lastStatusPR = $count;
						}
					}else if($type == 'PO'){
						if(preg_match('/Pending/i',$status)){
							$pColor = 'Red';
						}else{
							$pColor = 'Black';
						}
						$sheetSummaryPO .= '<tr>';
						$sheetSummaryPO .= '<td style ="vertical-align:middle;width:60%;" class = "summaryStatus">' . $status . '</td>';
						$sheetSummaryPO .= "<td class = 'summaryCount' style ='color:" . $pColor . ";text-align:right;' onclick = 'fetchTrackingByStatus(\"" . $status . "*PO"  . "\")'>" . $count . "</td><td></td>";
						$sheetSummaryPO .= '<tr>';
						$poTotal += $count;
						$poPieValues .= $count . '*';
						$poPieStatus .= $status . '*';
						if($status =="Waiting for Delivery"){
							$lastStatusPO = $count;
						}
					}else if($type == 'PX'){
						if(preg_match('/Pending/i',$status)){
							$pColor = 'Red';
						}else{
							$pColor = 'Black';
						}
						$sheetSummaryPX .= '<tr> ';
						$sheetSummaryPX .= '<td style ="vertical-align:middle;width:60%;" class = "summaryStatus">' . $status . '</td>';
						$sheetSummaryPX .= "<td class = 'summaryCount' style ='color:" . $pColor . ";text-align:right;' onclick = 'fetchTrackingByStatus(\"" . $status . "*PX"  . "\")'>" . $count . "</td><td></td>";					
						$sheetSummaryPX .= '<tr>';
						$pxTotal += $count;
						$pxPieValues .= $count . '*';
						$pxPieStatus .= $status . '*';
						if($status == "Check Released"){
							$lastStatusPX = $count;
						}
					}
				}
				if($prTotal == 0){
					$prTotal ='<span style ="color:grey;">No transaction yet.</span>';
				}
				if($poTotal == 0){
					$poTotal ='<span style ="color:grey;">No transaction yet.</span>';
				}
				if($pxTotal == 0){
					$pxTotal ='<span style ="color:grey;">No transaction yet.</span>';
				}
				
				$sheetSummaryPR .= '<tr>
									 <td></td>';
				$sheetSummaryPR .= "<td class ='hoverTotal' onclick = 'fetchTrackingByType(\"PR*" . $office . "\")' >" . $prTotal.  "</td>";
				$sheetSummaryPR .= '<td></td></tr>';
				$sheetSummaryPR .= '</table>';
				
				$sheetSummaryPO .= '<tr> <td></td>';	
				$sheetSummaryPO .= "<td class ='hoverTotal' onclick = 'fetchTrackingByType(\"PO*" . $office . "\")' >" . $poTotal.  "</td>";					
				$sheetSummaryPO .= ' <td></td>
									</tr>';
				$sheetSummaryPO .= '</table>';
				$sheetSummaryPX .= '<tr>
									 <td></td>';	
				$sheetSummaryPX .= "<td class ='hoverTotal' onclick = 'fetchTrackingByType(\"PX*" . $office . "\")' >" . $pxTotal.  "</td>";	
				$sheetSummaryPX .= '<td></td>
									</tr>';
				$sheetSummaryPX .= '</table>';
				
				$sheetSummary = '<div id ="pieValuesPR" style ="display:none;">' . $prPieValues . '</div>
								 <div id ="pieStatusPR" style ="display:none;">' . $prPieStatus . '</div>
								 <div id ="pieValuesPO" style ="display:none;">' . $poPieValues . '</div>
								 <div id ="pieStatusPO" style ="display:none;">' . $poPieStatus . '</div>
								 <div id ="pieValuesPX" style ="display:none;">' . $pxPieValues . '</div>
								 <div id ="pieStatusPX" style ="display:none;">' . $pxPieStatus . '</div>';
									
									
				if($prTotal > 0){
					$prComplete = round(($lastStatusPR / $prTotal) * 100); 
				}
				if($poTotal > 0){
					$poComplete = round(($lastStatusPO / $poTotal) * 100); 
				}
				if($pxTotal > 0){
					$pxComplete = round(($lastStatusPX / $pxTotal) * 100); 
				}					
				
				$sheetSummary .= '<table style = "border-spacing:0;margin:0 auto;" border ="0">';
				$sheetSummary .= '<tr>
										<td colspan ="100%"  style ="text-align:center;font-family:anton;font-size:22px;color:rgb(32, 50, 4);padding-bottom:60px ;">Transaction Summary</td>
			 					</tr>';
				
				
				$sheetSummary .= '<tr style ="font-size:56px;font-family:anton;color:grey;">
										<td style ="text-align:center;">' . $prComplete . '<span style ="font-family:nor;font-size:12px;"> % completed</span></td>
										<td style ="text-align:center;">' . $poComplete . '<span style ="font-family:nor;font-size:12px;"> % completed</span></td>
										<td style ="text-align:center;">' . $pxComplete . '<span style ="font-family:nor;font-size:12px;"> % completed</span></td>
									</tr>';
				$sheetSummary .= '<tr>
										<td style ="text-align:center;"><span class ="summaryHeader">Purchased Request</span></td>
										<td style ="text-align:center;"><span class ="summaryHeader">Purchased Order</span></td>
										<td style ="text-align:center;"><span class ="summaryHeader">Purchased Payment</span></td>
									</tr>';
				
				$sheetSummary .= '<tr>
										<td  style = "padding:10px;padding-bottom:0;text-align:center;"><canvas class ="canvas" id="canPR" width="200" height="200" /></td>
										<td  style = "padding:10px;padding-bottom:0;text-align:center;"><canvas class ="canvas" id="canPO" width="200" height="200" /></td>
										<td  style = "padding:10px;padding-bottom:0;text-align:center;"><canvas class ="canvas" id="canPX" width="200" height="200" /></td>
									</tr>';
				
				$sheetSummary .= '<tr>
									 <td>' . $sheetSummaryPR . '</td>';
				$sheetSummary .= 	'<td>' . $sheetSummaryPO . '</td>';
				
				$sheetSummary .= 	'<td>' . $sheetSummaryPX . '</td>';
				$sheetSummary .= '</tr>';
				
				/*$sheetSummary .= '<tr>';
				$sheetSummary .= '<td colspan ="100%;">
									<table style ="margin:0 auto;margin-top:50px;">';
				$sheetSummary .= '<tr><td colspan ="100%" style ="text-align:center;font-size:22px;font-family:anton;color:rgb(32, 50, 4);">Quarterly Summary</td></tr>';
				$sheetSummary .= '		<tr>
											  <td style ="padding:0px 20px;">' .  $this->summaryQuarter($case2,$office,'PR','For P.O') . '</td>	
											  <td style ="padding:0px 20px;">' . $this->summaryQuarter($case2,$office,'PO','Waiting for Delivery')  . '</td>	
											  <td style ="padding:0px 20px;">' . $this->summaryQuarter($case2,$office,'PX','Check Released') . '</td>';
				$sheetSummary .= '		</tr>';						
				$sheetSummary .= ' </table>
								  </td>';
				$sheetSummary .= '</tr>';
				*/
			/*	$sheetSummary .= '<tr><td colspan = "100%">' .  $this->summaryPR($office) . '</td></tr>';
				$sheetSummary .= '<tr><td colspan = "100%">' .  $this->summaryPO($office) . '</td></tr>';
				$sheetSummary .= '<tr><td colspan = "100%">' .  $this->summaryPX($office) . '</td></tr>';*/
				
				$sheetSummary .= '</table>';
				return $sheetSummary;
		}
		
		function summaryTransactionHeader($office,$officeName){
			$sql = "SELECT group_concat(distinct Status SEPARATOR '*') as Status FROM vouchercurrent where TrackingType = 'PR' and Status like '%Pending%' and office = '" . $office . "'";
			$recordHeader = $this->query($sql);
			$data = $this->fetch_array($recordHeader);
			$statusesPR = $data['Status'];
			$sql = "SELECT group_concat(distinct Status SEPARATOR '*') as Status FROM vouchercurrent where TrackingType = 'PO' and Status like '%Pending%' and office = '" . $office . "'";
			$recordHeader = $this->query($sql);
			$data = $this->fetch_array($recordHeader);
			$statusesPO = $data['Status'];
			
			$sql = "SELECT group_concat(distinct Status SEPARATOR '*') as Status FROM vouchercurrent where TrackingType = 'PX' and Status like '%Pending%' and office = '" . $office . "'";
			$recordHeader = $this->query($sql);
			$data = $this->fetch_array($recordHeader);
			$statusesPX = $data['Status'];
			
			
			$sqlHeader = "select * from status where type = 'PR' or type = 'PO' or type = 'PX' order by FIELD(type, 'PR', 'PO', 'PX'), OrderStat asc";
			$recordHeader = $this->query($sqlHeader);
			$statusRow = '<th ></th>';
			$guideColRow = '<th style ="background-color:rgb(70, 97, 129);"></th>';
			$statusColor = '<th style =""></th>';
			
			$arrayColumn = [];
			$arrayStatusIdPR = [];
			$arrayStatusIdPO = [];
			$arrayStatusIdPX = [];
			
			$arrayPRstatusProcessId = [];
			$arrayPOstatusProcessId = [];
			$arrayPXstatusProcessId = [];
						
			$arrayPRstatusOffice = [];
			$arrayPOstatusOffice = [];
			$arrayPXstatusOffice = [];

			$arrayPRstatusTime = [];
			$arrayPOstatusTime = [];
			$arrayPXstatusTime = [];
			
			$i = 1;
			$iCtrPR =1;
			$prCol = 0;
			$poCol = 0;
			$pxCol = 0;
			
			$oldType = '';
			$oneColumn = '<th class = "" ></th>';
			$twoColumn = '<th class = "headerTotalDaysA"></th>';
			$twoColumn = '';
			
			
			while($data = $this->fetch_array($recordHeader)){
				$id = $data['Id'];
				$status = $data['Status'];
				$visible = $data['Visible'];
				$office = $data['Office'];
				$color = $data['Color'];
				$type = $data['Type'];
				$time = $data['ProcessTime'];
				
				$subType = $data['SubType'];
				if($i > 1){
					if($type != $oldType){
						$statusRow .= $oneColumn;
						$guideColRow .=  '<th style ="background-color:rgb(70, 97, 129);" ></th>';
						$statusColor .=  '<th style ="" ></th>';
						$iCtrPR = 1;
					}
				}
				$oldType = $type;
				if($visible == 1){
					$i++;
					if($type == 'PR'){
						$prCol++;
						$arrayStatusIdPR[$status] = $prCol;
						$arrayStatusOffice[$status] = $office;
						if($subType =="AL"){
							$arrayPRstatusProcessId[$status] = $iCtrPR-1; // here
						}else{
							$arrayPRstatusProcessId[$status] = $iCtrPR; // here
						}
						
						$arrayPRstatusTime[$status] = $time;
					}else if($type == 'PO'){
						$poCol++;
						$arrayStatusIdPO[$status] = $poCol;
						$arrayPOstatusProcessId[$status] = $iCtrPR;
						$arrayPOstatusTime[$status] = $time;
						$arrayStatusOfficePO[$status] = $office;
					}else if($type == 'PX'){
						$pxCol++;
						$arrayStatusIdPX[$status] = $pxCol;
						$arrayPXstatusProcessId[$status] = $iCtrPR;
						$arrayPXstatusTime[$status] = $time;
						$arrayStatusOfficePX[$status] = $office;
					}
					$statusRow .= '<th class="rotate"  ><div ><span style ="border-bottom:1px solid rgba(121, 129, 137,.5);">' .$status .'</span></div></th>';
					$statusColor .= '<th style ="padding:4px 0px;border-bottom:1px solid rgba(121, 129, 137,.5); border-right:1px solid rgba(121, 129, 137,.9);"><div style ="float:right;margin-right:5px;background-color:' . $color . ';border:1px solid rgb(32, 116, 168);height:8px;width:8px;border-radius:2px;">&nbsp;</div></th>';
					
					$steps = $iCtrPR;
					if($subType == "AL"){
						$steps = $steps-1;
						$guideColRow .= '<th style ="text-align:right;padding-right:9px;background-color:rgb(70, 97, 129);"></th>';
					}else{
						
						$guideColRow .= '<th style ="text-align:right;padding-right:9px;background-color:rgb(70, 97, 129);">' . $steps .'</th>';
						$iCtrPR++;
					}
					
				}else{
				
					if($type == 'PR'){
						$match = preg_match('/' . $status . '/i', $statusesPR);
						
					}else if($type == 'PO'){
						$match = preg_match('/' . $status . '/i', $statusesPO);
					}else if($type == 'PX'){
						$match = preg_match('/' . $status . '/i', $statusesPX);
					}
					if($match == 1){
						if($type == 'PR'){
							$prCol++;
							$arrayStatusIdPR[$status] = $prCol;
							$arrayStatusOffice[$status] = $office;
							$arrayPRstatusProcessId[$status] = $iCtrPR;
							
						}else if($type == 'PO'){
							$poCol++;
							$arrayStatusIdPO[$status] = $poCol;
							$arrayPOstatusProcessId[$status] = $iCtrPR;
							$arrayStatusOfficePO[$status] = $office;
						}else if($type == 'PX'){
							$pxCol++;
							$arrayStatusIdPX[$status] = $pxCol;
							$arrayPXstatusProcessId[$status] = $iCtrPR;
							$arrayStatusOfficePX[$status] = $office;
						}
						
						$statusRow .= '<th class="rotate" ><div ><span style ="border-bottom:1px solid rgba(121, 129, 137,.5);">'. $status . '</span></div></th>';
						
						$steps = $iCtrPR;
						if($subType == "AL"){
							$steps = $steps-1;
							$guideColRow .= '<th style ="text-align:right;padding-right:9px;background-color:rgb(70, 97, 129);"></th>';
						}else{
							
							$guideColRow .= '<th style ="text-align:right;padding-right:9px;background-color:rgb(70, 97, 129);">' . $steps .'</th>';
							$iCtrPR++;
						}
						
						$statusColor .= '<th style ="padding:4px 0px;border-bottom:1px solid  rgba(121, 129, 137,.5);border-right:1px solid rgba(121, 129, 137,.9);"><div style ="float:right;margin-right:3px;background-color:' . $color . ';border:1px solid rgb(32, 116, 168);height:8px;width:8px;border-radius:2px;">&nbsp;</div></th>';
						$arrayColumn[$i]["Status"]= $status;
						$arrayColumn[$i]["Office"] = $office;
						$i++;
					}
				}
			}
			
			
			
			$colHeader = '<tr class = "trStatus" ><td colspan = "100%" style ="text-align:center;font-family:anton;font-size:22px;color:rgb(32, 50, 4);padding-bottom:160px;padding-top:60px;">Transaction Status</td></tr>';				
			$colHeader .= '<tr class = "trStatus" style ="">' . $statusRow    . '<th style =""></th></tr>';
			$colHeader .= '<tr  class = "trStatus" style = "background-color:rgb(90, 112, 137);color:white;">' . $statusColor . '<th style ="background-color:rgb(49, 64, 74);"></th></tr>';
			$colHeader .= '<tr class = "trStatus" style = "color:white;font-size:10px;">' . $guideColRow  . '<th style ="background-color:rgb(49, 64, 74);"></th></tr>';
			$colHeader .= '<tr class = "trStatus">	
							  <th  style ="background-color:rgb(17, 135, 15);"></th>
						      <th class ="processLabel"  colspan ="' . $prCol . '" style ="background-color:rgb(31, 173, 45);">Purchase Request Process</th><th class = "tdBorderHeader"></th> <th class = "headerTotalDaysB" style ="background-color:rgb(98, 166, 10);" ></th>
						      <th class ="processLabel" colspan ="' . $poCol . '" style = "background-color:rgb(35, 148, 200);">Purchase Order Process</th><th class = "tdBorderHeader"></th><th class = "headerTotalDaysB" style ="background-color:rgb(19, 124, 200);"></th>
						      <th class ="processLabel"  colspan ="' . $pxCol . '" style ="background-color:rgb(204, 155, 57);">Payment  Process</th><th class = "tdBorderHeader"></th><th class = "headerTotalDaysB" style ="background-color:rgb(49, 64, 74);min-width:80px;"></th>
						   </tr>'; 
			
			
			
			return array('arrayPRstatusProcessId' => $arrayPRstatusProcessId,'arrayPOstatusProcessId' => $arrayPOstatusProcessId,'arrayPXstatusProcessId' => $arrayPXstatusProcessId,
						 'arrayStatusIdPR' => $arrayStatusIdPR,'arrayStatusIdPO' => $arrayStatusIdPO,'arrayStatusIdPX' => $arrayStatusIdPX,
						 'prCol' => $prCol ,'poCol' => $poCol ,'pxCol' => $pxCol,
						 'arrayStatusOffice' => $arrayStatusOffice ,
						 
						 'header' => $colHeader);
		}
		function createSeeProc($record,$office,$officeName,$regulatoryOffice,$toolsType,$toolsProcessFrom,$toolsProcessTo){
			if(true){
				if($office == 'All'){
					$case1 = ' OfficeCode != "" ';
					$case2 = ' Office != "" ';
					$case3 = " a.Office != '' ";
				}else{
					$case1 = " OfficeCode = '" . $office . "'";
					$case2 = " Office = '" . $office . "'";
					$case3 = " a.Office = '" . $office . "' ";
				}
				$sql = "select a.*,b.Code,b.Name,c.Title,c.Code as ExpenseCode,c.Fund as AccountType, (a.PPMP - ifnull(a.PR,0)) as Balance from(
										select a.*,b.Total as PR from
										(SELECT Fund,ProgramCode as Program,AccountCode as Account,sum(Total) as PPMP FROM ppmpmain where " . $case1 . " and type in ('Regular','SB1','SB2','SB3','SB4') 
										and Fund in('General Fund','Trust Fund','SEF')
										group by ProgramCode,AccountCode order by Fund,Program) a 
										left join
										(
										SELECT Fund,PR_ProgramCode as Program,PR_AccountCode as Account, sum(Amount) as Total FROM vouchercurrent 
										where TrackingType = 'PR' and status != 'Cancelled' and " . $case2 . "
										group by Fund,PR_ProgramCode, PR_AccountCode order by Fund,Program) b

										on a.Fund = b.Fund and a.program = b.program and a.account = b.account
						) a
						left join programcode b on a.Program =  b.Code
						left join fundtitles c on a.Account =  c.Code
						order by a.Fund,b.Name,c.Fund,c.Title";
				
				$recordSummary = $this->query($sql);
				
				
				
				$arr = $this->summaryBreakdown($recordSummary,$office);
				$arrayFund = $arr['data'];
				$table = $arr['text'];				
				$summaryFundBreakdown = $table;
				$summaryFund = $this->summaryBudget($arrayFund);
				$summaryTransaction =  $this->summaryTransaction($office);
			
				
				$arr = $this->summaryTransactionHeader($office,$officeName);
			
				$colHeader = $arr['header'];
				$arrayPRstatusProcessId= $arr['arrayPRstatusProcessId'];
				$arrayPOstatusProcessId= $arr['arrayPOstatusProcessId'];
				
				
				$arrayPXstatusProcessId= $arr['arrayPXstatusProcessId'];
				
				$arrayStatusIdPR= $arr['arrayStatusIdPR'];
				$arrayStatusIdPO = $arr['arrayStatusIdPO'];
				$arrayStatusIdPX = $arr['arrayStatusIdPX'];
				
				$prCol= $arr['prCol'];
				$poCol= $arr['poCol'];
				$pxCol= $arr['pxCol'];
				$arrayStatusOffice = $arr['arrayStatusOffice'];
				
				
			}
			
			$sheet = '<table id ="sheetTable" border = "0" style = "width:100%;border-spacing:0;margin:0 auto;">';
			
			$sheet .= '<tr class ="trStatus1" >
							<th colspan ="100%" style ="text-align:left;line-height:32px;padding-top:20px;padding-left:10px;">
								<table style ="text-align:left;padding:10px 0px;padding-bottom:30px;">
									<tr>
											<th style ="vertical-align:top;">
												<div style = "line-height:22px;font-size:28px;padding:0px 5px;font-family:anton;color:rgb(39, 40, 38);" id  ="officeName">' . $officeName . '</div>
												<div style ="color:rgb(15, 32, 50);font-size:22px;font-family:oswald;padding-left:5px;text-shadow:0px 0px 5px white;letter-spacing:1px; " >PROCUREMENT TRANSACTIONS</div>
												<div style = "line-height:22px;font-size:18px;padding:0px 5px;font-family:oswald;color:rgb(39, 40, 38);border-top:1px solid black;">Goods and Services</div>	
											</th>
											
										</tr>
									</table>
								</th>
							  </tr>';
			
			$sheet .= '<tr id = "trBudget1" style ="display:none;"><th colspan = "100%" style ="padding:20px 0px;background-color:rgb(247, 250, 245);">' .  $summaryFund   . '</th></tr>';	
			$sheet .= '<tr id = "trBudget2" style ="display:none;"><th colspan = "100%" style ="padding:20px 0px;background-color:rgb(247, 250, 245);padding-bottom:100px;">' .  $summaryFundBreakdown    . '</th></tr>';
			
			$sheet .= '<tr id = "trBudget3" style ="display:none;"><th colspan = "100%" style ="padding:20px 0px;background-color:rgb(247, 250, 245);">' .  $this->createSupplierStatus($office)   . '</th></tr>';	
			
			$sheet .= '<tr id = "trTransaction1" style ="display:none;"><th colspan = "100%" style ="padding:90px 0px;background-color:rgb(193, 189, 162);">' . $summaryTransaction     . '</th></tr>';	
			
			$sheet .= '<tr id = "trTransaction2" style ="display:none;"><th colspan = "100%" style ="background-color:rgb(193, 189, 162);padding-bottom:60px;">
						<table style ="margin:20px auto;">';
								$sheet .= '<tr><th style ="padding:20px;background-color:rgb(247, 246, 234);">' . $this->summaryPR($office)   . '</th></tr>';	
								$sheet .= '<tr><th style ="padding:40px"></th></tr>';	
								$sheet .= '<tr><th  style ="padding:20px;background-color:rgb(247, 246, 234);">' . $this->summaryPO($office)   . '</th></tr>';
								$sheet .= '<tr><th style ="padding:40px"></th></tr>';		
								$sheet .= '<tr><th style ="padding:20px;background-color:rgb(247, 246, 234);"">' . $this->summaryPX($office)   . '</th></tr>';	
									
			$sheet .= '</table>
						</th></tr>';	
			
			
			
			$sheet .= '<tr id = "trTransaction3" style ="display:none;"><th colspan = "100%" style ="background-color:rgb(193, 189, 162);padding:160px 0px;">
						<table style ="margin:20px auto;">';
							//$sheet .= '<tr><th style ="padding:20px;background-color:rgb(247, 246, 234);">' . $this->summaryQuarter($office,'PR','For P.O')  . '</th></tr>';	
							//$sheet .= '<tr><th style ="padding:40px"></th></tr>';	
							//$sheet .= '<tr><th  style ="padding:20px;background-color:rgb(247, 246, 234);">' . $this->summaryQuarter($office,'PO','Waiting for Delivery')   . '</th></tr>';
							//$sheet .= '<tr><th style ="padding:40px"></th></tr>';		
							//$sheet .= '<tr><th style ="padding:20px;background-color:rgb(247, 246, 234);"">' . $this->summaryQuarter($office,'PX','Check Released')    . '</th></tr>';	
							$sheet .= '<tr>';
							$sheet .= '<th style ="padding:20px;background-color:rgb(247, 246, 234);vertical-align:top;">' . $this->summaryQuarter($office,'PR','For P.O')  . '</th><th style ="width:40px;"></th>';
							$sheet .= '<th style ="padding:20px;background-color:rgb(247, 246, 234);vertical-align:top;">' . $this->summaryQuarter($office,'PO','Waiting for Delivery')  . '</th><th style ="width:40px;"></th>';
							$sheet .= '<th style ="padding:20px;background-color:rgb(247, 246, 234);vertical-align:top;">' . $this->summaryQuarter($office,'PX','Check Released')   . '</th>';
							$sheet .='</tr>';			
			$sheet .= '</table>
						</th></tr>';
			
			
			$sheet .= '<tr id = "trTransaction4" style ="display:none;"><th colspan = "100%" style ="background-color:rgb(171, 171, 163);padding:160px 0px;">
							<table style ="margin:0px auto;border-spacing:0px;">
							<td style ="width:400px;">' . $this->summaryModeOfProcurement($office)   . '</td><td style ="width:40px;"></td>
							<td style ="width:400px;">' . $this->summaryMillions($office)   . '</td>
							</tr>
							</table>
						</th></tr>
						';			
			

			$sheet .= $colHeader;
			$i = 0;
			$oldPR = '';
			$oldPO = '';
			$trColorTotal ='';
			$trColor = '';
			$oddColor = '#FAF9EF';
			$evenColor = 'white';
			
			$oddColor = 'linear-gradient(to left,white,transparent)';
			$evenColor = 'linear-gradient(to left,rgba(248, 251, 209,.3),white)';
			
			
			$pr_maxProcess = max($arrayPRstatusProcessId);
			$po_maxProcess = max($arrayPOstatusProcessId);
			$px_maxProcess = max($arrayPXstatusProcessId);
			
			$totalDaysCompleted =0;
			
			
			while($data = $this->fetch_array($record)){
				
				$calendarDaysCompleted = $data['CalendarDaysCompleted'];
				$workingDaysCompleted = $data['WorkingDaysCompleted'];
				
				
				
				$office = $data['OfficeName'];
				$officeCode = $data['Office'];
				$pr_tn = $data['PR_TrackingNumber'];
				$description = ucwords(strtolower($data['Description'])); 
				$pr_amount = $data['PR_Amount']; 
				$pr_category = $data['PR_CategoryCode'];
				$pr_fund =  $data['Fund'];
				$pr_month = $data['PR_Month'];
				$quarter = $this->numberToQuarter($pr_month);
				 
				$pr_status = $data['PR_Status']; 
				$pr_encoded = $data['PR_DateEncoded']; 
				$pr_modified = $data['PR_DateModified']; 
				$pr_encodedBy = $data['PR_EncodedBy'];
				
				$pr_remarks = $data['PR_Remarks'];
				
				
				$pr_processNo = $arrayPRstatusProcessId[$pr_status];
				$pr_processPercentage = number_format($pr_processNo / $pr_maxProcess,2) * 100; 
				
				
				//echo $pr_processNo . ' -  ' . $pr_maxProcess . '<br>';
				$pr_CalendarDaysFromUpdated = $data['PR_CalendarDaysFromUpdated'];
				$pr_WorkingDaysFromUpdated = $data['PR_WorkingDaysFromUpdated'];
				$pr_CalendarDaysFromCreation  = $data['PR_CalendarDaysFromCreation'];
				$pr_WorkingDaysFromCreation  = $data['PR_WorkingDaysFromCreation'];
				
				$pr_fromUpdated = $pr_CalendarDaysFromUpdated;
				$pr_fromCreated =  $pr_CalendarDaysFromCreation;
				
				$totalDaysCompleted += $pr_fromCreated;
				
				$colspanPRa = $arrayStatusIdPR[$pr_status] ;
				$colspanPRb = $prCol -  $colspanPRa ;
				
				
				//-------------------------------------------------------------------------------
				$po_tracking =$data['PO_TrackingNumber'];
				$po_status =  $data['PO_Status'];
				$po_encoded = $data['PO_DateEncoded']; 
				$po_modified = $data['PO_DateModified']; 
				$po_claimant = $data['Claimant']; 
				$po_amount = $data['PO_Amount']; 
				
				
				if(isset($arrayStatusIdPO[$po_status]))																																																																									{
					$po_processNo = $arrayPOstatusProcessId[$po_status];
					$po_processPercentage = number_format($po_processNo / $po_maxProcess,2) *100; 
				}
				
				
				$po_remarks = $data['PO_Remarks'];
				$po_CalendarDaysFromUpdated = $data['PO_CalendarDaysFromUpdated'];
				$po_WorkingDaysFromUpdated = $data['PO_WorkingDaysFromUpdated'];
				$po_CalendarDaysFromCreation  = $data['PO_CalendarDaysFromCreation'];
				$po_WorkingDaysFromCreation  = $data['PO_WorkingDaysFromCreation']; 
				$po_fromUpdated = $po_CalendarDaysFromUpdated;
				$po_fromCreated =  $po_CalendarDaysFromCreation;
				
				$totalDaysCompleted += $po_fromCreated;
				
				
				//-------------------------------------------------------------------------------
				$px_tracking =$data['PX_TrackingNumber'];
				$px_status =  $data['PX_Status'];
				$px_encoded = $data['PX_DateEncoded']; 
				$px_modified = $data['PX_DateModified']; 
				$px_amount = $data['PX_Amount']; 
				$px_remarks = $data['PX_Remarks'];
				
				if(isset($arrayStatusIdPX[$px_status])){
					$px_processNo = $arrayPXstatusProcessId[$px_status];
					$px_processPercentage = number_format($px_processNo / $px_maxProcess,2) *100; 
				}
				
				
				$px_CalendarDaysFromUpdated = $data['PX_CalendarDaysFromUpdated'];
				$px_WorkingDaysFromUpdated = $data['PX_WorkingDaysFromUpdated'];
				$px_CalendarDaysFromCreation  = $data['PX_CalendarDaysFromCreation'];
				$px_WorkingDaysFromCreation  = $data['PX_WorkingDaysFromCreation']; 
				
				$px_fromUpdated = $px_CalendarDaysFromUpdated;
				$px_fromCreated =  $px_CalendarDaysFromCreation;
				
				$totalDaysCompleted += $px_fromCreated;
				
				if($px_status == 'Check Released'){
					$totalDaysSheet =  '<div class ="totalDaysDiv" style ="color:black;text-shadow:0px 0px 1px white;">'  . $totalDaysCompleted . '</div>';
					$totalDaysLabel = '<div class ="totalDaysLabel" style ="color:black;">Total Days Completed</div>';
				}else{
					$totalDaysSheet =  '<div class ="totalDaysDiv" style ="color:grey;">'  . $totalDaysCompleted . '</div>';
					$totalDaysLabel = '<div class ="totalDaysLabel" style = "color:grey;">Days Ongoing</div>';
				}
				$totalDaysCompleted = 0;
				
				
				$pr_statusOffice = $arrayStatusOffice[$pr_status];
				
				$po_statusOffice = '';
				if(isset($arrayStatusOfficePO[$po_status])){
					$po_statusOffice = $arrayStatusOfficePO[$po_status];
				}
				
				$px_statusOffice = '';
				if(isset($arrayStatusOfficePX[$px_status])){
					$px_statusOffice = $arrayStatusOfficePX[$px_status];
				}
				
				
				$trShow = '';
				if($regulatoryOffice != '-'){
					$trShow = 'none';
					if($toolsType == "PR"){
						if($regulatoryOffice == $pr_statusOffice){
							$trShow = 'table-row';
							$i++;
						}
					}else if($toolsType == "PO"){
						if($regulatoryOffice == $po_statusOffice){
							$trShow = 'table-row';
							$i++;
						}
					}else if($toolsType == "PX"){
						if($regulatoryOffice == $px_statusOffice){
							$trShow = 'table-row';
							$i++;
						}
					}
				}else{
					$i++;
				}
				
				//$toolsProcessFrom,$toolsProcessTo
				if($toolsProcessFrom != '-'){
					if($toolsProcessFrom == $toolsProcessTo){
						if($toolsType =="PR"){
							if($pr_processPercentage < $toolsProcessFrom ){
								$trShow = 'none';
							}
							
						}else if($toolsType =="PO"){
							if($po_processPercentage < $toolsProcessFrom ){
								$trShow = 'none';
							}
							
						}else{
							if($px_processPercentage < $toolsProcessFrom ){
								$trShow = 'none';
							}
						}
					}else{
						if($toolsType =="PR"){
							if($pr_processPercentage >= $toolsProcessFrom and $pr_processPercentage <= $toolsProcessTo ){
								$trShow = 'table-row';
							}else{
								$trShow = 'none';
							}
							
						}else if($toolsType =="PO"){
							if($po_processPercentage >= $toolsProcessFrom and $po_processPercentage <= $toolsProcessTo ){
								$trShow = 'table-row';
							}else{
								$trShow = 'none';
							}
							
						}else{
							if($px_processPercentage >= $toolsProcessFrom and $px_processPercentage <= $toolsProcessTo ){
								$trShow = 'table-row';
							}else{
								$trShow = 'none';
							}
						}
					}
				}
				
				$pr_processTime = '';
				if(isset($arrayPRstatusTime[$pr_status])){
					$pr_processTime = $arrayPRstatusTime[$pr_status];
				}
				
				
				$po_processTime = '';
				if(isset($arrayPOstatusTime[$po_status])){
					$po_processTime = $arrayPRstatusTime[$po_status];
				}
				$px_processTime = '';
				if(isset($arrayPXstatusTime[$px_status])){
					$px_processTime = $arrayPXstatusTime[$px_status];
				}
				if($oldPR != $pr_tn){
					if($trColor == $evenColor){
						$trColor = $oddColor;
						$trColorTotal = "rgb(232, 243, 250)";
					}else{
						$trColor = $evenColor;
						$trColorTotal = "rgb(209, 219, 197)";
					}
					$display = 1;
				}else{
					$trColor = $oddColor;
					$trColorTotal = "rgb(232, 243, 250)";
					$display = 0;
				}
				$sheet .= '<tr class ="trStatus" style = "background:' . $trColor . ';display:' . $trShow. ';">';
				if($display == 1){
					$sheet .= '<td ><div style  ="padding:2px 8px;font-size:28px;font-family:oswald;background-color:rgba(116, 120, 134,.1);text-align:center;">' . $i  . '</div></td>';	
				}else{
					$sheet .= '<td ><div style  ="display:none;padding:2px;font-size:28px;font-family:oswald;background-color:rgba(116, 120, 134,.1);text-align:center;">' . $i  . '</div></td>';	
				}
				
				//pr---------------------------------------------------------------------------------------------------------
				if($display == 1)																																																																												{
					
					$showy = 'remarksContainerHide';
					if(preg_match("/Pending/",trim($pr_status))){
						$bulletClassPR = "bulletPR bulletPRPending";
						$showy ='remarksContainer';
					}else if(preg_match("/For P.O/",trim($pr_status))){
						$bulletClassPR = "bulletPR bulletPRfinished";
					}else{
						$bulletClassPR = "bulletPR";
					}
					
					$sheet .= '<td class = "prTD" colspan ="' . $colspanPRa . '" style = "padding-top:40px;padding-right:20px;" >';
					$sheet .= '<div class ="barPRdiv" ></div>';
					$sheet .= '<div class = "' . $bulletClassPR . '"></div>';
					
					$sheet .= '<div class ="detailsContainer" >';
					$sheet .= '<div id ="containerProcess" style ="padding-top:5px;">';
						$sheet .= '<table style ="float:right;margin-right:-84px;border-spacing:0;margin-top:-52px;" border ="0">';	
										if($pr_status == "For P.O"){
											$sheet .= '<tr >
														<td style ="">
															<span style ="font-family:arial;font-size:12px;color:grey;">' . $pr_processNo . '/' . $pr_maxProcess . '</span>
															<span style ="color:rgb(126, 199, 25);font-size:30px;font-weight:bold;text-shadow:0px 0px 2px white;">' . $pr_processPercentage . '<span style ="font-weight:normal;font-size:20px;padding-left:2px;">%</span></span>
														</td>
													</tr>';
											$sheet .= '<tr >
														<td style ="text-align:right;padding-right:18px;">
															<span style ="color:rgb(126, 199, 25);font-size:20px;font-weight:bold;">' . $pr_fromCreated . '</span><br>
															<span class = "processStatus" >days<br>completed</span>
														</td>
													</tr>';
										}else{
											$sheet .= '<tr >
														<td style ="">
															<span style ="font-family:arial;font-size:12px;color:grey;">' . $pr_processNo . '/' . $pr_maxProcess . '</span>
															<span style ="font-size:30px;font-weight:bold;">' . $pr_processPercentage . '<span style ="font-weight:normal;font-size:20px;padding-left:2px;">%</span></span>
														</td>
													</tr>';
											$sheet .= '<tr >
														<td style ="text-align:right;padding-right:18px;">
															
															<span style ="color:black;font-size:20px;">' . $pr_fromCreated . '</span><br>
															<span class = "processStatus" s>days<br>ongoing</span>
														</td>
													</tr>';
										}							
						$sheet .='</table>';
					$sheet .= '</div>';
					$sheet .= '<div class ="descriptions">' . $description . '</div>';
					$sheet .= "<div class = 'trackingNumbers' onclick ='showTracking(\"" . $pr_tn  . "*PR" ."\")'>" . $pr_tn . "</div>";
					$sheet .= '<div class = "amounts">' . number_format($pr_amount,2) . '</div>';
					$sheet .= '<div class = "quarters">' . $quarter . '</div>';
					$sheet .= '<div class = "funds">' . $pr_fund . '</div>';
					$sheet .= '<div class = "encoded"><span>Created : </span>' . $pr_encoded . '</div>';
					$sheet .= '<div class = "statuses" style ="">' . $pr_status. '</div>';
					if($pr_processTime > 0){
							$sheet .= '<div class = "processTime"><span style ="font-weight:bold;">' . $pr_processTime . '</span> days processing time</div>';
					}
					$sheet .= '<div class = "statusOffice">' . $pr_statusOffice. '</div>';
					$sheet .= '<div class = "modified"><span>Updated : </span>' . $pr_modified . '</div>';
					$sheet .= '<div class = "fromUpdated"><span>' . $pr_fromUpdated . '</span><span>' .$this->daysAgoLabel($pr_fromUpdated) .  '</span> </div>';
					
					$sheet .= '<div class = "' . $showy. '" >';
					$sheet .= '<div class ="remarksLabel">Pending Notes</div>';
					$sheet .= '<div class ="remarks">' . $pr_remarks . '</div>';
					$sheet .= '</div>';
					$sheet .= '</div>';
					$sheet .= '</td>';
					if($colspanPRa < $prCol){
						$sheet .= '<td class = "prTD" colspan ="' . $colspanPRb . '"></td>';
					}
					$sheet .= '<td ><div class = "tdBorder"></div></td>';
					$sheet .= '<td class = "totalDaysTD" style ="background-color:rgba(16, 34, 76,.5);" ></td>';
					
					
				}else{
					$sheet .= '<td class = "prTD" colspan ="' . $colspanPRa . '" >';
					$sheet .= '</td>';
					if($colspanPRa < $prCol){
						$sheet .= '<td colspan ="' . $colspanPRb . '"></td>';
					}
					$sheet .= '<td><div class = "tdBorder"></div></td>';
					$sheet .= '<td class = "totalDaysTD" style ="background-color:rgba(16, 34, 76,.5)"></td>';
					
				}	
				//po---------------------------------------------------------------------------------------------------------
				if($po_tracking)																																																																																																				{
					
					if($oldPO != $po_tracking){
						if(isset($arrayStatusIdPO[$po_status]))																																																																									{
							/*$po_processNo = $arrayPOstatusProcessId[$po_status];
							$po_processPercentage = number_format($po_processNo / $po_maxProcess,2) *100; */
							
							
							$colspanPOa = $arrayStatusIdPO[$po_status] ;
							$colspanPOb = $poCol -  $colspanPOa ;
							$showyPO = 'remarksContainerHide';
							if(preg_match("/Pending/",trim($po_status))){
								$bulletClassPO = "bulletPO bulletPOPending";
								$showyPO ='remarksContainer';
							}else if(preg_match("/Waiting for Delivery/",trim($po_status))){
								$bulletClassPO = "bulletPO bulletPOfinished";
							}else{
								$bulletClassPO = "bulletPO";
							}
							$sheet .= '<td class = "poTD" colspan ="' . $colspanPOa . '" style = "padding-top:40px;padding-right:20px;" >';
							$sheet .= '<div class ="barPOdiv" ></div>';
							$sheet .= '<div class = "' . $bulletClassPO . '"></div>';
							$sheet .= '<div class ="detailsContainer" >';
							$sheet .= '<div id ="containerProcess" style ="padding-top:5px;">';
									
							$sheet .= '<table style ="float:right;margin-right:-84px;border-spacing:0;margin-top:-52px;" border ="0">';	
									if($po_status == "Waiting for Delivery"){
										$sheet .= '<tr >
													<td style ="">
														<span style ="font-family:arial;font-size:12px;color:grey;">' . $po_processNo . '/' . $po_maxProcess . '</span>
														<span style ="color:rgb(78, 187, 242);font-size:30px;font-weight:bold;text-shadow:0px 0px 2px white;">' . $po_processPercentage . '<span style ="font-weight:normal;font-size:20px;padding-left:2px;">%</span></span>
													</td>
												</tr>';
										$sheet .= '<tr >
													<td style ="text-align:right;padding-right:18px;">
														<span style ="color:rgb(78, 187, 242);font-size:20px;font-weight:bold;">' . $po_fromCreated . '</span><br>
														<span class = "processStatus" >days<br>completed</span>
													</td>
												</tr>';
									}else{
										$sheet .= '<tr >
													<td style ="">
														<span style ="font-family:arial;font-size:12px;color:grey;">' . $po_processNo . '/' . $po_maxProcess . '</span>
														<span style ="font-size:30px;font-weight:bold;">' . $po_processPercentage . '<span style ="font-weight:normal;font-size:20px;padding-left:2px;">%</span></span>
													</td>
												</tr>';
										$sheet .= '<tr >
													<td style ="text-align:right;padding-right:18px;">
														
														<span style ="color:black;font-size:20px;">' . $po_fromCreated . '</span><br>
														<span class = "processStatus" s>days<br>ongoing</span>
													</td>
												</tr>';
									}							
							$sheet .='</table>';
							$sheet .= '</div>';
							$sheet .= '<div class ="claimants">' . $po_claimant . '</div>';
							$sheet .= "<div class = 'trackingNumbers' onclick ='showTracking(\"" . $po_tracking  . "*PO" ."\")'>" . $po_tracking . "</div>";
							$sheet .= '<div class = "amounts">' . number_format($po_amount,2) . '</div>';
							$sheet .= '<div class = "encoded"><span>Created : </span>' . $po_encoded . '</div>';
							$sheet .= '<div class = "statuses" style ="">' . $po_status. '</div>';
							
							
							if($po_processTime > 0){
									$sheet .= '<div class = "processTime"><span style ="font-weight:bold;">' . $po_processTime . '</span> days processing time</div>';
							}
							$sheet .= '<div class = "statusOffice">' . $po_statusOffice. '</div>';
							
							$sheet .= '<div class = "modified"><span>Updated : </span>' . $po_modified . '</div>';
							$sheet .= '<div class = "fromUpdated"><span>' . $po_fromUpdated . '</span><span>' .$this->daysAgoLabel($po_fromUpdated) .  '</span> </div>';
							$sheet .= '<div class = "' . $showyPO. '" >';
							$sheet .= '<div class ="remarksLabel">Pending Notes</div>';
							$sheet .= '<div class ="remarks">' . $po_remarks . '</div>';
							$sheet .= '</div>';
							$sheet .= '</div>';
							$sheet .= '</td>';
							if($colspanPOa < $poCol){
								$sheet .= '<td class = "prTD" colspan ="' . $colspanPOb . '"></td>';
							}
							$sheet .= '<td ><div class = "tdBorder"></div></td>';
							$sheet .= '<td class = "totalDaysTD" style ="background-color:rgba(16, 34, 76,.5);" ></td>';
						
						}else{
							$sheet .= '<td class = "poTD" colspan ="' . $colspanPOa . '" >';
							$sheet .= '</td>';
							if($colspanPOa < $poCol){
								$sheet .= '<td colspan ="' . $colspanPOb . '"></td>';
							}
							$sheet .= '<td><div class = "tdBorder" ></div></td>';
							$sheet .= '<td class = "totalDaysTD"  style ="background-color:rgba(16, 34, 76,.5)" ></td>';
						}
					}else{
						$sheet .= '<td class = "prTD" colspan ="' . $colspanPOa . '" >';
						$sheet .= '</td>';
						if($colspanPOa < $poCol){
							$sheet .= '<td colspan ="' . $colspanPOb . '">-</td>';
						}
						$sheet .= '<td><div class = "tdBorder"></div></td>';
						$sheet .= '<td class = "totalDaysTD" style ="background-color:rgba(16, 34, 76,.5)"></td>';
					}	
				}
				
				//px---------------------------------------------------------------------------------------------------------
				if($px_tracking)																																																																																												{
					if(isset($arrayStatusIdPX[$px_status])){
						/*$px_processNo = $arrayPXstatusProcessId[$px_status];
						$px_processPercentage = number_format($px_processNo / $px_maxProcess,2) *100; */
						$colspanPXa = $arrayStatusIdPX[$px_status] ;
						$colspanPXb = $pxCol -  $colspanPXa ;
						if(isset($arrayStatusIdPX[$px_status])){
							$px_processNo = $arrayPXstatusProcessId[$px_status];
							$px_processPercentage = number_format($px_processNo / $px_maxProcess,2) *100; 
							$colspanPXa = $arrayStatusIdPX[$px_status] ;
							$colspanPXb = $pxCol -  $colspanPXa ;
							if(preg_match("/Pending/",trim($px_status))){
								$bulletClassPX = "bulletPX bulletPOPending";
								$showy ='remarksContainer';
							}else if(preg_match("/Check Released/",trim($px_status))){
								$bulletClassPX = "bulletPX bulletPXfinished";
							}else{
								$bulletClassPX = "bulletPX";
							}
							$sheet .= '<td class = "pxTD" colspan ="' . $colspanPXa . '" style = "padding-top:40px;padding-right:20px;" >';
							$sheet .= '<div class ="barPXdiv" ></div>';
							$sheet .= '<div class = "' . $bulletClassPX . '"></div>';
							$sheet .= '<div class ="detailsContainer" >';
							$sheet .= '<div id ="containerProcess" style ="padding-top:5px;">';
							
							$sheet .= '<table style ="float:right;margin-right:-84px;border-spacing:0;margin-top:-52px;" border ="0">';	
										if($px_status == "Check Released"){
											$sheet .= '<tr >
														<td style ="">
															<span style ="font-family:arial;font-size:12px;color:grey;">' . $px_processNo . '/' . $px_maxProcess . '</span>
															<span style ="color:orange;font-size:30px;font-weight:bold;text-shadow:0px 0px 2px white;">' . $px_processPercentage . '<span style ="font-weight:normal;font-size:20px;padding-left:2px;">%</span></span>
														</td>
													</tr>';
											$sheet .= '<tr >
														<td style ="text-align:right;padding-right:18px;">
															<span style ="font-weight:bold;font-size:20px;color:orange;">' . $px_fromCreated . '</span><br>
															<span class = "processStatus"  >days<br>completed</span>
														</td>
													</tr>';
										}else{
											$sheet .= '<tr >
														<td style ="">
															<span style ="font-family:arial;font-size:12px;color:grey;">' . $px_processNo . '/' . $px_maxProcess . '</span>
															<span style ="font-size:30px;font-weight:bold;">' . $px_processPercentage . '<span style ="font-weight:normal;font-size:20px;padding-left:2px;">%</span></span>
														</td>
													</tr>';
											$sheet .= '<tr >
														<td style ="text-align:right;padding-right:18px;">
															
															<span style ="font-size:20px;">' . $px_fromCreated . '</span><br>
															<span class = "processStatus" s>days<br>ongoing</span>
														</td>
													</tr>';
										}							
						$sheet .='</table>';
							$sheet .= '</div>';
							$sheet .= "<div class = 'trackingNumbers' onclick ='showTracking(\"" . $px_tracking  . "*PX" ."\")' >" . $px_tracking . "</div>";
							$sheet .= '<div class = "amounts">' . number_format($px_amount,2) . '</div>';
							$sheet .= '<div class = "encoded"><span>Created : </span>' . $px_encoded . '</div>';
							$sheet .= '<div class = "statuses" style ="">' . $px_status. '</div>';
							if($px_processTime > 0){	
									$sheet .= '<div class = "processTime"><span style ="font-weight:bold;">' . $px_processTime . '</span> days processing time</div>';
							}
							$sheet .= '<div class = "statusOffice">' . $px_statusOffice. '</div>';
							$sheet .= '<div class = "modified"><span>Updated : </span>' . $px_modified . '</div>';
							$sheet .= '<div class = "fromUpdated"><span>' . $px_fromUpdated . '</span><span>' .$this->daysAgoLabel($px_fromUpdated) .  '</span> </div>';
							$sheet .= '<div class = "' . $showy. '" >';
							$sheet .= '<div class ="remarksLabel">Pending Notes</div>';
							$sheet .= '<div class ="remarks">' . $px_remarks . '</div>';
							$sheet .= '</div>';
							$sheet .= '</div>';
							$sheet .= '</td>';
							if($colspanPXa < $pxCol){
								$sheet .= '<td class = "prTD" colspan ="' . $colspanPXb . '"></td>';
							}
							//$sheet .= '<td ><div class = "tdBorder"></div></td>';
							$sheet .= '<td class = "" style ="background-color:' . $trColorTotal . ';" >';
							$sheet .= $totalDaysSheet;
							$sheet .= $totalDaysLabel;
							$sheet .= '</td>';
							
						}else{
							$sheet .= '<td class = "poTD" colspan ="' . $colspanPXa . '" >';
							$sheet .= '</td>';
							if($colspanPXa < $pxCol){
								$sheet .= '<td colspan ="' . $colspanPOb . '" ></td>';
							}
							$sheet .= '<td ><div class = "tdBorder" ></div></td>';
							$sheet .= '<td class = "totalDaysTD"  style ="background-color:rgba(16, 34, 76,.5)" ></td>';
							
						}
					}
				}
				if(!$po_tracking)												{
						$sheet .= '<td class = "poTD"  colspan  ="' . ($poCol) . '"></td> ';
						$sheet .= '<td ><div  class = "tdBorder"></div></td><td class = "totalDaysTD" style ="background-color:rgba(16, 34, 76,.5);">12333</td>';
						$sheet .= '<td class = "pxTD"  colspan  ="' . ($pxCol) . '"></td>';
						$sheet .= '<td class = "" style ="background-color:' . $trColorTotal . ';" >';
						$sheet .= $totalDaysSheet;
						$sheet .= $totalDaysLabel;
						$sheet .= '</td>';
								//<td  style ="background-color:' . $trColorTotal . '"><div class = "tdBorder" ></div></td>
								
						$sheet .= '		 <td class = "totalDaysTD"  style ="background-color:rgba(16, 34, 76,.5)">123</td>';
						
				}else{
					if(!$px_tracking)										{
						$sheet .= '';
						$sheet .= '<td class = "pxTD" colspan  ="' . ($pxCol) . '"></td>';
						//$sheet .= '<td style ="background-colorL:' . $trColorTotal . '"><div  class = "tdBorder"></div></td>';
						$sheet .= '<td class = "" style ="background-color:' . $trColorTotal . ';" >';
						$sheet .= $totalDaysSheet;
						$sheet .= $totalDaysLabel;
						$sheet .= '</td>';
						$sheet .= ' <td class = "totalDaysTD" style ="background-color:rgba(16, 34, 76,.5);"></td>';
						
					}
					
				}
					
				$oldPR = $pr_tn;
				$oldPO = $po_tracking;
				$sheet .= '</tr>';	
			}
			$sheet .= '</table>';	
			return $sheet;
			return array('data' => $data_array, 'text' => $text_result);
			
		}
			
		function createCalendarOffice($year,$month,$regulatoryOffice,$userOffice){
			
			$sql ="SELECT Office,Color FROM status where Office != '' and Type in ('PR','PO','PX') and Office != 'Implementing Agency' group by office ";
			$record = $this->query($sql);
			
			$regColor = [];
			$rTable ='<table id  ="regulatoryTable" style ="margin-bottom:-1px;font-size:12px;font-family:arial;width:95%;color:silver;border:0;padding:0;border-spacing:0;" border ="0"><tr >';
			while($data = $this->fetch_array($record)){
			 	$office = $data['Office'];
			 	$color = $data['Color'];
			 	$regColor[$office] = $color;
			 	if($office == $regulatoryOffice){
					$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatoryOffice(this)">' . $office . '</th>';
				}else{
					$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatoryOffice(this)">' . $office . '</th>';
				}
			}
			if($regulatoryOffice == "-"){
				$rTable  .='<th class ="regulatoryMenuSelected" onclick ="clickRegulatoryOffice(this)">ALL</th>';
			}else{
				$rTable  .='<th class ="regulatoryMenu" onclick ="clickRegulatoryOffice(this)">ALL</th>';
			}
			
			$rTable .='</tr></table>';  
			
			if($regulatoryOffice == '-'){
				$case = ' c.RegulatoryOffice != "" ';
			}else{
				$case = ' c.RegulatoryOffice = "' . $regulatoryOffice . '"';
			}
		
			$month = $two_digit_number = sprintf('%02d', $month);
			$monthNameDisplay = $month_name = date("F", mktime(0, 0, 0, $month, 1));
			
			$searchDate = $year . '-' . $month; 
			
			$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
			$sheetDayName = '';
			$sheetDayNum = '';
			$weekEnd = [];
			for ($day = 1; $day <= $days_in_month; $day++) {
			    $timestamp = mktime(0, 0, 0, $month, $day, $year);
			    $dayName = date('D', $timestamp);
			    $dayNumber = date('j', $timestamp);
				
				$class = "headerWeekdays";
				$class1 = "headerWeekdays1";
			    if($dayName == "Sat" || $dayName == "Sun"){
					$class = "headerWeekend";
					$class1 = "headerWeekend1";
				}
			    $sheetDayName .= '<th class ="' . $class1 . '">' . $dayName . '</th>';
			    $sheetDayNum .=  '<td class ="' . $class . '">' . $dayNumber . '</td>';
			}
			
			$sheetMonth = '<th colspan ="100%"><table style ="width:97%;"><tr>';
			for($i = 1; $i <= 12; $i++){
				 $timestamp = mktime(0, 0, 0, $i, 1);
				 $monthName = date('M', $timestamp);
				 $iMonth = $two_digit_number = sprintf('%02d', $i);
				 $class ="headerMonth";
				 if($iMonth == $month){
				 	 $class ="headerMonthSelected";
				 }
				 $sheetMonth .=  "<th class ='" . $class . "' style ='' onclick ='selectmonthOffice(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
			}
			$sheetMonth .= '</tr></table></th>';
			$sheet = '<table id  ="tableCalendar" style ="margin:0 auto;" border ="0">';
			
			
			$sheet .= '<tr><th rowspan ="3" colspan ="3" style ="font-size:42px; font-weight: normal;font-family:anton;border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '
						</th> ' . $sheetMonth . '</tr>';
			$sheet .= '<tr><th colspan ="100%" style ="border-right:1px solid rgb(234, 233, 195);padding:0;background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . $rTable . '</th></tr>';		
			$sheet .= '<tr></td>' . $sheetDayName . '<td rowspan ="2" colspan ="3" style ="padding:0px 10px;background-color:rgb(38, 39, 38);" class ="rowTotal"></td></tr>';
			$sheet .= '<tr><td colspan ="2" style ="color:white;text-align:left;padding-left:27px;background-color:rgb(86, 184, 219);">Office / Document</td>
						   <td style ="color:white;background-color:rgb(86, 184, 219);text-align:left;padding-left:5px;">Status</td>' . $sheetDayNum . '</tr>';
		
	
			$sql = "select a.*,count(1) as Count,b.Name as Office, c.RegulatoryOffice from( SELECT Office, 
					Case when TrackingType = 'PR' Then 'Purchase Request' when TrackingType = 'PO' Then 'Payment' else DocumentType end as Document, Status,substr(DateModified,9,2) as Day 
					FROM vouchercurrent where substr(DateModified,1,7) = '" .  $searchDate . "' and Office = '".$userOffice."' group by TrackingNumber) a 
					left join office b on a.Office = b.Code 
					left join (Select Office as RegulatoryOffice,Status from status group by Status ) c
					on a.Status = c.Status
					where " . $case . "
					group by a.Office,a.Status,Document,Day order by b.Name, Document,a.Status,Day asc";

			$sheetData = '';
			$record = $this->query($sql);
			$lastDocument = '';
			$lastOffice = '';
			$lastStatus = '';
			$lastDay = 0;
			$first  = 0;
			$rowTotal =0;
			$dayCount = 0;
			$i =1;
			while($data = $this->fetch_array($record)){
				$office = $data['Office'];
				
				$status = $data['Status'];
				$fontColor = "";
				if(preg_match("/Pending at/",trim($status))){
					$fontColor = "color:rgb(221, 39, 72);";
				}

				if(preg_match("/Pending Released/",trim($status))){
					$fontColor = "color:rgb(221, 39, 72);";
				}

				if(trim($status) == 'For P.O' || trim($status) == 'Waiting for Delivery' || trim($status) == 'Check Released'){
					// $fontColor = "color:rgb(13, 127, 214);";
					$fontColor = "color:rgb(86, 184, 219);";
				}

				
				
				
				$document =  ucwords(strtolower($data['Document']));
				$count = $data['Count'];
				$day = $data['Day'];
				$dateTd = $searchDate . '-' . $day;
				$par  = $status .'*' . $document . '*' . $dateTd;
				if($lastOffice != $office  || $lastDocument != $document  || $lastStatus != $status ){
					
					if($first == 0){
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}else{
						if($lastOffice != $office){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
						}else{
							if($lastDocument != $document ){
								$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
							    $arr = explode("**",$arr);
							    $dayCount = $arr[1];
								$sheetData .= $arr[0];
								$dayCount = -1;
							}else{
								if($lastStatus != $status ){
									$arr = $this->loopTD($days_in_month - $lastDay+1,$dayCount,$searchDate);
								    $arr = explode("**",$arr);
								    $dayCount = $arr[1];
									$sheetData .= $arr[0];
									$dayCount = -1;
								}
							}	
						}
						$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
						$rowTotal = 0;
						$sheetData .= '</tr>';
						$dayCount++;
	
						$sheetData .= '<tr class ="trCalendar" onclick ="clickCalendarTR(this)">';
					}
	
					$sheetData .= '<td colspan ="2" class ="calendarDocument" >' . $document. '</td>';
					$sheetData .= '<td  class ="calendarStatus" style ="border-right:1px solid rgba(101, 114, 97,.1);' . $fontColor . '">' . $status . '</td>';
					
					$arr = $this->loopTD($day,$dayCount,$searchDate);
				    $arr = explode("**",$arr);
				    $dayCount = $arr[1];
					$sheetData .= $arr[0];

					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarOffice(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarOffice(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}else{
					
					$arr = $this->loopTD($day - $lastDay,$dayCount,$searchDate);
					$arr = explode("**",$arr);
					$sheetData .= $arr[0];
					$dayCount = $arr[1];
					if($this->is_weekend($searchDate . '-' . $day)){
						$sheetData .= "<td class ='weekend' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarOffice(\"" . $par. "\")'>" .  $count  . "</td>";
					}else{
						$sheetData .= "<td class ='weekdays' style ='" . $fontColor . "'  onclick = 'fetchByDayCalendarOffice(\"" . $par. "\")'>" .  $count  . "</td>";
					}
					
				}
				
				$rowTotal += $count;
				$lastOffice = $office;
				$lastStatus = $status;
				$lastDocument = $document;
				$lastDay = $day;
				$first = 1;	
			}
			if($rowTotal > 0){
				$arr = $this->loopTD($days_in_month - $day +1,$dayCount,$searchDate);
				$arr = explode("**",$arr);
				$sheetData .= $arr[0];
				$sheetData .= '<td class ="rowTotal">' . $rowTotal . '</td>';
			}
			$sheetData .= '</tr>';
			$sheetData .= '<tr><th id = "calendarContainerUsers1" colspan ="100%" style ="padding:10px;background-color:white;background: linear-gradient(to top,white,rgb(224, 228, 229));"></th></tr>';
			$sheet .= $sheetData;
			$sheet .= '</table>';
			echo $sheet;
			
		}


		function createSimpleCalendar($year, $month, $regulatoryOffice, $userOffice) {
			// Retrieve the status colors for the offices
			$sql = "SELECT Office, Color FROM status WHERE Office != '' AND Type IN ('PR', 'PO', 'PX') AND Office != 'Implementing Agency' GROUP BY Office";
			$record = $this->query($sql);
		
			$regColor = [];
			$rTable = '<table id="regulatoryTable" style="margin-bottom:-1px;font-size:12px;font-family:arial;width:95%;color:silver;border:0;padding:0;border-spacing:0;" border="0"><tr>';
			while ($data = $this->fetch_array($record)) {
				$office = $data['Office'];
				$color = $data['Color'];
				$regColor[$office] = $color;
				// if ($office == $regulatoryOffice) {
				// 	$rTable .= '<th class="regulatoryMenuSelected" onclick="clickRegulatoryOfficeJay(this)">' . $office . '</th>';
				// } else {
				// 	$rTable .= '<th class="regulatoryMenu" onclick="clickRegulatoryOfficeJay(this)">' . $office . '</th>';
				// }
				if ($office == $regulatoryOffice || ($regulatoryOffice == "CBO Received" && $office == "City Budget Office")) {
					$rTable .= '<th class="regulatoryMenuSelected" onclick="clickRegulatoryOfficeJay(this)">' . $office . '</th>';
				} else {
					$rTable .= '<th class="regulatoryMenu" onclick="clickRegulatoryOfficeJay(this)">' . $office . '</th>';
				}
			}
			$rTable .= '<th class="regulatoryMenu" onclick="clickRegulatoryOfficeJay(this)">ALL</th>';
			$rTable .= '</tr></table>';
		
			// Define status conditions for each office
			$statusConditions = [
				'City Budget Office' => '"CBO Received"',
				'General Service Office' => '"GSO Received"',
				'City Treasurer\'s Office' => '"CTO Received"',
				'City Administrator\'s Office' => '"Admin Received"',
				'Bids and Awards Committee' => '"BAC Received"',
				'City Accountant\'s Office' => '"CAO Received"', 
			];
		
			// Determine if "ALL" is selected
			$allOffices = $regulatoryOffice == "-";
		
			$month = sprintf('%02d', $month);
			$monthNameDisplay = date("F", mktime(0, 0, 0, $month, 1));
		
			$searchDate = $year . '-' . $month;
		
			$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
			$sheetDayName = '';
			$sheetDayNum = '';
			$dayCells = array_fill(1, $days_in_month, '<td></td>'); // Initialize all days with empty cells
		
			for ($day = 1; $day <= $days_in_month; $day++) {
				$timestamp = mktime(0, 0, 0, $month, $day, $year);
				$dayName = date('D', $timestamp);
				$dayNumber = date('j', $timestamp);
		
				$class = "headerWeekdays";
				$class1 = "headerWeekdays1";
				if ($dayName == "Sat" || $dayName == "Sun") {
					$class = "headerWeekend";
					$class1 = "headerWeekend1";
				}
				$sheetDayName .= '<th class="' . $class1 . '">' . $dayName . '</th>';
				$sheetDayNum .= '<td class="' . $class . '">' . $dayNumber . '</td>';
			}
		
			$sheetMonth = '<th colspan="100%"><table style="width:97%;"><tr>';
			for ($i = 1; $i <= 12; $i++) {
				$timestamp = mktime(0, 0, 0, $i, 1);
				$monthName = date('M', $timestamp);
				$iMonth = sprintf('%02d', $i);
				$class = "headerMonth";
				if ($iMonth == $month) {
					$class = "headerMonthSelected";
				}
				$sheetMonth .= "<th class='" . $class . "' style='' onclick='selectmonthJay(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
			}
			$sheetMonth .= '</tr></table></th>';
			$sheet = '<table id="tableCalendar" style="margin:0 auto;" border="0">';
		
			$sheet .= '<tr><th rowspan="3" colspan="3" style="font-size:42px; font-weight: normal;font-family:anton;border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '</th> ' . $sheetMonth . '</tr>';
			$sheet .= '<tr><th colspan="100%" style="border-right:1px solid rgb(234, 233, 195);padding:0;background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . $rTable . '</th></tr>';
			$sheet .= '<tr>' . $sheetDayName . '<td rowspan="2" colspan="3" style="padding:0px 10px;background-color:rgb(38, 39, 38);" class="rowTotal"></td></tr>';
			$sheet .= '<tr><td colspan="3" style="color:white;text-align:left;padding-left:27px;"></td>' . $sheetDayNum . '</tr>';
		
			// Process data for each office
			$officesToProcess = $allOffices ? array_keys($statusConditions) : [$regulatoryOffice];
				// Initialize total variables
				$totalPR = 0;
				$totalPO = 0;
				$totalNF = 0;
				$totalIP = 0;
				$totalPX = 0;
				$totalPY = 0;	
				$overallTotal = 0;
		
			foreach ($officesToProcess as $office) {
				$condition = $statusConditions[$office] ?? '"CBO Received"'; // Default condition if office not in statusConditions
				$encodedCondition = urlencode($condition);
				
				// PR Data
				$sqlPR = "
					SELECT 
						a.Trackingnumber AS TrackingNumber , trackingtype, status, SUBSTRING(b.DateModified, 1, 10) AS dates, 
						COUNT(1) AS Count 
					FROM 
						(SELECT Office, TrackingNumber, trackingtype, status, pr_number FROM citydoc2024.vouchercurrent 
						 WHERE TrackingType = 'PR' 
						 GROUP BY TrackingNumber) a
					LEFT JOIN (
						SELECT 
							TrackingNumber, 
							MIN(DateModified) AS DateModified 
						FROM 
							citydoc2024.voucherhistory 
						WHERE 
							Status IN ($condition)
						GROUP BY TrackingNumber
					) b 
					ON a.TrackingNumber = b.TrackingNumber 
					WHERE 
						a.PR_Number != '' 
						AND b.DateModified != '' 
						AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
					GROUP BY 
						dates
					ORDER BY 
						dates ASC;
				";
		
				$record = $this->query($sqlPR);
				$prRowTotal = 0;
				$dayClass1 = $this->is_weekend($day) ? 'weekend' : 'weekdays';
				$prDayCells = array_fill(1, $days_in_month, "<td class='$dayClass1'></td>"); // Reinitialize day cells

				$prDayCells = array();

				// Loop through each day of the month
				for ($day = 1; $day <= $days_in_month; $day++) {
					// Create a date string for the current month and day
					$date = sprintf("%04d-%02d-%02d", $year, $month, $day);
					
					// Determine if the day is a weekend or weekday
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					
					// Initialize the cell with the correct class
					$prDayCells[$day] = "<td class='$dayClass'></td>";
				}

				
				
		
				while ($data = $this->fetch_array($record)) {
					$date = $data['dates'];
					$trackingnumber = $data['TrackingNumber'];
					$trackingtype = $data['trackingtype'];
					$status = $data['status'];
					$count = $data['Count'];
					$day = (int)substr($date, -2); // Extract the day number
		
					$par = $trackingnumber . '*' . $date  . '*' . $trackingtype . '*' . $status;
					$fontColor = "";

					// Ensure the day cell is initialized
					if (!isset($prDayCells[$day])) {
						$prDayCells[$day] = '<td></td>'; // Initialize the day cell if not set
					}
		
					// Update the specific day cell
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					$prDayCells[$day] = "<td class='$dayClass' style='$fontColor' onclick='fetchByDayCalendarJay(\"" . $par . "\", \"$encodedCondition\")'>" . $count . "</td>";
		
					// Track total for PR
					$prRowTotal += $count;
				}
		
				// PO Data
				$sqlPO = "
					SELECT 
						a.Trackingnumber AS TrackingNumber, trackingtype, status, SUBSTRING(b.DateModified, 1, 10) AS dates, 
						COUNT(1) AS Count 
					FROM 
						(SELECT Office, TrackingNumber, trackingtype, status, po_number FROM citydoc2024.vouchercurrent 
						 WHERE TrackingType = 'PO' 
						 GROUP BY TrackingNumber) a
					LEFT JOIN (
						SELECT 
							TrackingNumber, 
							MIN(DateModified) AS DateModified 
						FROM 
							citydoc2024.voucherhistory 
						WHERE 
							Status IN ($condition)
						GROUP BY TrackingNumber
					) b 
					ON a.TrackingNumber = b.TrackingNumber 
					WHERE 
						a.PO_Number != '' 
						AND b.DateModified != '' 
						AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
					GROUP BY 
						dates
					ORDER BY 
						dates ASC;
				";
		
				$record = $this->query($sqlPO);
				$poRowTotal = 0;
				$poDayCells = array_fill(1, $days_in_month, "<td class='$dayClass1'></td>"); // Reinitialize day cells

				$poDayCells = array();

				// Loop through each day of the month
				for ($day = 1; $day <= $days_in_month; $day++) {
					// Create a date string for the current month and day
					$date = sprintf("%04d-%02d-%02d", $year, $month, $day);
					
					// Determine if the day is a weekend or weekday
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					
					// Initialize the cell with the correct class
					$poDayCells[$day] = "<td class='$dayClass'></td>";
				}

		
				while ($data = $this->fetch_array($record)) {
					$date = $data['dates'];
					$trackingnumber = $data['TrackingNumber'];
					$trackingtype = $data['trackingtype'];
					$status = $data['status'];
					$count = $data['Count'];
					$day = (int)substr($date, -2); // Extract the day number
		
					$par = $trackingnumber . '*' . $date . '*' . $trackingtype . '*' . $status ;
					$fontColor = "";

		
					// Ensure the day cell is initialized
					if (!isset($poDayCells[$day])) {
						$poDayCells[$day] = '<td></td>'; // Initialize the day cell if not set
					}
		
					// Update the specific day cell
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					$poDayCells[$day] = "<td class='$dayClass' style='$fontColor' onclick='fetchByDayCalendarJay(\"" . $par . "\", \"$encodedCondition\")'>" . $count . "</td>";
		
					// Track total for PO
					$poRowTotal += $count;
				}


				// PX Data
				$sqlPX = "
					SELECT 
						a.Trackingnumber AS TrackingNumber , trackingtype, status, SUBSTRING(b.DateModified, 1, 10) AS dates, 
						COUNT(1) AS Count 
					FROM 
						(SELECT Office, TrackingNumber, trackingtype, status FROM citydoc2024.vouchercurrent 
						 WHERE TrackingType = 'PX' 
						 GROUP BY TrackingNumber) a
					LEFT JOIN (
						SELECT 
							TrackingNumber, 
							MIN(DateModified) AS DateModified 
						FROM 
							citydoc2024.voucherhistory 
						WHERE 
							Status IN ($condition)
						GROUP BY TrackingNumber
					) b 
					ON a.TrackingNumber = b.TrackingNumber 
					WHERE 
						b.DateModified != '' 
						AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
					GROUP BY 
						dates
					ORDER BY 
						dates ASC;
				";
		
				$record = $this->query($sqlPX);
				$pxRowTotal = 0;
				$dayClass1 = $this->is_weekend($day) ? 'weekend' : 'weekdays';
				$pxDayCells = array_fill(1, $days_in_month, "<td class='$dayClass1'></td>"); // Reinitialize day cells

				$pxDayCells = array();

				// Loop through each day of the month
				for ($day = 1; $day <= $days_in_month; $day++) {
					// Create a date string for the current month and day
					$date = sprintf("%04d-%02d-%02d", $year, $month, $day);
					
					// Determine if the day is a weekend or weekday
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					
					// Initialize the cell with the correct class
					$pxDayCells[$day] = "<td class='$dayClass'></td>";
				}

				while ($data = $this->fetch_array($record)) {
					$date = $data['dates'];
					$trackingnumber = $data['TrackingNumber'];
					$trackingtype = $data['trackingtype'];
					$status = $data['status'];
					$count = $data['Count'];
					$day = (int)substr($date, -2); // Extract the day number
		
					$par = $trackingnumber . '*' . $date . '*' . $trackingtype . '*' . $status ;
					$fontColor = "";

		
					// Ensure the day cell is initialized
					if (!isset($pxDayCells[$day])) {
						$pxDayCells[$day] = '<td></td>'; // Initialize the day cell if not set
					}
		
					// Update the specific day cell
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					$pxDayCells[$day] = "<td class='$dayClass' style='$fontColor' onclick='fetchByDayCalendarJay(\"" . $par . "\", \"$encodedCondition\")'>" . $count . "</td>";
		
					// Track total for PO
					$pxRowTotal += $count;
				}

				// NF Data
				$sqlNF = "
					SELECT 
						a.Trackingnumber AS TrackingNumber , trackingtype, status, SUBSTRING(b.DateModified, 1, 10) AS dates, 
						COUNT(1) AS Count 
					FROM 
						(SELECT Office, TrackingNumber, trackingtype, status FROM citydoc2024.vouchercurrent 
						 WHERE TrackingType = 'NF' 
						 GROUP BY TrackingNumber) a
					LEFT JOIN (
						SELECT 
							TrackingNumber, 
							MIN(DateModified) AS DateModified 
						FROM 
							citydoc2024.voucherhistory 
						WHERE 
							Status IN ($condition)
						GROUP BY TrackingNumber
					) b 
					ON a.TrackingNumber = b.TrackingNumber 
					WHERE 
						b.DateModified != '' 
						AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
					GROUP BY 
						dates
					ORDER BY 
						dates ASC;
				";

				$record = $this->query($sqlNF);
				$nfRowTotal = 0;
				$dayClass1 = $this->is_weekend($day) ? 'weekend' : 'weekdays';
				$nfDayCells = array_fill(1, $days_in_month, "<td class='$dayClass1'></td>"); // Reinitialize day cells

				$nfDayCells = array();

				// Loop through each day of the month
				for ($day = 1; $day <= $days_in_month; $day++) {
					// Create a date string for the current month and day
					$date = sprintf("%04d-%02d-%02d", $year, $month, $day);
					
					// Determine if the day is a weekend or weekday
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					
					// Initialize the cell with the correct class
					$nfDayCells[$day] = "<td class='$dayClass'></td>";
				}

				while ($data = $this->fetch_array($record)) {
					$date = $data['dates'];
					$trackingnumber = $data['TrackingNumber'];
					$trackingtype = $data['trackingtype'];
					$status = $data['status'];
					$count = $data['Count'];
					$day = (int)substr($date, -2); // Extract the day number
		
					$par = $trackingnumber . '*' . $date . '*' . $trackingtype . '*' . $status ;
					$fontColor = "";

		
					// Ensure the day cell is initialized
					if (!isset($nfDayCells[$day])) {
						$nfDayCells[$day] = '<td></td>'; // Initialize the day cell if not set
					}
		
					// Update the specific day cell
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					$nfDayCells[$day] = "<td class='$dayClass' style='$fontColor' onclick='fetchByDayCalendarJay(\"" . $par . "\", \"$encodedCondition\")'>" . $count . "</td>";
		
					// Track total for PO
					$nfRowTotal += $count;
				}

				// IP Data
				$sqlIP = "
					SELECT 
						a.Trackingnumber AS TrackingNumber , trackingtype, status, SUBSTRING(b.DateModified, 1, 10) AS dates, 
						COUNT(1) AS Count 
					FROM 
						(SELECT Office, TrackingNumber, trackingtype, status FROM citydoc2024.vouchercurrent 
						 WHERE TrackingType = 'IP' 
						 GROUP BY TrackingNumber) a
					LEFT JOIN (
						SELECT 
							TrackingNumber, 
							MIN(DateModified) AS DateModified 
						FROM 
							citydoc2024.voucherhistory 
						WHERE 
							Status IN ($condition)
						GROUP BY TrackingNumber
					) b 
					ON a.TrackingNumber = b.TrackingNumber 
					WHERE 
						b.DateModified != '' 
						AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
					GROUP BY 
						dates
					ORDER BY 
						dates ASC;
				";

				$record = $this->query($sqlIP);
				$ipRowTotal = 0;
				$dayClass1 = $this->is_weekend($day) ? 'weekend' : 'weekdays';
				$ipDayCells = array_fill(1, $days_in_month, "<td class='$dayClass1'></td>"); // Reinitialize day cells

				$ipDayCells = array();

				// Loop through each day of the month
				for ($day = 1; $day <= $days_in_month; $day++) {
					// Create a date string for the current month and day
					$date = sprintf("%04d-%02d-%02d", $year, $month, $day);
					
					// Determine if the day is a weekend or weekday
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					
					// Initialize the cell with the correct class
					$ipDayCells[$day] = "<td class='$dayClass'></td>";
				}

				while ($data = $this->fetch_array($record)) {
					$date = $data['dates'];
					$trackingnumber = $data['TrackingNumber'];
					$trackingtype = $data['trackingtype'];
					$status = $data['status'];
					$count = $data['Count'];
					$day = (int)substr($date, -2); // Extract the day number
		
					$par = $trackingnumber . '*' . $date . '*' . $trackingtype . '*' . $status ;
					$fontColor = "";

		
					// Ensure the day cell is initialized
					if (!isset($ipDayCells[$day])) {
						$ipDayCells[$day] = '<td></td>'; // Initialize the day cell if not set
					}
		
					// Update the specific day cell
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					$ipDayCells[$day] = "<td class='$dayClass' style='$fontColor' onclick='fetchByDayCalendarJay(\"" . $par . "\", \"$encodedCondition\")'>" . $count . "</td>";
		
					// Track total for PO
					$ipRowTotal += $count;
				}
				// PY Data
				$sqlPY = "
				SELECT 
					a.Trackingnumber AS TrackingNumber, 
					trackingtype, 
					status, 
					documenttype, 
					SUBSTRING(b.DateModified, 1, 10) AS dates, 
					COUNT(1) AS Count 
				FROM 
					(SELECT Office, TrackingNumber, trackingtype, status, documenttype FROM citydoc2024.vouchercurrent 
					WHERE TrackingType = 'PY' 
					GROUP BY TrackingNumber) a
				LEFT JOIN (
					SELECT 
						TrackingNumber, 
						MIN(DateModified) AS DateModified 
					FROM 
						citydoc2024.voucherhistory 
					WHERE 
						Status IN ($condition)
					GROUP BY TrackingNumber
				) b 
				ON a.TrackingNumber = b.TrackingNumber 
				WHERE 
					b.DateModified != '' 
					AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
				GROUP BY 
					documenttype, dates
				ORDER BY 
					dates ASC;
				";

				$record = $this->query($sqlPY);

				$pyRowTotals =  [];
				$dayClass1 = $this->is_weekend($day) ? 'weekend' : 'weekdays';
				$pyDayCells = array_fill(1, $days_in_month, "<td class='$dayClass1'></td>"); // Reinitialize day cells

				$pyDayCells = array();

				// Initialize day cells for each day of the month
				for ($day = 1; $day <= $days_in_month; $day++) {
					$date = sprintf("%04d-%02d-%02d", $year, $month, $day);
					$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
					$pyDayCells[$day] = []; // Initialize an empty array for each day
				}
				// Process the query results
				while ($data = $this->fetch_array($record)) {
					$date = $data['dates'];
					$trackingnumber = $data['TrackingNumber'];
					$trackingtype = $data['trackingtype'];
					$status = $data['status'];
					$documenttype = $data['documenttype'];
					$count = $data['Count'];
					$day = (int)substr($date, -2); // Extract the day number

					$par = $trackingnumber . '*' . $date . '*' . $trackingtype . '*' . $status . '*' . $documenttype;

					$fontColor = "";

					// Initialize the document type in the row totals if not set
					if (!isset($pyRowTotals[$documenttype])) {
						$pyRowTotals[$documenttype] = 0;
					}

					// Increment the total for the document type
					$pyRowTotals[$documenttype] += $count;

					// Ensure the day cell is initialized for this document type
					if (!isset($pyDayCells[$day][$documenttype])) {
						$dayClass = $this->is_weekend($date) ? 'weekend' : 'weekdays';
						$pyDayCells[$day][$documenttype] = "<td class='$dayClass'></td>"; // Initialize empty cell
					}

					// Update the specific day cell
					$pyDayCells[$day][$documenttype] = "<td class='$dayClass' style='$fontColor' onclick='fetchByDayCalendarJay(\"" . $par . "\", \"$encodedCondition\")'>" . $count . "</td>";
				}
				// Construct the sheet data for this office
				$sheetDataPR = '';
				$sheetDataPO = '';
				$sheetDataPX = '';
				$sheetDataNF = '';
				$sheetDataIP = '';
				$sheetDataPY = [];
				foreach ($pyRowTotals as $docType => $rowTotal) {
					$sheetDataPY[$docType] = '';
					for ($day = 1; $day <= $days_in_month; $day++) {
						$dayClass = $this->is_weekend(sprintf("%04d-%02d-%02d", $year, $month, $day)) ? 'weekend' : 'weekdays';
						$sheetDataPY[$docType] .= $pyDayCells[$day][$docType] ?? "<td class='$dayClass' style='$fontColor'></td>"; // Add empty cell if no data
					}
				}

				
				for ($day = 1; $day <= $days_in_month; $day++) {
					if (isset($prDayCells[$day])) {
						$sheetDataPR .= $prDayCells[$day];
					} else {
						$sheetDataPR .= "<td style='$fontColor'></td>"; // Add empty cell if no data
					}
		
					if (isset($poDayCells[$day])) {
						$sheetDataPO .= $poDayCells[$day];
					} else {
						$sheetDataPO .= "<td style='$fontColor'></td>"; // Add empty cell if no data
					}

					if (isset($pxDayCells[$day])) {
						$sheetDataPX .= $pxDayCells[$day];
					} else {
						$sheetDataPX .= "<td style='$fontColor'></td>"; // Add empty cell if no data
					}
					if (isset($nfDayCells[$day])) {
						$sheetDataNF .= $nfDayCells[$day];
					} else {
						$sheetDataNF .= "<td style='$fontColor'></td>"; // Add empty cell if no data
					}
					if (isset($ipDayCells[$day])) {
						$sheetDataIP .= $ipDayCells[$day];
					} else {
						$sheetDataIP .= "<td style='$fontColor'></td>"; // Add empty cell if no data
					}
				}
				
				$total = ''; 
				// Add the rows for this office
				$sheet .= '<tr class="trCalendar" onclick="clickCalendarTR(this)">';
				$sheet .= '<td colspan="3" class="calendarRegulatory">' . $office . '</td>';

				for ($day = 1; $day <= $days_in_month; $day++) {
					// Format the date string to check if it's a weekend
					$date = sprintf('%s-%02d-%02d', $year, $month, $day);
					
					// Check if it's a weekend
					$isWeekend = $this->is_weekend($date);
					
					// Assign the appropriate class
					$dayClass = $isWeekend ? 'weekend' : $dayClass1;
					
					// Add the table cell with the correct class
					$sheet .= "<td class='$dayClass'></td>";
				}

				$sheet .= '<td class="rowTotal">' . $total . '</td>';
				$sheet .= '</tr>';


				
			
				// PR Data Row
				if($prRowTotal != 0){
					$sheet .= '<tr class="trCalendar">';
					$sheet .= '<td colspan="3" style="text-align:left; padding-left:30px;">Purchase Request</td>';
					$sheet .= $sheetDataPR;
					$sheet .= '<td class="rowTotal">' . ($prRowTotal > 0 ? $prRowTotal : '') . '</td>';
					$sheet .= '</tr>';
					$totalPR += $prRowTotal;
				}
				
				// PO Data Row
				if($poRowTotal != 0){
					$sheet .= '<tr class="trCalendar" onclick="clickCalendarTR(this)">';
					$sheet .= '<td colspan="3" style="text-align:left; padding-left:30px;">Purchase Order</td>';
					$sheet .= $sheetDataPO;
					$sheet .= '<td class="rowTotal">' . ($poRowTotal > 0 ? $poRowTotal : '') . '</td>';
					$sheet .= '</tr>';
					$totalPO += $poRowTotal;
				}
				// NF Data Row
				if($nfRowTotal != 0){
					$sheet .= '<tr class="trCalendar" onclick="clickCalendarTR(this)">';
					$sheet .= '<td colspan="3" style="text-align:left; padding-left:30px;">Infrastracture Project</td>';
					$sheet .= $sheetDataNF;
					$sheet .= '<td class="rowTotal">' . ($nfRowTotal > 0 ? $nfRowTotal : '') . '</td>';
					$sheet .= '</tr>';
					$totalNF += $nfRowTotal;
				}
				// IP Data Row
				if ($ipRowTotal != 0) {
					$sheet .= '<tr class="trCalendar" onclick="clickCalendarTR(this)">';
					$sheet .= '<td colspan="3" style="text-align:left; padding-left:30px;">Infrastracture Payment</td>';
					$sheet .= $sheetDataIP;
					$sheet .= '<td class="rowTotal">' . ($ipRowTotal > 0 ? $ipRowTotal : '') . '</td>';
					$sheet .= '</tr>';
					$totalIP += $ipRowTotal;
				}

				// PX Data Row
				if($pxRowTotal != 0){
					$sheet .= '<tr class="trCalendar" onclick="clickCalendarTR(this)">';
					$sheet .= '<td colspan="3" style="text-align:left; padding-left:30px;">Payment</td>';
					$sheet .= $sheetDataPX;
					$sheet .= '<td class="rowTotal">' . ($pxRowTotal > 0 ? $pxRowTotal : '') . '</td>';
					$sheet .= '</tr>';
					$totalPX += $pxRowTotal;
				}
							
				// Adding PY Data Rows
				foreach ($sheetDataPY as $docType => $dayCells) {
					if($pyRowTotals[$docType] != 0){
						$sheet .= '<tr class="trCalendar" onclick="clickCalendarTR(this)">';
						$sheet .= "<td colspan='3' style='text-align:left; padding-left:30px;'>$docType</td>"; // Display document type as the row label
						$sheet .= $dayCells;
						$sheet .= '<td class="rowTotal">' . ($pyRowTotals[$docType] > 0 ? $pyRowTotals[$docType] : '') . '</td>';
						$sheet .= '</tr>';
						$totalPY += $pyRowTotals[$docType];
					}
				}

				
				$sheet .= '<tr class="trCalendar totalRow">';
				$sheet .= '<td colspan="3" style="text-align:right; padding-left:30px;"><strong>Total</strong></td>';
				for ($day = 1; $day <= $days_in_month; $day++) {
					$dayClass = $this->is_weekend(sprintf("%04d-%02d-%02d", $year, $month, $day)) ? 'weekend' : 'weekdays';
					$sheet .= "<td class='$dayClass'></td>"; // Empty cells for each day
				}
				$sheet .= '<td class="rowTotal"><strong>' . ($totalPR + $totalPO + $totalNF + $totalIP + $totalPX + $totalPY) . '</strong></td>';
				$sheet .= '</tr>';

				$overallTotal += $totalPR + $totalPO + $totalNF + $totalIP + $totalPX + $totalPY;
		
			}
			
			echo 'Overall Total: ' . $overallTotal;
			if ($regulatoryOffice == '-'){
				$sheet .= '<tr class="trCalendar totalRow">';
				$sheet .= '<td colspan="3" style="text-align:right; padding-left:30px;"><strong>Overall Total</strong></td>';
				for ($day = 1; $day <= $days_in_month; $day++) {
					$dayClass = $this->is_weekend(sprintf("%04d-%02d-%02d", $year, $month, $day)) ? 'weekend' : 'weekdays';
					$sheet .= "<td class='$dayClass'></td>"; // Empty cells for each day
				}
				
					$sheet .= '<td class="rowTotal"><strong>'. $overallTotal .'</strong></td>';
					$sheet .= '</tr>';
			}
			$sheet .= '<tr><th id = "calendarContainerUsers2" colspan ="100%" style ="padding:10px;background-color:white;background: linear-gradient(to top,white,rgb(224, 228, 229));"></th></tr>';
			$sheet .= '</table>';
			// echo $sqlNF;
			// echo $regulatoryOffice;
			echo $sheet;
		}
		
		
		
		
		
		
		
		
		

		// function createSimpleCalendar($year, $month) {
		// 	// Format month as two digits and get month name
		// 	$month = sprintf('%02d', $month);
		// 	$monthNameDisplay = date("F", mktime(0, 0, 0, $month, 1));
			
		// 	// Get number of days in the month
		// 	$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
		
		// 	// Generate day names and numbers
		// 	$sheetDayName = '';
		// 	$sheetDayNum = '';
		// 	for ($day = 1; $day <= $days_in_month; $day++) {
		// 		$timestamp = mktime(0, 0, 0, $month, $day, $year);
		// 		$dayName = date('D', $timestamp);
		// 		$dayNumber = date('j', $timestamp);
		
		// 		$class = ($dayName == "Sat" || $dayName == "Sun") ? "headerWeekend" : "headerWeekdays";
		// 		$class1 = ($dayName == "Sat" || $dayName == "Sun") ? "headerWeekend1" : "headerWeekdays1";
		// 		$sheetDayName .= '<th class="' . $class1 . '">' . $dayName . '</th>';
		// 		$sheetDayNum .= '<td class="' . $class . '">' . $dayNumber . '</td>';
		// 	}
		
		// 	// Generate month selector
		// 	$sheetMonth = '<th colspan="100%"><table style="width:97%;"><tr>';
		// 	for ($i = 1; $i <= 12; $i++) {
		// 		$timestamp = mktime(0, 0, 0, $i, 1);
		// 		$monthName = date('M', $timestamp);
		// 		$iMonth = sprintf('%02d', $i);
		// 		$class = ($iMonth == $month) ? "headerMonthSelected" : "headerMonth";
		// 		$sheetMonth .= "<th class='" . $class . "' onclick='selectMonth(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
		// 	}
		// 	$sheetMonth .= '</tr></table></th>';
		
		// 	// Construct the calendar structure
		// 	$sheet = '<table id="tableCalendar" style="margin:0 auto;" border="0">';
		// 	$sheet .= '<tr><th rowspan="3" colspan="3" style="font-size:42px; font-weight: normal; font-family:anton; border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '</th>' . $sheetMonth . '</tr>';
		// 	$sheet .= '<tr><th colspan="100%" style="border-right:1px solid rgb(234, 233, 195); padding:0; background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . '</th></tr>'; // Removed $rTable
		// 	$sheet .= '<tr>' . $sheetDayName . '<td rowspan="2" colspan="3" style="padding:0px 10px; background-color:rgb(38, 39, 38);" class="rowTotal"></td></tr>';
		// 	$sheet .= '<tr><td colspan="2" style="color:white; text-align:left; padding-left:27px; background-color:rgb(86, 184, 219);">Office / Document</td><td style="color:white; background-color:rgb(86, 184, 219); text-align:left; padding-left:5px;">Status</td>' . $sheetDayNum . '</tr>';
		// 	$sheet .= '</table>';
		
		// 	echo $sheet;
		// }

		// function createSimpleCalendar($year, $month) {
		// 	// Format month as two digits and get month name
		// 	$month = sprintf('%02d', $month);
		// 	$monthNameDisplay = date("F", mktime(0, 0, 0, $month, 1));
		
		// 	// Get number of days in the month
		// 	$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
		
		// 	// Generate day names and numbers
		// 	$sheetDayName = '';
		// 	$sheetDayNum = '';
		// 	for ($day = 1; $day <= $days_in_month; $day++) {
		// 		$timestamp = mktime(0, 0, 0, $month, $day, $year);
		// 		$dayName = date('D', $timestamp);
		// 		$dayNumber = date('j', $timestamp);
		
		// 		$class = ($dayName == "Sat" || $dayName == "Sun") ? "headerWeekend" : "headerWeekdays";
		// 		$class1 = ($dayName == "Sat" || $dayName == "Sun") ? "headerWeekend1" : "headerWeekdays1";
		// 		$sheetDayName .= '<th class="' . $class1 . '">' . $dayName . '</th>';
		// 		$sheetDayNum .= '<td class="' . $class . '">' . $dayNumber . '</td>';
		// 	}
		
		// 	// Generate month selector
		// 	$sheetMonth = '<th colspan="100%"><table style="width:97%;"><tr>';
		// 	for ($i = 1; $i <= 12; $i++) {
		// 		$timestamp = mktime(0, 0, 0, $i, 1);
		// 		$monthName = date('M', $timestamp);
		// 		$iMonth = sprintf('%02d', $i);
		// 		$class = ($iMonth == $month) ? "headerMonthSelected" : "headerMonth";
		// 		$sheetMonth .= "<th class='" . $class . "' style='' onclick='selectmonthJay(\"" . $i . "\")'>" . strtoupper($monthName) . '</th>';
		// 	}
		// 	$sheetMonth .= '</tr></table></th>';
		
		// 	// SQL Query to get data
		// 	$sql = "
		// 		SELECT office, a.Trackingnumber, PR_Number, SUBSTRING(b.DateModified, 1, 10) AS dates, COUNT(1) AS Count 
		// 		FROM (SELECT * FROM citydoc2024.vouchercurrent WHERE trackingtype = 'PR' GROUP BY trackingnumber) a
		// 		LEFT JOIN (
		// 			SELECT TrackingNumber, MIN(DateModified) AS DateModified 
		// 			FROM citydoc2024.voucherhistory 
		// 			WHERE status LIKE '%GSO Received%' 
		// 			GROUP BY TrackingNumber
		// 		) b ON a.TrackingNumber = b.TrackingNumber 
		// 		WHERE PR_Number != '' 
		// 		  AND b.DateModified != '' 
		// 		  AND SUBSTRING(b.DateModified, 1, 10) LIKE '%$year-$month%'
		// 		GROUP BY dates;
		// 	";
		
		// 	// Execute SQL query
		// 	$result = $this->query($sql); // Adjust based on your database handling method
		
		// 	// Initialize data array
		// 	$calendarData = [];
		// 	while ($row = $this->fetch_array($result)) {
		// 		$calendarData[$row['dates']] = [
		// 			'office' => $row['office'],
		// 			'count' => $row['Count']
		// 		];
		// 	}
		
		// 	// Construct the calendar structure
		// 	$sheet = '<table id="tableCalendar" style="width: 100%; margin: 20px auto; border-collapse: collapse; font-family: Arial, sans-serif;">';
		// 	$sheet .= '<tr><th rowspan="3" colspan="3" style="font-size:42px; font-weight: normal; font-family: Anton, sans-serif; border-bottom:1px solid rgb(234, 233, 195); text-align: center; background-color: #f7f7f7; padding: 20px;">' . $monthNameDisplay . '</th>' . $sheetMonth . '</tr>';
		// 	$sheet .= '<tr><th colspan="100%" style="border-right:1px solid rgb(234, 233, 195); padding:0; background: linear-gradient(to bottom, rgba(42, 56, 2, 1), rgba(5, 34, 57, .99)); height: 20px;"></th></tr>';
		// 	$sheet .= '<tr>' . $sheetDayName . '<td rowspan="2" colspan="3" style="padding:0px 10px; background-color:rgb(38, 39, 38);" class="rowTotal"></td></tr>';
		// 	$sheet .= '<tr><td colspan="2" style="color:white; text-align:left; padding-left:27px; background-color:rgb(86, 184, 219); padding: 10px;">Office / Document</td><td style="color:white; background-color:rgb(86, 184, 219); text-align:left; padding-left:5px; padding: 10px;">Status</td></tr>';
		
		// 	// Add data to the calendar
		// 	for ($day = 1; $day <= $days_in_month; $day++) {
		// 		$currentDate = sprintf('%04d-%02d-%02d', $year, $month, $day);
		// 		$sheet .= '<tr style="background-color:' . ($day % 2 == 0 ? '#f9f9f9' : '#fff') . '; border-bottom: 1px solid #ddd;">';
		// 		$sheet .= '<td style="padding: 10px; border-right: 1px solid #ddd; text-align: center;">' . $day;
		// 		if (isset($calendarData[$currentDate]['count'])) {
		// 			$sheet .= '<div style="background-color: lightgrey; border-radius: 50%; padding: 5px; display: inline-block; margin-left: 5px;">' . $calendarData[$currentDate]['count'] . '</div>';
		// 		}
		// 		$sheet .= '</td>';
		// 		$sheet .= '<td style="padding: 10px; border-right: 1px solid #ddd;">' . (isset($calendarData[$currentDate]['office']) ? $calendarData[$currentDate]['office'] : '') . '</td>';
		// 		$sheet .= '<td style="padding: 10px;">' . (isset($calendarData[$currentDate]['trackingnumber']) ? $calendarData[$currentDate]['trackingnumber'] : '') . '</td>';
		// 		$sheet .= '<td style="padding: 10px;">' . (isset($calendarData[$currentDate]['pr_number']) ? $calendarData[$currentDate]['pr_number'] : '') . '</td>';
		// 		$sheet .= '</tr>';
		// 	}
		
		// 	$sheet .= '</table>';
		
		// 	echo $sheet;
		// }
		
		
		
		
		
		
		
		
		

		// function createTrackingDataCalendar($yearMonth) {
		// 	$month = sprintf('%02d', $month);
		// 	$monthNameDisplay = date("F", mktime(0, 0, 0, $month, 1));
			
		// 	// Get number of days in the month
		// 	$days_in_month = cal_days_in_month(CAL_GREGORIAN, $month, $year);
		
		// 	// Generate day names and numbers
		// 	$sheetDayName = '';
		// 	$sheetDayNum = '';
		// 	for ($day = 1; $day <= $days_in_month; $day++) {
		// 		$timestamp = mktime(0, 0, 0, $month, $day, $year);
		// 		$dayName = date('D', $timestamp);
		// 		$dayNumber = date('j', $timestamp);
		
		// 		$class = ($dayName == "Sat" || $dayName == "Sun") ? "headerWeekend" : "headerWeekdays";
		// 		$class1 = ($dayName == "Sat" || $dayName == "Sun") ? "headerWeekend1" : "headerWeekdays1";
		// 		$sheetDayName .= '<th class="' . $class1 . '">' . $dayName . '</th>';
		// 		$sheetDayNum .= '<td class="' . $class . '">' . $dayNumber . '</td>';
		// 	}
		
		// 	// Generate month selector
		// 	$sheetMonth = '<th colspan="100%"><table style="width:97%;"><tr>';
		// 	for ($i = 1; $i <= 12; $i++) {
		// 		$timestamp = mktime(0, 0, 0, $i, 1);
		// 		$monthName = date('M', $timestamp);
		// 		$iMonth = sprintf('%02d', $i);
		// 		$class = ($iMonth == $month) ? "headerMonthSelected" : "headerMonth";
		// 		$sheetMonth .= "<th class='" . $class . "' onclick='selectMonthJay(\"" . $i . "\")'>" . strtoupper($monthName) . "</th>";
		// 	}
		// 	$sheetMonth .= '</tr></table></th>';
		
		// 	// Construct the calendar structure
		// 	$sheet = '<table id="tableCalendar" style="margin:0 auto;" border="0">';
		// 	$sheet .= '<tr><th rowspan="3" colspan="3" style="font-size:42px; font-weight: normal; font-family:anton; border-bottom:1px solid rgb(234, 233, 195);">' . $monthNameDisplay . '</th>' . $sheetMonth . '</tr>';
		// 	$sheet .= '<tr><th colspan="100%" style="border-right:1px solid rgb(234, 233, 195); padding:0; background: linear-gradient(to bottom,rgba(42, 56, 2,1),rgba(5, 34, 57,.99));">' . '</th></tr>';
		// 	$sheet .= '<tr>' . $sheetDayName . '<td rowspan="2" colspan="3" style="padding:0px 10px; background-color:rgb(38, 39, 38);" class="rowTotal"></td></tr>';
		// 	$sheet .= '<tr><td colspan="2" style="color:white; text-align:left; padding-left:27px; background-color:rgb(86, 184, 219);">Office / Document</td><td style="color:white; background-color:rgb(86, 184, 219); text-align:left; padding-left:5px;">Status</td>' . $sheetDayNum . '</tr>';
		// 	$sheet .= '</table>';
		
		// 	// Output the calendar
		// 	echo $sheet;
		// }
		
		
		
		
	
		
		function createInfraProjects(){
			$sql = "select a.*,b.Name as OfficeName,c.Name as LumpName, d.Title,e.Description as SubDescription  from programcode a left join office b on a.office = b.code  
					left join (Select Name,Code as Code from programcode where Code is not null) as c on a.Lump = c.Code
					left join fundtitles d on a.ExpenseCode = d.Code
					left join subprogramcode e on a.SubCode = e.SubCode
					where Category  = 'Infrastructure Project' 
					order by id desc";
			$record = $this->query($sql);
			
			$sheet = '<table border = "0" style = "border:1px solid silver;border-spacing:0px;padding:3px;" id  ="infraTableProjects">';
			$sheet .= '<tr style = "">
							<th></th>
							<th>Office</th>
							<th>Fund</th>
							<th>Type</th>
							<th style = "background-color:rgb(54, 66, 73);">Project</th>
							<th style ="text-align:right;padding-right:5px;">Amount</th>
							<th style = "background-color:rgb(54, 66, 73);text-align:center;">TN</th>
							<th colspan ="2">Sched</th>
					   </tr>';
			$i =1;		   
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$entry = $data['Entry'];
				$fund = $data['Fund'];
				
				$office = $data['Office'];
				$officeName =  $data['OfficeName'];
				$lump = $data['Lump'];
				
				$lumpName = $data['LumpName'];
				$seq = $data['Series'];
				
				$code =$data['Code'];
				if(strlen($code) > 0){
					$code = $data['Code'];
				}else{
					$code  = $seq;
				}
				$series = $data['Series'];
				$name = utf8_encode($data['Name']);
				$expense =  $data['ExpenseCode'];
				$tn =  $data['TrackingNumberInfra'];
				$title =  $data['Title'];
				$milestone =  $data['Milestone'];
				$fundYear =  $data['FundYear'];
				$subcode =  $data['SubDescription'];
				if($milestone ==  NULL){
					$milestone =1;
				}
				$amount = number_format($data['Amount'],2);
				
				$month = array('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');
				$monthvalue = $month[$milestone-1];
				$sheet .= '<tr>
							<td style = "font-weight:bold;">' . $i++ . '</td>
							<td id = "' . $office . '">' . $officeName . '</td>
							<td>' .  ' <b style = "font-weight:bold;color:rgb(17, 125, 164);">'  . $fundYear . '</b> ' . $entry .  '<div style = "white-space: nowrap;">' . $fund .  '</div><div>' . $lump . '</div><div>' . $lumpName . '</div><div>' . $subcode . '</div></td>
							
							
							<td><div style = "white-space: nowrap;font-weight:bold;color:rgb(17, 125, 164);">' .$title  . '</div>' . $expense . '</td>
							
							
							<td ><span style = "font-weight:bold;">' . $code . '</span><div>' . $name . '</div></td>
							
							<td style = "text-align:right;">' . $amount . '</td>
							
							<td>' . $tn . '</td>
							<td  id = "' . $milestone . '" style ="text-align:center;">' . $monthvalue . '</td>';
							
				if(strlen($tn) > 0){
					$sheet .= '<td></td>';
				}else{
					$sheet .= '
							   <td><div id ="' . $id . '" class ="buttonProjectEditor" style = "line-height:22px;" onclick ="removeThisProject(this)">✖</div></td>';
				}				
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet;
		}

		
		
		//-------------------------------FUND
		function CreateEncodedFundTable($record){
			$count = $this->num_rows($record);
			if($count > 0){
				$sheet = '<table id = "" style ="border-spacing:0;">';
				$sheet .= '<tr>';
				$sheet .= '	<td style="width:6%;text-align:center;" class ="tdHeader1" >#</td>';
				$sheet .= '	<td style="width:9%" class ="tdHeader1">Fund</td>';
				$sheet .= '	<td style="width:9%" class ="tdHeader1">Program</td>';
				$sheet .= '	<td style="width:9%"class ="tdHeader1">Code</td>';
				$sheet .= '	<td style="width:32%" class ="tdHeader1">Title</td>';
				$sheet .= '	<td style="width:15%;text-align:center" class ="tdHeader1">Amount</td>';
				$sheet .= '	<td style="width:5%;" class ="tdHeader1">&nbsp;</td>';
				$sheet .= '</tr>';
					
				$progTotal = 0;
				$total = 0;
				$program = "set";
				while($data = $this->fetch_array($record)){
					
					if($program == "set"){
						$program	 = $data['ProgramCode'];
					}else{
						if($program != $data['ProgramCode']){
							$sheet .= '<tr>';
							$sheet .= '<td colspan ="6" style = "text-align:right;font-weight:bold;padding-bottom:30px;padding-right:8px;color:rgb(9, 136, 215);border-bottom:1px solid rgb(231, 235, 237);">
										<span style = "text-align:right;padding-right:10px;padding-bottom:30px;color:rgb(245, 126, 54);font-weight:bold;">' . $program . '</span> ' . number_format($progTotal,2) . '</td>';
							$sheet .= '<td  style = " padding:2px 5px;border-bottom:1px solid rgb(231, 235, 237);">&nbsp;</td>';
							$sheet .= '</tr>';
							$program	 = $data['ProgramCode'];
							$progTotal = 0;
						}
					}
					$amount  = $data['Amount'];
					$total =$total +$amount;
					$progTotal = $progTotal + $amount;
					$sheet .= '<tr class = "tr1">';
					$sheet .= '<td style = "width:6%;text-align:center;" class = "tableDataRows">' . $count-- . '</td>';
					$sheet .= '<td style = "width:9%;text-align:center;" class = "tableDataRows">' . $data['Fund'] . '</td>';
					$sheet .= '<td style = "width:9%;text-align:left;padding-left:8px;" class = "tableDataRows">' . $program  . '</td>';
					$sheet .= '<td style = "width:9%;text-align:left;padding:0px 10px;" class = "tableDataRows">' . $data['Code'] . '</td>';
					$sheet .= '<td style = "width:32%;padding-left:10px;" class = "tableDataRows">' . $data['Title'] . '</td>';
					$sheet .= '<td style = "width:15%;text-align:right;padding-right:10px;" class = "tableDataRows" >' . number_format($amount,2) . '</td>';
					$sheet .= '<td style = "width:5%;" class = "tableDataRows"  ><div class = "button1"  style = "width:20px;height:20px;padding:0;font-size:14px;" onclick = "removeApp(this)">x</div></td></tr>';
				}
				$sheet .= '<tr>';
				$sheet .= '<td colspan ="6" style = "text-align:right;font-weight:bold;padding-bottom:10px;padding-right:8px;color:rgb(9, 136, 215);">
							<span style = "text-align:right;padding-right:10px;padding-bottom:30px;color:rgb(245, 126, 54);font-weight:bold;">' . $program . '</span> ' . number_format($progTotal,2) . '</td>';
				$sheet .= '<td  style = " padding:2px 5px;">&nbsp;</td>';
				$sheet .= '</tr>';
				
				$sheet .= '<tr>';
				$sheet .= '<td  colspan = "5"style = " padding:2px 5px;border-bottom:1px solid rgb(231, 235, 237);">&nbsp;</td>';
				$sheet .= '<td  style = "text-align:right;font-size:22px;font-weight:bold;border-top:4px double silver;border-bottom:1px solid rgb(231, 235, 237);padding-right:8px"><span style = "font-size:16px;color:grey;px;font-weight:normal;">Total&nbsp;</span>' . number_format($total,2) . '</td>';
				$sheet .= '<td  style = " padding:2px 5px;border-bottom:1px solid rgb(231, 235, 237);">&nbsp;</td>';
				$sheet .= '</tr>';
				
				$sheet .= '</table>';
				return $sheet;
			}else{
			/*	$sheet = '<table id = "tableDataRows" class = "tableDataRows">';
				$sheet .= '<tr>';
				$sheet .= '<td style = "width:7%;"></td>';
				$sheet .= '<td style = "width:15%;"></td>';
				$sheet .= '<td style = "width:10%;"></td>';
				$sheet .= '<td style = "width:28%;padding-right:8px;"></td>';
				$sheet .= '<td style = "width:40%;"></td>';
				$sheet .= '</tr>';
				$sheet .= '</table>';
				return $sheet;*/
				return '<div style = "padding: 25px;">No record found. </div>';
			}	
		}
		function CreateEncodedFundTableBudget($record){ //----------------------------------------------budget fund view
			$count = $this->num_rows($record);
			$program = '';
			if($count > 0){
				$sheet = '<table id = "tableOfFunds" style ="border-spacing:1;">';
				$sheet .= '<tr><td colspan ="7">';
				$sheet .= '				<div class = "menuContainer3" >';
				$sheet .= '				<div class = "menu3fund" onclick="getEncodedByFund2(this)">CO</div>';
				$sheet .= '				<div class = "menu3fund" onclick="getEncodedByFund2(this)">PS</div>';
				$sheet .= '				<div class = "menu3fund" onclick="getEncodedByFund2(this)">MOOE</div>';
				$sheet .= '				<div class = "menu3fund" onclick="getEncodedByFund2(this)">UNCHECK</div>';
				$sheet .= '				<div class = "menu3fund" onclick="getEncodedByFund2(this)">All</div>';
				$sheet .= '			</div>';
				$sheet .= '</td></tr>';		
				$sheet .= '<tr>';
				$sheet .= '	<td style="width:6%;text-align:center" class ="tdHeader1" >#</td>';
				$sheet .= '	<td style="width:9%" class ="tdHeader1">Fund</td>';
				$sheet .= '	<td style="width:9%"class ="tdHeader1">Code</td>';
				$sheet .= '	<td style="width:32%" class ="tdHeader1">Title</td>';
				$sheet .= '	<td style="width:15%;text-align:center" class ="tdHeader1">Amount</td>';
				$sheet .= '	<td style="width:22%;" class ="tdHeader1">Encoded</td>';
				$sheet .= '	<td style="" class ="tdHeader1">Approval</td>';
				$sheet .= '</tr>';	
				while($data = $this->fetch_array($record)){
					if($program != $data['ProgramCode']){
						$sheet .= '<tr style ="background-color:rgb(236, 243, 249);font-weight:bold;">';
						$sheet .= '<td style = "padding:8px 5px;" colspan = "8" class = "tableDataRows">' . $data['ProgramCode'] . ' - ' . $data['Name']. '</td>';
						$sheet .= '<tr>';
						$program = $data['ProgramCode'];
					}
					if($data['Approval'] != 1){
						$sheet .= '<tr style  ="background-color:rgb(242, 212, 214);" class = "tr1">';	
					}else{
						$sheet .= '<tr class = "tr1">';	
					}
					$sheet .= '<td style = "width:6%;text-align:center;" class = "tableDataRows">' . $count-- . '</td>';
					
					$sheet .= '<td style = "width:9%;text-align:center;" class = "tableDataRows">' . $data['Fund'] . '</td>';
					$sheet .= '<td style = "width:9%;text-align:center;" class = "tableDataRows">' . $data['Code'] . '</td>';
					$sheet .= '<td style = "width:32%;" class = "tableDataRows">' . $data['Title'] . '</td>';
					$sheet .= '<td style = "width:15%;text-align:right;padding-right:8px;" class = "tableDataRows" >' . number_format($data['Amount'],2) . '</td>';
					$sheet .= '<td style = "width:22%;color:grey1" class = "tableDataRows"  >' . $data['Encoded'] . '</td>';
					if($data['Approval'] == 1){
						$sheet .= '<td  style = "width:22%;padding-left:8px; text-align:center;" class = "tableDataRows"  ><input id = "idFund' . $data['Id'] . '" type ="checkbox" name = "fundCheck" checked ="1" onclick = "updateApproval(this)"/></td></tr>';
					}else{
						$sheet .= '<td  style = "width:22%;padding-left:8px;text-align:center;" class = "tableDataRows"  ><input id = "idFund' . $data['Id'] . '" type ="checkbox" name = "fundCheck" onclick = "updateApproval(this)" /></td></tr>';
					}
				}
				$sheet .= '</table>';
				return $sheet;
			}else{
				$sheet = '<table id = "tableDataRows" class = "tableDataRows">';
				$sheet .= '<tr>';
				$sheet .= '<td style = "width:7%;"></td>';
				$sheet .= '<td style = "width:15%;"></td>';
				$sheet .= '<td style = "width:10%;"></td>';
				$sheet .= '<td style = "width:28%;padding-right:8px;"></td>';
				$sheet .= '<td style = "width:40%;"></td>';
				$sheet .= '</tr>';
				$sheet .= '</table>';
				echo $sheet;
			}	
		}
		function CreateFundSummary($record){
				$header = '';
				$total = 0;
				$sheet = '<table id = "tableDataRows" class = "tableDataRows1">';
				
				while($data = $this->fetch_array($record)){
					if($header != $data['ProgramCode']){
						if($total == 0){
							$total = $data['Amount'];
						}else{
							$sheet .= '<tr style = ""><td colspan = "2"  style = "padding:9px 8px;text-align:right;"><span style ="padding:5px;">Total</span><font color ="red">' . number_format($total,2) . '</font></td></tr>';
						}
						
						$sheet .= '<tr style = ""><td colspan = "2"  style = "cursor:pointer; border-bottom:1px solid rgba(8, 149, 196,.3);" id = "' . $data['ProgramCode'] . '"  onclick = "getEncodedByProgramCode(this)">' . $data['ProgramCode'] . '</td></tr>';
						$sheet .= '<tr style = "">';
						$sheet .= '	<td style="width:10%;" colspan ="2" class = "">&nbsp;</td>';
						$sheet .= '</tr>';	
						$header = $data['ProgramCode'];
						$total = $data['Amount'];
					}else{
						$total = $total + $data['Amount'];
					}
					
					$sheet .= '<tr>';
					$sheet .= '<td style = "text-align:right;padding-right:8px;cursor:pointer" id ="' . $data['ProgramCode'] . '" onclick = "getEncodedByFund(this)">' . $data['FundType'] . '</td>';
					$sheet .= '<td style = "text-align:right;padding-right:8px;" >' . number_format($data['Amount'],2) . '</td>';
					$sheet .= '</tr>';
				}
				$sheet .= '<tr style = ""><td colspan = "2"  style = "padding:9px 8px;padding-right:8px;text-align:right;"><span style ="padding:5px;">Total</span><font color ="red">' . number_format($total,2) . '</font></td></tr>';
						
				$sheet .= '</table>';
				return $sheet;
		}
		function CreateOfficeSelect($record){
			$sheet = '<span class = "label3"><span class ="number">1</span>Select Office </span>';
			$sheet .= '<table  style ="margin:0 auto;">';
			$sheet .= '<tr >';
			$sheet .= '<td ><select id = "selectOfficeCodeFund" class = "select2" onchange = "SelectProgramCodeByOffice(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Name'] . ' - (' . $data['Code'] .')';
				$sheet .= '</option>';
			}
			$sheet .= '</select></td>';
			$sheet .= '</tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		
		function CreateProgramSelect($record){
			$sheet = '<span class = "label3"><span class ="number">2</span>Select Code/Program</span>';
			$sheet .= '<table  style ="margin:0 auto;">';
			$sheet .= '<tr >';
			$sheet .= '<td><select id = "selectProgramCode2" class = "select2" onchange = "SelectFundsByProgramCode(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Code'] . '&nbsp;' .  $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '<option value = "All">&nbsp;All</option>';
			$sheet .= '</select></td>';
			$sheet .= '</tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		function CreateProgramSelect1($record,$size){
			$sheet = '<select id = "programInChanges" style = "width:' . $size . 'px;"  class = "select2" onchange = "getAccountCodeByProgram(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Code'] . '&nbsp;' .  $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet; 
		}
		function CreateProgramSAAOB($record,$classVal,$func){
			$i = 1;
			$totalObligated = 0;
			$totalLiquidated =  0;
			$totalAB = 0;
			$totalUnliquidated =  0;
			$totalSavings = 0;

			$sheet = '<table id  = "markId" style = "border-spacing:1px;margin:10px 0px;" class = "' . $classVal . '" border="0">';
			while($data = $this->fetch_array($record)){
				if($i == 1){
					$sheet .= '<tr  class = "rowColor" onclick = "' . $func . '(this)">';
				}else{
					$sheet .= '<tr class = "rowColor" onclick = "' . $func . '(this)">';
				}
				
				$programCode = $data['ProgramCode'];
				$programName=  $data['Name'];
				$annualBudget = $data['AnnualBudget'];
				$obligated =  $data['Obligated'];
				$liquidated = 	$data['Liquidated'];
				$savings = 	$data['Savings'];
				$unliquidated = $data['Unliquidated'];
				
				$totalObligated = ($totalObligated + $obligated);
				$totalLiquidated = ($totalLiquidated + $liquidated);
				$totalAB =  ($totalAB + $annualBudget);
				$totalUnliquidated =  ($totalUnliquidated + $unliquidated);
				$totalSavings =  ($totalSavings + $savings);
				
				if($totalUnliquidated < 0){
					$color = "red";
				}else{
					$color = "black";
				}
				$sheet .= '<td style = "width:40px;color:gray;text-align:center;">&nbsp;' . $i . '&nbsp;</td>
							<td style = "border-left:1px solid rgb(236, 238, 235);font-weight:bold; width:20px;color:rgb(61, 201, 9);  text-align:left;padding:2px 3px;border-bottom:1px solid rgb(224, 225, 224);white-space: nowrap;">' .$programCode . '</td>
							<td style = "border-left:1px solid rgb(236, 238, 235);padding:2px;border-bottom:1px solid rgb(236, 238, 235);padding-left:10px;white-space:nowrap;font-size:14px;text-align:right;padding-right:5px;">' . $this->zeroToNothing(number_format($annualBudget,2)) . '</td>
							<td style = "border-left:1px solid rgb(236, 238, 235);padding:2px;border-bottom:1px solid rgb(236, 238, 235);padding-left:10px;white-space:nowrap;font-size:14px;text-align:right;padding-right:5px;">' . $this->zeroToNothing(number_format($obligated,2)) . '</td>
							<td style = "border-left:1px solid rgb(236, 238, 235);padding:2px;border-bottom:1px solid rgb(224, 225, 224);padding-left:10px;white-space:nowrap;font-size:14px;text-align:right;padding-right:5px;">' . $this->zeroToNothing(number_format($liquidated,2)) . '</td>
							<td style = "border-left:1px solid rgb(236, 238, 235);padding:2px;border-bottom:1px solid rgb(224, 225, 224);padding-left:10px;white-space:nowrap;font-size:14px;text-align:right;padding-right:5px;color:' . $color . '">' . $this->zeroToNothing(number_format(($unliquidated),2)) . '</td>
							
							<td style = "border-left:1px solid rgb(236, 238, 235);padding:2px;border-bottom:1px solid rgb(236, 238, 235);padding-left:10px;white-space:nowrap;font-size:14px;text-align:right;padding-right:5px;">' . $this->zeroToNothing(number_format($savings,2)) . '</td>
							
							
							
							<td style = "border-left:1px solid rgb(236, 238, 235);padding:2px;border-bottom:1px solid rgb(236, 238, 235);padding-left:10px;white-space:nowrap;font-size:14px;">' .  $programName . '</td>';
				$sheet .= '</tr>';
				$i++;
			}
			$properties = 'programCodeContainerAuto';
			if($i > 10){
				$properties = "programCodeContainerFix";
			}
			$sheet1 = '<div  class= "' . $properties . '" onscroll = "myFunction(this)" style = "width:320px;">';
			$sheet2 = '</div>';
			
			$sheet .= '</table>';
			return $sheet1 . $sheet . $sheet2 . '~!~' . $i . '~!~' . number_format($totalObligated,2) . '~!~' . $this->zeroToNothing(number_format($totalLiquidated,2)) . '~!~' . $this->zeroToNothing(number_format($totalUnliquidated,2))  . '~!~' .$this->zeroToNothing(number_format($totalAB,2)) . '~!~' . $this->zeroToNothing(number_format($totalSavings,2)) ;
			
		}
		function CreateOfficeSelectInStatus($record){
			$sheet = '<table  style ="float:right;">';
			$sheet .= '<tr >';
			$sheet .= '<td><span class = "label5" style ="padding-right:4px;">Office</span></td>';
			$sheet .= '<td ><input id = "maskOffice" class= "text3" onkeydown="keypressAndWhat1(this,event,SelectOfficeInStatus,1)" /><select id = "selectOfficeCode2" class = "select3" style ="text-align:left;" onchange = "SelectOfficeInStatus(this)">';
			$sheet .= '<option value = "all">All</option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select></td>';
			$sheet .= '</tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		//---------------------------------------------------------------------------------Doctrack Add New------------------
		function CreateSelectProgramPPMP($record){
			$sheet = '<select id = "selectProgramPPMP"  class = "select2">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option >';
				$sheet .= $data['ProgramCode'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectProgramFundsByOffice($record){
			$sheet = '<select id ="source1"  class = "select2" style = "width:200px;" onclick="clickInput(this)" onchange ="selectMultiSourceFund(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "'  . $data['Code'] . '">';
				$sheet .= $data['Code'] . ' ' . $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectManualProgramFundsByOffice($record){
			$sheet = '<select  class = "select2" style = "width:200px;" onclick="clickInput(this)" onchange ="selectManualSource(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "'  . $data['Code'] . '">';
				$sheet .= $data['Code'] . ' ' . $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectAppropriation($record){
			
			$sheet = '<select id = "selectFund2"  class = "select2" onchange = "SelectByOffice(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "">';
				$sheet .= $data['Code'] . '&nbsp;&nbsp;' .  $data['Title'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectPrograms($record){
			
			$sheet = '<select id = "selectPrograms"  class = "select2" style = "font-size:16px; width:200px;" onchange = "SelectByPogramCode(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] .'">';
				$sheet .= $data['Code'] . '&nbsp;&nbsp;' .  $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectProgramsPY($record){
			
			$sheet = '<select id = "selectProgramsPY" onclick="clickInput(this)" class = "data2 checkPY" style = "width:200px;" onchange = "SelectByPogramCodePY(this)">';
			$sheet .= '<option value = "">&nbsp;</option>';
			while($data = $this->fetch_array($record)){
				$sub =  $data['SubCode'];
				$sheet .= '<option value = "' . $data['Code'] .'~' . $sub . '">';
				$sheet .= $data['Code'] . '&nbsp;&nbsp;' .  $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			
			return $sheet;
		}
		function CreateSelectAccountCodes($record){
			
			$sheet = '<select id = "selectAccountCodesPY" onclick="clickInput(this)" class = "data2 checkPY" style = "width:300px;">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				
				$code = $data['Code'];
				$title = $data['Title'];
				
				//if($approval ==1){
					$sheet .= '<option value = "' . $code . '">';
					$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $title ;
					$sheet .= '</option>';
				//}
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectAccountCodes1($record,$size){
			$sheet = '<select id = "selectAccountCodesPY" onclick="clickInput(this)" class = "select2 checkPY" style = "width:' . $size . 'px;">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$fund = $data['Fund'];
				$code = $data['Code'];
				$title = $data['Title'];
				$approval = $data['Approval'];
				if($approval ==1){
					$sheet .= '<option value = "' . $code . '">';
					$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $title . ' (' . $fund . ')';
					$sheet .= '</option>';
				}
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectAccountCodesMultiple($record){
			
			$sheet = '<select id = "source2" onclick="clickInput(this)" class = "select2 checkPY" style = "width:300px;">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$fund = $data['Fund'];
				$code = $data['Code'];
				$title = $data['Title'];
				$approval = $data['Approval'];
				//if($approval ==1){
					$sheet .= '<option value = "' . $code . '">';
					$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $title . ' (' . $fund . ')';
					$sheet .= '</option>';
				//}
			}
			$sheet .= '</select>';
			return $sheet;
		}
		
		function CreateSelectClaimTypePY($record){
			
			$sheet = '<select id = "selectDocType" onclick="clickInput(this)" onchange = "onSelectClaimType(this)" class = "data2 checkPY" >';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$type = $data['Type'];

				if(substr($type, 0, 5) == "WAGES"){
					$office = $_SESSION['cbo'];
					// temp removed for detailed-in 1091,1032,1071
					if($office == "ROD1" || $office == "HALL" || $office == "COA1" || $office == 'PEFI'){
					
					//if($office == "ROD1" || $office == "PSCC" || $office == "104A" || $office == "LSBD" || $office == "TMCD" || $office == "4411" || $office == "8852" || $office == "CARC" || $office == "ANSU" || $office == "DISA" || $office == "VIRU" || $office == "PESO" || $office == "911C" || $office == "REHA" || $office == "1014" || $office == "1091" || $office == "PAOH" || $office == "SOCC" || $office == "9993" || $office == "RPO1" || $office == "MTCC" || $office == "COA1" || $office == "HALL"){
						$sheet .= '<option value = "' . $data['OBRType'] . '">';
						$sheet .= $type;
						$sheet .= '</option>';
					}
				/*}else if($type == "BENEFITS - GRATUITY PAY" || $type == "BENEFITS - CNA AND PEI" || $type == "BENEFITS - PAHALIPAY" || $type == "BENEFITS - SERVICE RECOGNITION INCENTIVE" ){*/
				}else if(substr($type, 0, 8)  == "BENEFITS" && $type != "BENEFITS - ELAP"){
					
					$office = $_SESSION['cbo'];
					// temp removed for detailed-in 1091,1032,1071
					if($office == "ROD1" || $office == "HALL" || $office == "COA1" || $office == 'PEFI'){
					
					//if($office == "ROD1" || $office == "PSCC" || $office == "104A" || $office == "LSBD" || $office == "TMCD" || $office == "4411" || $office == "8852" || $office == "CARC" || $office == "ANSU" || $office == "DISA" || $office == "VIRU" || $office == "PESO" || $office == "911C" || $office == "REHA" || $office == "1014" || $office == "1091" || $office == "PAOH" || $office == "SOCC" || $office == "9993" || $office == "RPO1" || $office == "MTCC" || $office == "COA1" || $office == "HALL"){
						$sheet .= '<option value = "' . $data['OBRType'] . '">';
						$sheet .= $type;
						$sheet .= '</option>';
					}
				}else if(substr($type, 0, 9)  == "ALLOWANCE"  ){
					
					$office = $_SESSION['cbo'];
					// temp removed for detailed-in 1091,1032,1071
					if($office == "ROD1" || $office == "HALL" || $office == "COA1" || $office == 'PEFI'){
					
					//if($office == "ROD1" || $office == "PSCC" || $office == "104A" || $office == "LSBD" || $office == "TMCD" || $office == "4411" || $office == "8852" || $office == "CARC" || $office == "ANSU" || $office == "DISA" || $office == "VIRU" || $office == "PESO" || $office == "911C" || $office == "REHA" || $office == "1014" || $office == "1091" || $office == "PAOH" || $office == "SOCC" || $office == "9993" || $office == "RPO1" || $office == "MTCC" || $office == "COA1" || $office == "HALL"){
						$sheet .= '<option value = "' . $data['OBRType'] . '">';
						$sheet .= $type;
						$sheet .= '</option>';
					}
				}else if($type == "ASSISTANCE - FINANCIAL"){
					
					$office = $_SESSION['cbo'];
					if($office == "ROD1" || $office == "HALL" || $office == "COA1" || $office == 'PEFI'){

						$sheet .= '<option value = "' . $data['OBRType'] . '">';
						$sheet .= $type;
						$sheet .= '</option>';

					}

				}else{
					$sheet .= '<option value = "' . $data['OBRType'] . '">';
					$sheet .= $type;
					$sheet .= '</option>';
				}
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateSelectPPMP($record){
			$sheet = '<select id = "selectCategoryPPMP" class = "select2" onclick = "selectDefault(selectSchedPPMP)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['CategoryCode'] .'">';
				$sheet .= $data['CategoryCode'] . '&nbsp;&nbsp;' . $data['CategoryName'] ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;	
		}
		function CreateSelectManualPPMP($record){
			$sheet = '<select id = "selectCategoryPPMP" class = "select2" onclick = "selectDefault(selectSchedPPMP)" onchange = "selectManualCategory(this)">';
			$sheet .= '<option value = ""></option>';
			$sheet .= '<option value = "myPeak">Multiple Category</option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['CategoryCode'] .'">';
				$sheet .= $data['CategoryCode'] . '&nbsp;&nbsp;' . $data['CategoryName'] ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;	
		}
		function CreateSelectApprovePR($record){
			$sheet = '<select id = "selectTrackingPR" class = "data2" onchange = "SelectItemsByPRRelease(this)">';	
			$sheet .= '<option value = "">&nbsp;</option>';
			$i = 1;
			while($data = $this->fetch_array($record)){
				
				$chargeType = $data['ChargeType'];
				if($chargeType > 1){
					$amount =  $data['TotalAmountMultiple'];
				}else{
					$amount = $data['Amount'];
				}
				if($i % 2 == 0){
					$sheet .= '<option style = "background-color:rgb(223, 226, 228);" value = "' .  $data['TrackingNumber'] .  '">';
				}else{
					$sheet .= '<option value = "' .  $data['TrackingNumber'] .  '">';
				}
				
				$sheet .= $data['TrackingNumber'] . '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' . number_format($amount,2)  ;
				$sheet .= '</option>';
				$i++;
			}
			$sheet .= '</select>';
			return $sheet;	
		}
		function CreateSelectManualApprovePR($record){
			$sheet = '<select id = "selectTrackingPR" class = "select2" onclick="clickInput(this)" onchange = "viewApprovedPRfunds(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['PR_CategoryCode'] . '~' . $data['TrackingNumber'] .  '">';
				$sheet .= $data['TrackingNumber'] . '&nbsp;-----------------------------------------------------------&nbsp;' . $data['CategoryName'] ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;	
		}
		function CreateTableItemsPPMP($record,$month){ //para sa pag view lng og details sa ppmp
			if (preg_match_all("/\b(Jan|Feb|March)\b/i",$month,$matches)) { 
				$matches = array_unique($matches[0]);
								
				$quarter = "1st Quarter";
				
			}else if (preg_match_all("/\b(Apr|May|June)\b/i",$month,$matches)) { 
				
				$quarter = "2nd Quarter";
			}else if (preg_match_all("/\b(July|Aug|Sept)\b/i",$month,$matches)) { 
				
				$quarter = "3rd Quarter";
			}else if (preg_match_all("/\b(Oct|Nov|December)\b/i",$month,$matches)) { 
				
				$quarter = "4th Quarter";
			} 
			$sheet0 = '<table id = "tableContent" border= "0" style = "margin:0 auto;">';
			$sheet2 = '<tr>
							<td class = "tdHeader3" style="padding:10px;">Cat.</td>
							<td class = "tdHeader3" style="padding:10px;">Qty</td>
							<td class = "tdHeader3" style="padding:10px;">Unit</td>
							<td class = "tdHeader3" style="padding:10px;">Description</td>
							<td class = "tdHeader3" style="padding:10px;">Unit&nbsp;Cost</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Amount</td>
						</tr>';
					   $gTotal = 0;	
					   $sheet3 = '';
					   
					   $funds = '';
					   $fund = '';
					   
					   $c1 = array();
					   $c2 = array();
					   $i=0;
					   $counter = 0;
					   while($data = $this->fetch_array($record)){
					   		$qty = $data[$month];
							$qtyYear = $data['Quantity'];
							$estBudget  = $data['EstimatedBudget'];
							$tCost = ($estBudget  / $qtyYear) * $qty;
							$cost = ($estBudget  / $qtyYear) ;
							$gTotal = $gTotal + $tCost;
							if($fund != $data['ProgramCode']){
								$funds .= $data['ProgramCode'] . '~';
								$fund = $data['ProgramCode'];
								$counter++;
							}
							if($counter >1){
								$m = "Multiple";
							}else{
								$m = $data['ProgramCode'];
							}
							$c1[$i] = $data['ProgramCode'];
							$c2[$i] = $tCost;
							$i++;
							$sheet1 = '<tr>
										    <td colspan="6" style = "border-bottom:1px solid silver;padding:5px 0px;">
												<span  class = "label1" style ="font-weight:normal; margin-right:20px;">Program Code : <span id = "prProgramCode">' . $m . '</span><br/> Account Code : <span id = "prAccountCode">' . $data['AccountCode'] . '</span></span>
												<span class = "label1" style ="font-weight:normal;float:right;color:rgb(81, 185, 214)">' . $quarter . '</span>
											</td>
									   </tr>';
					   		
							$sheet3 .= '<tr>
											<td class = "tableDataRows3" style="padding:10px;">' . $data['CategoryCode'] . '</td>
											<td class = "tableDataRows3" style="padding:10px;">' . $qty . '</td>
											<td class = "tableDataRows3" style="padding:10px;">' . $data['QuantityUnit'] . '</td>
											<td class = "tableDataRows3" style="padding:10px;">' . $data['ItemName'] . ' - ' . $data['ItemDescription'] . '</td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;">' . number_format($cost,2) . '</td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;">' . number_format($tCost,2) . '</td>
									   </tr>';	
					   }
					   $splits = explode('~',$funds);
					   $t = 0;
					   $totals = '';
					   for($e = 0 ; $e < sizeof($splits)-1; $e++ ){
					   	   for($i = 0; $i < sizeof($c1); $i++){
						   	  if($c1[$i] == $splits[$e]){
								 $t = $t + $c2[$i];
							  }
						   }
						   $totals .= $t . '~';
						   $t = 0;
					   }
					  
			$sheet4 = '<tr>
							<td colspan="5" class = "tableDataRows31" style="padding:10px;text-align:right;">Total<input id = "prHiddens" type = "hidden" value = ' . $funds . '**' . $totals .  '></td>
							<td id = "prTotal" class = "tableDataRows31" style="font-weight:bold;padding:10px;text-align:right;">' . number_format($gTotal,2) . '</td>
					  </tr></table>';
			return $sheet0.  $sheet1 . $sheet2 .  $sheet3 .$sheet4;
		}
		function CreateTableItemsPPMPselection($record,$month){ //para sa pag view lng og details sa ppmp
			if (preg_match_all("/\b(Jan|Feb|March)\b/i",$month,$matches)) { 
				$matches = array_unique($matches[0]);
								
				$quarter = "1st Quarter";
				
			}else if (preg_match_all("/\b(Apr|May|June)\b/i",$month,$matches)) { 
				
				$quarter = "2nd Quarter";
			}else if (preg_match_all("/\b(July|Aug|Sept)\b/i",$month,$matches)) { 
				
				$quarter = "3rd Quarter";
			}else if (preg_match_all("/\b(Oct|Nov|December)\b/i",$month,$matches)) { 
				
				$quarter = "4th Quarter";
			} 
			$sheet0 = '<table id = "tableContentPR" border= "0" style = "margin:0 auto;">';
			$sheet2 = '<tr>
							<td class = "tdHeader3" style="padding:10px;">Check</td>
							<td class = "tdHeader3" style="padding:10px;">Program</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Qty</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Unit</td>
							<td class = "tdHeader3" style="padding:10px;">Description</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Unit&nbsp;Cost</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Amount</td>
						</tr>';
					   $gTotal = 0;	
					   $sheet3 = '';
					   
					   $funds = '';
					   $fund = '';
					   
					   $c1 = array();
					   $c2 = array();
					   $i=0;
					   $counter = 0;
					   while($data = $this->fetch_array($record)){
					   		$itemDescription = $data['ItemDescription'];
							
							
					   		$qty = $data[$month];
							$qtyYear = $data['Quantity'];
							$estBudget  = $data['EstimatedBudget'];
							$tCost = ($estBudget  / $qtyYear) * $qty;
							$cost = ($estBudget  / $qtyYear) ;
							$gTotal = $gTotal + $tCost;
							if($fund != $data['ProgramCode']){
								$funds .= $data['ProgramCode'] . '~';
								$fund = $data['ProgramCode'];
								$counter++;
							}
							if($counter >1){
								$m = "Multiple";
							}else{
								$m = $data['ProgramCode'];
							}
							$c1[$i] = $data['ProgramCode'];
							$c2[$i] = $tCost;
							$i++;
							$sheet1 = '<tr>
										    <td colspan="7" style = "border-bottom:1px solid silver;padding:5px 0px;">
												<span  class = "label1" style ="font-weight:normal; margin-right:20px;">Program Code : <span id = "prProgramCode">' . $m . '</span>
												
												<br/> Account Code : <span id = "prAccountCode">' . $data['AccountCode'] . '</span></span>
												<span class = "label1" style ="font-weight:normal;float:right;color:rgb(81, 185, 214)">' . $quarter . '</span>
											</td>
									   </tr>';
					   		
							$sheet3 .= '<tr>
											<td class = "tableDataRows3" style="padding:10px;"><input  type = "checkbox" checked = "checked" onclick ="selectCalculateAddPR(this)" /></td>
											<td class = "tableDataRows3" style="padding:10px;">' . $fund .'</td>
											
											<td class = "tableDataRows3" style="padding:10px;"><input style = "width:100px;text-align:center;"  class = "select2" value  = "' . $qty . '" maxlength ="15" onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" /></td>
											<td class = "tableDataRows3" style="padding:10px;"><input style = "width:70px;text-align:center" class = "select2" value ="' . $data['QuantityUnit'] . '" maxlength ="10" onclick = "clickInput(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;"><textarea class = "select2" style ="width:250px;font-size:16px;resize:vertical;" onclick = "clickInput(this)">' . $itemDescription . '</textarea></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;"><input class = "select2" style = "width:100px;text-align:right;" maxlength ="10" value  = "' . $cost . '" onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;font-size:18px;letter-spacing:1px;">' . number_format($tCost,2) . '</td>
									   </tr>';	
					   }
					   $splits = explode('~',$funds);
					   $t = 0;
					   $totals = '';
					   for($e = 0 ; $e < sizeof($splits)-1; $e++ ){
					   	   for($i = 0; $i < sizeof($c1); $i++){
						   	  if($c1[$i] == $splits[$e]){
								 $t = $t + $c2[$i];
							  }
						   }
						   $totals .= $t . '~';
						   $t = 0;
					   }
					  
			$sheet4 = '<tr>
							<td colspan="5" class = "tableDataRows31" style="padding:10px;text-align:right;">Total<input id = "prHiddens" type = "hidden" value = ' . $funds . '**' . $totals .  '></td>
							<td colspan = "2" id = "prTotal" class = "tableDataRows31" style="font-weight:bold;padding:10px;text-align:right;letter-spacing:2px;">' . number_format($gTotal,2) . '</td>
					  </tr></table>';
			return $sheet0.  $sheet1 . $sheet2 .  $sheet3 .$sheet4;
		}

		function CreatePOBreakdown($record){

			$sheet3 = ''; 
			$sheet0 = '<table id = "selectedPOtable" style = "border-spacing:0;margin:0 auto;"  border= "0">';
			$sheet2 = '<tr>
							<td class = "tdHeader3" style="padding:10px;">&nbsp;</td>
							<td class = "tdHeader3" style="padding:10px;">Program</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Qty</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Unit</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Desciption</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">OBR Amount</td>
							
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Cost</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">TotalCost</td>
						</tr>';
					  $gTotal = 0;	
					   while($data = $this->fetch_array($record)){
					   		$prAccountCode = $data['PR_AccountCode'];
							$prTrackingNumber = $data['TrackingNumber'];
							
							$amount = $data['Amount'];
							$category = $data['PR_CategoryCode'];
							$obrNumber = $data['OBR_Number'];
							$prNumber = $data['PR_Number'];
							$obrNumber = $data['OBR_Number'];
							$fund = $data['Fund'];
							
							
							$prMonth = $data['PR_Month'];
							
							
							$chargeType = $data['ChargeType'];
							if($chargeType > 0){
								$prTotal = $data['TotalAmountMultiple'];
							}else{
								$prTotal = $data['TotalAmount'];
							}
							
							
							
							$fund = $data['Fund'];
							
							$programCode = $data['ProgramCode'];
							$qty = $data['Qty'];
							$unit = $data['Unit'];
							$description = $data['Description'];
							$cost = $data['Amount'];
							$totalCost = $data['Total'];
							
							
					   		$sheet3 .= '<tr style= "background-color:rgb(229, 228, 228);">
											<td class = "tableDataRows3" style="padding:10px;"><input type = "checkbox"  onclick = "selectCalculatePO(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px; text-align:center;"><span class ="label2">' . $programCode .  '</span></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:center;"><input id ="" class = "text2" style = "width:60px;text-align:center;" onclick="clickInput(this)" maxlength = "7" value = "' . $qty . '" onkeydown="return isAmount(this,event)" onkeyup = "calculateOnchangeSelectedPO(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:center;"><input id ="" class = "text2" style = "width:90px;text-align:center;" onclick="clickInput(this)" value = "' . $unit . '"/></td>	
											<td class = "tableDataRows3" style="padding:10px;text-align:center;"><textarea class = "select2" style = "width:250px;font-size:16px;resize:vertical;" onclick="clickInput(this)">' . $description . '</textarea></td>	
											<td class = "tableDataRows3" style="padding:10px;text-align:center;"><span class ="label2" style = "color:red;">'  . $totalCost . '</span></td>	
											
											<td class = "tableDataRows3" style="padding:10px;"><input id ="" class = "text2" style = "width:100px;text-align:right;" onclick="clickInput(this)" maxlength = "11" value = "0.00" onkeydown="return isAmount(this,event)" onkeyup = "calculateOnchangeSelectedPO(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;font-size:18px;"><span class ="label2" >0.00</span></td>
										</tr>';
										
							$gTotal = $gTotal+$amount;
					   }
					   if($category == 'Multiple'){
							$sheet1 = '<div style = "padding:10px;text-align:left;"><span class = "label1">PR details :</span>
										<div id = "prManualdetails" style = "padding:10px;padding-left:20px;">'  . $description . '</div></div>';
					   }else{
							$sheet1 = '<div style = "text-align:left;padding-left:15px;margin:10px; 0px;">
										<span class = "label2" style = "font-weight:bold;">PR details : </span>
										<div style = "padding-left:5px;padding-top:5px;">PR. TN# : <span id  = "poPRtrackingNumber" style = "padding-left:31px;">' . $prTrackingNumber . '</span></div>	
										<div style = "padding-left:5px;">PR N# : <span id  = "poPRnumber" style = "padding-left:40px;">' . $prNumber . '</span></div>	
										<div style = "padding-left:5px;">OBR N# : <span id  = "poOBRnumber" style = "padding-left:30px;">' . $obrNumber . '</span></div>	
										<div style = "padding-left:5px;">Fund : <span id  = "poPRfund" style = "padding-left:45px;">' . $fund . '</span></div>	
										
										<div style = "padding-left:5px;">PR Month : <span id  = "poPRmonth" style = "padding-left:16px;">' . $prMonth . '</span></div>	
										
										<div style = "padding-left:5px;">PR Category : <span id  = "poPRcategory">' . $category . '</span></div>	
										<div style = "padding-left:5px;">Acct. Code : <span id  = "poPRaccountCode" style = "padding-left:8px;">' . $prAccountCode . '</span></div>	
										<div style = "padding-left:5px;">Total : <span style = "padding-left:45px;color:red;letter-spacing:2px;">' . number_format($prTotal,2) . '</span></div>	
										
									   </div>';
					   }
			$sheet4 = '<tr>
							<td colspan="8" style="padding:10px;text-align:right;padding-right:10px;"><input id = "prManualHidden" type = "hidden" value ="' . $obrNumber . '~' . $prNumber  . '~' . $fund . '" />
							<span id = "selectedPOTotal" class = "label2" style = "letter-spacing:2px; color:red;padding-left:20px;">0.00</span></td>
					  </tr></table>';
			return $sheet1 . $sheet0 . $sheet2 .  $sheet3 .$sheet4 ;
		
		}
	

	


		function CreateViewListPRPO($record){
			$count = $this->num_rows($record);	
			$sheet3 = ''; 
			$sheet0 = '<table id = "selectedPRPOtable" style = "border-spacing:0;margin:0 auto;width:100%;border:1px solid rgb(215, 216, 217);"  border= "0">';
			$sheet2 = '<tr style = "background-color:rgb(207, 208, 209);">
						<td class = "dataHeader1" style="padding:5px 10px;border-bottom:0px solid grey;">Program</td>
						<td class = "dataHeader1" style="padding:5px 10px;border-bottom:0px solid grey;">&nbsp;</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:left;border-bottom:0px solid grey;">Desciption<span class = "countTotal"> (' . $count . ')</span></td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">Qty</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">&nbsp;</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">Cost</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">&nbsp;</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">Total</td>
					 </tr>';
					 
					 $c1 = '';
					 $c2 = '';
					 
					  $gTotal = 0;	
					  $programO = '';
					  $codeO = '';
					  $categoryO = '';
					  $categoryTotal = 0;
					  $programTotal = 0;
					  $i = 1;
					   while($data = $this->fetch_array($record)){
					   		$prAccountCode = $data['Code'];
							$prTrackingNumber = $data['TrackingNumber'];
							
							$amount = $data['Amount'];
							$category = $data['Category'];
							$code = $data['Code'];
							$programCode = $data['ProgramCode'];
							$qty = $data['Qty'];
							$unit = $data['Unit'];
							$description = $data['Description'];
							$cost = $data['Amount'];
							$totalCost = $data['Total'];
							
							
							if($programO != $programCode){
								
								if($i > 1){
									  $sheet3 .= '<tr>
													<td colspan="8" style="padding:10px;text-align:right;padding-right:15px;">
													<span  class = "data1" style = "color:orange;font-weight:bold;">' . $programO . '</span>
													<span id = "selectedPOTotal" class = "data1" style = "letter-spacing:1px; padding-left:10px;font-size:24px;color:black;font-weight:bold;">
													  ' . number_format($programTotal,2) . '</span></td>
											    </tr>';	
									$programTotal = $totalCost;
								}else{
									$programTotal = $totalCost;
								}
								$c1 = $code;
								$programO = $programCode;
							}else{
								
								if($c1 != $code){
									$c1 = $code;
								}else{
									$c1 = "";
								}
								
								$programTotal = $programTotal + $totalCost;
								$programCode = '';
								$programName = '';
							}
							
						
							if($programCode != ''){
								$sheet3 .= '<tr>	
											<td style = "background-color:rgb(222, 226, 228);padding:5px ;border-bottom:1px solid silver;border-top:1px solid silver;padding-left:10px;"><div class = "data1"style = "font-weight:bold;color:rgb(26, 142, 196);font-size:19px;">' . $programO .  '
											<span style = "font-size:13px;color:black;text-shadow:0px 0px 2px white;font-weight:normal;padding-left:3px;" class = "data1"></span></div></td>	
											<td style = "background-color:rgb(222, 226, 228);padding:5px ;border-bottom:1px solid silver;border-top:1px solid silver;"></td>
											<td colspan ="6" style = "color:black;font-size:12px;background-color:rgb(222, 226, 228);padding:5px 12px;border-bottom:1px solid silver;border-top:1px solid silver;"><div  class = "data1" style = "font-size:15px;">' . $category .  '</div></td>
										</tr>'; 
							}
							
							if($i % 2 == 0){
								$sheet3 .= '<tr style= "background-color:rgb(221, 236, 243);">';
							}else{
								$sheet3 .= '<tr  >';
							}
					   		
				   			$sheet3 .= 	'
										<td class = "tableDataRows3" style= "vertical-align:top; padding:12px 10px;">
											<span class = "data1" style= "font-size:13px;padding-left:10px;">' . $c1 . '</span>
										</td>
										<td class = "tableDataRows3" style="padding:13px 2px;text-align:right;"><span style = "padding: 2px;font-style:italic;color:black;font-weight:bold;">' . $i++ . '</span></td>	
										<td class = "tableDataRows3" style="padding:10px;">
											<div class = "data1" style = "font-size:16px;white-space: pre-line; word-wrap: break-word;background-color1:white;padding:0px 5px;">' . $description . '</div>
										</td>
										<td class = "tableDataRows3" style="padding:10px;text-align:center;"><div style = "border-bottom:1px solid silver;color:rgb(45, 90, 126);font-weight:bold;" class = "data1">' . intVal($qty) . '</div>
										<span class = "data1">' . $unit . '</span></td>	
										<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span >x</span></td>
										<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span class = "data1" style = "color:rgb(45, 90, 126);font-weight:bold;">' . number_format($cost,2) . '</span></td>
										<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span >=</span></td>
										<td class = "tableDataRows3" style="padding:10px;text-align:right;">
										<span style = "font-weight:bold;padding:5px;" class = "data1">' . number_format($totalCost,2) . '</span></td>
									</tr>';
							
							$gTotal = $gTotal + $totalCost;
					   }
			$sheet3 .= '<tr>
						<td colspan="8" style="padding:10px;text-align:right;padding-right:10px;">
						<span class = "data1" style = "color:orange;font-weight:bold;">' . $programO . '</span>
						<span  class = "data1" id = "selectedPOTotal" class = "data1" style = "letter-spacing:1px; color:red;padding-left:10px;font-size:24px;color:black;font-weight:bold;">' . number_format($programTotal,2) . '</span></td>
				       </tr>';
			$sheet4 = '<tr>
							<td class = "data1" colspan="8" style="padding:10px;text-align:right;padding-right:10px;">Total
							<span class = "data1" id = "selectedPOTotal" style = "letter-spacing:1px; color:red;padding-left:26px; font-size:26px;font-weight:bold;">' . number_format($gTotal,2) . '</span></td>
					  </tr></table>';
			return  $sheet0 . $sheet2 .  $sheet3 .$sheet4 ;
		}
		
		function CreateViewListPISPO($record){
			$count = $this->num_rows($record);	
			$sheet3 = ''; 
			$sheet0 = '<table id = "selectedPRPOtable" style = "border-spacing:0;margin:0 auto;width:100%;border:1px solid rgb(215, 216, 217);"  border= "0">';
			$sheet2 = '<tr style = "background-color:rgb(207, 208, 209);">
						<td class = "dataHeader1" style="padding:5px 10px;border-bottom:0px solid grey;">Program</td>
						<td class = "dataHeader1" style="padding:5px 10px;border-bottom:0px solid grey;">&nbsp;</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:left;border-bottom:0px solid grey;">Desciption<span class = "countTotal"> (' . $count . ')</span></td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">Qty</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">&nbsp;</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">Cost</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">&nbsp;</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;border-bottom:0px solid grey;">Total</td>
					 </tr>';
					 
					 $c1 = '';
					 $c2 = '';
					 
					  $gTotal = 0;	
					  $programO = '';
					  $codeO = '';
					  $categoryO = '';
					  $categoryTotal = 0;
					  $programTotal = 0;
					  $i = 1;

					   while($data = $this->fetch_array($record)){
					   		$prAccountCode = $data['Code'];
							$prTrackingNumber = $data['TrackingNumber'];
							
							$amount = $data['Amount'];
							$category = $data['Category'];
							$code = $data['Code'];
							$programCode = $data['ProgramCode'];
							$qty = $data['Qty'];
							$unit = $data['Unit'];
							$description = $data['Description'];
							$cost = $data['Amount'];
							$totalCost = $data['Total'];
							
							
							if($programO != $programCode){
								
								if($i > 1){
									  $sheet3 .= '<tr>
													<td colspan="8" style="padding:10px;text-align:right;padding-right:15px;">
													<span  class = "data1" style = "color:orange;font-weight:bold;">' . $programO . '</span>
													<span id = "selectedPOTotal" class = "data1" style = "letter-spacing:1px; padding-left:10px;font-size:24px;color:black;font-weight:bold;">
													  ' . number_format($programTotal,2) . '</span></td>
											    </tr>';	
									$programTotal = $totalCost;
								}else{
									$programTotal = $totalCost;
								}
								$c1 = $code;
								$programO = $programCode;
							}else{
								
								if($c1 != $code){
									$c1 = $code;
								}else{
									$c1 = "";
								}
								
								$programTotal = $programTotal + $totalCost;
								$programCode = '';
								$programName = '';
							}
							
						
							if($programCode != ''){
								$sheet3 .= '<tr>	
											<td style = "background-color:rgb(222, 226, 228);padding:5px ;border-bottom:1px solid silver;border-top:1px solid silver;padding-left:10px;"><div class = "data1"style = "font-weight:bold;color:rgb(26, 142, 196);font-size:19px;">' . $programO .  '
											<span style = "font-size:13px;color:black;text-shadow:0px 0px 2px white;font-weight:normal;padding-left:3px;" class = "data1"></span></div></td>	
											<td style = "background-color:rgb(222, 226, 228);padding:5px ;border-bottom:1px solid silver;border-top:1px solid silver;"></td>
											<td colspan ="6" style = "color:black;font-size:12px;background-color:rgb(222, 226, 228);padding:5px 12px;border-bottom:1px solid silver;border-top:1px solid silver;"><div  class = "data1" style = "font-size:15px;">' . $category .  '</div></td>
										</tr>'; 
							}
							
							if($i % 2 == 0){
								$sheet3 .= '<tr style= "background-color:rgb(221, 236, 243);">';
							}else{
								$sheet3 .= '<tr  >';
							}
					   		
				   			$sheet3 .= 	'
										<td class = "tableDataRows3" style= "vertical-align:top; padding:12px 10px;">
											<span class = "data1" style= "font-size:13px;padding-left:10px;">' . $c1 . '</span>
										</td>
										<td class = "tableDataRows3" style="padding:13px 2px;text-align:right;"><span style = "padding: 2px;font-style:italic;color:black;font-weight:bold;">' . $i++ . '</span></td>	
										<td class = "tableDataRows3" style="padding:10px;">
											<div class = "data1" style = "font-size:16px;white-space: pre-line; word-wrap: break-word;background-color1:white;padding:0px 5px;">' . $description . '</div>
										</td>
										<td class = "tableDataRows3" style="padding:10px;text-align:center;"><div style = "border-bottom:1px solid silver;color:rgb(45, 90, 126);font-weight:bold;" class = "data1">' . intVal($qty) . '</div>
										<span class = "data1">' . $unit . '</span></td>	
										<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span >x</span></td>
										<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span class = "data1" style = "color:rgb(45, 90, 126);font-weight:bold;">' . number_format($cost,2) . '</span></td>
										<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span >=</span></td>
										<td class = "tableDataRows3" style="padding:10px;text-align:right;">
										<span style = "font-weight:bold;padding:5px;" class = "data1">' . number_format($totalCost,2) . '</span></td>
									</tr>';
							
							$gTotal = $gTotal + $totalCost;

					   }
			$sheet3 .= '<tr>
						<td colspan="8" style="padding:10px;text-align:right;padding-right:10px;">
						<span class = "data1" style = "color:orange;font-weight:bold;">' . $programO . '</span>
						<span  class = "data1" id = "selectedPOTotal" class = "data1" style = "letter-spacing:1px; color:red;padding-left:10px;font-size:24px;color:black;font-weight:bold;">' . number_format($programTotal,2) . '</span></td>
				       </tr>';
			$sheet4 = '<tr>
							<td class = "data1" colspan="8" style="padding:10px;text-align:right;padding-right:10px;">PR Total 
							<span class = "data1" id = "selectedPOTotal" style = "letter-spacing:1px; color:red;padding-left:26px; font-size:26px;font-weight:bold;">' . number_format($gTotal,2) . '</span></td>
					  </tr></table>';
			return  $sheet0 . $sheet2 .  $sheet3 .$sheet4 ;
		}

		function CreateViewGroupDetails($grp){
			$splitDataA = explode('*',$grp);	
			$obrGRP = '';
			$amountX = 0;
			$programS = '';
			$codeS = '';
			for($i = 0; $i < sizeof($splitDataA)-1 ; $i++ ){
				$splitDataB = explode('~',$splitDataA[$i]);	
				$programCode = $splitDataB[0];
				$code = $splitDataB[1];
				$amount = $splitDataB[2];
				$total = $splitDataB[3];
				if($total == 0){
					$total = $amount;
				}
				$programName =$splitDataB[4];
				$title = $splitDataB[5];
				if($programS != $programCode){
					$programS = $programCode;
					$amountX = $amount;
					$codeS = $code;
					$obrGRP .= $programS . '~' . $codeS . '~' . $amountX . '~' . $total  . '~'  . $programName . '~'  . $title  .  '*';
				}else{
					if($codeS != $code){
						$amountX = $amount;
						$codeS = $code;
						$obrGRP .= $programS . '~' . $codeS . '~' . $amountX . '~' . $total  . '~'  . $programName . '~'  . $title  .  '*';
					}else{
						$amountX = $amountX + $amount;
					}
				}	
			}
	   
			$sheet3 = '';
			$sheet0 = '<table id = "" style = "border-spacing:0;margin:0 auto;width:100%;border:1px solid rgb(215, 216, 217);"  border= "0">';
			$sheet2 = '<tr style = "background-color:rgb(121, 137, 141);">
						<td class = "dataHeader1" style="padding:5px 10px;">Program <span class = "countTotal">(' . $i . ')</span></td>
						<td class = "dataHeader1" style="padding:5px  10px;text-align:">Code</td>
						<td class = "dataHeader1" style="padding:5px 10px;text-align:center;">Amount</td>
					 </tr>';
					 $splitDataA = explode('*',$obrGRP);
					 $programO = '';			   
					  for($i = 0; $i < sizeof($splitDataA)-1 ; $i++ ){
					  	$splitDataB = explode('~',$splitDataA[$i]);	
						$programCode = $splitDataB[0];
						$code = $splitDataB[1];
						$amount = $splitDataB[2];
						$total = $splitDataB[3];
						if($total == 0){
							$total = $amount;
						}
						$programName =$splitDataB[4];
						$title = $splitDataB[5];
						if($programO != $programCode){
							$programO = $programCode;
						}else{
							$programCode = '';
							$programName = '';
						}
						if($i % 2 == 1){
							$color = "rgb(228, 240, 246)";
						}else{
							$color = "";
						}
					 	 $sheet3 .= '<tr style= "background-color:' . $color . ';">	
											<td class = "data1" style="padding:10px;">
												<div style = "font-weight:bold;">' . $programCode .  '</div>
												<span>' . utf8_encode($programName)  . '</span>
											</td>
											<td class = "data1" style="padding:10px;">
												<div style = "font-weight:bold;">' . $code .  '</div>
												<span >' . $title  . '</span>
											</td>
											<td class = "data1" style="padding:10px;text-align:right;font-weight:bold;"><span >' . number_format($amount,2) . '</span></td>
								     </tr>';
					 }		   
			$sheet4 = '<tr>
							<td colspan="7" class = "data1" style="padding:10px;text-align:right;padding-right:10px;">OBR Total
							<span id = "prTotal" class = "data1" style = "letter-spacing:1px; color:red;padding-left:20px;font-weight:bold;font-size:26px;">' . number_format($total,2) . '</span></td>
					  </tr></table>';
			return $sheet0 . $sheet2 .  $sheet3 . $sheet4 ;
			//return $obrGRP;
			
		}

		//-----------------------------------------------------------PR Form
		
		
		function CreateFormPR($record,$month,$categoryName,$officeName,$pageItems,$dataPeople,$trackingNumber){ 
			if($month == 1){
				$month = "Jan";
			}else if($month == 2){
				$month = "Feb";
			}if($month ==3){
				$month = "March";
			}if($month == 4){
				$month = "Apr";
			}if($month == 5){
				$month = "May";
			}if($month == 6){
				$month = "June";
			}if($month == 7){
				$month = "July";
			}if($month == 8){
				$month = "Aug";
			}if($month == 9){
				$month = "Sept";
			}if($month == 10){
				$month = "Oct";
			}if($month == 11){
				$month = "Nov";
			}if($month == 1){
				$month = "December";
			}
			
			if (preg_match_all("/\b(Jan|Feb|March)\b/i",$month,$matches)) { 
				$matches = array_unique($matches[0]);				
				$quarter = "1st Quarter";
			}else if (preg_match_all("/\b(Apr|May|June)\b/i",$month,$matches)) { 
				$quarter = "2nd Quarter";
			}else if (preg_match_all("/\b(July|Aug|Sept)\b/i",$month,$matches)) { 
				$quarter = "3rd Quarter";
			}else if (preg_match_all("/\b(Oct|Nov|December)\b/i",$month,$matches)) { 		
				$quarter = "4th Quarter";
			} 
			
		   $gTotal = 0;	  
		   $arrayQty = array();
		   $arrayUnit = array();
		   $arrayDesc = array();
		   $arrayCost = array();
		   $arrayTotal = array();
		   $arrayLength = array();
		   
		   $programs = '';
		   $p = '';
		   $arrayProg = array();
		   $accountCode = '';
		   while($data = $this->fetch_array($record)){
				$year = $data['Period'];
				$categoryCode = $data['CategoryCode'];
				$qty = $data['Qty'];
				$unit = $data['Unit'];
				$description = $data['Description'];
				$cost = $data['Cost'];
				$total  = $data['Total'];
				$program = $data['ProgramCode'];
				$accountCode = $data['PR_AccountCode'];
				
				if($p != $program){
					
					$programs  .= $program . ', ';
					$p = $program;
					$i = 0;
					foreach($arrayProg as $prog) {
					  if($program == $prog) {
						 unset($arrayProg[$i]);
						 $arrayProg[$i] ='';
						 
					  }
					  $i++;
					}
					array_push($arrayProg,$program);
				}
				
				
				$gTotal = $gTotal + $total;
				
				array_push($arrayQty,$qty);
				array_push($arrayUnit,$unit);
				array_push($arrayDesc,$description);
				array_push($arrayCost,$cost);
				array_push($arrayTotal,$total);
				array_push($arrayLength,strlen($description));
				
				$quarterCat  = '<span style = "font-size:13px;font-weight:bold;">' . $quarter . ' ' . $year . '<br/>' . $categoryCode . ' - ' . $categoryName . '</span>';
		   	}
			
			
			$mainPageEntry = $pageItems;		   			  
		
			$perPage = $mainPageEntry;
			$sizeOfarray = sizeOf($arrayQty);
			
			
			
			$pagePerItems = $sizeOfarray / $perPage;
			$page = $pagePerItems;
			if($pagePerItems % 2 == 1){
				$page = intval($pagePerItems) + 1;
			}else{
				$page = ceil($pagePerItems);
			}
			if($perPage == $sizeOfarray){
				$page = 1;
			}
			if($perPage > $sizeOfarray){
				$perPage = $sizeOfarray;
				$page = 1;
			}
			
			$start  = 0;
			$end = $perPage;
			$lastPage = 0;
			$pageTotal = 0;
			
			$sql = "select PR_ProgramCode,PR_AccountCode from vouchercurrent where trackingnumber = '" . $trackingNumber . "'";
			$record = $this->query($sql);
			$pro = '';
			$progs = '';
			
			
			$acc = '';
			$accs = '';
			
			while($data = $this->fetch_array($record)){
				if($pro != $data['PR_ProgramCode']){
					$pro = $data['PR_ProgramCode'];
					$progs .= $pro . ',';
				}	
				if($acc != $data['PR_AccountCode']){
					$acc = $data['PR_AccountCode'];
					$accs .= $acc . ',';
				}	
			}
			$progs = substr($progs,0,strlen($progs)-1);
			$accs = substr($accs,0,strlen($accs)-1);
			
			for($i = 0; $i < $page; $i++ ){
				if($page == 1){
					$lastPage = intval($mainPageEntry - $perPage);			
				}
				$form = '<div class = "containerPRform" style ="border:0px solid black;width:670px;margin:0 auto;">';
				$form .= $this->f1($officeName,$trackingNumber);
				$s1 = $this->f2($arrayQty,$arrayUnit,$arrayDesc,$arrayCost,$arrayTotal,$arrayLength,$start,$end,$quarterCat,$lastPage,$pageTotal);
				$form .= $s1[0];
				$pageTotal = $s1[1];
				
				
				
				
				//$form .= $this->f3($pageTotal,($i +1),intval($page),$dataPeople,implode($arrayProg,' '),$accountCode);
				$form .= $this->f3($pageTotal,($i +1),intval($page),$dataPeople,$progs,$accs);
				$form .= '</div>';
				
				echo $form; 
				
				
				$start = $start + $perPage;
				$end = $end + $perPage;
				if($end > $sizeOfarray){
					$end = $sizeOfarray;
					$lastPage = intval($perPage - ($end - $start));
				}
				
			}
		}
		function f0(){
			$sheet = '<table style = "border-spacing:0;height:600px;"><tr>
							<td style="font-size:13px;border:2px solid black;border-top:0;border-bottom:0; border-left:0;width:31px;"></td>
							<td style="font-size:13px;width:67px;border-right:2px solid black;"></td>
							<td style="font-size:13px;width:60px;border-right:2px solid black;"></td>
							<td style="font-size:13px;border-right:2px solid black;vertical-align:top; width:307px;">
								<textarea onkeypress = "check(this,event)" cols="70" rows="20" style = "overflow:hidden; background-color:transparent;border:0;resize:none;height:100%;width:100%;"></textarea>
							</td>
							<td style="font-size:13px;border-top:2px solid black;width:80px;border-right:2px solid black;border-top:0;"></td>
							<td style="font-size:13px;border-top:2px solid black;width:95px;border-top:0;"></td>
						</tr>';
		
			$sheet .= '</table>';
						
			return $sheet;
		}
		function f1($officeName,$trackingNumber){
			$sheet = '<table style="border-spacing:0;margin:0 auto;width:100%;padding-bottom:5px;border:2px solid black;border-bottom:0;" >
						<tr>
							<td colspan="4" style = "padding:5px 0px;border-bottom:2px solid black;padding:15px 0px;text-align:right;">
								<table style ="float:right;width:500px;" border ="0">
									<tr>
										<td style ="text-align:center;"><span style = "font-size:20px;font-weight:bold;">PURCHASE REQUEST</span></td>
									</tr>
									<tr>
										<td style ="text-align:center;"><span >City Government of Davao</span></td></td>
									</tr>
									<tr>
										<td style ="text-align:center;">
											<span style ="letter-spacing:2px;">LGU</span>
										</td>
										<td style = "width:150px;vertical-align:bottom;text-align:center;">
											<span style = "font-size:12px;">TN#: ' . $trackingNumber . '</span>
										</td>
									</tr>
									
								</table>
							</td>
						</tr>
						<tr>
							<td  valign="top" >
								<table border ="0" style="width:100%;font-size:14px;">
									<tr>
										<td valign="top" style = "width:10px;">Department&nbsp;:</td>
										<td style="border-bottom:2px solid black;">'  .   $officeName . '</td>
									</tr>
									<tr>
										<td>Section :</td>
										<td style="border-bottom:2px solid black;"><input style = "width:100%;border:0;"/></td>
										
									</tr>
								</table>
							</td>
							<td width = "45%" style = "">
								<table border ="0" style = "font-size:14px;">
									<tr>
										<td>PR. No :</td><td width ="85px;" style="border-bottom:2px solid black;"></td>
										<td>Date:</td><td width ="80px;" style="border-bottom:2px solid black;"></td>
									</tr>
									<tr>
										<td>SAI No :</td><td style="border-bottom:2px solid black;"></td><td>Date:</td>
										<td style="border-bottom:2px solid black;"></td>
									</tr>
									<tr>
										<td>Alobs No :</td><td style="border-bottom:2px solid black;"></td><td>Date:</td>
										<td style="border-bottom:2px solid black;"></td>
									</tr>
								</table>
							</td>
						</tr>
					</table>';
					
			return $sheet;
		}	
		function f2($arrayQty,$arrayUnit,$arrayDesc,$arrayCost,$arrayTotal,$arrayLength,$start,$end,$quarterCat,$lastPage,$pageTotal){
			$size = count($arrayQty);
			$total = 0;
			$sheet = '<div id = "overflowContainer" style = "height:500px;border:2px solid black;border-top:0;border-bottom:0;overflow-y:hidden;">';
			
			$sheet .= '<table style = "width:100%;border-spacing:0px;"><table style = " border-spacing:0;">';
			$ctr = 0;
			for($i = $start ; $i < $end; $i++ ){
				$aQty = $arrayQty[$i];
				$fQty = floor($arrayQty[$i]);
				
				if($aQty - $fQty == 0){
					$qty = $fQty;
				}else{
					$qty = $aQty;
				}
				
				//$qty =$aQty - floor($aQty);
				if($ctr == 0){
					$sheet .= '<tr>
									<td style="font-size:13px;border:2px solid black;border-left:0;width:31px;;text-align:center;">Item No.</td>
									<td style="font-size:13px;border-top:2px solid black;width:63px;border-right:2px solid black;border-bottom:2px solid black;text-align:center;">Qty</td>
									<td style="font-size:13px;border-top:2px solid black;width:60px;border-right:2px solid black;border-bottom:2px solid black;text-align:center;">Unit of Issue</td>
									<td style="width:307px; font-size:13px;border-top:2px solid black;border-right:2px solid black; border-bottom:2px solid black;text-align:center;">Description</td>
									<td style="font-size:13px;border-top:2px solid black;width:80px;border-right:2px solid black;border-bottom:2px solid black;text-align:center;">Estimated Unit Cost</td>
									<td style="padding:0px 2px;font-size:13px;border-top:2px solid black;width:95px;border-bottom:2px solid black;text-align:center;">Estimated Cost</td>
								</tr>';
					$sheet .= '<tr>
									<td style="border-right:2px solid black;border-left:0;"></td>
									<td style="border-right:2px solid black;"></td>
									<td style="border-right:2px solid black;"></td>
									<td style="border-right:2px solid black;text-align:center;padding:10px 0px;">' . $quarterCat . '</td>
									<td style="border-right:2px solid black;"></td>
									<td ></td>
								</tr>';
					if($start > 0){
					$sheet .= '<tr>
									<td style="border-right:2px solid black;border-left:0;"></td>
									<td style="border-right:2px solid black;"></td>
									<td style="border-right:2px solid black;"></td>
									<td style="border-right:2px solid black;text-align:center;padding:5px 0px;">Balance forwarded</td>
									<td style="border-right:2px solid black;"></td>
									<td class = "rowData" style="text-align:right;font-weight:bold;padding:5px 0px;padding-right:5px;">' . number_format($pageTotal,2) . '</td>
								</tr>';
					}
								
					$sheet .= '<tr>
									<td class = "rowData" style=" border-right:2px solid black;text-align:center;">' . ($i+1) . '</td>
									<td class = "rowData" style="border-right:2px solid black;text-align:center;"><input value = "' . $qty . '" style = "text-align:center;border:0;width:59px;"/></td>
									
									<td class = "rowData" style="border-right:2px solid black;text-align:center;">' . $arrayUnit[$i] . '</td>
									<td class = "rowData" style="border-right:2px solid black;text-align:left;white-space: pre-line;word-wrap: break-word;">' . $arrayDesc[$i] . '</td>
									<td class = "rowData" style="border-right:2px solid black;text-align:right;">' . number_format($arrayCost[$i],2) . '</td>
									<td class = "rowData" style="text-align:right;">' . number_format($arrayTotal[$i],2) . '</td>
								</tr>';
					$total = $total + $arrayTotal[$i];	
				}else{
					$sheet .= '<tr>
							<td class = "rowData" style="border-right:2px solid black;text-align:center;">' . ($i+1). '</td>
							<td class = "rowData" style="border-right:2px solid black;text-align:center;padding:0;"><input value = "' .$qty . '" style = "text-align:center;border:0;width:59px;"/></td>
							<td class = "rowData" style="border-right:2px solid black;text-align:center;">' . $arrayUnit[$i] . '</td>
							<td class = "rowData" style="border-right:2px solid black;text-align:left;white-space: pre-line;word-wrap: break-word;">' . $arrayDesc[$i] . '</td>
							<td class = "rowData" style="border-right:2px solid black;text-align:right;">' . number_format($arrayCost[$i],2) . '</td>
							<td class = "rowData" style="text-align:right;">' . number_format($arrayTotal[$i],2) . '</td>
						</tr>';
					$total = $total + $arrayTotal[$i];
				}
				$ctr++;
			}
			
			$total = $total + $pageTotal;
			if($lastPage == 1){
				$totalCaption  = 'Total';
			}else{
				$totalCaption  = 'Subtotal';
			}
			if($lastPage != 0){
				$totalCaption  = 'Total';
			}
		
			$sheet .= '<tr>
									<td class = "rowData" style=" border-right:2px solid black;text-align:center;">&nbsp;</td>
									<td class = "rowData" style="border-right:2px solid black;text-align:center;">&nbsp;</td>
									<td class = "rowData" style="border-right:2px solid black;text-align:center;">&nbsp;</td>
									<td class = "rowData" style="border-right:2px solid black;text-align:left;">&nbsp;</td>
									<td style="border-right:2px solid black;text-align:center;font-weight:bold;font-size:14px;">' . $totalCaption . '</td>
									<td style="font-size:13px;font-weight:bold;text-align:right;border-top:2px solid black;border-bottom:4px double black;padding-right:5px;">' . number_format($total,2) . '</td>
								</tr>';
			if($lastPage == 0){
				$sheet .= '<tr>
										<td class = "rowData" style=" border-right:2px solid black;">&nbsp;</td>
										<td class = "rowData" style="border-right:2px solid black;">&nbsp;</td>
										<td class = "rowData" style="border-right:2px solid black;">&nbsp;</td>
										<td class = "rowData" style="border-right:2px solid black;">&nbsp;</td>
										<td class = "rowData" style="border-right:2px solid black;">&nbsp;</td>
										<td class = "rowData" style="">&nbsp;</td>
									</tr>';
			}
						
			if($lastPage != 0){
				for($i =0; $i < $lastPage-1; $i++){
					$sheet .= '<tr>
									<td class = "rowData" style="border-right:2px solid black;"></td>
									<td class = "rowData" style="border-right:2px solid black;"><input style = "width:100%;border:0;"/></td>
									<td class = "rowData" style="border-right:2px solid black;"><input style = "width:100%;border:0;"/></td>
									<td class = "rowData" style="border-right:2px solid black;"><input style = "width:100%;border:0;"/></td>
									<td class = "rowData" style="border-right:2px solid black;"><input style = "width:100%;border:0;"/></td>
									<td class = "rowData" style="text-align:right;"><input style = "width:100%;border:0;"/></td>
								</tr>';
				}
				
			}
			$sheet .= '</table>';
			$sheet .= $this->f0();
			$sheet .= '</div>';
			
			$sheets = array();
			array_push($sheets,$sheet);
			array_push($sheets,$total);
			
			return $sheets;
		}
		function f3($gTotal,$currentPage,$totalPage,$dataPeople,$programs,$accountCode){
			
			if(strlen($dataPeople) > 0){
				$s = explode("~",$dataPeople);
				
				$r1 = $s[0];
				$r2 = $s[1];
				
				$c1 = $s[2];
				$c2 = $s[3];
				
				$a1 = $s[4];
				$a2 = $s[5];
				
				$d1 = $s[6];
				
				if(strlen($s[7])>96){
					$p1 = trim(substr($s[7],0,95));
					$p2 = trim(substr($s[7],95));
				}else{
					$p1 = $s[7];
					$p2 = '';
				}
				
				$o1 = $s[8];
			}else{
				$r1 = '-';
				$r2 = '-';
				
				$c1 = '-';
				$c2 = '-';
				
				$a1 = '-';
				$a2 = '-';
				
				$d1 = '-';
				
				$p1 = '-';
				$p2 = '';
				$o1 = '-';
			}
			
			if(isset($_COOKIE['RequestedBy'])){
				$r1 =  $_COOKIE['RequestedBy'];
				$r2 = $_COOKIE['RequestedDesignation'];
				
				$c1 = $_COOKIE['CertifiedBy'];
				$c2 = $_COOKIE['CertifiedDesignation'];
				
				$a1 = $_COOKIE['ApprovedBy'];
				$a2 = $_COOKIE['ApprovedDesignation'];
				
				$o1 = $_COOKIE['ControlledBy'];
			}
			
							
			$sheet = '<div style ="border:2px solid black;border-top:0;border-bottom:0;"><table border = "0" style = "width:100%;border-spacing:0;">
							<tr>
								<td  style="width:31px;border-right:2px solid black;">&nbsp;</td>
								<td  style="width:67px;border-right:2px solid black;">&nbsp;</td>
								<td  style="width:60px;border-right:2px solid black;">&nbsp;</td>
								
								<td  style="width:307px;border-right:0px solid black;font-size:12px;text-align:center;vertical-align:bottom;padding-bottom:5px;">
									Delivery&nbsp;Period:<input value = "' . $d1 .'" style = "font-size:14px;width:25px;text-align:center;border:0;border-bottom:1px solid black;"/>Days Upon Receipt of Approved PO
									<div style = "margin-top:10px;text-align:center;">Page ' . $currentPage . ' of &nbsp;' . $totalPage . '</div>
								</td>
								<td colspan = "2" style="width:0px;font-size:14px;padding-top:10px;">
									<div style = "font-size:11px;padding-left:5px;background-color:white;padding-bottom:35px;">
										THIS IS TO CERTIFY that the items 
										stated above are included in the PPMP of this Office.
									</div>
									<div style = " border-bottom:1px solid silver;">
										<input value = "' . $c1 .'" type = "text" style = "background-color:white;font-family:Arial; font-size:10px;font-weight:bold; width:100%;text-align:center;border:0;" placeholder = "Type name here" />
									</div>
									<div style = "">
										<input  value = "' . $c2 .'" style = "background-color:white;font-family:Arial; font-size:10px;width:100%;text-align:center;border:0;" placeholder = "Type title" />
									</div>
								</td>
							</tr></table ></div>';		
			//strtoupper($this->numWords($gTotal))		
			
			//$gTotal ='124205.91';
			$gTotal =preg_replace('/[,]/', '', number_format($gTotal,2));
			
			 $n = explode(".",$gTotal);
			 if(sizeof($n) == 2){
				$n1 =  $n[0];
				$n2 = abs($n[1]);
				//$n2 = intval($n[1]);
				
				if($n2 > 1){
					$cen = " CENTAVOS";	
					$cen = '';
					$inWords = $this->numWords($n1) . ' PESOS AND ' . $n2 . '/100' . $cen;
				}else if($n2 == 1){
					$cen = " CENTAVO";	
					$cen = '';
					$inWords = $this->numWords($n1) . ' PESOS AND ' . $n2 . '/100' . $cen;
				}else{
					$inWords = $this->numWords($n1) . ' PESOS';
				}
				
			}else{
				$n1 =  $n[0];	
				$inWords = $this->numWords($n1) . ' PESOS';
			}
		    	
		    	
		    
		    	
		    	
		    	
		    
			$sheet .= '<table border ="0" style = "width:100%;border-spacing:0;background-color:white;border-left:2px solid black;border-right:2px solid black;">
								<tr>
									<td style="padding-left:5px;width:10px;font-size:12px;border-top:2px solid black;border-bottom:2px solid black;font-weight:bold;vertical-align:top;padding-top:4px;">
										TOTAL
									</td>
									<td style ="border-bottom:2px solid black;border-top:2px solid black;padding-left:10px;">
										<textarea style = "font-family:arial;padding:2px; font-size:11px;border:0;width:100%;resize:vertical;height:30px;">' . strtoupper($inWords)   . '</textarea>
									</td>
									<td style="font-size:13px;border-bottom:2px solid black;border-top:2px solid black;width:110px;text-align:right;font-weight:bold;padding-right:5px;">' . number_format($gTotal,2) . '</td>
								</tr>
							</table>';
						 
			$sheet .= 	'<table border = "0" style = "width:100%;padding-bottom:0px;border-left:2px solid black;border-right:2px solid black;">
							<tr>
								<td style="width:50px;font-size:12px;padding-left:5px;">Purpose</td>
								<td style="border-bottom:1px solid black;"><input value = "' . $p1 .'"  style = "width:100%;border:0;padding:0px;font-size:11px;"/></td>
						    </tr>
						    <tr>
								<td ></td>
								<td style="border-bottom:0px solid black;"><input value = "' . $p2 .'"  style = "width:100%;border:0;padding:0px;font-size:11px;"/></td>
						    </tr>
						 </table>';
				   
			$sheet .= '<table border = "0" style ="font-size:12px; border-spacing:0; margin:0 auto;width:100%;border:2px solid black;border-top:0;">
							<tr>
								<td style = "border:2px solid black;border-left:0;"></td>
								<td style = "width:250px;border-right:2px solid black;border-bottom:2px solid black;border-top:2px solid black;text-align:center;">Requested by:</td>
								<td style= "border-right:2px solid black;border-bottom:2px solid black;text-align:center;border-top:2px solid black;">Cash availability</td>
								<td style= "text-align:center;border-top:2px solid black;border-bottom:2px solid black;border-right:0;">Approved by:</td>
							</tr>
							';
							
			
			
		  	$sheet .=  '<tr>
								<td style = "border-bottom:0px solid black;border-right:2px solid black;padding-top:30px;width:80px;padding-left:10px;">
									<input value ="Signature" style = "font-family:Arial; font-size:10px;border:0;width:100%;"/>
									<input value ="Printed Name"  style = "border:0;font-family:Arial; font-size:10px;width:100%;"/>
									<input value ="Designation"  style = "border:0;font-family:Arial; font-size:10px;width:100%;"/>
									
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									
								</td>
								<td style = "border-bottom:0px solid black;border-right:2px solid black;padding-top:60px;">
									
									<input  style = "font-family:Arial; font-size:10px;width:100%;border:0;text-align:center;"/>
									<input value ="' . $r1 . '" style = "font-family:Arial; font-size:10px;font-weight:bold;width:100%;border:0;text-align:center;"/>
									<input value ="' . $r2 . '"  style = "width:100%;border:0;text-align:center;font-family:Arial; font-size:11px;"/>
									</br>
									</br><span style = "font-size:10px;">&nbsp;Controlled/charged to:<span style = "font-weight:bold;">' . $programs . '</span></span>
									</br><span style = "font-size:10px;">&nbsp;Fund Acct. Code:<span style = "font-weight:bold;">' . $accountCode . '</span></span>
									<input value ="' . $o1 . '" style = "font-family:Arial; font-size:10px;font-weight:bold;width:100%;border:0;text-align:center;margin-top:25px;"/>
									<input value ="Fund Controller"  style = "width:100%;border:0;text-align:center;font-family:Arial; font-size:10px;"/>
									
									
									
								</td>
								<td style = "border-bottom:0px solid black;border-right:2px solid black;padding-top:50px;">
									
									<input style = "font-family:Arial; font-size:10px;width:100%;border:0;text-align:center;"/>
									<input value ="ERWIN P. ALPARAQUE" style = "font-family:Arial; font-size:10px;font-weight:bold;width:100%;border:0;text-align:center;"/>
									<input value ="Acting City Treasurer"  style = "width:100%;border:0;text-align:center;font-family:Arial; font-size:11px;"/>
									
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									
									
								</td>
								<td style = "border-bottom:0px solid black;padding-top:50px;">
									
									<input  style = "font-family:Arial; font-size:10px;width:100%;border:0;text-align:center;"/>
									<input value ="' . $a1 . '" style = "font-family:Arial; font-size:10px;font-weight:bold;width:100%;border:0;text-align:center;"/>
									<input value ="' . $a2 . '"  style = "width:100%;border:0;text-align:center;font-family:Arial; font-size:11px;"/>
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									</br>
									
									
								</td>
							</tr>';					
							
							
		
				
		 		$sheet .= '</table><div style = "font-size:8px;">Original copy; Green copy for City Treasurer\'s Office; Blue copy for City Accounting Office; Pink copy for City General Services Office; White copy for the Requisitioning Dept.</div>';		   
			
			
			  return $sheet;
		}
		
		
		//-----------------------------------------------------------OBR Form
		
		// function CreateFormOBR($record,$trackingNumber,$officeName,$payee){
		// 	$programCode = array();
		// 	$programName = array(); 
		// 	$codes = array();
		// 	$amount = array();
		// 	$accountTitles =array();
		// 	$h1 = '<table style ="width:100%;border-spacing:0;" border ="0">
		// 				<tr>
		// 					<td style= "width:140px;padding-bottom:10px;"><div id = "logo"></div></td>
		// 					<td style ="text-align:center;">
		// 						<div style ="width:445px;border:">
		// 							<div style = "font-size:20px;font-weight:bold;">Republic of the Philippines</div>
		// 							<div style = "font-size:16px;">City Government of Davao</div>
		// 						</div>
		// 					</td>
		// 				</tr>
		// 				<tr>
		// 					<td colspan ="2" style = "font-size:18px;border-top:2px solid black;border-bottom:2px solid black;text-align:center;font-weight:bold;">
		// 						OBLIGATION REQUEST<span style = "margin-left:130px;margin-top:-28px;right;position:absolute;font-weight:normal;"><font style = "font-size:12px;">DocTrack</font> 2022</span>
		// 					</td>
		// 				</tr>
		// 			</table>';
		// 	$type = '';
		// 	$sub = 0;
		// 	while($data = $this->fetch_array($record)){
		// 		$obr = $data['OBR_Number'];
		// 		$subCode = $data['SubCode'];
		// 		$type = $data['TrackingType'];
		// 		$address = $data['Address'];
		// 		$particulars = $data['OBRParticulars'];
				
				
		// 		if($subCode > 0){
		// 			$sub = $subCode;
		// 		}
		// 		 array_push($programCode, $data['PR_ProgramCode']);
		// 		 array_push($programName, $data['ProgramName']);
		// 		 if($type == "PO"){
		// 		 	 array_push($amount, $data['PO_Amount']);
		// 		 	 $officeName = '';
		// 		 }else{
		// 		 	 $address = '';
		// 		 	 array_push($amount, $data['Amount']);
		// 		 }
				
		// 		 array_push($codes, $data['PR_AccountCode']);
		// 		 array_push($accountTitles, $data['Title']); 
		// 		 $type = $data['ChargeType'];
		// 		 $periodMonth = $data['PeriodMonth'];
			
		// 	}
		// 	$h2 = '<table style ="width:100%;border-spacing:0;font-size:13px;border-top:1px solid black;border-bottom:1px solid black;margin-top:2px;padding-bottom:4px;" border ="0">
		// 				<tr>
		// 					<td style ="width:65px;padding-left:5px;">Payee :</td>
		// 					<td style = "border-bottom:2px solid black;">' . strtoupper($payee) .'</td>
		// 					<td style = "width:155px;border-left:0px solid black;border-bottom:2px solid black;padding-left:5px;">
		// 						&nbsp;&nbsp;&nbsp;TN No <span style = "font-weight:bold;padding-left:5px;font-size:14px;text-overflow:nowrap;white-space: nowrap;" id="trackingNum">' . $trackingNumber .'</span>
		// 					</td>
		// 				</tr>
		// 				<tr>
		// 					<td style ="padding-left:5px;">Office :</td>
		// 					<td style = "border-bottom:2px solid black;"><input style = "width:100%;border:0px;" value = "' . $officeName .'"/></td>
		// 					<td style = "border-bottom:2px solid black;border-left:0px solid black;vertical-align:top;padding-left:5px;">
		// 						OBR No <span style = "font-weight:bold;padding-left:5px;font-size:15px;">' . $obr . '</span>
		// 					</td>
		// 				</tr>
		// 				<tr>
		// 					<td style ="padding-left:5px;" >Address :</td>
		// 					<td colspan = "2"style = ";"><input style = "width:100%;border:0px;" value = "' . $address . '"/></td>
		// 				</tr>
						
		// 			</table>';	
			
		// 	$des = '';
		// 	if($sub > 0){
		// 		$sql = "select * from subprogramcode where SubCode = '" . $sub . "'";
		// 		$record = $this->query($sql);
		// 		$data = $this->fetch_array($record);
		// 		$des = $data['Description'];
		// 	}
			
		// 	$h3 = '<table style = "width:100%;border-top:1px solid black;border-bottom:1px solid black;border-spacing:0;margin-top:1px;" border="0">
		// 			 <tr style = "font-size:12px;font-weight:bold;">
		// 				<td style = "width:80px;border-right:2px solid black;padding:5px;text-align:center;">Responsibility Center</td>
		// 				<td style = "width:50px;text-align:center;border-right:2px solid black;padding:5px;">F.P.P</td>
		// 				<td style = "width:250px;border-right:2px solid black;padding:5px;padding-left:30px;">Particulars</td>
						
		// 				<td style ="width:70px;text-align:center;border-right:2px solid black;padding:5px;">Account Code</td>
		// 				<td style ="width:70px;text-align:center;padding:5px;">Amount</td>
		// 			  <tr>';
				  
			
		// 	$header = '';
		// 	for($i = 0; $i < sizeof($amount);$i++){
				
		// 		if($header != $programCode[$i]){
		// 			$h3 .= '<tr style ="font-size:12px;">';
		// 			$h3 .= '	<td colspan = "3" style = "text-align:left;font-weight:bold;border-top:2px solid black;border-right:2px solid black;padding:2px;padding-left:15px;">' . $programCode[$i] . ' &nbsp;<span style = "font-weight:normal;"> ' .   $programName[$i]  . '</span></td>';
		// 			//$h3 .= '	<td style = "font-weight:bold;border-top:2px solid black;border-right:2px solid black;padding:0px;" colspan = "2"><input style = "font-weight:bold;padding-left:5px;width:100%;border:0;" value = "' . $programName[$i] . '"/></td>';
		// 			$h3 .= '	<td style ="border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>';
		// 			$h3 .= '	<td style ="border-top:2px solid black;;">&nbsp;</td>';
		// 			$h3 .= '</tr>';
		// 			$header = $programCode[$i];
		// 		}
		// 		$h3 .= '<tr style ="font-size:12px;">';
		// 		$h3 .= '	<td colspan = "3"  style ="text-align:left;border-top:2px solid black;border-right:2px solid black;border-top:2px solid black;padding:0"><input style = "padding-left:80px;width:100%;border:0;" value = "' . $accountTitles[$i]. '"/></td>';
		// 		$h3 .= '	<td style ="text-align:center;border-top:2px solid black;border-right:2px solid black;border-top:2px solid black;font-weight:bold;">'. $codes[$i] .'</td>';
		// 		$h3 .= '	<td style ="font-size:13px;text-align:right;border-top:2px solid black;border-top:2px solid black;padding-right:10px;font-weight:bold;">'. number_format($amount[$i],2) .'</td>';
		// 		$h3 .= '</tr>';
		// 	}
		// 	if($type ==3){
		// 		$i = $i * 2 -1;
		// 	}
		// 	for($j = 0; $j < (13-$i); $j++ ){
		// 			$h3 .= '<tr>';
		// 			$h3 .= '	<td colspan = "3" style = "border-top:2px solid black;border-right:2px solid black;"><input style = "border:0;width:100%;" /></td>';
		// 			//$h3 .= '	<td style = "border-top:2px solid black;border-right:2px solid black;"><input style = "width:100%;" /></td>';
		// 			$h3 .= '	<td style = "border-top:2px solid black;border-right:2px solid black;"></td>';
		// 			$h3 .= '	<td style = "border-top:2px solid black;">&nbsp;</td>';
		// 			$h3 .= '<tr>';
		// 	}
		// 	$h3 .= '<tr><td colspan = "2" style = "border-top:2px solid black;border-right:0px solid black;"></td>
		// 				<td style = "border-top:2px solid black;border-right:2px solid black;font-family:Oswald;text-align:right;font-weight:bold;padding-right:10px;letter-spacing:1px;">' . $des . '</td>
		// 				<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
		// 				<td style = "border-top:2px solid black;">&nbsp;</td>
		// 			</tr>';
		// 	$h3 .= '<tr  style = "font-size:12px;">
		// 				<td colspan ="3" rowspan = "3" style = "border-top:2px solid black;border-right:2px solid black;">
		// 					<div style = "padding-left:5px;">Particulars: <span id="showSaving" class="saving1" style="display: none;">SAVING</span></div>
		// 					<textarea id="obrParticulars" style = "overflow:hidden; resize:none;padding:0px 10px;;width:100%;height:50px;border:0;" onkeyup="checkBeforeSave()" onclick="checkBeforeSave()"> ' . $particulars . ' </textarea>
						
		// 				</td>
		// 				<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
		// 				<td style = "border-top:2px solid black;">&nbsp;</td>
		// 			</tr>';
		// 	$h3 .= '<tr style = "font-size:12px;">
		// 				<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
		// 				<td style = "border-top:2px solid black;">&nbsp;</td>
		// 			</tr>';
		// 	$h3 .= '<tr style = "font-size:12px;">
		// 				<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
		// 				<td style = "border-top:2px solid black;">&nbsp;</td>
		// 			</tr>';	
		// 	$h3 .= '<tr style = "font-size:12px;font-weight:bold;">';
		// 	$h3 .= '	<td colspan = "3" style = "padding:7px;border-top:2px solid black;color:grey;">COMPUTER GENERATED FORM <span style ="letter-spacing:2px;font-size :10px;font-style:italic;"> '  .  substr(strrev($trackingNumber),0,1) . substr(array_sum($amount),0,2)  . ' </font></td>';
		// 	$h3 .= '	<td  style = "padding:7px;padding-right:5px;text-align:right;border-top:2px solid black;">Total</td>';
		// 	$h3 .= '	<td style ="font-size:13px;text-align:right;padding:7px;border-top:2px solid black;font-weight:bold;padding-right:10px;">' .  number_format(array_sum($amount),2) . '</td>';
		// 	$h3 .= '<tr>';
		// 	$h3 .= '</table>';
		// 	if(isset($_COOKIE['obrCertifiedBy'])){
		// 		$obrCertifiedBy =$_COOKIE['obrCertifiedBy'];
		// 	}else{
		// 		$obrCertifiedBy = '';
		// 	}
		// 	if(isset($_COOKIE['obrCertifiedDesignation'])){
		// 		$obrCertifiedDesignation =$_COOKIE['obrCertifiedDesignation'];
		// 	}else{
		// 		$obrCertifiedDesignation = '';
		// 	}
		// 	$h4 ='<table style = "border-top:1px solid black;border-bottom:1px solid black;margin-top:1px;border-spacing:0;padding-bottom:1px;"><tr>
		// 			<td >
		// 				<table style ="border-spacing:0;">
		// 					<tr>
		// 						<td style = "width:50%;border-right:1px solid;vertical-align:top;">
		// 							<table style ="border-spacing:0;font-size:12px;" border="0">
		// 								<tr>
		// 									<td>A.Certified:</td>
		// 									<td></td>
		// 								</tr>
		// 								<tr>
		// 									<td><div style = "border:1px solid;">&nbsp;</div></td>
		// 									<td>Charges to appropriation/allotment necessary, lawful, and under my direct supervision.</td>
		// 								</tr>
		// 								<tr>
		// 									<td><div style = "border:1px solid;">&nbsp;</div></td>
		// 									<td>Supporting documents valid, proper, and legal.</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan = "2" style = "padding:17px 0px;"></td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan = "2" style = "font-weight:bold; padding:10px;text-align:center;padding-bottom:0px;">
		// 										<input style = "font-family:arial;font-weight:bold; width:300px;font-size:12px;border:0;text-align:center;" placeholder="Type name" value = "' . $obrCertifiedBy . '" onkeyup = "setToCookieName(this)"/><br/>
												
		// 										<input style = "width:300px;font-size:12px;text-align:center;border:0;" placeholder="Type position"  value = "' . $obrCertifiedDesignation . '" onkeyup = "setToCookieDesignation(this)" />
												
		// 										<input style = "width:100%;margin-top:10px;font-weight:bold;font-size:11px;border:0;"/>
		// 										<input style = "width:100%;font-size:11px;border:0;"/>
											
		// 									</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan = "2" style = "">
		// 										Date:<input style = "display:inline-block;font-size:12px; border:0;"  value = ""  />
		// 									</td>
		// 								</tr>
										
		// 							</table>	
		// 						<td/>
		// 						<td style = "width:50%;border:0px solid;vertical-align:top;">
		// 							<table style = "width:100%; font-size:12px;border-spacing:0; " border="0">
		// 								<tr>
		// 									<td colspan="2">B.Certified:</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan="2">&nbsp;</td>
											
		// 								</tr>
		// 								<tr>
		// 									<td style = "width:80px;">&nbsp;</td>
		// 									<td >Existence of available appropriation</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan="2" style = "padding:20px 0px;">&nbsp;</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan = "2" style = "font-weight:bold; padding:10px;text-align:center;">
		// 										ERMELINDA F. GALLEGO<br/><span style = "font-weight:normal;" >CITY BUDGET OFFICER</span>
		// 									</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan="2" style = "padding:0px 0px;">Date</td>
		// 								</tr>
		// 								<tr>
		// 									<td colspan="2" style = "padding:0px 0px;">CBO Transaction No.:</td>
		// 								</tr>
		// 							</table>	
		// 						<td/>
								
		// 					</tr>
		// 				</table>
		// 			</td>
		// 		</tr>
		// 		<tr>
		// 			<td  style = "border-top:2px solid black;border-bottom:1px solid black;font-size:8px;padding:0px 0px;padding:2px;" valign="top">
		// 				While(original) to be attached to the Disbursement voucher; Pink Copy for CBO; Yellow Copy for Accounting;
		// 				 and Green Copy for Concerned Office.
		// 			</td>
		// 		</tr></table>';
			
			
			
		// 	$form = '<div style = "border:2px solid black;border-bottom:0px solid black; width:670px;margin:0 auto;">';	
		// 	$form .=  $h1;	
		// 	$form .=  $h2;	
		// 	$form .=  $h3;
		// 	$form .=  $h4;
		// 	$form .= '</div>';
		// 	return $form;
			
		// }	
		

		function CreateFormOBR($newRecord){
			$h1 = '<table style ="width:100%;border-spacing:0;" border ="0">
						<tr>
							<td style= "width:140px;padding-bottom:10px;"><div id = "logo"></div></td>
							<td style ="text-align:center;">
								<div style ="width:445px;border:">
									<div style = "font-size:20px;font-weight:bold;">Republic of the Philippines</div>
									<div style = "font-size:16px;">City Government of Davao</div>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan ="2" style = "font-size:18px;border-top:2px solid black;border-bottom:2px solid black;text-align:center;font-weight:bold;">
								OBLIGATION REQUEST<span style = "margin-left:130px;margin-top:-28px;right;position:absolute;font-weight:normal;"><font style = "font-size:12px;">DocTrack</font> 2023</span>
							</td>
						</tr>
					</table>';

			$trackingNumber = $newRecord['TrackingNumber'];
			$obr = $newRecord['OBR_Number'];
			$claimant = $newRecord['Claimant'];
			$subCode = $newRecord['SubCode'];
			$trackingType = $newRecord['TrackingType'];
			$chargeType = $newRecord['ChargeType'];
			$periodMonth = $newRecord['PeriodMonth'];
			$officeCode = $newRecord['Office'];
			$officeName = $newRecord['OfficeName'];
			$total = $newRecord['TotalAmountMultiple'];
			$payee = $newRecord['Payee'];
			$subTitle = $newRecord['SubTitle'];
			$address = $newRecord['Address'];
			$particulars = $newRecord['OBRParticulars'];
			$grp = $newRecord['GRP'];

			$h2 = '<table style ="width:100%;border-spacing:0;font-size:13px;border-top:1px solid black;border-bottom:1px solid black;margin-top:2px;padding-bottom:4px;" border ="0">
						<tr>
							<td style ="width:65px;padding-left:5px;">Payee :</td>
							<td style = "border-bottom:2px solid black;">' . strtoupper($payee) .'</td>
							<td style = "width:155px;border-left:0px solid black;border-bottom:2px solid black;padding-left:5px;">
								&nbsp;&nbsp;&nbsp;TN No <span style = "font-weight:bold;padding-left:5px;font-size:14px;text-overflow:nowrap;white-space: nowrap;" id="trackingNum">' . $trackingNumber .'</span>
							</td>
						</tr>
						<tr>
							<td style ="padding-left:5px;">Office :</td>
							<td style = "border-bottom:2px solid black;"><input style = "width:100%;border:0px;" value = "' . $officeName .'"/></td>
							<td style = "border-bottom:2px solid black;border-left:0px solid black;vertical-align:top;padding-left:5px;">
								OBR No <span style = "font-weight:bold;padding-left:5px;font-size:15px;">' . $obr . '</span>
							</td>
						</tr>
						<tr>
							<td style ="padding-left:5px;" >Address :</td>
							<td colspan = "2"style = ";"><input style = "width:100%;border:0px;" value = "' . $address . '"/></td>
						</tr>
						
					</table>';	
			
			$h3 = '<table style = "width:100%;border-top:1px solid black;border-bottom:1px solid black;border-spacing:0;margin-top:1px;" border="0">
					 <tr style = "font-size:12px;font-weight:bold;">
						<td style = "width:80px;border-right:2px solid black;padding:5px;text-align:center;">Responsibility Center</td>
						<td style = "width:50px;text-align:center;border-right:2px solid black;padding:5px;">F.P.P</td>
						<td style = "width:250px;border-right:2px solid black;padding:5px;padding-left:30px;">Particulars</td>
						
						<td style ="width:70px;text-align:center;border-right:2px solid black;padding:5px;">Account Code</td>
						<td style ="width:70px;text-align:center;padding:5px;">Amount</td>
					  <tr>';

			$header = '';
			$grp1 = explode('*',$grp);

			for ($i=0; $i < sizeof($grp1); $i++) { 
				$grp2 = explode('~', $grp1[$i]);
				$prg = $grp2[0];
				$acc = $grp2[1];
				$amount = $grp2[2];
				$total = $grp2[3];
				$prgTitle = $grp2[4];
				$accTitle = $grp2[5];

				if($header != $prg){
					$h3 .= '<tr style ="font-size:12px;">';
					$h3 .= '	<td colspan = "3" style = "text-align:left;font-weight:bold;border-top:2px solid black;border-right:2px solid black;padding:2px;padding-left:15px;">' . $prg . ' &nbsp;<span style = "font-weight:normal;"> ' .   $prgTitle  . '</span></td>';
					$h3 .= '	<td style ="border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>';
					$h3 .= '	<td style ="border-top:2px solid black;;">&nbsp;</td>';
					$h3 .= '</tr>';
					$header = $prg;
				}

				$h3 .= '<tr style ="font-size:12px;">';
				$h3 .= '	<td colspan = "3"  style ="text-align:left;border-top:2px solid black;border-right:2px solid black;border-top:2px solid black;padding:0"><input style = "padding-left:80px;width:100%;border:0;" value = "' . $accTitle . '"/></td>';
				$h3 .= '	<td style ="text-align:center;border-top:2px solid black;border-right:2px solid black;border-top:2px solid black;font-weight:bold;">'. $acc .'</td>';
				$h3 .= '	<td style ="font-size:13px;text-align:right;border-top:2px solid black;border-top:2px solid black;padding-right:10px;font-weight:bold;">'. number_format($amount,2) .'</td>';
				$h3 .= '</tr>';
			}

			if($chargeType == 3){
				$i = $i * 2 -1;
			}


			$projectId = $newRecord['ProjectId'];
			$projectName = $newRecord['ProjectName'];

			if(strlen($projectName) > 0) {

				for($j = 0; $j < (11-$i); $j++ ){
					$h3 .= '<tr>';
					$h3 .= '	<td colspan = "3" style = "border-top:2px solid black;border-right:2px solid black;"><input style = "border:0;width:100%;" /></td>';
					$h3 .= '	<td style = "border-top:2px solid black;border-right:2px solid black;"></td>';
					$h3 .= '	<td style = "border-top:2px solid black;">&nbsp;</td>';
					$h3 .= '</tr>';
				}

				$h3 .= '<tr>';
				$h3 .= '	<td rowspan="2" colspan = "3" style = "border-top:2px solid black;border-right:2px solid black; font-size:13px; padding:3px 5px; vertical-align:top;">('.$projectId.') '.$projectName.'</td>';
				$h3 .= '	<td style = "border-top:2px solid black;border-right:2px solid black;"></td>';
				$h3 .= '	<td style = "border-top:2px solid black;">&nbsp;</td>';
				$h3 .= '</tr>';
				$h3 .= '<tr>';
				$h3 .= '	<td style = "border-top:2px solid black;border-right:2px solid black;"></td>';
				$h3 .= '	<td style = "border-top:2px solid black;">&nbsp;</td>';
				$h3 .= '</tr>';

			}else {

				for($j = 0; $j < (13-$i); $j++ ){
						$h3 .= '<tr>';
						$h3 .= '	<td colspan = "3" style = "border-top:2px solid black;border-right:2px solid black;"><input style = "border:0;width:100%;" /></td>';
						$h3 .= '	<td style = "border-top:2px solid black;border-right:2px solid black;"></td>';
						$h3 .= '	<td style = "border-top:2px solid black;">&nbsp;</td>';
						$h3 .= '<tr>';
				}

			}



			unset($grp1);
			unset($grp2);

			$h3 .= '<tr><td colspan = "2" style = "border-top:2px solid black;border-right:0px solid black;"></td>
						<td style = "border-top:2px solid black;border-right:2px solid black;font-family:Oswald;text-align:right;font-weight:bold;padding-right:10px;letter-spacing:1px;">' . $subTitle . '</td>
						<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
						<td style = "border-top:2px solid black;">&nbsp;</td>
					</tr>';
			$h3 .= '<tr  style = "font-size:12px;">
						<td colspan ="3" rowspan = "3" style = "border-top:2px solid black;border-right:2px solid black;">
							<div style = "padding-left:5px;">Particulars: <span id="showSaving" class="saving1" style="display: none;">SAVING</span></div>
							<textarea id="obrParticulars" style = "overflow:hidden; resize:none;padding:0px 10px;;width:100%;height:50px;border:0;" onkeyup="checkBeforeSave()" onclick="checkBeforeSave()"> ' . $particulars . ' </textarea>
						
						</td>
						<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
						<td style = "border-top:2px solid black;">&nbsp;</td>
					</tr>';
			$h3 .= '<tr style = "font-size:12px;">
						<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
						<td style = "border-top:2px solid black;">&nbsp;</td>
					</tr>';
			$h3 .= '<tr style = "font-size:12px;">
						<td style = "border-top:2px solid black;border-right:2px solid black;">&nbsp;</td>
						<td style = "border-top:2px solid black;">&nbsp;</td>
					</tr>';	
			$h3 .= '<tr style = "font-size:12px;font-weight:bold;">';
			$h3 .= '	<td colspan = "3" style = "padding:7px;border-top:2px solid black;color:grey;">COMPUTER GENERATED FORM <span style ="letter-spacing:2px;font-size :10px;font-style:italic;"> '  .  substr(strrev($trackingNumber),0,1) . substr($total,0,2)  . ' </font></td>';
			$h3 .= '	<td  style = "padding:7px;padding-right:5px;text-align:right;border-top:2px solid black;">Total</td>';
			$h3 .= '	<td style ="font-size:13px;text-align:right;padding:7px;border-top:2px solid black;font-weight:bold;padding-right:10px;">' .  number_format($total,2) . '</td>';
			$h3 .= '<tr>';
			$h3 .= '</table>';
			if(isset($_COOKIE['obrCertifiedBy'])){
				$obrCertifiedBy =$_COOKIE['obrCertifiedBy'];
			}else{
				$obrCertifiedBy = '';
			}
			if(isset($_COOKIE['obrCertifiedDesignation'])){
				$obrCertifiedDesignation =$_COOKIE['obrCertifiedDesignation'];
			}else{
				$obrCertifiedDesignation = '';
			}
			$h4 ='<table style = "border-top:1px solid black;border-bottom:1px solid black;margin-top:1px;border-spacing:0;padding-bottom:1px;"><tr>
					<td >
						<table style ="border-spacing:0;">
							<tr>
								<td style = "width:50%;border-right:1px solid;vertical-align:top;">
									<table style ="border-spacing:0;font-size:12px;" border="0">
										<tr>
											<td>A.Certified:</td>
											<td></td>
										</tr>
										<tr>
											<td><div style = "border:1px solid;">&nbsp;</div></td>
											<td>Charges to appropriation/allotment necessary, lawful, and under my direct supervision.</td>
										</tr>
										<tr>
											<td><div style = "border:1px solid;">&nbsp;</div></td>
											<td>Supporting documents valid, proper, and legal.</td>
										</tr>
										<tr>
											<td colspan = "2" style = "padding:17px 0px;"></td>
										</tr>
										<tr>
											<td colspan = "2" style = "font-weight:bold; padding:10px;text-align:center;padding-bottom:0px;">
												<input style = "font-family:arial;font-weight:bold; width:300px;font-size:12px;border:0;text-align:center;" placeholder="Type name" value = "' . $obrCertifiedBy . '" onkeyup = "setToCookieName(this)"/><br/>
												
												<input style = "width:300px;font-size:12px;text-align:center;border:0;" placeholder="Type position"  value = "' . $obrCertifiedDesignation . '" onkeyup = "setToCookieDesignation(this)" />
												
												<input style = "width:100%;margin-top:10px;font-weight:bold;font-size:11px;border:0;"/>
												<input style = "width:100%;font-size:11px;border:0;"/>
											
											</td>
										</tr>
										<tr>
											<td colspan = "2" style = "">
												Date:<input style = "display:inline-block;font-size:12px; border:0;"  value = ""  />
											</td>
										</tr>
										
									</table>	
								<td/>
								<td style = "width:50%;border:0px solid;vertical-align:top;">
									<table style = "width:100%; font-size:12px;border-spacing:0; " border="0">
										<tr>
											<td colspan="2">B.Certified:</td>
										</tr>
										<tr>
											<td colspan="2">&nbsp;</td>
											
										</tr>
										<tr>
											<td style = "width:80px;">&nbsp;</td>
											<td >Existence of available appropriation</td>
										</tr>
										<tr>
											<td colspan="2" style = "padding:20px 0px;">&nbsp;</td>
										</tr>
										<tr>
											<td colspan = "2" style = "font-weight:bold; padding:10px;text-align:center;">
												ERMELINDA F. GALLEGO<br/><span style = "font-weight:normal;" >CITY BUDGET OFFICER</span>
											</td>
										</tr>
										<tr>
											<td colspan="2" style = "padding:0px 0px;">Date</td>
										</tr>
										<tr>
											<td colspan="2" style = "padding:0px 0px;">CBO Transaction No.:</td>
										</tr>
									</table>	
								<td/>
								
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td  style = "border-top:2px solid black;border-bottom:1px solid black;font-size:8px;padding:0px 0px;padding:2px;" valign="top">
						While(original) to be attached to the Disbursement voucher; Pink Copy for CBO; Yellow Copy for Accounting;
						 and Green Copy for Concerned Office.
					</td>
				</tr></table>';
			
			
			
			$form = '<div style = "border:2px solid black;border-bottom:0px solid black; width:670px;margin:0 auto;">';	
			$form .=  $h1;	
			$form .=  $h2;	
			$form .=  $h3;
			$form .=  $h4;
			$form .= '</div>';
			return $form;
			
		}
		
		
		//--------------------------------------------------------------------------------------------- para ni sa  mag Add og PO
		function CreateTableItemsPPMP1($record,$month){ 
			
			if (preg_match_all("/\b(Jan|Feb|March)\b/i",$month,$matches)) { 
				$matches = array_unique($matches[0]);
								
				$quarter = "1st Quarter";
				
			}else if (preg_match_all("/\b(Apr|May|June)\b/i",$month,$matches)) { 
				
				$quarter = "2nd Quarter";
			}else if (preg_match_all("/\b(July|Aug|Sept)\b/i",$month,$matches)) { 
				
				$quarter = "3rd Quarter";
			}else if (preg_match_all("/\b(Oct|Nov|December)\b/i",$month,$matches)) { 
				
				$quarter = "4th Quarter";
			} 
			 
			$sheet0 = '<table style = "border-spacing:0;" id = "tableContentPO" border= "0">';
			$sheet2 = '<tr>
							<td class = "tdHeader3" style="padding:10px;">&nbsp;</td>
							<td class = "tdHeader3" style="padding:10px;">Unit</td>
							<td class = "tdHeader3" style="padding:10px;">Description</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">Qty</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;;">Unit&nbsp;Cost</td>
							<td class = "tdHeader3" style="padding:10px;">Amount</td>
						</tr>';
					   $gTotal = 0;	
					   $sheet3 = '';
					   $program = '';
					   $i = 0;
					   while($data = $this->fetch_array($record)){
					   		
							if($program != $data['ProgramCode']){
								$program = $data['ProgramCode'];
								$i++;
							}
							if($i > 1){
								$program = "Multiple";
							}
							
							$programCode = $data['ProgramCode'];
							$fundX =1;
							//$fundX = $data['Fund'];
							
							$qty = $data[$month];
							$qtyYear = $data['Quantity'];
							
							$estBudget  = $data['EstimatedBudget'];
							$tCost = ($estBudget  / $qtyYear) * $qty;
							$cost = ($estBudget  / $qtyYear) ;
							$gTotal = $gTotal + $tCost;
							
							
							$sheet1 = '<tr>
										    <td colspan="6" style = "border-bottom:1px solid silver;padding:5px 0px;">
												<span  class = "label1" style ="font-weight:normal; margin-right:20px;">Fund : ' . $fundX . '</span><br/>
												<span  class = "label1" style ="font-weight:normal; margin-right:20px;">Program Code : <span id = "prProgramCode">' . $program . '</span>
												
												
												<br/> Account Code : <span id = "prAccountCode">' . $data['AccountCode'] . '</span>
												<br/> Category Code : <span id = "prCategoryCode">' . $data['CategoryCode'] . '</span></span>
												<span class = "label1" style ="font-weight:normal;float:right;color:rgb(81, 185, 214)">' . $quarter . '</span>
													
											</td>
											
									   </tr>';
					   		$sheet3 .= '<tr>
											<td class = "tdHeader3" style="padding:10px;"><input id = "poFund' . $programCode . '" type = "checkbox" onclick = "computeTotal(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;">' . $data['QuantityUnit'] . '</td>
											<td class = "tableDataRows3" style="padding:10px;"><textarea class = "text1" style = "height:50px;font-size:14px; width:350px;">' . $data['ItemName'] . ' - ' . $data['ItemDescription'] . '</textarea></td>
											<td class = "tableDataRows3" style="padding:10px;"><input id ="m1" class = "text2" style = "width:50px;text-align:center;" value = "' . $qty . '" onkeyup = "calculate(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;"><input id ="m2" class = "text2" value = "' . $cost . '" onkeyup = "calculate(this)"/></td>
											<td id ="m3" class = "tableDataRows3" style="padding:10px;text-align:right;">' . number_format($tCost,2) . '</td>
									   </tr>';
					   }
			$sheet4 = '<tr>
							<td colspan="5" class = "tableDataRows31" style="padding:10px;text-align:right;">Total<input id = "gTotal" type = "hidden" value = ' . $gTotal . '></td>
							<td id = "m4" class = "tableDataRows31" style="font-weight:bold;padding:10px;text-align:right;">0.00</td>
					  </tr></table>';
			return $sheet0.  $sheet1 . $sheet2 .  $sheet3 .$sheet4;
		}
		function CreateTableItemsPPMPonPO($record,$month){ // para ni sa  mag View sa PO details
			$quarter = '';
			if (preg_match_all("/\b(Jan|Feb|March)\b/i",$month,$matches)) { 
				$matches = array_unique($matches[0]);
								
				$quarter = "1st Quarter";
				
			}else if (preg_match_all("/\b(Apr|May|June)\b/i",$month,$matches)) { 
				
				$quarter = "2nd Quarter";
			}else if (preg_match_all("/\b(July|Aug|Sept)\b/i",$month,$matches)) { 
				
				$quarter = "3rd Quarter";
			}else if (preg_match_all("/\b(Oct|Nov|December)\b/i",$month,$matches)) { 
				
				$quarter = "4th Quarter";
			} 
			$sheet0 = '<table id = "tableContent" border= "0">';
			$sheet2 = '<tr>
							<td class = "tdHeader3" style="padding:10px;">Fund</td>
							<td class = "tdHeader3" style="padding:10px;">Qty</td>
							<td class = "tdHeader3" style="padding:10px;">Unit</td>
							<td class = "tdHeader3" style="padding:10px;">Description</td>
							<td class = "tdHeader3" style="padding:10px;">Unit Cost</td>
							<td class = "tdHeader3" style="padding:10px;">Amount</td>
						</tr>';
					   $gTotal = 0;	
					   
					   $sheet3 = '';
					   while($data = $this->fetch_array($record)){
					   		$qty = $data["Qty"];
							$unit = $data["Unit"];
							$amount  = $data['Amount'];
							$total = $qty * $amount;
							$gTotal = $gTotal + $total;
							
							$programCode = $data['ProgramCode'];
							$accountCode = $data['PR_AccountCode'];
							$categoryCode = urldecode($data['PR_CategoryCode']);
							$description = $data['Description'];
							$type = $data['TrackingType'];
							

							$sheet1 = '<tr>
										    <td colspan="6" style = "border-bottom:1px solid silver;padding:5px 0px;padding-top:20px;">
												<span  class = "label2" style =" margin-right:20px;">' . $type . ' Details:</span>
											</td>
									   </tr>';
					   		$sheet3 .= '<tr>
											<td class = "tableDataRows3" style="padding:10px;">' . $programCode . '</td>
											<td class = "tableDataRows3" style="padding:10px;">' . $qty . '</td>
											<td class = "tableDataRows3" style="padding:10px;">' . $unit . '</td>
											<td class = "tableDataRows3" style="padding:10px;">' . $description . '</td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;">' . number_format($amount,2) . '</td>
											<td class = "tableDataRows3" style="padding:10px;text-align:right;">' . number_format($total,2) . '</td>
									   </tr>';
					   }
			$sheet4 = '<tr>
							<td colspan="5" class = "tableDataRows31" style="padding:10px;text-align:right;">Total</td>
							<td id = "prTotal" class = "tableDataRows31" style="font-weight:bold;padding:10px;text-align:right;">' . number_format($gTotal,2) . '</td>
					  </tr></table>';
			return $sheet0.  $sheet1 . $sheet2 .  $sheet3 . $sheet4;
			
		}
		
		// function CreateAIRTrackerInfo($record){ // Inventory 
		// 	$grp = '';
		// 	$logOffice = $_SESSION['gso'];
		// 	$acct = $_SESSION['accountType'];
		// 	if($_SESSION['accountType'] >= 2){
		// 		$className = 'label19';
		// 	}else{
		// 		$className = 'hide';	
		// 	}	
		// 	while($data = $this->fetch_array($record)){
				
		// 		$trackingType = $data['TrackingType'];
		// 		$trackingNumber = $data['TrackingNumber'];
				
		// 		$status = $data['Status'];
				
		// 		$year = $data['Year'];
		// 		$office = $data['Office'];
		// 		$officeName = $data['Name'];
					
				
		// 		$trackingPartner = $data['TrackingPartner'];
				 
		// 		$prTrackingNumber = $data['PR_TrackingNumber'];
		// 		$prNumber = $data['PR_Number'];
		// 		$poNumber = $data['PO_Number'];
		// 		//$arNumber = $data['ARNumber'];
		// 		$arNumber = '';
		// 		$obrNumber = $data['OBR_Number'];
		// 		$prMonth =  $data['PR_Month'];
		// 		$controlNo = $data['ControlNo'];
		// 		$netAmount = $data['NetAmount'];
				
				
		// 		$periodType  = $data['PeriodType'];
		// 		if($periodType == 2){
		// 			$netAmount = $data['Amount'];
		// 		}
		// 		$payeeNumber = $data['PayeeNumber']; 
				
				
				
				
		// 		$fund = $data['Fund'];
		// 		$total = $data['TotalAmountMultiple'];
		// 		if($trackingType == "PO"){
		// 			$amount = $data['PO_Amount'];
					
		// 			if($total > 0){
		// 				$poAmount = $total;
						
		// 			}else{
						
		// 				$poAmount = $amount;
		// 			}
		// 		}else{
		// 			$amount = $data['Amount'];
		// 			$poAmount = $amount;
		// 		}
				
				
		// 		$pendingNote =  $data['Remarks'];
		// 		$claimant =  strtoupper($data['Claimant']);
		// 		$claimType  = $data['ClaimType'];
				
		// 		$checkNumber  = $data['checknumber'];
		// 		$checkDate  = $data['checkdate'];
				
				
		// 		$docType  = $data['DocumentType'];
		// 		$adv =  $data['ADV1'];
		// 		$adv2 =  $data['ADV2'];
		// 		if($adv < 1  ){
		// 			$adv = '';
		// 			if($acct == 4 ){
		// 				$adv = '';
		// 				if($status == "CBO Received" || $status == "Encoded" || $status == "GSO Received"){
		// 			   		//$adv = '99999';
		// 			   	}
		// 			}
		// 			if($acct == 5 ){
		// 				$adv = 99999;
		// 				if($status == "CBO Received" || $status == "Encoded"){
		// 			   		$adv = '0';
		// 			   	}
		// 			}
		// 			if($acct == 9 ){
		// 				if($docType == 'LTO COMPUTER FEE'){
		// 					$adv = $data['ADV2'] . 'a' ;
		// 				}
		// 			}	
		// 		}
		// 		$periodType = $data['PeriodType'];
		// 		$periodValue = $data['PeriodMonth'];
		// 		$document  = $data['DocumentType'];
		// 		$category =  $data['PR_CategoryCode'];
		// 		$categoryName =  $data['CategoryName'];
				
		// 		$programCode = $data['PR_ProgramCode'];
		// 		$programName = $data['ProgramName'];
		// 		$accountCode = $data['PR_AccountCode'];
		// 		$title = $data['Title'];
		// 		$chargeType = $data['ChargeType'];
		// 		if($trackingType == "PO"){
		// 			$prData = urlencode($year . '~' . $office . '~' . $officeName . '~' . $category .'~' . $prMonth . '~' . $categoryName . '~' . $prTrackingNumber);	
					
		// 		}else{
		// 			$prData = urlencode($year . '~' . $office . '~' . $officeName . '~' . $category .'~' . $prMonth . '~' . $categoryName . '~' . $trackingNumber );	
		// 		}
				
		// 		$encodedBy = utf8_encode($data['FirstName'] . ' ' . $data['MiddleName'] . ' ' . $data['LastName'] );
		// 		$dateEncoded = $data['DateEncoded'];
		// 		$dateUpdated = $data['DateModified'];
		// 		$completion = $data['Completion'];
		// 		$mode = $data['ModeOfProcurement'];
		// 		$grp .= $programCode . '~' . $accountCode . '~' . $amount . '~' . $total . '~' .$programName . '~' . $title . '*';
		// 	}

		// 	if($trackingType == "PR"){
		// 		$record1 =  $this->SearchPRrecord($trackingNumber);
				
		// 	}else if($trackingType == "PO"){

		// 		$record1 =  $this->SearchPOrecord($trackingNumber);

		// 		$record1a = $this->SearchPOrecord($trackingNumber);

		// 		$sql = "Select a.PR_ProgramCode,a.PR_AccountCode,a.Amount,a.TotalAmountMultiple ,b.Name as ProgramName,c.Title as Title  from vouchercurrent  a 
		// 			   left join programcode b on a.PR_ProgramCode = b.code
		// 			   left join fundtitles c on a.PR_AccountCode = c.Code
		// 			    where a.trackingnumber = '" . $prTrackingNumber . "' order by PR_ProgramCode, PR_AccountCode asc";
		// 		$record2  = $this->FetchThis($sql);
		// 		$grp = '';
		// 		while($data = $this->fetch_array($record2)){
		// 			$programCode = $data['PR_ProgramCode'];
		// 			$accountCode = $data['PR_AccountCode'];
		// 			$amount = $data['Amount']; 
		// 			$total = $data['TotalAmountMultiple'];
		// 			$programName = $data['ProgramName'];
		// 			$title= $data['Title'];
		// 			$grp .= $programCode . '~' . $accountCode . '~' . $amount . '~' . $total . '~' .$programName . '~' . $title . '*';
		// 		}
		// 	}
		// 	$t1 = '';
		// 	$t2 = '';
		// 	if($trackingType != "PY"){
		// 		$className = $this->permissionClass($acct,$logOffice,$trackingType,$status,$office);	
		// 		$t1 = $this->CreateSlider($trackingType,$status,$claimType,$mode);
		// 		// $t2 = $this->AIRPOinfo($checkNumber, $checkDate,$trackingType,$status,$officeName,$poNumber,$arNumber,$prNumber,$obrNumber,$className,$trackingNumber,$prTrackingNumber,$prMonth,$adv,$claimType,$claimant,$grp,$prData,$record1,$pendingNote,$encodedBy,$dateEncoded,$dateUpdated,$completion,$fund,$prMonth,$poAmount,$office,$netAmount,$programCode,$record1a);	
		// 	}else{
		// 		$className = 'hide';
		// 		$t1 = $this->CreateSlider($trackingType,$status,$claimType,$mode);
		// 		// $t2 = $this->AIRinfo($checkNumber, $checkDate, $trackingType,$status,$officeName,$obrNumber,$className,$trackingNumber,$adv,$claimant,$grp,$pendingNote,$encodedBy,$dateEncoded,$dateUpdated,$completion,$fund,$docType,$claimType,$periodValue,$amount,$netAmount,$payeeNumber,$periodType,$trackingPartner,$office,$programCode,$controlNo);
		// 	}

		// 	return $t1 .  '*v*'  .  $t2; 
			
		// }

		// function CreateCategoryPISItemsEdit($record){		
		// 	//$office = $_SESSION['gso'];
		// 	//$acct = $_SESSION['accountType'];
		// 	//$acct  = 7;	
		// 	//$office = 1061;

		// 	$sheet = '<table id = "prItemsTable" style = "border-spacing:0; border:0; font-family:oswald" border ="0">';
		// 	$sheet .= '<tr class ="dataHeader1">';
		// 	$sheet .= '<td style = "padding:5px 10px;font-size:18px; background-color:grey;">&nbsp;</td>
		// 				<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Code</td>
		// 				<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Description</td>
						
		// 				<td  colspan = "5"  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Qty x Price</td>
		// 				<td  style = "padding:5px 10px;font-size:22px; background-color:rgb(108, 111, 113);">&nbsp;</td>'; //onclick = "AddPRItem(this)
		// 	$sheet .= '</tr>';	 //<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">&nbsp;</td>
		// 	$i = 1;
		// 	$totalAmount = 0;
		// 	//$x=0;
		// 	$Counter = 0;
		// 	$TempDesc = '';
		// 	$iDisplay = 0;
		// 	$sheetEdit = '';
		// 	$finalAmount = 0;
		// 	$programO = '';

		// 	$setString = '';
		// 	$check = 0;
		// 	$setEmptyStr = '';
		// 	while($data = $this->fetch_array($record)){
				
		// 		$id = $data['Id'];
		// 		$trackingNumber = $data['TrackingNumber'];
		// 		$trackingType = substr($trackingNumber,0,2);
		// 		$amount =  $data['Amount'];
		// 		$total = $data['Total'];
				

		// 		$qty =  intval($data['Qty']);
		// 		$unit =  $data['Unit'];
		// 		$desc =  $data['Description'];
		// 		$program =  $data['ProgramCode'];
		// 		$code =  $data['Code'];
		// 		$category = $data['Category'];
		// 		$totalAmount = $totalAmount + $total;
				
		// 		$set =  $data['Setter'];

		// 		if ($unit == 'Set/s') {
		// 			if ($set == ''){
		// 				$set = '';
		// 			} else {
		// 				$set = 'Set ' . $set;
		// 			}
		// 		}
				

		// 		$item = $data['Item'];
		// 		$itemDescription = $data['ItemDescription'];
		// 		$serialNumber  = $data['SerialNumber'];
		// 		$propertyNumber  = $data['PropertyNumber'];
		// 		$classificationNumber  = $data['ClassificationNumber'];


		// 		$sheet .= '<tr  style = "background-color:rgb(206, 215, 218);">';

		// 		$sheeti = '<td style = "padding:10px 10px;vertical-align:top;">';
		// 		$sheeti1 = '<span class = "number" style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">';
		// 		$sheeti1a = '</span>';
		// 		$sheeti2 = '</td>';

		// 		$sheet1  = '<td style = "width:450px;padding:10px 10px;">';
		// 		$sheet2  = '<table id="piRecordTableList" style="width:100%; font-family:Oswald; border-spacing:0;" border ="0">';

		// 		$sheet2a =	'	<tr>
		// 							<td style="padding:5px 10px;font-size:16px; background-color:transparent; text-align:left; font-weight:bold">';
		// 		$sheet2a1 = '		</td>
		// 						</tr>';

	
		// 		$sheet2b  ='	<tr style="color:black">
		// 							<td style="padding:5px 10px;font-size:16px; background-color:transparent; text-align:left; width:150px">'.$item . ' ' .$itemDescription . '</td>
		// 							<td style="padding:5px 10px;font-size:16px; background-color:transparent; text-align:left; width:115px">'.$serialNumber.'</td>
		// 							<td style="padding:5px 10px;font-size:16px; background-color:transparent; text-align:left; width:115px">'.$propertyNumber.'</td>
		// 							<td style="padding:5px 10px;font-size:16px; background-color:transparent; text-align:left; width:115px">'.$classificationNumber.'</td>
		// 						</tr>
		// 					</table>
		// 					</td>';

		// 		$sheet3 = '<td style = "padding:10px 10px;vertical-align:top;">';			
		// 		$sheetprogramAndCode = '<input class = "data1"  onclick = "clickInput(this)"  style = "font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;color:black;" value ="' . $program . '" disabled/>
		// 				   <input class = "data1"  onclick = "clickInput(this)" style = "color:black;display:block;font-size:14px;width:80px;border:0;background-color:transparent;" value = "' . $code . '" disabled/></td>';
		// 		$sheet3a = '</td>';				



		// 		$sheet4 = '<td style = "width:10px;">';
		// 		$sheetQtyPriceUnit = '<input class = "data1"  onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value = "' . $qty . '" maxlength = "8" 
		// 								style = "color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:16px;border-bottom:1px solid silver;background-color:transparent;padding:2px;" disabled/>
		// 						   		<br/>
		// 							   <input class = "data1"  onclick = "clickInput(this)" value = "' . $unit . '" style = " font-size:16px;border:0;background-color:transparent; text-align:center;width:85px;" disabled/>';
		// 		$sheet4a = '</td>';


		// 		$sheet5 = '<td style = "padding:0 10px">';
		// 		$sheetX  ='x';
		// 		$sheet5a = '</td>';

		// 		$sheet6 = '<td style = "padding:0 2px">';
		// 		$sheetAmout = '<input class = "data1"  onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value  = ' . number_format($amount,2) . '  
		// 								style = "color:rgb(45, 90, 118);text-align:left;font-weight:bold;width:90px;border:0;font-size:16px;
		// 								background-color:transparent;padding:2px;" disabled/>';
		// 		$sheet6a = '</td>';

		// 		$sheet7 = '<td style = "width:20px">';
		// 		$sheetEqual = '=';
		// 		$sheet7a = '</td>';


		// 		$sheet8  = '<td style = "padding:0 5px">';
		// 		$sheetTotal ='<input class = "data1" value = ' . number_format($total,2) . ' disabled 
		// 					  style = " width:105px;text-align:left;color:black;border:0;font-size:17px;padding:5px; 2px;font-weight:bold;"/>';
		// 		$sheet8a = '</td>';

		// 		$sheet9 = '<td style = "background-color:rgb(222, 228, 231); padding:5px 10px;font-size:22px; "></td>';
		// 		//$sheetEdit = '<td style = "background-color:rgb(222, 228, 231); padding:5px 10px;font-size:22px; cursor:pointer;"  onclick="showPISList(this,'.$program.')" id="updateItemNumber' . $id . '">+</td>';


			

		// 		if($Counter == 0) {
		// 			$TempDesc = $desc;
		// 			$programO = $program;  
		// 			$setString =  $set;
		// 			$iDisplay = $iDisplay + 1; 
		// 			$sheet .= $sheeti . $sheeti1 . $i++ . $sheeti1a . $sheeti2;
		// 			$sheet .= $sheet3 . $sheetprogramAndCode . $sheet3a;
		// 			$sheet .= $sheet1 . $TempDesc . $sheet2 . $sheet2a . $setString . $sheet2a1 . $sheet2b;
		// 			$sheet .= $sheet4 . $sheetQtyPriceUnit . $sheet4a;
		// 			$sheet .= $sheet5 . $sheetX . $sheet5a;
		// 			$sheet .= $sheet6 . $sheetAmout . $sheet6a;
		// 			$sheet .= $sheet7 . $sheetEqual . $sheet7a;
		// 			$sheet .= $sheet8 . $sheetTotal . $sheet8a;
		// 			$finalAmount = $finalAmount + $total;
		// 			//$sheet .= $sheetEdit;
		// 			$sheet .= '<td style = "background-color:rgb(222, 228, 231); padding:5px 10px;font-size:22px; cursor:pointer;"  onclick="showPISList(this,'.$iDisplay.')" id="updateItemNumber' . $id . '">+</td>';
		// 			}else {
		// 			if ($programO != $program || $TempDesc != $desc) {
		// 				$TempDesc = $desc;
		// 				$programO = $program;
		// 				$setString = $set;
		// 				$iDisplay = $iDisplay + 1; 
		
		// 				$sheet .= $sheeti . $sheeti1 . $i++ . $sheeti1a . $sheeti2;
		// 				$sheet .= $sheet3 . $sheetprogramAndCode . $sheet3a;
		// 				//$sheet .= $sheet1 . $TempDesc . $sheet2 . $sheet2b;
		// 				$sheet .= $sheet1 . $TempDesc . $sheet2 . $sheet2a . $setString . $sheet2a1 . $sheet2b;
		// 				$sheet .= $sheet4 . $sheetQtyPriceUnit . $sheet4a;
		// 				$sheet .= $sheet5 . $sheetX . $sheet5a;
		// 				$sheet .= $sheet6 . $sheetAmout . $sheet6a;
		// 				$sheet .= $sheet7 . $sheetEqual . $sheet7a;
		// 				$sheet .= $sheet8 . $sheetTotal . $sheet8a;
		// 				$finalAmount = $finalAmount + $total;
		// 				//$sheet .= $sheetEdit;
		// 				$sheet .= '<td style = "background-color:rgb(222, 228, 231); padding:5px 10px;font-size:22px; cursor:pointer;"  onclick="showPISList(this,'.$iDisplay.')" id="updateItemNumber' . $id . '">+</td>';
					

		// 			} else{
								

		// 					if($setString!= $set) { 
		// 						$setString = $set;
		// 						$setEmptyStr = $sheet2a . $setString . $sheet2a1;
		// 					} else { 
		// 						$setString = '';
		// 						$setEmptyStr = '';
		// 					}

		// 				    $sheet .= $sheeti . $sheeti2;
		// 					$sheet .= $sheet3 . $sheet3a;
		// 					$sheet .= $sheet1 . $sheet2 . $setEmptyStr . $sheet2b;
		// 					$sheet .= $sheet4 . $sheet4a;
		// 					$sheet .= $sheet5 . $sheet5a;
		// 					$sheet .= $sheet6 . $sheet6a;
		// 					$sheet .= $sheet7 . $sheet7a;
		// 					$sheet .= $sheet8 . $sheet8a;
		// 					$sheet .= $sheet9;

		// 					$setString = $set;
		// 			}
				
		
		// 		}





		// 		$sheet .= '</tr>';



		// 		$Counter++;

		// 	}
		// 		$sheet .= '<tr>';
		// 		$sheet .= '<td colspan = "7"></td><td colspan ="2"  style = "padding:2px  10px;padding-right:20px;">
		// 				   <input class = "data1" id ="totalAmountItems" value = ' . number_format($finalAmount,2) . ' disabled 
		// 				   style = "font-size:20px;border:0;background-color:transparent;width:120px;text-align:right;font-weight:bold;letter-spacing:1px;color:red;"/>
		// 				   <input class = "data1" id ="categoryId" value = "' . $category . '" hidden />	
		// 				   </td>';
		// 		$sheet .= '</tr></table>';

		// 		$sheet .= '<div style = "width:60px;font-size:16px;display:inline-block;margin-right:10px;" class  = "button1" onclick = "cancelEditPIS(this)" id = "editPIS' . $trackingNumber  .'">Cancel</div>';

				
		// 	return $sheet .  '*v*'  ;		

		// }	


		// function CreatePIRrecordList($record,$record1,$rowNumber,$record2){
		// 	$office = $_SESSION['gso'];
		// 	$acct = $_SESSION['accountType'];

		// 	$sheetItems = '';
		// 	$sheet = '';

		// 	$sheet .= '<table id = "pIStemsTable" style = "border-spacing:0; border:0; font-family:oswald" border ="0">
		// 					<tr class ="dataHeader1">
		// 						<td style = "padding:5px 10px;font-size:18px; background-color:grey;">&nbsp;</td>
		// 						<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Code</td>
		// 						<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Description</td>
		// 						<td  colspan = "5"  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Qty x Price</td>
		// 						<td  style = "padding:5px 10px;font-size:22px; background-color:rgb(108, 111, 113);">&nbsp;</td>
		// 					</tr>';

		// 	while ($data1 = $this->fetch_array($record1)) {
		// 		$program =  $data1['ProgramCode'];
		// 		$code =  $data1['Code'];
		// 		$desc =  $data1['Description'];
		// 		$qty =  intval($data1['Qty']);
		// 		$unit =  $data1['Unit'];
		// 		$amount =  $data1['Amount'];
		// 		$total = $data1['Total'];
		// 	}				
		// 	$sheet .=	'<tr  style = "background-color:rgb(206, 215, 218);">
		// 					<td style = "padding:10px 10px;vertical-align:top;">
		// 						<span class = "number" style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">'.$rowNumber.'</span>
		// 					</td>
		// 					<td style = "padding:10px 10px;vertical-align:top;">
		// 						<input class = "data1"  onclick = "clickInput(this)"  style = "font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;color:black;" value ="' . $program . '" disabled/>
		//    						<input class = "data1"  onclick = "clickInput(this)" style = "color:black;display:block;font-size:14px;width:80px;border:0;background-color:transparent;" value = "' . $code . '" disabled/></td>
		// 					</td>
		// 					<td style = "width:450px;padding:10px 10px;">'.$desc.'</td>
		// 					<td style = "width:10px;">
		// 						<input class = "data1"  onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value = "' . $qty . '" maxlength = "8" 
		// 						style = "color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:16px;border-bottom:1px solid silver;background-color:transparent;padding:2px;" disabled/>
		// 			   			<br/>
		// 				   		<input class = "data1"  onclick = "clickInput(this)" value = "' . $unit . '" style = " font-size:16px;border:0;background-color:transparent; text-align:center;width:85px;" disabled/>
		// 					</td>
		// 					<td style = "padding:0 10px">x</td>
		// 					<td style = "padding:0 2px">
		// 						<input class = "data1"  onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value  = ' . number_format($amount,2) . '  
		// 						style = "color:rgb(45, 90, 118);text-align:left;font-weight:bold;width:90px;border:0;font-size:16px;
		// 						background-color:transparent;padding:2px;" disabled/>
		// 					</td>
		// 					<td style = "width:20px">=</td>
		// 					<td style = "padding:0 5px">
		// 						<input class = "data1" value = ' . number_format($total,2) . ' disabled 
		// 	  					style = " width:105px;text-align:left;color:black;border:0;font-size:17px;padding:5px; 2px;font-weight:bold;"/>
		// 					</td>
		// 					<td style = "background-color:rgb(222, 228, 231); padding:5px 10px;font-size:22px; "></td>
		// 				</tr>';

		// 	$sheet .= '	</table>';

		// 	$sheet .= '<div>&nbsp;</div>';			

		// 	$sheet .= '<div align="right">';
		// 	$sheet .= '<table id="piRecordTable" style="font-family:Oswald; border-spacing:0;" border ="0">';
		// 	$sheet .= '	<tr class ="dataHeader1">';
		// 	$sheet .= '		<td style="padding:5px 10px;font-size:16px; background-color:grey;">&nbsp;</td>';
		// 	$sheet .= '		<td style="padding:5px 4px; font-size:16px; background-color:rgb(121, 137, 141);">Set</td>';
		// 	$sheet .= '		<td style="padding:5px 10px;font-size:16px;background-color:rgb(121, 137, 141);">Item</td>';
		// 	$sheet .= '		<td style="padding:5px 10px;font-size:16px;background-color:rgb(121, 137, 141);">Description</td>';
		// 	$sheet .= '		<td style = "padding:5px 10px;font-size:16px;background-color:rgb(121, 137, 141);">Serial Number</td>';
		// 	$sheet .= '		<td style = "padding:5px 10px;font-size:16px;background-color:rgb(121, 137, 141);">Property Number</td>';
		// 	$sheet .= '		<td style = "padding:5px 10px;font-size:16px;background-color:rgb(121, 137, 141);">Classification Number</td>';
		// 	$sheet .= '		<td style = "padding:5px 10px;font-size:16px; background-color:rgb(108, 111, 113); text-align:center; font-weight:bold; cursor:pointer;" onclick = "pisAddRow(this)">+</td>';
		// 	$sheet .= '	</tr>';

		// 	$i=1;
		// 	$itemsArray = array();
		// 	while($data = $this->fetch_array($record2)) {
		// 		$items = $data['Description'];
		// 		$itemsArray[$i] = $items;
		// 		$i = $i +1;
		// 	}
	


		// 	$rowCount = 1;
		// 	while($data = $this->fetch_array($record)) {
		// 		$trackingNumber = $data['TrackingNumber'];
		// 		$itemNumber = $data['ItemNumber'];
		// 		$item= $data['Item'];
		// 		$itemDescription = htmlspecialchars($data['ItemDescription']);
		// 		$serialNumber  = $data['SerialNumber'];
		// 		$propertyNumber  = $data['PropertyNumber'];
		// 		$classificationNumber  = $data['ClassificationNumber'];
		// 		$set = $data['Setter'];
		// 		$sheet .= '<tr style="background-color:rgb(206, 215, 218)">';

		// 		$sheet .= '	<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;"><span class = "number" style ="padding:2px;font-size:14px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px; font-weight:normal">'.$rowCount++.'</span></td>';
		// 		//$sheet .= '	<td style="border-bottom:2px solid white;"><input class = "data1"  style = " font-size:16px; border:0;background-color:transparent;color:black;" onclick = "this.style.backgroundColor=\'white\';" value ="1" /></td>';
 	// 			$sheet .= '	<td style="border-bottom:2px solid white; width:20px"><input class="data1" style="border:0; background-color:transparent;font-size:16px; width:25px; text-align:c"  onclick = "this.style.backgroundColor=\'white\';"  value="'.$set.'" /> </td>';
 	// 			//$sheet .= '	<td style="border-bottom:2px solid white;"><input class="data1" style="border:0; background-color:transparent;font-size:16px"  onclick = "this.style.backgroundColor=\'white\';"  value="'.$itemDescription.'" /> </td>';
 	// 			//$sheet .= '	<td style="border-bottom:2px solid white;">'.$sheetItems.'</td>';
 	// 			$sheet .= '	<td style="border-bottom:2px solid white;">';
 	// 			$sheet .= '		<select  class="select2" id = "pisItems" style="font-family:Oswald; color:black">';
 	// 										$sheet .= '<option></option>';	
		//  							foreach($itemsArray as $key => $value){
		//  								if ($value == $item){
		//  									$sheet .= '<option value= "'.$value.'" selected>'.$value.'</option>';				
		//  								} else {
		//  									$sheet .= '<option value= "'.$value.'">'.$value.'</option>';
		//  								}
		//  							}
 	// 			$sheet .= '		</select>';			
 	// 			$sheet .= ' </td>';
 	// 			$sheet .= '	<td style="border-bottom:2px solid white;"><input class="data1" style="border:0; background-color:transparent;font-size:16px"  onclick = "this.style.backgroundColor=\'white\';"  value="'.$itemDescription.'" /> </td>';
 	// 			$sheet .= '	<td style="border-bottom:2px solid white;"><input class="data1" style="border:0; background-color:transparent;font-size:16px"  onclick = "this.style.backgroundColor=\'white\';"  value="'.$serialNumber.'" /> </td>';
		// 		$sheet .= '	<td  style="border-bottom:2px solid white;"><input class="data1" style="border:0; background-color:transparent;font-size:16px" onclick = "this.style.backgroundColor=\'white\';"  value="'.$propertyNumber.'" /></td>'; 
		// 	    $sheet .= '	<td  style="border-bottom:2px solid white;"><input class="data1" style="border:0; background-color:transparent;font-size:16px" onclick = "this.style.backgroundColor=\'white\';"  value="'.$classificationNumber.'" /></td>'; 
				
	
		// 		if($office == '1081' and $acct >1 ){
		// 			$sheet .= '	<td style = "background-color:rgb(222, 228, 231); padding:5px 10px; border-bottom:2px solid white; border-left:1px solid white; border-right:1px solid white"><input disabled type = "checkbox" checked/></td>';
		// 		}else{
		// 			$sheet .= '	<td style = "background-color:rgb(222, 228, 231); padding:5px 10px; border-bottom:2px solid white; border-left:1px solid white; border-right:1px solid white"><input type = "checkbox" checked></td>';
		// 		}		 
			
		// 		$sheet .= '</tr>';	
		// 	}

			

		// 	$sheet .= '<tr><td colspan="6" style="font-size:20"><div>&nbsp;</div></td></tr>';

		// 	$sheet .= '</table>';

		// 	$sheet .= '</div>';

		// 	$sheet1 = '<div style = "width:60px;font-size:16px;display:inline-block;margin-right:10px;" class  = "button1" onclick = "editPIS(this)" id = "pisEditz' . $trackingNumber . '">Cancel</div>
		// 		 	   <div style = "width:60px;font-size:16px;display:inline-block;" class  = "button1" id = "ItemNumber' . $itemNumber .'" onclick = "updatePIS(this)" >Update</div>
		// 			   <input id = "pisTrackingNumber" type = "hidden" value = "'.$trackingNumber.'">';

		// 	return $sheet .  $sheet1  . '*v*'  ;
		// }



		//--------------------------------------------------------------------------------------------------------------------Doctrack update
		function CreateDoctrackInfoPR($record){
			$grp = '';
			$logOffice = $_SESSION['gso'];
			$acct = $_SESSION['accountType'];
			if($_SESSION['accountType'] >= 2){
				$className = 'label19';
			}else{
				$className = 'hide';	
			}	
			
			$trackingType = $record['TrackingType'];
			$trackingNumber = $record['TrackingNumber'];
			$status = $record['Status'];
			$year = $record['Year'];
			$office = $record['Office'];
			$officeName = $record['OfficeName'];
			$trackingPartner = $record['TrackingPartner'];
			$prTrackingNumber = $record['PR_TrackingNumber'];
			$prNumber = $record['PR_Number'];
			$poNumber = $record['PO_Number'];
			$obrNumber = $record['OBR_Number'];
			$prMonth =  $record['PR_Month'];
			$controlNo = $record['ControlNo'];
			$netAmount = $record['NetAmount'];
			$periodType  = $record['PeriodType'];
			$payeeNumber = $record['PayeeNumber']; 
			$fund = $record['Fund'];
			$total = $record['TotalAmountMultiple'];
			$amount = $record['PO_Amount'];
			$poAmount = $amount;
			$pendingNote =  $record['Remarks'];
			$remarksNote =  $record['Remarks1'];
			$claimant =  strtoupper($record['Claimant']);
			$claimType  = $record['ClaimType'];
			$checkNumber  = $record['CheckNumber'];
			$checkDate  = $record['CheckDate'];
			$docType  = $record['DocumentType'];
			$adv =  $record['ADV'];
			$subCode = $record['SubCode'];
			$peorOfc = $record['PeaceOfficeId'];
			$periodType = $record['PeriodType'];
			$periodValue = $record['PeriodMonth'];
			$document  = $record['DocumentType'];
			$category =  $record['PR_CategoryCode'];
			$categoryName =  $record['CategoryName'];
			$chargeType = $record['ChargeType'];
			$complex = $record['Complex'];
			$prData = $record['PR_Data'];	
			
			$encodedBy = utf8_encode($record['EncodedBy']);
			$dateEncoded = $record['DateEncoded'];
			$dateUpdated = $record['DateModified'];
			$completion = $record['Completion'];
			$mode = $record['ModeOfProcurement'];
			$batchTracking = $record['BatchTracking']; 
			$grp = $record['GRP'];
			$programCode = $record['PR_ProgramCode'];
			$conformDate = $record['ConformDate'];
			$nature = $record['NatureOfPayment'];
			$specifics = $record['Specifics'];

			$caoOfficerId = $record['CAOOfficer'];
			$caoOfficer = $record['CAOOfficerName'];

			$forDrrmo = $record['ForDRRMO'];
			$drrmo = $record['DRRMO'];

			// 2022-07-11 -> added because 
			$variation = '';

			$variation1 = 0;
			$variation2 = 0;
			$variationOBR2 = "";
			
			$nf ='';
			$remark = '';
			$mxBatchNumber = '';
			if($trackingType == "PR"){
				$record1 =  $this->SearchPRrecord($trackingNumber);
			
			}else if($trackingType == "PO"){
				$record1 =  $this->SearchPOrecord($trackingNumber);
				
			}else if($trackingType == "PX"){
				$record1 =  $this->SearchPXrecord($trackingNumber);
				
			}else if($trackingType == "NF"){
				$sql = "SELECT * FROM infra WHERE TrackingNumber = '".$trackingNumber."' LIMIT 1";
				$record = $this->query($sql);
				$data = $this->fetch_array($record);
				
				$batchNumber = $data['BatchNumber'];
				$location = utf8_encode($data['Location']);
				$duration = $data['Duration'];
				$remark = $data['Remarks'];
				$mode = $data['Mode'];
				$started =  $data['Started'];
				$completed =  $data['Completed'];
				$programmer =  $data['Programmer'];
				$inspector =  $data['Inspector'];
				$checker =  $data['Checker'];
				$surveyor =  $data['Surveyor'];
				$draftsman =  $data['Draftsman'];
				$extension =  $data['Extension'];
				$barangay =  $data['Barangay'];
				$variation =  $data['Variation'];
				$variationOBR =  $data['VariationObr'];
				$variation1 =  $data['Variation1'];
				$variation2 =  $data['Variation2'];
				$variationOBR2 =  $data['VariationObr2'];
				
				$sql = "SELECT * FROM programcode WHERE TrackingNumberInfra = '".$trackingNumber."' LIMIT 1";
				$record = $this->query($sql);
				$data = $this->fetch_array($record);
				$fundYear = $data['FundYear'];
				$name = $data['Name'];
				$entry = $data['Entry'];
				$lump = $data['Lump'];
				$code = $data['Code'];
				$amount = $data['Amount'];
				$expenseCode = $data['ExpenseCode'];
				
				$fundName = '';
				if(strlen($lump) > 0){
					$code = $lump;
					$sql = "SELECT Name FROM programcode WHERE Code = '". $code ."' LIMIT 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					$fundName = $data['Name'];
				}
				
				$sql = "SELECT Title FROM fundtitles WHERE Code = '" . $expenseCode . "' LIMIT 1";
				$record = $this->query($sql);
				$data = $this->fetch_array($record);
				$title = $data['Title'];
				
				$nf = $batchNumber . '*!*' .  $location . '*!*' .  $duration . '*!*' .  $mode . '*!*' .  $name . '*!*' .  $entry  . '*!*' .  $code . '*!*' 
					.  $amount . '*!*' .  $fundYear . '*!*' .  $fundName . '*!*' .  $title . '*!*' .  $expenseCode . '*!*' .  $title  
					. '*!*' . $claimant . '*!*' . $started . '*!*' . $completed . '*!*' . $programmer . '*!*' . $inspector . '*!*' . $extension . '*!*' . $barangay . '*!*' . $variationOBR
					. '*!*' . $checker . '*!*' . $surveyor . '*!*' . $draftsman . '*!*' . $variation1 . '*!*' . $variation2 . '*!*' . $variationOBR2;
			}else if($trackingType == 'IP') {

				$sql = "SELECT BatchNumber FROM particulars WHERE TrackingNumber = '" . $trackingNumber . "' LIMIT 1";
				$record = $this->query($sql);
				$data = $this->fetch_array($record);
				$mxBatchNumber = $data['BatchNumber'];

			}
				
			
			$t1 = '';
			if($trackingType == "PR" || $trackingType == "PO" || $trackingType == "PX"){
				$className = $this->permissionClass($acct,$logOffice,$trackingType,$status,$office);	
				
				$t1 = $this->CreateSlider($trackingType,$status,$claimType,$mode,$fund,$docType);

				$t2 = $this->PRPOinfo($complex,$subCode,$checkNumber, $checkDate,$trackingType,$status,$officeName,$poNumber,$prNumber,$obrNumber,$className,$trackingNumber,$prTrackingNumber,$prMonth,$adv,$claimType,$claimant,$grp,$prData,$record1,$pendingNote,$encodedBy,$dateEncoded,$dateUpdated,$completion,$fund,$prMonth,$poAmount,$office,$netAmount,$programCode,$trackingPartner,$conformDate,$nature,$specifics,$drrmo,$forDrrmo,$remarksNote);	
				
			}else{
				$className = 'hide';
				$t1 = $this->CreateSlider($trackingType,$status,$claimType,$mode,$fund,$docType);
				$t2 = $this->PYinfo($complex,$batchTracking,$subCode,$checkNumber, $checkDate, $trackingType,$status,$officeName,$obrNumber,$className,$trackingNumber,$adv,$claimant,$grp,$pendingNote,$encodedBy,$dateEncoded,$dateUpdated,$completion,$fund,$docType,$claimType,$periodValue,$amount,$netAmount,$payeeNumber,$periodType,$trackingPartner,$office,$programCode,$controlNo,$nf,$remark,$peorOfc,$year,$variation,$conformDate,$caoOfficerId,$caoOfficer,$mxBatchNumber,$variation1,$variation2,$variationOBR2,$drrmo,$forDrrmo,$remarksNote);
			}
			return $t1 .  '*v*'  .  $t2; 
			
		}
		
		function CreateSlider($trackingType,$status,$claimType,$mode,$fund,$docType){
			
			$sheet = '';

			if($trackingType == "PO"){
				$array = array(

					"1*Tracking - Office" => 'Encoded', 
					"2*Received - GSO" => 'GSO Received', 
					"x*GSO Pending" => 'Pending at GSO',
					"x*Pending Released - GSO" => 'Pending Released - GSO',

					"3*Received - Admin" => 'Admin Received', 
					"x*Pending at Admin" => 'Pending at Admin', 
					"x*Pending Released - Admin" => 'Pending Released - Admin',  

					"4*PO Signed - Admin" => 'PO Signed',
					"5*Serve to Supplier - Admin" => 'Serve to Supplier',
					"6*Supplier Conformed - GSO" => 'Supplier Conformed',
												
					"7*Appropriation Recording - CBO" => 'Fund Control',
					"x*Pending at CBO" => 'Pending at CBO', 
					"x*Pending Released - CBO" => 'Pending Released - CBO', 

					"8*Payment Preparation - Office" => 'Waiting for Delivery',

				);
			}

			// if($trackingType == "PY"){
			// 	if(strtoupper($claimType) == "CHECK"){
			// 		if($docType != 'BOND - RETENTION MONEY') {
			// 			$array = array(
							
			// 				"1*Encoded" => 'Encoded', 
			// 				"2*CBO Received" => 'CBO Received', 
			// 				"x*Pending at CBO" => 'Pending at CBO', 
			// 				"x*Pending Released - CBO" => 'Pending Released - CBO', 
			// 				"3*CBO Released" => 'CBO Released', 
			// 				"4*Accounting Received" => 'CAO Received',
			// 				"x*Pending at CAO" => 'Pending at CAO', 
			// 				"x*Pending Released - CAO" => 'Pending Released - CAO', 
			// 				"5*Carded - Accounting" => 'Carded - Accounting',
			// 				"6*SLP Created - Accounting" => 'SLP Created - Accounting',
			// 				"7*Released - CAO" => 'Forwarding Transmittal',
							
			// 				"8*Check Preparation" => 'Check Preparation - CTO'
							
			// 			);
						
			// 			if($status == "Forwarded to Admin - Operation"){
							
			// 				$array["9*Check for Signature"] = 'Forwarded to Admin - Operation';
			// 				$array["10*Check Advised"] = 'Check Advised';
							
			// 			}else if($status == "Forwarded to Admin - Administration"){
			// 				$array["9*Check for Signature"] = 'Forwarded to Admin - Administration';
			// 				$array["10*Check Advised"] = 'Check Advised';
			// 			}else if($status == "Forwarded to SP - Admin"){
			// 				$array["9*Check for Signature"] = 'Forwarded to SP - Admin';
			// 				$array["10*Check Advised"] = 'Check Advised';
			// 			}else{
			// 				$array["9*Check for Signature"] = '';
			// 				$array["10*Check Advised"] = 'Check Advised';
			// 			}
			// 			$array["11*Check Released"] = 'Check Released';
			// 		}else {
			// 			$array = array(
			// 					"1*Encoded" => 'Encoded', 
			// 					"2*Accounting Received" => 'CAO Received',
			// 					"x*Pending at CAO" => 'Pending at CAO', 
			// 					"x*Pending Released - CAO" => 'Pending Released - CAO', 
			// 					"3*CAO Released" => 'CAO Released');
			// 		}
					
					
			// 	}else if(strtoupper($claimType) == "WINDOW"){
			// 		$array = array(
			// 				"1*Encoded" => 'Encoded', 
			// 				"2*CBO Received" => 'CBO Received', 
			// 				"x*Pending at CBO" => 'Pending at CBO', 
			// 				"x*Pending Released - CBO" => 'Pending Released - CBO', 
			// 				"3*CBO Released" => 'CBO Released', 
			// 				"4*Accounting Received" => 'CAO Received',
			// 				"x*Pending at CAO" => 'Pending at CAO', 
			// 				"x*Pending Released - CAO" => 'Pending Released - CAO', 
			// 				"5*Forwarded to CTO" => 'Forwarded to CTO');
			// 	}else{
			// 		$array = array(
			// 				"1*Encoded" => 'Encoded', 
			// 				"2*Accounting Received" => 'CAO Received',
			// 				"x*Pending at CAO" => 'Pending at CAO', 
			// 				"x*Pending Released - CAO" => 'Pending Released - CAO', 
			// 				"3*CAO Released" => 'CAO Released');
			// 	}
			// }

			if($trackingType == "PY"){
				if(strtoupper($claimType) == "CHECK"){
					if($docType != 'BOND - RETENTION MONEY') {
						$array = array(
							
							"1*Encoded" => 'Encoded', 
							"2*CBO Received" => 'CBO Received', 
							"x*Pending at CBO" => 'Pending at CBO', 
							"x*Pending Released - CBO" => 'Pending Released - CBO', 
							"3*CBO Released" => 'CBO Released', 
							"4*Accounting Received" => 'CAO Received',
							"x*Pending at CAO" => 'Pending at CAO', 
							"x*Pending Released - CAO" => 'Pending Released - CAO', 
							"x*Fund Correction" => 'Fund Correction',
							"5*On Evaluation - Accounting" => 'On Evaluation - Accounting',
							"6*Carded - Accounting" => 'Carded - Accounting',
							"7*SLP Created - Accounting" => 'SLP Created - Accounting',
							"8*Evaluated - Accounting" => 'Evaluated - Accounting',
							"9*Released - CAO" => 'Forwarding Transmittal',
							
							"10*Check Preparation" => 'Check Preparation - CTO'
							
						);
						
						if($status == "Forwarded to Admin - Operation"){
							
							$array["11*Check for Signature"] = 'Forwarded to Admin - Operation';
							$array["12*Check Advised"] = 'Check Advised';
							
						}else if($status == "Forwarded to Admin - Administration"){
							$array["11*Check for Signature"] = 'Forwarded to Admin - Administration';
							$array["12*Check Advised"] = 'Check Advised';
						}else if($status == "Forwarded to SP - Admin"){
							$array["11*Check for Signature"] = 'Forwarded to SP - Admin';
							$array["12*Check Advised"] = 'Check Advised';
						}else{
							$array["11*Check for Signature"] = '';
							$array["12*Check Advised"] = 'Check Advised';
						}
						$array["13*Check Released"] = 'Check Released';
					}else {
						$array = array(
								"1*Encoded" => 'Encoded', 
								"2*Accounting Received" => 'CAO Received',
								"x*Pending at CAO" => 'Pending at CAO', 
								"x*Pending Released - CAO" => 'Pending Released - CAO', 
								"x*Fund Correction" => 'Fund Correction',
								"3*On Evaluation - Accounting" => 'On Evaluation - Accounting',
								"4*Evaluated - Accounting" => 'Evaluated - Accounting',
								"5*CAO Released" => 'CAO Released');
					}
					
					
				}else if(strtoupper($claimType) == "WINDOW"){
					$array = array(
							"1*Encoded" => 'Encoded', 
							"2*CBO Received" => 'CBO Received', 
							"x*Pending at CBO" => 'Pending at CBO', 
							"x*Pending Released - CBO" => 'Pending Released - CBO', 
							"3*CBO Released" => 'CBO Released', 
							"4*Accounting Received" => 'CAO Received',
							"x*Pending at CAO" => 'Pending at CAO', 
							"x*Pending Released - CAO" => 'Pending Released - CAO', 
							"x*Fund Correction" => 'Fund Correction',
							"5*On Evaluation - Accounting" => 'On Evaluation - Accounting',
							"6*Carded - Accounting" => 'Carded - Accounting',
							"7*Evaluated - Accounting" => 'Evaluated - Accounting',
							"8*Forwarded to CTO" => 'Forwarded to CTO');
				}else{
					$array = array(
							"1*Encoded" => 'Encoded', 
							"2*Accounting Received" => 'CAO Received',
							"x*Pending at CAO" => 'Pending at CAO', 
							"x*Pending Released - CAO" => 'Pending Released - CAO', 
							"x*Fund Correction" => 'Fund Correction',
							"3*On Evaluation - Accounting" => 'On Evaluation - Accounting',
							"4*Evaluated - Accounting" => 'Evaluated - Accounting',
							"5*CAO Released" => 'CAO Released');
				}
			}

			if($trackingType == "PR"){
				
				$stat = $status;
				if($status  == "Admin Received"){
					$label = "Admin Received";
				}else if($status  == "Forwarded to SP Admin - PR"){
					$label = "Forwarded to SP Admin";
				}else{
					$label = "Admin Received";
					$stat = "Admin Received";
				}
				$array = array(
						"1*Encoded" => 'Encoded',
						"2*CBO Received" => 'CBO Received', 
						"x*Pending at CBO" => 'Pending at CBO', 
						"x*Pending Released - CBO" => 'Pending Released - CBO', 
						"3*GSO Received" => 'GSO Received', 
						"x*Pending at GSO" => 'Pending at GSO', 
						"x*Pending Released - GSO" => 'Pending Released - GSO', 

						"4*GSO Released" => 'GSO Released',
						
						"5*CTO Received" => 'CTO Received', 
						"x*Pending at CTO" => 'Pending at CTO', 
						"x*Pending Released - CTO" => 'Pending Released - CTO',
						
						"6*" . $label .   "" => '' . $stat . '', 
						
						
						"x*Pending at Admin" => 'Pending at Admin', 
						"x*Pending Released - Admin" => 'Pending Released - Admin',  
						
						"6*Forwarding to BAC" => 'Forwarding to BAC', 
						"7*BAC Received" => 'BAC Received', 
						"x*Pending at BAC" => 'Pending at BAC', 
						"x*Pending Released - BAC" => 'Pending Released - BAC',
						
						"8*BAC Deliberation" => 'BAC Deliberation', 
						"x*Pending at Deliberation" => 'Pending at Deliberation', 
						"x*Pending Released - Deliberation" => 'Pending Released - Deliberation'
						
				);
				if($mode == 1){ //bidding
					$array["9*BAC Bidding Process"] = 'BAC Bidding Process';
					$array["x*Failed Bid"] = 'Failed Bid';
					$array["x*Failed Bid Released"] = 'Failed Bid Released';
					$array["10*BAC Canvas Signed"] = 'BAC Canvas Signed';
					$array["11*BAC for P.O"] = 'For P.O';
				}
				if($mode >= 2 and $mode < 15){
					$array["9*BAC Canvassing"] = 'BAC Canvassing';
					$array["10*BAC Canvas Complete"] = 'BAC Canvas Complete';
					$array["11*Office Review Canvas"] = 'Office Review Canvas';
					$array["12*BAC Received Abstract"] = 'BAC Received Abstract';
					$array["x*Pending Abstract"] = 'Pending Abstract';
					$array["x*Pending Released Draft"] = 'Pending Released Draft';
					$array["13*BAC Awarding"] = 'BAC Awarding';
					$array["14*BAC For Final Abstract"] = 'BAC For Final Abstract';
					$array["15*Office Final Abstract"] = 'Office Final Abstract';
					$array["16*BAC Received Final Abstract"] = 'BAC Received Final Abstract';
					$array["x*Pending Final Abstract"] = 'Pending Abstract';
					$array["x*Pending Released Final Abstract"] = 'Pending Released Final Abstract';
					
					$array["17*BAC Signed"] = 'BAC Signed';
					$array["18*For P.O"] = 'For P.O';
				}	
				if($mode >= 15){
					$array["9*For P.O"] = 'For P.O';
				}		
			}

			if($trackingType == "NF"){
				$array = array(
						"1*Project Encoded" => "Project Encoded",
						"2*Requesting for Fund Certification" => "Requesting for Fund Certification",
						"3*Acknowledge Certification Request" => "Acknowledge Certification Request",
						"4*Fund Certification Signed" => "Fund Certification Signed",
						"5*Schedule for Inspection - CEO" => "Schedule for Inspection",
						"6*For Inspection - CEO" => "For Inspection",
						"x*Inspected - Not Feasible - CEO" => "Inspected - Not Feasible",
						"7*Preparation of Plans, PoW, and Detailed Estimates - CEO" => "Preparation of Plans, PoW, and Detailed Estimates",
						"8*Plans, PoW, and Detailed Estimates for Approval - Admin" => "Plans, PoW, and Detailed Estimates for Approval",
						"9*Plans, PoW, and Detailed Estimates Signed - Admin" => "Plans, PoW, and Detailed Estimates Signed",
						"10*For BAC Procedures - CEO" => "For BAC Procedures",
						"11*Drafting Invitation to Bid - BAC Secretariat" => "Drafting Invitation to Bid",
						"12*Checking Invitation to Bid - CEO" => "Checking Invitation to Bid",
						"13*Invitation to Bid for Adjustment - CEO" => "Invitation to Bid for Adjustment",
						"14*Invitation to Bid for Pick-up - CEO" => "Invitation to Bid for Pick-up",
						"15*Invitation to Bid for Transmit - BAC Secretariat" => "Invitation to Bid for Transmit",
						"16*Invitation to Bid for Signature - BAC Chairman" => "Invitation to Bid for Signature",
						"17*Invitation to Bid Signed - BAC Chairman" => "Invitation to Bid Signed",
						"18*Posting - BAC Secretariat" => "Posting",
						"19*Bidding Schedule - BAC Secretariat" => "Bidding Schedule",
						"20*Post Qualification - BAC Secretariat" => "Post Qualification",
						"21*Letters for Signature - BAC Chairman" => "Letters for Signature",
						"22*Letters Signed - BAC Chairman" => "Letters Signed",
						"23*Notice of Award for Transmit - BAC Secretariat" => "Notice of Award for Transmit",
						"24*Notice of Award for Admin Signature - Admin" => "Notice of Award for Admin Signature",
						"25*Notice of Award Admin Signed - Admin" => "Notice of Award Admin Signed",
						"26*NoA and Contract for Contractor's Signature - BAC Secretariat" => "NoA and Contract for Contractor's Signature",
						"27*NoA and Contract Released to Contractor" => "NoA and Contract Released to Contractor",
						"28*NoA and Contract Contractor Signed - BAC Secretariat" => "NoA and Contract Contractor Signed",
						"29*Obligation Request Preparation - CEO" => "Obligation Request Preparation",
						"30*OBR for Implementing Office Signature - CEO" => "OBR for Implementing Office Signature",
						"31*OBR Implementing Office Signed - CEO" => "OBR Implementing Office Signed",
						"32*CBO Received - CBO" => "CBO Received",
						"x*Pending at CBO" => "Pending at CBO",
						"x*Pending Released - CBO" => "Pending Released - CBO", 
						"33*Obligation Request for Pick-up" => "Obligation Request for Pick-up",
						"34*Obligation Request Signed - BAC Secretariat" => "Obligation Request Signed",
						"35*Contract and NTP for City Engineer's Signature - CEO" => "Contract and NTP for City Engineer's Signature",
						"36*Contract and NTP Signed - CEO" => "Contract and NTP Signed",
						"37*Document Filing - BAC Secretariat" => "Document Filing",
						"38*CAO Received" => "CAO Received",
						"x*Pending at CAO" => "Pending at CAO",
						"x*Pending Released - CAO" => "Pending Released - CAO", 
						"39*Document for Pick-up - CAO" => "Document for Pick-up - CAO",
						"40*Contract and NTP Transmit to Admin - BAC Secretariat" => "Contract and NTP Transmit to Admin",
						"41*Contract and NTP for Admin Signature - Admin" => "Contract and NTP for Admin Signature",
						"x*Pending at Admin" => "Pending at Admin",
						"x*Pending Released - Admin" => "Pending Released - Admin", 
						"42*Document for Pick-up - Admin" => "Document for Pick-up - Admin",
						"43*Contract for Notarization - BAC Secretariat" => "Contract for Notarization",
						"44*Released to Contractor for Notarization" => "Released to Contractor for Notarization",
						"45*Contract Notarized - BAC Secretariat" => "Contract Notarized",
						"46*Prepare Letter for Pick-up NTP - CEO" => "Prepare Letter for Pick-up NTP",
						"47*Forwarded Letter for Pick-up NTP - CEO" => "Forwarded Letter for Pick-up NTP",
						"48*NTP Released to Contractor" => "NTP Released to Contractor",
						"49*NTP Received from Contractor - CEO" => "NTP Received from Contractor",
						"50*NTP Forwarded to Construction Division - CEO" => "NTP Forwarded to Construction Division"
						);
			}

			if($trackingType == "IP"){
				$array = array(
							"1*Encoded" => 'Encoded', 
							"2*Accounting Received" => 'CAO Received',
							"x*Pending at CAO" => 'Pending at CAO', 
							"x*Pending Released - CAO" => 'Pending Released - CAO', 
							"3*On Evaluation - Accounting" => 'On Evaluation - Accounting',
							"4*Evaluated - Accounting" => 'Evaluated - Accounting',
							"5*Released - CAO" => 'Forwarding Transmittal',
							"6*Check Preparation" => 'Check Preparation - CTO'
							);

				if($status == "Forwarded to Admin - Operation"){
					$array["7*Check for Signature"] = 'Forwarded to Admin - Operation';
					$array["8*Check Advised"] = 'Check Advised';
				}else if($status == "Forwarded to Admin - Administration"){
					$array["7*Check for Signature"] = 'Forwarded to Admin - Administration';
					$array["8*Check Advised"] = 'Check Advised';
				}else if($status == "Forwarded to SP - Admin"){
					$array["7*Check for Signature"] = 'Forwarded to SP - Admin';
					$array["8*Check Advised"] = 'Check Advised';
				}else{
					$array["7*Check for Signature"] = '';
					$array["8*Check Advised"] = 'Check Advised';
				}
				$array["9*Check Released"] = 'Check Released';
			}

			// if($trackingType == "PX"){
			// 	$array = array(
			// 				"1*Encoded" => 'Encoded', 
			// 				"2*For Inspection - GSO" => 'For Inspection',
			// 				"3*Inspection - GSO" => 'Inspected',
			// 				"x*Pending Inspection - GSO" => 'Pending at GSO - Inspection',
			// 				"x*Pending Released - Inspection" => 'Pending Released - Inspection',
			// 				"4*Inventory - GSO" => 'Inventory',
			// 				"x*Pending Inventory - GSO" => 'Pending at GSO - Inventory',
			// 				"x*Pending Released - Inventory" => 'Pending Released - Inventory',
			// 				"5*Accounting Received" => 'CAO Received',
			// 				"x*Pending at CAO" => 'Pending at CAO', 
			// 				"x*Pending Released - CAO" => 'Pending Released - CAO', 
			// 				"6*Released - CAO" => 'Forwarding Transmittal',
			// 				"7*Check Preparation" => 'Check Preparation - CTO'
			// 				);

			// 	if($status == "Forwarded to Admin - Operation"){
			// 		$array["8*Check for Signature"] = 'Forwarded to Admin - Operation';
			// 		$array["9*Check Advised"] = 'Check Advised';
			// 	}else if($status == "Forwarded to Admin - Administration"){
			// 		$array["8*Check for Signature"] = 'Forwarded to Admin - Administration';
			// 		$array["9*Check Advised"] = 'Check Advised';
			// 	}else if($status == "Forwarded to SP - Admin"){
			// 		$array["8*Check for Signature"] = 'Forwarded to SP - Admin';
			// 		$array["9*Check Advised"] = 'Check Advised';
			// 	}else{
			// 		$array["8*Check for Signature"] = '';
			// 		$array["9*Check Advised"] = 'Check Advised';
			// 	}
			// 	$array["10*Check Released"] = 'Check Released';
			// }

			if($trackingType == "PX"){
				$array = array(
							"1*Encoded" => 'Encoded', 
							"2*For Inspection - GSO" => 'For Inspection',
							"3*Inspection - GSO" => 'Inspected',
							"x*Pending Inspection - GSO" => 'Pending at GSO - Inspection',
							"x*Pending Released - Inspection" => 'Pending Released - Inspection',
							"4*Inventory - GSO" => 'Inventory',
							"x*Pending Inventory - GSO" => 'Pending at GSO - Inventory',
							"x*Pending Released - Inventory" => 'Pending Released - Inventory',
							"5*Received - CAO" => 'CAO Received',
							"x*Pending at CAO" => 'Pending at CAO', 
							"x*Pending Released - CAO" => 'Pending Released - CAO', 
							"x*Fund Correction" => 'Fund Correction',
							"6*On Evaluation - Accounting" => 'On Evaluation - Accounting',
							"7*Evaluated - Accounting" => 'Evaluated - Accounting',
							"8*Released - CAO" => 'Forwarding Transmittal',
							"9*Check Preparation" => 'Check Preparation - CTO'
							);

				if($status == "Forwarded to Admin - Operation"){
					$array["10*Check for Signature"] = 'Forwarded to Admin - Operation';
					$array["11*Check Advised"] = 'Check Advised';
				}else if($status == "Forwarded to Admin - Administration"){
					$array["10*Check for Signature"] = 'Forwarded to Admin - Administration';
					$array["11*Check Advised"] = 'Check Advised';
				}else if($status == "Forwarded to SP - Admin"){
					$array["10*Check for Signature"] = 'Forwarded to SP - Admin';
					$array["11*Check Advised"] = 'Check Advised';
				}else{
					$array["10*Check for Signature"] = '';
					$array["11*Check Advised"] = 'Check Advised';
				}
				$array["12*Check Released"] = 'Check Released';
			}
			
			
			$sheet = '<div style = "margin-top:160px;margin-right:10px;">';
				$sheet .= '<div style = "font-size:26px;font-family:Oswald;text-align:right;padding:2px 0px;;color:rgb(137, 155, 165);padding-right:8px;"><span style = "color:rgb1(87, 1516, 175)">S</span>tatus&nbsp;Guide</div>';
				$i =1;
				$mark = 0;
				foreach($array as $x => $x_value) {
					$arr = explode("*",$x);
					
					if($status == $x_value){
						if($arr[0] == 'x'){
							if($mark == 0){
								$sheet .= "<div class = 'sliderSelectedPending' style = ''>" .  $arr[1] .  " <div class = 'numberSlider'>" .  $i++ . "</div></div>";
								$mark = 1;
							}
						}else{
							$sheet .= "<div class = 'sliderSelected' style = ''>" .  $arr[1] .  " <div class = 'numberSlider'>" .  $i++ . "</div></div>";
						}	
					}else{
						if($arr[0] != 'x'){
							$sheet .= "<div class = 'slider' style = ''>" .  $arr[1] .  " <div class = 'numberSliderNone'>" .  $i++ . "</div></div>";
						}
					}
				}
				$sheet .= '</div>';
			
			return $sheet;
		}
		
		function permissionClass($acct,$logOffice,$trackingType,$status,$office){
			$className = 'hide';
			if($trackingType == "PR"){
				if($acct == 1){
					if($logOffice == $office){//budget lnga ng  mag edit sa mga amount na mali kay niagi na sa GSO
						if($status == "Encoded" || $status  == "Pending at GSO"  || $status  == "Pending Released - GSO"){
							$className = '';
						}else {
							$className = 'hide';
						}
						
					}
				}
				if($acct == 2){
					if($logOffice == '1061'){
						if($status == "Encoded" || $status  == "GSO Received"  || $status  == "Pending at GSO" || $status  == "Pending Released - GSO"){
							$className = '';
						}else{
							$className = 'hide';
						}
					}
					if($logOffice == '1071'){
						if($status  == "CBO Received"  || $status  == "Pending at CBO" || $status  == "Pending Released - CBO"){
							$className = '';
						}else{
							$className = 'hide';
						}
					}

				}
			}
			if($trackingType == "PO"){
					if($acct == 1){
						if($logOffice == $office){
							if($status == "Encoded" || $status  == "Pending Released - GSO"){
								$className = '';
							}else{
								$className = 'hide';
							}
						}
					}
					if($acct == 2){
						if($logOffice == '1061'){
							if($status == "Encoded" || $status  == "GSO Received" ||  $status  == "Pending at GSO"  || $status  == "Pending Released - GSO"){
								$className = '';
							}else{
								$className = 'hide';
							}
						}
					}
					if($acct == 4){
						if($logOffice == '1081'){
							if($status  == "GSO Received" ||  $status  == "CAO Received" || $status  == "Pending at CAO"  || $status  == "Pending Released - CAO"){
								$className = '';
							}else{
								$className = 'hide';
							}
						}
					}
			}
			return $className ;
		}

		
		function permissionClassByField($trackingType,$status,$office,$field){
			$logOffice = $_SESSION['gso'];
			$acct = $_SESSION['accountType'];
			$perm  = $_SESSION['perm'];
			$privy = $_SESSION['privy'];
			$className = 'hide';
			
			if($perm == 31){
				if($acct == 3 || $acct == 4 || $acct == 7){
					$className = 'label19';
				}
			}

			if($trackingType == "PY"){
				if($acct == 1){
					if($logOffice == $office){ 
						if($field == "SubProg" || $field == "Claimant" || $field == "Document" || $field == "Period" || $field == "ClaimType" || $field == "Fund" || $field == "OBRdetails" || $field == "GrossAmount" || $field == "Spent" || $field == "ORdetails" || $field == "WGSParticulars"){
							if($status == "Encoded"  || $status  == "Pending Released - CBO"  || $status  == "Pending Released - CAO"){
								$className = 'label19';
							}	
						}
					}
				}

				if($acct == 2){
					if($logOffice == '1071'){
						if($field == "OBRNumber" || $field == 'Fund' || $field == "OBRdetails" || $field == 'Claimant'  || $field == 'Document'){
							if($status  == "CBO Received"  || $status  == "Pending at CBO" || $status  == "Pending Released - CBO"){
								$className = 'label19';
							}
						}
						if($field == "Claimant" || $field == "Document" || $field == "Period" || $field == "ClaimType" || $field == "Fund"  ){
							if($status == "Encoded"){
								$className = 'label19';
							}	
						}

						// if($field == "OBRdetails"){
						// 	if($status  == "Pending Released - CAO"){
						// 		$className = 'label19';
						// 	}
						// 	if($status  == "CAO Received"){
						// 		$className = 'label19';
						// 	}
						// }
					
					}
					if($logOffice == 'SUGA'){
						if($field == "OBRdetails"){
							if($status  == "Encoded"){
								$className = 'label19';
							}
							if($status  == "Pending Released - CBO" || $status  == "Pending Released - CAO"){
								$className = 'label19';
							}
						}
					}
					if($logOffice == '1091'){
						if($field == 'Document' || $field == 'Claimant' || $field == 'Fund' || $field == 'OfficeAssigned' || $field == 'CashRelease' || $field == 'ClaimType' || $field == 'Window'){
							//if($status  == "CBO Received"  || $status  == "Pending at CBO" || $status  == "Pending Released - CBO"){
								$className = 'label19';
							//}
						}
					}
				}
				
				// if($acct == 4  ){
				if($privy == 2){
					if($field == "Claimant" || $field == "Document" || $field == "Period" || $field == "ClaimType" || $field == "Fund"  || $field == "Adv" || $field == "NetAmount" || $field == "GrossAmount" || $field == "Spent" || $field == "ORdetails" || $field == "OBRNumber" || $field == "Complex"){
						if($status == "CAO Received" || $status  == "Pending at CAO" || $status  == "SLP Created - Accounting" || $status == "On Evaluation - Accounting"){
							$className = 'label19';
						}
						
						if($status == "Encoded"){
							$className = 'label19';
						}	
						if($status == "Evaluated - Accounting"){
							$className = 'label19';
						}
					}

					if($field == "NetAmount" || $field == "Claimant" ){
						if($status == "Check Preparation - CTO"){
							$className = 'label19';
						}	
					}
					
					if($field == "OBRdetails" || $field == 'WGSParticulars'){
						if($status  == "CAO Received" || $status  == "Pending Released - CAO" || $status  == "CBO Received" || $status  == "CBO Released"  || $status  == "Check Preparation - CTO" || $status == "On Evaluation - Accounting"){
							$className = 'label19';
						}
					}
					if($field == "LTO"){
						if($status == "CAO Released" || $status == 'CAO Received' || $status == 'CAO Released' || $status == 'Check Preparation - CTO'  || $status == 'Check Preparation - CTO' || $status == 'Forwarded to Admin - Administration' || $status == 'Forwarded to Admin - Operation' || $status == 'Forwarded to SP - Admin' || $status == "On Evaluation - Accounting"){
							$className = 'label19';
						}
					} 

					if($field == "CAOOfficer") {
						if($status == "CAO Received" || $status == "On Evaluation - Accounting"){
							$className = 'label19';
						}
					}
				}

				if($privy == 3) {
					if($field == "Adv"){
						if($status == "CAO Received" || $status == "SLP Created - Accounting"){
							$className = 'label19';
						}
					}
				}

				if($acct == 8 ){
					if($field == "Claimant" || $field == "Document" || $field == "Period" || $field == "ClaimType" || $field == "Fund" || $field == "NetAmount" || $field == "Adv"){
						if($status == "CAO Received" || $status  == "Pending at CAO" || $status  == "Encoded" || $status  == "SLP Created - Accounting" || $status  == "Carded - Accounting"){
							$className = 'label19';
						}	
					}
					
				}

				if($acct == 5 ){
					
					if($field == "Claimant" || $field == "Document" || $field == "Period" || $field == "ClaimType" || $field == "Fund"  || $field == "NetAmount"  || $field == "LTO" || $field == "Adv"   ){
						
						if($status == "CAO Received" || $status  == "Pending at CAO"  || $status  == "CAO Released"  ){
							$className = 'label19';
						}	
					}
				}

				if($acct == 9 ){
					if($field == "CheckNumber" || $field == "CheckDate" || $field == "Claimant"   || $field == "Supplier" || $field == "Fund"  ){
						if($status == "CAO Released" ){
							$className = 'label19';
						}	
					}
					if($field == "NetAmount"  || $field == "Claimant"  || $field == "Document" ||  $field == "Adv" ){
						$className = 'label19';
					}
					if($field == "LTO"){
						if($status == "CAO Released" || $status == 'CAO Received' || $status == 'CAO Released'   || $status == 'Check Preparation - CTO' || $status == 'Forwarded to Admin - Administration' || $status == 'Forwarded to Admin - Operation' || $status == 'Forwarded to SP - Admin' ){
							$className = 'label19';
						}
					} 
				}
			}

			if($trackingType == "PR"){
				if($acct == 1){
					if($logOffice == $office){ 
						if($field == "Fund"){
							if($status == "Encoded" || $status  == "GSO Received" || $status  == "Pending at GSO"  || $status  == "Pending Released - GSO" || $status  == "Pending Released - CBO"){
								$className = 'label19';
							}	
						}
						if($field == "PRdetails" || $field == "DRRMO"){
							if($status  == "Pending Released - CBO" || $status  == "Encoded" || $status  == "Pending Released - GSO" || $status  == "Pending Released - Admin" || $status  == "Pending Released - CTO" || $status  == "Pending Released - BAC"){
								$className = 'label19';
							}	
						}
					}
				}

				if($acct == 2){

					if($logOffice == '1061'){
						if($field == "PRNumber"){
							if($status  == "GSO Received"  || $status  == "Pending at GSO" || $status  == "Pending Released - GSO" || $status  == "CBO Received"  || $status  == "Pending at CBO"  || $status  == "Pending Released - CBO" ){
									$className = 'label19';
							}
						}
						if($field == "PRdetails" || $field == "OBRNumber"){
							if($status  == "GSO Received" ){
								$className = 'label19';
							}	
						}
					}
					
					if($logOffice == '1071'){
						if($field == "PRNumber"){
							if($status  == "GSO Received"  || $status  == "Pending at GSO" || $status  == "Pending Released - GSO" || $status  == "CBO Received"  || $status  == "Pending at CBO"  || $status  == "Pending Released - CBO" || $status  == "Pending Released - CTO" ){
									$className = 'label19';
							}
						}
						if($field == "OBRNumber" || $field == 'Fund'){
							if($status  == "CBO Received"  || $status  == "Pending at CBO" || $status  == "Pending Released - CBO" || $status  == "CBO Released"  || $status  == "Pending Released - CTO" || $status  == "Pending at CTO"){
								$className = 'label19';
							}
						}
					}

					if($logOffice == '1091'){
						if($field == "PRNumber"){
							if($status  == "CTO Received"){
									$className = 'label19';
							}
						}
						if($field == "OBRNumber" ){
							if($status  == "CTO Received"){
								$className = 'label19';
							}
						}
					}

					if($logOffice == 'DISA'){
						if($field == "DRRMO"){
							$className = 'label19';
						}
					}

				}

				if($logOffice == '1081'){
					if($field == "PRNumber" || $field == "OBRNumber"){
						if( $status  == "CBO Released"  ){
								$className = 'label19';
						}
					}
				}

				if($field == 'Remarks1') {
					if($logOffice == '1071') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'CBO Received') {
								$className = '';
							}
						}
					}
	
					if($logOffice == '1061') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'GSO Received' || $status == 'BAC Received') {
								$className = '';
							}
						}
					}

					if($logOffice == '1091') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'CTO Received') {
								$className = '';
							}
						}
					}
	
					if($logOffice == '1031') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'Admin Received') {
								$className = '';
							}
						}
					}
				}

			}

			if($trackingType == "PO"){

				if($acct == 1){
					if($logOffice == $office){ 
						if($field == "Claimant" || $field == "Supplier"  || $field == "PRdetails" ){ 
							if($status == "Encoded" || $status  == "GSO Received" || $status  == "Pending at GSO"  || $status  == "Pending Released - GSO"  || $status  == "Pending Released - CAO" || $status  == "Pending Released - CBO"){
								$className = 'label19';
							}	
						}

						if($field == "computeLD" ){

							if($status == "Waiting for Delivery" || $status == "Pending Released - CAO"){
								$className = 'label19';
							}  
							
						} 

						if($field == "NatureOfPayment" || $field == "POMode" || $field == "PaymentTerm" || $field == "InvoiceNumber" || $field == "InvoiceDate"){

							if($status == "Encoded" || $status  == "Pending Released - GSO"  || $status  == "Pending Released - CAO" || $status  == "Pending Released - CBO" || $status == "Waiting for Delivery"){
								$className = 'label19';
							}  
							
						} 

						if($field == "PRdetails") {
							if($status == "Pending Released - GSO" || $status == "Pending Released - Inspection" || $status == "Pending Released - Inventory" ){  // - Inventory 
								$className = 'label19';
							}  
						}


						if($field == "Claimant" || $field == "Supplier" ){ // - Inventory

							if($status == "Pending Released - GSO" || $status == "Waiting for Delivery" || $status == "Pending Released - Inspection" || $status == "Pending Released - Inventory" ){  // - Inventory 
								$className = 'label19';
							}  
							
						} 

						if ($field == "Supplier") { // - Inventory
							if ($status == "Pending Released - Inspection" || $status == "Pending Released - Inventory" ) {
								$className = 'label19';
							}
						}

						if ($field == "PONumber" || $field == "Supplier" || $field == "PODate" || $field == "InvoiceNumber" || $field == "InvoiceDate"){  // - Inventory
							if($status == "Waiting for Delivery"   ){
								$className = 'label19';
							}
						}

						if ($field == "Supplier" || $field == "PRdetails") { // - Inventory
							if($status == "For Inspection" || $status == "GSO Received - Inspection" ){
								$className = 'label19';
							}
						}


					}
				}
				
				if($acct == 2) {  // - Inventory
					if($logOffice == '1061'){ 
						if ($field == "PONumber" || $field == "PODate"){ // Inventory
							// if($status == "Forwarded to CMO" || $status == "CMO Approved" ||  $status == "Served to Supplier" || $status == "Supplier Conformed" || $status == "GSO Received - Inspection" || $status == "Pending Released - Inspection" ||     $status == "Waiting for Delivery"  || $status == "Pending Released - Inventory" || $status == "Inventory" || $status == "Pending at GSO - Inspection" ||  $status == "Pending at GSO - Inventory"  ||  $status == "Serve to Supplier"){
								$className = 'label19';
							// }
						}
					}
					
					if($logOffice == '1071'){
						if($field == "OBRNumber" ||  $field == "Fund" ||  $field == "PRdetails" || $status  == "CAO Received" || $status  == "Pending Released - CAO"){
							if($status  == "Fund Control"  || $status  == "Pending at CBO"){
									$className = 'label19';
							}
							
						}
						if($field == "OBRNumber"){
							$className = 'label19';
						}
					}


					if($logOffice == '1031'){
						if($field == "PONumber" || $field == "PODate"){
							$className = 'label19';
						}
					}
					 
				}

				if($acct == 2){
					if($logOffice == '1061'){
						if($field == "PONumber"){
							if($status  == "GSO Received"  || $status  == "Pending at GSO" || $status  == "Pending Released - GSO"){
									$className = 'label19';
							}
						}
					}
				}

				// if($acct == 4){
				if($privy == 2){
					if($logOffice == '1081'){
						
						if($field == "Claimant" || $field == "Supplier" || $field == "Fund"  || $field == "NetAmount" || $field == "PRdetails" || $field == "OBRNumber" || $field == "Complex" ){
							if($status == "CAO Received"  || $status  == "Pending at CAO"  || $status  == "Pending Released - CAO"){
								$className = 'label19';
							}	
						}
						if($field == "Adv"){
							if($status  == "CAO Received" || $status  == "Pending at CAO"  || $status  == "Pending Released - CAO"){
									$className = 'label19';
							}
						}
						if($field == "computeLD" ){

							if($status == "CAO Received"){
								$className = 'label19';
							}  
							
						} 

						if($field == "NatureOfPayment" || $field == "POMode" || $field == "PaymentTerm" || $field == "InvoiceNumber" || $field == "InvoiceDate"){

							if($status  == "CAO Received" || $status  == "Pending at CAO"  || $status  == "Pending Released - CAO"){
								$className = 'label19';
							}  
							
						} 

						if($field == "NatureOfPayment" || $field == "POMode" || $field == "PaymentTerm" || $field == "InvoiceNumber" || $field == "InvoiceDate" || $field == "PODate" || $field == "PONumber"){
							if($status == "Waiting for Delivery" || $status  == "Inspected" || $status  == "Inventory" || $status  == "For Payment"){
								$className = 'label19';
							}  
							
						} 

					}

				}

				if($acct == 5){
					if($logOffice == '1081'){
						
						if($field == "NetAmount" || $field == "Adv" ||  $field == "Fund"  ||  $field == "Supplier"){
							if($status == "CAO Received" || $status == "CAO Released"){
								$className = 'label19';
							}	
						}		
					}
				}

				if($acct == 9 ){
					if($field == "CheckNumber" || $field == "CheckDate" || $field ==  "NetAmount" ||  $field == "Claimant"   ||  $field == "Supplier"  ||  $field == "Adv" ||  $field == "Fund"   ){
						if($status == "CAO Released" ){
							$className = 'label19';
						}	
					}
				}

				if($field == 'Remarks1') {
					if($logOffice == '1061') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'GSO Received') {
								$className = '';
							}
						}
					}

					if($logOffice == '1031') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'Admin Received') {
								$className = '';
							}
						}
					}

					if($logOffice == '1071') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'Fund Control') {
								$className = '';
							}
						}
					}
				}
			}

			if($trackingType == "NF"){
			
				if($acct == 2 || $acct == 7){
					if($logOffice == '1071'){
						if($field == "OBRNumber" ){
							$className = 'label19';
						}
						if($field == "Variation"){
							$className = 'label19';
						}
						if($field == "Variation2"){
							$className = 'label19';
						}
					}

					if($perm == 38 || $perm == 42){ //admin and  bac
						if($field == 'Programmer' || $field == 'Inspector' || $field == 'Claimant' || $field == 'NetAmount' 
						|| $field == 'BatchNumber' || $field == 'OBRDetails' ||  $field == 'Location'||  $field == 'Duration' 
						||  $field == 'ModeOfProcurement' ||  $field == 'Started' ||  $field == 'Completed' || $field == 'Checker' || $field == 'Surveyor' || $field == 'Draftsman'){

								$className = 'label19';

						}
					}
					
					if($perm == 40 ){ //pdd
						if($field == 'Barangay' ||  $field == 'Programmer' || $field == 'Inspector' || $field == 'BatchNumber' ||  $field == 'Duration' ||  $field == 'Location' ||  $field == 'Remarks'
						||  $field == 'Started' ||  $field == 'Completed' || $field == 'Checker' || $field == 'Surveyor' || $field == 'Draftsman'){

								$className = 'label19';

						}
					}
					if($perm == 41 ){ //construction
						if($field == 'Barangay' || $field == 'Programmer' || $field == 'Inspector' || $field == 'BatchNumber' ||  $field == 'Duration' ||  $field == 'Location' 
						||  $field == 'Remarks' ||  $field == 'Started' ||  $field == 'Completed'  ||  $field == 'Extension' || $field == 'Checker' || $field == 'Surveyor' || $field == 'Draftsman'){

								$className = 'label19';

						}
					}
					if($perm == 42 ){ //admin
						if($field == 'Barangay' || $field == 'Programmer' || $field == 'Inspector' || $field == 'BatchNumber' ||  $field == 'Duration' ||  $field == 'Location' 
						||  $field == 'Remarks' ||  $field == 'Started' ||  $field == 'Completed' ||  $field == 'Extension' || $field == 'Checker' || $field == 'Surveyor' || $field == 'Draftsman'){

								$className = 'label19';

						}
					}
					
				}

			}

			if($trackingType == "IP") {
				// if($acct == 4){
				if($privy == 2){
						// if($field == "Period" || $field == "ClaimType"  || $field == "Adv" || $field == "NetAmount"  || $field == "GrossAmount" || $field == "Complex"){
					if($field == "Period" || $field == "ClaimType"  || $field == "Adv" || $field == "Complex"){
						if($status == "CAO Received" || $status  == "Pending at CAO"){
							$className = 'label19';
						}
						if($status == "Encoded"){
							$className = 'label19';
						}	
						
					}

					if($field == "NetAmount" || $field == "Claimant" ){
						if($status == "Check Preparation - CTO"){
							$className = 'label19';
						}	
					}


				}
			}

			if($trackingType == "PX") {
				if ($acct == 1) {
					if($logOffice == $office){ 
						if($field == "PRdetails" || $field == "DVGoodsParticulars"){ 
							if($status == "Encoded" || $status  == "Pending Released - GSO"  || $status  == "Pending Released - CAO" || $status  == "Pending Released - Inventory" || $status  == "Pending Released - Inspection"){
								$className = 'label19';
							}	
						}
					}

					if($office == 'ONE1' || $office == '1021' || $office == '1016' || $office == 'BFP1') {
						if($field == "DVGoodsParticulars" || $field == "PXAccountNumber" || $field == "InvoiceNumber" || $field == "InvoiceDate" || $field == "GasPeriod") {
							$className = 'label19';
						}
					}
				}

				if ($acct == 2) {
					if($logOffice == '1071'){
						if($field == "PRdetails"){
							if($status  == "Fund Control"  || $status  == "Pending at CBO"){
									$className = 'label19';
							}
							
						}
					}
				}

				// if ($acct == 4) {
				if($privy == 2){
						if($logOffice == '1081'){
						if($field == "NetAmount" || $field == "PRdetails" || $field == "Complex" || $field == "Adv" || $field == "InvoiceNumber" || $field == "InvoiceDate" || $field == "GasPeriod" || $field == "DVGoodsParticulars"){
							if($status == "CAO Received"  || $status  == "Pending at CAO"  || $status  == "Pending Released - CAO" || $status == "On Evaluation - Accounting"){
								$className = 'label19';
							}	
						}
						if($status == "Evaluated - Accounting"){
							$className = 'label19';
						}
						if($field == "CAOOfficer") {
							if($status == "CAO Received" || $status == "On Evaluation - Accounting"){
								$className = 'label19';
							}
						}

					}
				}

				if($privy == 3) {
					if($field == "Adv"){
						if($status == "CAO Received"){
							$className = 'label19';
						}
					}
				}

				if ($acct == 5) {
					if($logOffice == '1081'){
						if($field == "NetAmount" || $field == "Adv"){
							if($status == "CAO Received" || $status == "CAO Released"){
								$className = 'label19';
							}	
						}		
					}
				}

				if ($acct == 9) {
					if($field == "CheckNumber" || $field == "CheckDate" || $field ==  "NetAmount" ||  $field == "Adv" ||  $field == "Fund"   ){
						if($status == "CAO Released" ){
							$className = 'label19';
						}	
					}
				}

				if($field == 'Remarks1') {
					if($logOffice == '1061') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'For Inspection' || $status == 'Inventory') {
								$className = '';
							}
						}
					}

					if($logOffice == '1081') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'CAO Received') {
								$className = '';
							}
						}
					}

					if($logOffice == '1091') {
						if($acct == 2 || $acct == 3 || $acct == 4) {
							if($status == 'Check Preparation - CTO') {
								$className = '';
							}
						}
					}
				}

			}

			if($perm == 99){
				if($acct == 3 || $acct == 4 || $acct == 7){
					$className = 'label19';
				}

				if($field == 'Remarks1') {
					if($acct == 7){
						$className = '';
					}
				}
				
			}
			return $className;
		}

		function InfraRetentionDetailsTracker($trackingNumber) {
			$sql = "SELECT * FROM vouchercurrent WHERE TrackingPartner = '".$trackingNumber."' AND DocumentType = 'RETENTION - INFRA' LIMIT 1";
			$record = $this->query($sql);
			$data = $this->fetch_array($record);
			$sheet = "";

			if($this->num_rows($record) > 0) {

				$trackingNumber = $data['TrackingNumber'];
				$amount = $data['Amount'];
				$dateEncoded = $data['DateEncoded'];
				$dateModified = $data['DateModified'];
				$status = $data['Status'];

				$sheet = "	<table border='0' cellpadding='0' style='font-family:NOR; font-size:14px; border-spacing:0px; width:100%;'>
								<tr>
									<td colspan='5' style='padding:15px 0px 5px 0px;'><span class='data1' style='color:rgb(64, 161, 202); font-weight:bold; font-size:20px;'>Retention Tracking</span></td>
								</tr>
								<tr>
									<td style='padding:0px 5px; font-size:14px; font-weight:bold; text-align:left; border:1px solid rgb(232, 234, 235); border-right:0px;'>TN</td>
									<td style='padding:0px 5px; font-size:14px; font-weight:bold; text-align:right; border:1px solid rgb(232, 234, 235); border-left:0px; border-right:0px;'>Amount</td>
									<td style='padding:0px 5px; font-size:14px; font-weight:bold; text-align:left; border:1px solid rgb(232, 234, 235); border-left:0px; border-right:0px;'>Status</td>
									<td style='padding:0px 5px; font-size:14px; font-weight:bold; text-align:left; border:1px solid rgb(232, 234, 235); border-left:0px; border-right:0px;'>Encoded</td>
									<td style='padding:0px 5px; font-size:14px; font-weight:bold; text-align:left; border:1px solid rgb(232, 234, 235); border-left:0px;'>Last Updated</td>
								</tr>
								<tr>
									<td colspan='5' style='padding:1px 0px; border-top:1px solid gray;'></td>
								</tr>
								<tr>
									<td style='padding:0px 5px; border:1px solid rgb(232, 234, 235); border-right:0px; cursor:pointer;' onclick='searchThisPartner(this)' class='hover'>".$trackingNumber."</td>
									<td style='padding:0px 5px; border:1px solid rgb(232, 234, 235); border-right:0px; text-align:right;'>".number_format($amount, 2)."</td>
									<td style='padding:0px 5px; border:1px solid rgb(232, 234, 235); border-right:0px;'>".$status."</td>
									<td style='padding:0px 5px; border:1px solid rgb(232, 234, 235); border-right:0px;'>".$dateEncoded."</td>
									<td style='padding:0px 5px; border:1px solid rgb(232, 234, 235);'>".$dateModified."</td>
								</tr>
							</table>";
			}

			return $sheet;

		}

		function InfrapaymentBreakdown($trackingNumber){
			// $sql = "select * from infrapayment where InfraTracking ='" . $trackingNumber ."' order by id asc";
			// $record = $this->query($sql);

			$sql = "SELECT TrackingNumber FROM infrapayment WHERE InfraTracking = '".$trackingNumber."' LIMIT 1";
			$record = $this->query($sql);
			$pyTN = "";
			if($this->num_rows($record) > 0) {
				$data = $this->fetch_array($record);
				$pyTN = $data['TrackingNumber'];
			}

			$sql = "SELECT BatchNumber FROM particulars WHERE TrackingNumber = '".$pyTN."' LIMIT 1";
			$record = $this->query($sql);
			$pyBatchNum = "";
			if($this->num_rows($record) > 0) {
				$data = $this->fetch_array($record);
				$pyBatchNum = $data['BatchNumber'];
			}

			if(strlen(trim($pyBatchNum)) > 0) {

				$temp = explode('*', $pyBatchNum);
				// $sql = "SELECT TrackingNumber FROM particulars where BatchNumber ='".$pyBatchNum."'";
				$sql = "SELECT TrackingNumber FROM particulars where SUBSTRING_INDEX(BatchNumber,'*',-1) = '".$temp[1]."'";
				$record = $this->query($sql);

				$pyTNs = "";
				while ($data = $this->fetch_array($record)) {
					$pyTNs .= ",'".$data['TrackingNumber']."'";
				}

				$sql = "SELECT * FROM infrapayment WHERE TrackingNumber IN (".substr($pyTNs, 1).") ORDER BY Id ASC";
				$record = $this->query($sql);

			}else{
				$sql = "select * from infrapayment where InfraTracking ='" . $trackingNumber ."' order by id asc";
				$record = $this->query($sql);
			}

			$count = $this->num_rows($record);
			$sheet = '';
			if($count > 0){
				$sheet .= '<tr>
				 			<td colspan = "3" style = "padding:15px 0px 5px 0px;">
				 				<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Payment History </span>
				 			</td>
			 			</tr>';
				$sheet .= '<tr><td colspan ="3"><table id ="infraPaymentHistory" style ="font-family:NOR;margin:0 auto;font-size:14px;border-collapse:collapse;width:100%;background-color:white;padding:50px;" border ="0">';
				$sheet .= '<tr><td colspan = "100%" style ="background-color:rgb(227, 236, 239);padding:0px 5px;letter-spacing:2px;font-size:13px;"></td></tr>';
				$sheet .= '<tr>
						   		<th style = "padding:2px 5px;border-left:1px solid rgb(232, 234, 235);">TN</th>
						   		<th style = "padding:2px 5px;text-align:left;">Payment</th>
						   		<th style = "padding:2px 5px;">Variation</th>
						   		<th style = "padding:2px 5px;">Unperformed</th>
						   		<th style = "padding:2px 5px;">Contract</th>
						   		<th style = "padding:2px 5px;">Adjustment</th>
						   		
						   		<th style = "padding:2px 5px;">T.Progress</th>
						   		<th style = "padding:2px 5px;">B.Progress</th>
						   		<th style = "padding:2px 5px;text-align:center;">S.Curve</th>
						   		<th style = "padding:2px 5px;text-align:right;">Billed&nbsp;Amount</th>
						   		<th style = "padding:2px 5px;text-align:right;">2(%)</th>
						   		<th style = "padding:2px 5px;text-align:right;">5(%)</th>
						   		<th style = "padding:2px 5px;text-align:right;">Tax</th>
						   		<th style = "padding:2px 5px;text-align:right;">Ret</th>
						   		<th style = "padding:2px 5px;text-align:right;">Delay</th>
						   		<th style = "padding:2px 5px;text-align:right;">LD</th>
						   		<th style = "padding:2px 5px;text-align:right;border-right:1px solid rgb(232, 234, 235);">Net</th>
						   </tr>
						   <tr><td colspan ="100%" style = "border-top:1px solid grey;"></td></tr>	
						   ';
				$totalGross = 0;		   
				$totalNet = 0;
				$totalTwo =0;
				$totalFive =0;
				$totalRetention =0;
				$totalTax =0;
				$totalLD =0;
				
				$retentionTotal = 0;
				$done = 0;
				$lastProgress = 0;
				$billedProgress = 0;
				$ld = 0;
				$type = array('1st Payment','2nd Payment','3rd Payment','4th Payment','5th Payment','6th Payment','7th Payment','Final Payment');
				while($data = $this->fetch_array($record)){
						$infaTN = $data['TrackingNumber'];
						$infaPaymentType = $data['Type'];
						$arrayKey = array_search($infaPaymentType, $type);
						unset($type[$arrayKey]);
						if($infaPaymentType == 'Final Payment'){
							$done = 1;
						}
						
						$progress = $data['Progress'];
						$actual = $data['Actual'];
						
						
						$variationSaved =  $data['Variation'];
						$unperformedSaved = $data['Unperformed'];
						if($variationSaved > 0 || $unperformedSaved > 0){
							$adjustment = number_format($data['ActualAdjustment']);
						}else{
							$adjustment = '';
						}
						$gross = $data['Gross'];
						$billedProgress = $data['BilledProgress'];
						$lastProgress = $progress;
						$sCurve = $data['Scurve'];
						$delay = $data['Delay'];
						$tax = $data['Tax'];
						$retention = $data['Retention'];
						
						$net = $data['Net'];
						$two = $data['Two'];
						$five = $data['Five'];
						$ld = $data['LD'];

						$ldPercentage = '';
						if($data['LDpercentage'] != '') {
							$ldPercentage = "<span style='color:rgb(72, 169, 220); margin-left:3px;'>(".($data['LDpercentage'] * 100)."%)</span>";
						}

						$retentionTotal += $retention;
						$totalTax += $tax;
						$totalTwo += $two;
						$totalFive += $five;
						$totalNet += $net;
						$totalGross += $gross;
						$sheet .= '<tr>
							   		<td style = "padding:0px 5px;cursor:pointer; white-space:nowrap;" class = "hover" onclick ="searchThisPartner(this)">' . $infaTN . '</td>
							   		<td style = "padding:0px 5px;white-space:nowrap;">' . $infaPaymentType . '</td>
							   		<td style = "padding:0px 5px;text-align:right;border-bottom:1px solid rgb(232, 234, 235);">' . $this->zeroToNothing(number_format($variationSaved,2)) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;border-bottom:1px solid rgb(232, 234, 235);">' . $this->zeroToNothing(number_format($unperformedSaved,2)) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;border-bottom:1px solid rgb(232, 234, 235);">' . number_format($actual,2) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;border-bottom:1px solid rgb(232, 234, 235);">' . $adjustment . '</td>
							   		<td style = "text-align:center;">' . $progress . '</td>
							   		<td style = "text-align:center;">' . $billedProgress . '</td>
							   		
							   		<td style = "padding:0px 5px;text-align:center;">' . $sCurve . '</td>
							   		<td style = "text-align:right;">' . number_format($gross,2) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;">' .number_format($two,2) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;">' .number_format($five,2) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;">' .number_format($tax,2) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;">' . number_format($retention,2) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;">' . $this->zeroToEmpty($delay) . '</td>
							   		<td style = "padding:0px 5px;text-align:right;">' . $this->zeroToEmpty(number_format($ld,2)) . $ldPercentage . '</td>
							   		<td style = "padding:0px 5px;text-align:right;border-right:1px solid rgb(232, 234, 235);">' . number_format($net,2) . '</td>
							   </tr>';
					}
					$sheet .= ' <tr>
									
									<th ></th>
									<th ></th>
									
									<th colspan ="7"></th>
									<th style = "text-align:right;color:rgb(10, 82, 149);font-weight:bold;">' . number_format($totalGross,2) .'</th>
									
									<th style = "padding:5px;text-align:right;color:rgb(10, 82, 149);font-weight:normal;">' . number_format($totalTwo,2) . '</th>
									<th style = "padding:5px;text-align:right;color:rgb(10, 82, 149);font-weight:normal;">' . number_format($totalFive,2) . '</th>
									<th style = "padding:5px;text-align:right;color:rgb(10, 82, 149);font-weight:normal;">' . number_format($totalTax,2) . '</th>
									<th style = "padding:5px;text-align:right;color:rgb(10, 82, 149);font-weight:normal;">' . number_format($retentionTotal,2) . '</th>
									<th></th>
									<th style = "padding:5px;text-align:right;color:rgb(10, 82, 149);font-weight:normal;">' . $this->zeroToEmpty(number_format($ld,2)) . '</th>
									
									<th style = "padding:5px;text-align:right;"><span style = "color:red;font-weight:bold;">' . number_format($totalNet,2) . '</span></th>
								</tr>';	
					$sheet .= ' <tr><th colspan ="100%"  style = "padding:5px;"></th></tr>';	
				$sheet .= '</table></td></tr>';
			}
			
			return $sheet;
		}
		function PYinfo($complex,$batchTracking,$subCode,$checkNumber, $checkDate,$trackingType,$status,$officeName,$obrNumber,$className,$trackingNumber,$adv,$claimant,$grp,$pendingNote,$encodedBy,$dateEncoded,$dateUpdated,$completion,$fund,$docType,$claimType,$period,$amount,$netAmount,$payeeNumber,$periodType,$trackingPartner,$office,$programCode,$controlNo,$nf,$remark,$peorOfc,$trackYear,$variation,$conformDate,$caoOfficerId,$caoOfficer,$mxBatchNumber,$variation1,$variation2,$variationOBR2,$drrmo,$forDrrmo,$remarksNote){
			
			$sheet = '<table class = "doctrackUpdateTable" border ="0"  style = "margin:0 auto;min-width:650px;max-width:750px; border-spacing:0px;">';
			$sheet .= '<tr style = "background-color:rgb(245, 246, 246);background-color:rgb(23, 207, 253);">
					   		<td colspan ="3"  style = "text-align:left;padding:15px 0px;padding-bottom:10px;">
					   			<span class = "label7" style = "color:white;padding-left:20px;">Status</span>
								<span id ="trackType" style = "text-shadow:0px 0px 10px black;color:rgb(42, 122, 172);font-weight:bold;color:white;font-size:34px;" class = "data1">' . $trackingType . ' - </span>
								<span id = "labelStatus" style = "text-shadow:0px 0px 10px black;color:rgb(42, 122, 172);font-weight:bold;color:white;font-size:34px;" class = "data1">' . $status . '</span>
								<div style = "color:black;padding-left:5px;width:110px; display:inline-block;display:none;" >' . $this->ezDate1($dateUpdated) . '</div>
								<div  class = "data1"  style = "padding:5px;padding-left:75px;color:white;text-shadow:0px 0px 1px white;">' . $officeName .  '</div>
							</td>
					   <tr>';
			$sheet .= '<tr><td colspan = "3" style = "padding:5px;"><hr style = "border:0;border-top:0px solid silver;"/></td></tr>';	//------------------   	
				   
			$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">' . 
							 $this->CreateGenDetailsPY($complex,$batchTracking,$subCode,$checkNumber, $checkDate,$obrNumber,$className,$trackingNumber,$adv,$claimant,$fund,$docType,$claimType,$period,$amount,$netAmount,$payeeNumber,$periodType,$trackingPartner,$status,$office,$programCode,$controlNo,$trackingType,$nf,$peorOfc,$variation,$trackYear,$variation1,$variation2,$variationOBR2,$drrmo,$forDrrmo)  .
					 '</td></tr>';
			$className ='';

			if($trackingType == "NF"){
				$sheet .= "	<tr>
								<td colspan='3' style='padding:0px; padding-bottom:20px;'>
									".$this->InfraManpowerSheet($trackingNumber, $trackingType, $status, $office, $nf)."
								</td>
							</tr>";
			}

			// if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE" || $docType == "ASSISTANCE - FINANCIAL"){
				
			// 	$sql = "SELECT * FROM particulars WHERE TrackingNumber = '".$trackingNumber."' LIMIT 1";
			// 	$record = $this->query($sql);
			// 	$data = $this->fetch_array($record);

			// 	$dispDocType = "";
				
			// 	$temp = explode(" - ", $docType);
			// 	$genType = $temp[0];
			// 	$spcType = $temp[1];

			// 	$dispDocType = $spcType." ".$genType;
			// 	if($genType == 'WAGES') {
			// 		$dispDocType = $spcType;
			// 		if($spcType == 'SALARY PLANTILLA') {
			// 			$dispDocType = "salaries of officials and employees";
			// 		}elseif(substr($spcType, 0, 10) == 'SALARY J.O') {
			// 			$dispDocType = "services rendered of J.O/Contract of Service";
			// 		}elseif($spcType == 'OVERTIME PAY (J.O)') {
			// 			$dispDocType = "OVERTIME PAY of J.O/Contract of Service";
			// 		}elseif($spcType == 'OVERTIME PAY (Plantilla)') {
			// 			$dispDocType = "OVERTIME PAY of officials and employees";
			// 		}elseif($spcType == 'SALARY DIFFERENTIAL') {
			// 			$dispDocType = $spcType." of officials and employees";
			// 		}elseif($spcType == 'BACK PAY') {
			// 			$dispDocType = 'salaries of officials and employees';
			// 		}
			// 	}

			// 	if($genType == 'ALLOWANCE') {
			// 		if($spcType == "CELLCARD" ){
			// 			$dispDocType = "CELLCARD EXPENSE of officials and employees";
			// 		}elseif( $spcType == "TRAVEL"){
			// 			$dispDocType = "TRAVELLING EXPENSE of officials and employees";
			// 		}elseif( $spcType == "TRANSPORTATION"){
			// 			$dispDocType = "TRANSPORTATION EXPENSE of officials and employees";
			// 		}else {
			// 			$dispDocType = $spcType." ".$genType;
			// 		}
			// 	}

			// 	if($genType == 'BENEFITS') { 
			// 		$dispDocType = $spcType." ".$genType." of officials and employees";

			// 		if($docType == "BENEFITS - ELAP"){
			// 			$dispDocType = "ELAP granted to employees of the City Government of Davao";
			// 		}
			// 	}



			// 	$p = "";
			// 	if($periodType  == 1 ){
			// 		$p = "1-15 ";
			// 	}else if($periodType  == 2){
			// 		$p = "16-31 ";
			// 	}else if($periodType  == 3){
			// 		$p = "";
			// 	}else{
			// 		$p = "";
			// 	}

			// 	$explanation = "To payment of ".$dispDocType." for the month of ".$period." ".$p.$trackYear.", as per supporting papers hereto attached in the amount of";

			// 	if($genType == 'ASSISTANCE') { 
			// 		if($spcType == 'FINANCIAL') {
			// 			$explanation = "To payment of FINANCIAL ASSISTANCE to ".trim($claimant).", as per supporting papers hereto attached in the amount of";
			// 		}
			// 	}

			// 	if(strlen(trim($data['Particulars'])) > 0) {
			// 		$explanation = nl2br($data['Particulars']);
			// 	}

			// 	$className =  $this->permissionClassByField($trackingType,$status,$office,"WGSParticulars"); 

			// 	$sheet .= "	<tr>
			// 					<td colspan='3' style=''>
			// 						<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Particulars</span>
			// 						<table border='0' cellpadding='0' style='border-spacing:0px; border-collapse:collapse; font-family:Oswald; width:100%;'>
			// 							<tr>
			// 								<td colspan='4' style='width:0px; white-space:nowrap; padding:0px 10px 0px 30px; font-size:18px;'>
			// 									<span class='genDtlLabel' style='display:none;'>Explanation</span>
			// 								</td>
			// 							</tr>
			// 							<tr>
			// 								<td colspan='3' style='padding:5px 0px 5px 62px;'>
			// 									<div style='border:1px solid silver; border-right:1px solid rgba(225,225,225,.9); border-bottom:1px solid rgba(225,225,225,.9); padding:8px 10px; font-size:14px; font-family:Oswald; text-align:justified; background-color:white; text-align:justify; max-width:1000px;'>
			// 										".$explanation."
			// 									</div>
			// 								</td>
			// 								<td style='width:0px; padding:0px 10px 0px 10px;'>
			// 									<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editParticularsForThisWGS(this)'>EDIT</span>
			// 								</td>
			// 							</tr>
			// 						</table>
			// 					</td>
			// 				</tr>";
				
			// }

			$className = $this->permissionClassByField($trackingType,$status,$office,"CAOOfficer");
			$sheet .= "	<tr>
							<td colspan='3' style='padding:15px 40px 10px 0px;'>
								<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Audit and Compliance Officers</span>
								<table border='0' cellpadding='0' style='border-spacing:0px; border-collapse:collapse; font-family:Oswald; margin:5px 0px 5px 20px;'>
									<tr>
										<td style='width:0px; white-space:nowrap; padding:0px 5px 0px 37px; font-size:18px;'>
											<span class='data1 genDtlLabel'>Accounting Evaluator</span>
										</td>
										<td id='officer".$caoOfficerId."' style='border-bottom:1px solid silver; padding:0px 10px 0px 0px; font-weight:bold; font-size:22px; white-space:nowrap; min-width:350px; width:100%;'>".utf8_encode($caoOfficer)."</td>
										<td style='padding-left:10px;'>
											<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editThis(this)'>EDIT</span>
										</td>
									</tr>
								</table>
							</td>
						</tr>";

			if($docType == 'BOND - RETENTION MONEY') {
				$sql = "SELECT a.TrackingNumber as poTN, a.PO_Number, b.InvoiceNumber, b.InvoiceDate, c.TrackingNumber as pxTN, d.TrackingNumber as txTN, d.Retention
						FROM vouchercurrent a 
						LEFT JOIN particulars b ON a.TrackingNumber = b.TrackingNumber
						LEFT JOIN vouchercurrent c ON c.TrackingPartner = a.TrackingNumber
						LEFT JOIN pxvouchertax d ON c.TrackingNumber = d.TrackingNumber
						WHERE a.TrackingPartner = '".$trackingNumber."' GROUP BY c.TrackingNumber, a.TrackingNumber;";
				$record2 = $this->query($sql);
				
				$retRow = 0;
				$retTotalRet = 0;
				$poList = "";
				$poList .= "<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>List of POs</span>
							<table border='0' cellpadding='0' style='border-spacing:0px; border-collapse:collapse; font-family:Oswald; margin:5px 0px 5px 20px; width:100%;'>
								<tr style='background-color:rgb(121, 137, 141); color:white; font-weight:bold;'>
									<td style='padding:2px 10px; width:0px;'></td>
									<td style='padding:2px 8px;'>TN</td>
									<td style='padding:2px 8px;'>PO No.</td>
									<td style='padding:2px 8px;'>Invoice No.</td>
									<td style='padding:2px 8px;'>Invoice Date</td>
									<td style='padding:2px 8px; text-align:right;'>Retention</td>
								</tr>";

				while ($data2 = $this->fetch_array($record2)) {
					$retPoTN = $data2['poTN'];
					$retPoNumber = $data2['PO_Number'];
					$retInvNumber = $data2['InvoiceNumber'];
					$retInvDate = $data2['InvoiceDate'];
					$retRetention = $data2['Retention'];

					$poList .= "<tr style='border-bottom:1px solid rgb(234, 233, 233);'>
									<td style='padding:2px 10px; text-align:center; font-weight:bold; font-size:10px; border-bottom:1px solid transparent;'>".++$retRow."</td>
									<td style='padding:2px 8px;' class='hover' onclick='searchThisPartner(this)'>".$retPoTN."</td>
									<td style='padding:2px 8px;'>".$retPoNumber."</td>
									<td style='padding:2px 8px;'>".$retInvNumber."</td>
									<td style='padding:2px 8px;'>".$retInvDate."</td>
									<td style='padding:2px 8px; text-align:right;'>".number_format($retRetention, 2)."</td>
								</tr>";

					$retTotalRet += $retRetention;
					
				}

				$poList .= "<tr>
								<td colspan='6' style='text-align:right; font-weight:bold; color:red; padding:2px 8px;'><span style='margin-right:10px; color:black;'>Total</span>".number_format($retTotalRet, 2)."</td>
							</tr>";

				$poList .= "</table>";

				$sheet .= "	<tr>
								<td colspan='3' style='padding:15px 40px 10px 0px;'>
								".$poList."
								</td>
							</tr>";

			}

			
			$sheet .= '<tr><td colspan = "3" ><hr style = "border:0;border-top:1px solid silver;"/></td></tr>';	//------------------
			
			//----slp
			
			//daan na SLP before merging sa payrol brgs
			if(substr($docType,0,3) == "SLP"){
				$sheet .='<tr>
								<td colspan = "2" style = "padding:5px;"><span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Salary List of Payroll</span>
							</tr><tr>
						    <td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">';  
							
				$sql = "select TrackingNumber, Claimant, NetAmount from vouchercurrent where BatchTracking = '" . $trackingNumber . "' group by trackingnumber order by claimant asc";
				$record = $this->query($sql);			
				$count = $this->num_rows($record);
				$sheetSLP = '<table style = "width:100%;border-spacing:0;font-family:oswald;">';
				$sheetSLP .= '<tr style = "background-color:rgb(121, 137, 141);color:white;">
								<td class="dataHeader1" style = "padding-left:5px;"></td>
								<td class="dataHeader1" >TN</td>
								<td class="dataHeader1">Claimant</td>
								<td class="dataHeader1" style = "text-align:right;padding-right:10px;">Net Amount</td>
								';
				$i = 1;		
				$totalSLP = 0; 	
				while($data = $this->fetch_array($record)){
					$tnSLP = $data['TrackingNumber'];
					$claimantSLP = $data['Claimant'];
					$netSLP = $data['NetAmount'];
					$totalSLP += $netSLP;
					$sheetSLP .= '<tr >
									<td style = "padding-left:5px;font-weight:bold;font-size:10px;text-align:center;">' .$i++ . '</td>
									<td  style = "border-bottom:1px solid rgb(234, 233, 233);" class="hover" onclick="searchThisPartner(this)">' .$tnSLP . '</td>
									<td  style = "border-bottom:1px solid rgb(234, 233, 233);">' . utf8_encode($claimantSLP) . '</td>
									<td style = "text-align:right;padding-right:10px;border-bottom:1px solid rgb(234, 233, 233);">' . number_format($netSLP,2) . '</td></tr>';
				}
				$sheetSLP .= '<tr >
									<td colspan ="100%;" style = "text-align:right;padding-right:10px;border-bottom:1px solid rgb(234, 233, 233);color:red;font-weight:bold;">' . number_format($totalSLP,2) . '</td></tr>';
				$sheetSLP .= '</table>';
				
				$sheet .= $sheetSLP;
				$sheet .='</td></tr>';
			}
			
			
			if($fund != "Trust Fundx"  ){
					
					if(strtoupper(trim($docType)) != "LIQUIDATION"){
						if( $periodType != 2){
							
							if($programCode != ''){
								$className =  $this->permissionClassByField($trackingType,$status,$office,"OBRdetails"); 
								
								if($trackingType != "NF"){
									// $sheet .= '<tr><td colspan = "2" style = "padding:5px;"><span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">OBR Information</span>
									// 	 	<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' .  urlencode($claimant) . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
									// 	 	<span class = "data1 lnk">OBR Form</span></a>
									// 	 	<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;font-size:22px;letter-spacing:1px;color:black;padding-left:10px;"><span class = "data1 lnk">DV Form</span></a>';
									
									if(substr($trackingNumber,0,4) == "LING"){
										$sheet .= '	<tr>
														<td colspan = "2" style = "padding:5px;">
															<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">OBR Information</span>
															<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' .  urlencode($claimant) . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
																<span class = "data1 lnk">OBR Form</span>
															</a>
															<a href = "../interface/formDVLing.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;font-size:22px;letter-spacing:1px;color:black;padding-left:10px;">
																<span class = "data1 lnk">DV Form</span>
															</a>
															<a href = "../interface/formBeneficiaries.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "label8">view Beneficiaries</span></a>';
									}
									else if($docType == "WAGES - SALARY PLANTILLA" || $docType == "WAGES - BACK PAY"){
									// else if(substr($docType, 0, 5) == "WAGES"){
									// else if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE" || $docType == "ASSISTANCE - FINANCIAL"){
										$sheet .= '	<tr>
														<td colspan = "2" style = "padding:5px;">
															<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">OBR Information</span>
															<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' .  urlencode($claimant) . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
																<span class = "data1 lnk">OBR Form</span>
															</a>
															<a href = "../interface/formDVWgs.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;font-size:22px;letter-spacing:1px;color:black;padding-left:10px;">
																<span class = "data1 lnk">DV Form</span>
															</a>';
									}else {
										$sheet .= '	<tr>
														<td colspan = "2" style = "padding:5px;">
															<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">OBR Information</span>
															<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' .  urlencode($claimant) . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
																<span class = "data1 lnk">OBR Form</span>
															</a>
															<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;font-size:22px;letter-spacing:1px;color:black;padding-left:10px;">
																<span class = "data1 lnk">DV Form</span>
															</a>';
									}
								
								}else{
									//$sheet .= $this->InfrapaymentBreakdown($trackingNumber);
									
									/*$sheet .= '<tr style ="background-color1:rgb(243, 248, 248);">
				 								<td colspan = "3" style = "padding:10px 0px;">
				 									' . $this->InfrapaymentBreakdown($trackingNumber) . '
				 								</td></tr>';*/

									$sheet .= $this->InfrapaymentBreakdown($trackingNumber);

									$sheet .= "<tr><td>".$this->InfraRetentionDetailsTracker($trackingNumber)."</td></tr>";

								 	$sheet .= '<tr>
								 			<td colspan = "3" style = "padding-top:10px;">
								 				<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Printables </span>';
								 				
								 				
								 	
								 	// if($_SESSION['accountType'] == 7 || $_SESSION['perm'] == 38 || $_SESSION['perm'] == 42){			
									if($_SESSION['accountType'] == 7){			
								 		$sheet .= '<span id = "obrEdit' . $trackingNumber   . '" class = "button1" style = "margin-right:10px;float:right;font-size:16px;width:90px;" onclick = "editINFRAStatus(this, \''.addslashes($status).'\')">Edit&nbsp;Status</span>';
									}	 	
									$sheet .= '<div style = "line-height:28px;"><a href = "../interface/formINFRA.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
										 	<span class = "data1 lnk">1. Infra Form</span></a></div>';
									if($fund == "General Fund"  || $fund == "SEF"){
										
										$sheet .= '<div style = "line-height:32px;"><a href = "../interface/formCertificationGF.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
											   <span class = "data1 lnk">2. Certificate of Available Appropriation</span></a></div>';
										$sheet .= '<div style = "line-height:24px;"><a href = "../interface/formOBRNF.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" 
												   style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;"><span class = "data1 lnk">3. OBR Form</span></a></div>';					
										
										// if($variation > 0){
										// 	$sheet .= '<div style = "line-height:24px;"><a href = "../interface/formOBRNFvariation.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" 
										// 		   style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;"><span class = "data1 lnk">4. OBR Form Variation</span></a></div>';	
										// 	$sheet .= '<div style = "line-height:28px; margin-bottom:10px;"><a href = "../interface/formINFRAPaymentHistory.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
										//  		<span class = "data1 lnk">5. Payment History</span></a></div>';
										// }else{
										// 	$sheet .= '<div style = "line-height:28px; margin-bottom:10px;"><a href = "../interface/formINFRAPaymentHistory.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
										//  		<span class = "data1 lnk">4. Payment History</span></a></div>';
										// }

										$sheet .= '	<div style = "line-height:28px;">
														<a href = "../interface/formINFRAPaymentHistory.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
															<span class = "data1 lnk">4. Payment History</span>
														</a>
													</div>';
										
										if($variation > 0){
											$sheet .= '	<div style = "line-height:24px;">
															<a href = "../interface/formOBRNFvariation.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
																<span class = "data1 lnk">5. OBR Form Variation 1</span>
															</a>
														</div>';
										}
										if($variation2 > 0){
											$sheet .= '	<div style = "line-height:24px;">
															<a href = "../interface/formOBRNFvariation1.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
																<span class = "data1 lnk">6. OBR Form Variation 2</span>
															</a>
														</div>';

										}
														
										
									}
									if($fund == "Trust Fund"){
										$sheet .= '<div style = "line-height:26px;"><a href = "../interface/formCertificationTF.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
										 		  <span  class = "data1 lnk">2. Certificate of Availability of Fund</span></a></div>';
										$sheet .= '<div style = "line-height:28px; margin-bottom:10px;"><a href = "../interface/formINFRAPaymentHistory.php?trackingNumber=' . $trackingNumber . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
										 		<span class = "data1 lnk">3. Payment History</span></a></div>';
									}	
									 	
										 		
										 		
										 		
								}

								/*
									//link ni sa cheke cto module
									if($_SESSION['cbo'] == '1091' || $_SESSION['accountType'] == '7'){
										//$sheet .= '	<a href = "../interface/formcheque.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;font-size:22px;letter-spacing:1px;color:black;padding-left:10px;"><span class = "data1 lnk">Check</span></a>';
									}
								*/
										 	
								// if(substr($trackingNumber,0,4) == "LING"){
								// 		$sheet .= '<a href = "../interface/formBeneficiaries.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "label8">view Beneficiaries</span></a>';
								// }

								//Addt'l para ma-distinguish kong unsa editor ang gamiton pati ang parameters sa editOBRAmount - 05-21-2021
								$editOBRAmount = 1;
								// if(substr($docType,0,5) == "WAGES" || $docType == "BENEFITS - PAHALIPAY" || $docType == "BENEFITS - CNA AND PEI" || $docType == "BENEFITS - SERVICE RECOGNITION INCENTIVE"){
								// if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE" || $docType  == "ASSISTANCE - FINANCIAL"){
								// 	$sheet .= '<a href = "../interface/formBreakdownWages.php?tn=' . $trackingNumber . '" target="_blank" style = "text-decoration:none; margin-left:10px;"><span class = "label8">view Breakdown</span></a>';
								// 	$editOBRAmount = 2;	
								// }
								
								if( ($_SESSION['accountType'] == 1 && $_SESSION['cbo'] == $office) || ($_SESSION['accountType'] != 1 && $_SESSION['cbo'] == '1081') ){
									if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE" || $docType  == "ASSISTANCE - FINANCIAL"){
										if(substr($trackingNumber, 0, 4) != 'LING') {
											$sheet .= '<a href = "../interface/formBreakdownWages.php?tn=' . $trackingNumber . '" target="_blank" style = "text-decoration:none; margin-left:10px;"><span class = "label8">view Breakdown</span></a>';
											// $editOBRAmount = 2;	
										}

										if($office == "ROD1" || $office == "HALL" || $office == "COA1" || $office == 'PEFI'){ 
											$editOBRAmount = 1;	
										}else {
											$editOBRAmount = 2;	
										}
									}
								}

								if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE" || $docType  == "ASSISTANCE - FINANCIAL"){
									// $editOBRAmount = 2;	

									if($office == "ROD1" || $office == "HALL" || $office == "COA1" || $office == 'PEFI'){ 
										$editOBRAmount = 1;	
									}else {
										$editOBRAmount = 2;	
									}
								}

								if($_SESSION['perm'] == 38 || $_SESSION['accountType'] == 7){
								/*	$sheet .= '		</td>
													<td style = "padding-right:16px;padding-top:25px;text-align:right;">
														<span id = "obrEdit' . $trackingNumber   . '" class = "button1" style = "width:75px;text-shadow:0px 0px 1px GREY; padding:5px 10px;font-weight:bold;color:white;letter-spacing:1px;font-size:14px;background-color:rgb(18, 184, 240); " onclick = "editINFRAStatus(this, \''.addslashes($status).'\')">Edit&nbsp;Status</span></a>
													</td>
												</tr>';*/

								}elseif($trackingType != "NF"){
									$sheet .= '		</td>
													<td style = "padding-right:16px;padding-top:25px;text-align:right;">
														<span id = "obrEdit' . $trackingNumber   . '" class = "button1 ' . $className . '" style = "width:75px;text-shadow:0px 0px 1px GREY; padding:5px 10px;font-weight:bold;color:white;letter-spacing:1px;font-size:14px;background-color:rgb(18, 184, 240); " onclick = "editOBRAmount(this,'.$editOBRAmount.')">Edit&nbsp;items</span></a>
													</td>
												</tr>';		
								}
								if($trackingType != "NF"){
									if($grp != "") {
										$className = "hide";
										$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">' .  
												 $this->CreateViewGroupDetails($grp) . 
									 		 '</td></tr>';
									}
								}
							}else{
								
								
								// Addt'l na edit para sa PAYMASTER
								$forPAY = "";
								$forRET = "";
								// if($docType == "CASH ADVANCE TO PAYMASTER" && $_SESSION['accountType'] == 2){
								// 	// $forPAY = "<a onclick='openPaymasterEditor(\"".$trackingNumber."\")' style = 'text-decoration:none;'><span class = 'label8'>Edit Breakdown</span></a>";
								// 	$forPAY .= "<a href='../interface/formPM.php?trackingNumber=". $trackingNumber ."' target='_blank' style = 'text-decoration:none;'><span class = 'label8'>View Summary</span></a>";
								// 	$forPAY .= "<a href='../interface/formPMBreakDown.php?trackingNumber=". $trackingNumber ."' target='_blank' style = 'text-decoration:none;'><span class = 'label8'>View Breakdown</span></a>";
								// }else 
								if($docType == "BOND - RETENTION MONEY"){
									if($status == "Encoded" || substr($status,0, 16) == 'Pending Released'){
										$sheet .= '	<tr>
														<td colspan = "2" style = "padding:5px;">
															<span style  = "font-style:italic;color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Voucher Form</span>
															<a href = "../interface/formDVRet.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;">
																<span class = "label8">preview DV</span>
															</a>
															<a onclick="openRetentionEditor(this)" id="newRET'.$trackingNumber.'" style = "text-decoration:none;"><span class = "label8">Edit Breakdown</span></a>
														</td>
													</tr>
													';
										$forRET = "<a onclick='openRetentionEditor(\"".$trackingNumber."\")' style = 'text-decoration:none;'><span class = 'label8'>Edit Breakdown</span></a>";
									}
								}

								if($trackingType == "IP"){
									$sql = "select InfraTracking from infrapayment where trackingnumber = '" . $trackingNumber . "'";
									$record = $this->query($sql);
									$data = $this->fetch_array($record);
									$trackingProject = $data['InfraTracking'];
									
									$sheet .= $this->InfrapaymentBreakdown($trackingProject);
									
								}

								if($docType == "CASH ADVANCE TO PAYMASTER"){
									// $sheet .= "	<tr>
									// 				<td colspan='3' style='line-height:22px;'>
									// 					<span class='data1' style='color:rgb(64, 161, 202); font-weight:bold; font-size:20px;'>Printables</span>
									// 					<div style='margin-top:10px;'>
									// 						<a href='../interface/formDV.php?trackingNumber=".$trackingNumber."' target='_blank' style = 'padding-left:10px; text-decoration:none; font-size:22px; letter-spacing:1px; color:black;'><span class='data1 lnk'>1. DV Form</span></a>
									// 					</div>
									// 					<div>
									// 						<a href='../interface/formPM.php?trackingNumber=". $trackingNumber ."' target='_blank' style = 'padding-left:10px; text-decoration:none; font-size:22px; letter-spacing:1px; color:black;'><span class='data1 lnk'>2. Paymaster Summary</span></a>
									// 					</div>
									// 					<div>
									// 						<a href='../interface/formPMBreakDown.php?trackingNumber=". $trackingNumber ."' target='_blank' style = 'padding-left:10px; text-decoration:none; font-size:22px; letter-spacing:1px; color:black;'><span class='data1 lnk'>3. Paymaster Summary with Breakdown</span></a>
									// 					</div>
									// 					<div>
									// 						<a href='../ajax/excelCreator.php?pmSaveToExcel=1&trackingNumber=". $trackingNumber ."' target='_blank' style = 'padding-left:10px; text-decoration:none; font-size:22px; letter-spacing:1px; color:black;'><span class='data1 lnk'>4. Save to Excel</span></a>
									// 					</div>
									// 				</td>
									// 			</tr>";

									$sheet .= "	<tr>
													<td colspan='3' style='line-height:22px;'>
														<span class='data1' style='color:rgb(64, 161, 202); font-weight:bold; font-size:20px;'>Printables</span>
														<div style='margin-top:10px;'>
															<a href='../interface/formDV.php?trackingNumber=".$trackingNumber."' target='_blank' style = 'padding-left:10px; text-decoration:none; font-size:22px; letter-spacing:1px; color:black;'><span class='data1 lnk'>1. DV Form</span></a>
														</div>
														<div>
															<a href='../ajax/excelCreator.php?pmSaveToExcel=1&trackingNumber=". $trackingNumber ."' target='_blank' style = 'padding-left:10px; text-decoration:none; font-size:22px; letter-spacing:1px; color:black;'><span class='data1 lnk'>2. Save to Excel</span></a>
														</div>
													</td>
												</tr>";

									// $sheet .= "	<tr>
									// 				<td style='padding:5px;'>
									// 					<span class='data1' style='color:rgb(64,161,202); font-weight:bold; font-size:20px;'>List of Payroll</span>
									// 				</td>
									// 				<td colspan='2' style='text-align:right; padding-right:5px;'>
									// 					<span class='button1' style='display:inline-block; margin-right:10px; font-size:16px; width:100px;' onclick='openPaymasterEditor(\"".$trackingNumber."\")'>Add&nbsp;Breakdown</span>
									// 				</td>
									// 			</tr>
									// 			<tr><td colspan='3' style='padding:5px 15px;'>
									// 			";

									$sheet .= "	<tr>
													<td style='padding:5px;'>
														<span class='data1' style='color:rgb(64,161,202); font-weight:bold; font-size:20px;'>List of Payroll</span>
													</td>
													<td colspan='2' style='text-align:right; padding-right:5px;'>
													</td>
												</tr>
												<tr><td colspan='3' style='padding:5px 15px;'>
												";
												
									// $sql = "SELECT 
									// 		a.TrackingNumber, a.Claimant, a.Amount, a.TotalAmountMultiple, a.NetAmount, b.NumOfEmps, b.PTRSNo, b.OfficeAssigned
									// 		FROM vouchercurrent a
									// 		LEFT JOIN particulars b ON a.TrackingNumber = b.TrackingNumber 
									// 		WHERE a.TrackingPartner = '" . $trackingNumber . "' 
									// 		GROUP BY a.TrackingNumber ORDER BY a.Claimant ASC";
									$sql = "SELECT * FROM chequerist.paymaster WHERE PMTrackYear = '".$trackYear."' AND PMTrackingNumber = '".$trackingNumber."' ORDER BY AddedClaimant ASC";
									$record = $this->query($sql);	

									$count = $this->num_rows($record);
									
									$rowsPM = "";
									$i = 1;		
									$totalPM = 0; 	
									$totalPMNet = 0; 	
									$totalEmpsPM = 0; 	
									while($data = $this->fetch_array($record)){
										// $tnPM = $data['TrackingNumber'];
										// $claimantPM = $data['Claimant'];
										// $numOfEmps = $data['NumOfEmps'];
										// $officeAssigned = $data['OfficeAssigned'];
										// $amount = floatval($data['Amount']);
										// if(strlen(trim($data['TotalAmountMultiple'])) > 0 && $data['TotalAmountMultiple'] > 0){
										// 	$amount = floatval($data['TotalAmountMultiple']);
										// }
										// $net = floatval($data['NetAmount']);

										$tnPM = $data['AddedTrackingNumber'];
										$claimantPM = $data['AddedClaimant'];
										$numOfEmps = $data['AddedNumOfEmps'];
										$officeAssigned = $data['AddedOfficeAssigned'];
										$amount = floatval($data['AddedGross']);
										$net = floatval($data['AddedNet']);
										$caTNYear = $data['AddedTrackYear'];

										$uniqClr = "";
										if($trackYear != $caTNYear) {
											$uniqClr = "color:red; font-weight:bold;";
										}


										$totalPMNet += $net;
										$totalPM += $amount;
										$totalEmpsPM += $numOfEmps;
										$remove = "";

										if($status == "Draft" || $status == "Encoded" || $status == "Pending Released - CAO") {
											if( ($_SESSION['accountType'] == 2 && $office == '1091') || $_SESSION['accountType'] == 7 ) {
												$remove = "<i style='cursor:pointer; font-weight:bold; color:red; font-style:normal; font-size:12px;' onclick='pmRemoveThisDirectInTracker(\"".$tnPM."\")'>&#x2715;</i>";
											}
										}
										
										$rowsPM .= '<tr >
														<td style = "vertical-align:top; padding:5px 8px 0px 8px; font-weight:bold; font-size:10px; text-align:center; background-color:rgba(200, 200, 200, .4); border:1px solid white; border-top:0px;">' .$i++ . '</td>
														<td style = "vertical-align:top; border-bottom:1px solid rgb(234, 233, 233); '.$uniqClr.' ">' . $caTNYear . '</td>
														<td style = "vertical-align:top; border-bottom:1px solid rgb(234, 233, 233); cursor:pointer; padding:0px 5px; white-space:nowrap;" class="hover" onclick="searchThisPartner(this)">' .$tnPM . '</td>
														<td style = "vertical-align:top; border-bottom:1px solid rgb(234, 233, 233); white-space:nowrap;">' . utf8_decode($claimantPM) . '</td>
														<td style = "vertical-align:top; border-bottom:1px solid rgb(234, 233, 233); white-space:nowrap;">' . $officeAssigned . '</td>
														<td style = "vertical-align:top; border-bottom:1px solid rgb(234, 233, 233); text-align:center;">' . $numOfEmps . '</td>
														<td style = "vertical-align:top; text-align:right;padding-right:10px;border-bottom:1px solid rgb(234, 233, 233);">' . number_format($amount,2) . '</td>
														<td style = "vertical-align:top; text-align:right;padding-right:10px;border-bottom:1px solid rgb(234, 233, 233);">' . number_format($net,2) . '</td>
														<td>'.$remove.'</td>
													</tr>';
									}
									// $rowsPM .= '<tr><td colspan ="100%;" style = "text-align:right;padding-right:10px;border-bottom:1px solid rgb(234, 233, 233);color:red;font-weight:bold;">' . number_format($totalPMNet,2) . '</td></tr>';
									$rowsPM .= '<tr>
													<td colspan="6"></td>
													<td style = "text-align:right;padding-right:10px;font-weight:bold;">' . number_format($totalPM,2) . '</td>
													<td style = "text-align:right;padding-right:10px;color:red;font-weight:bold;">' . number_format($totalPMNet,2) . '</td>
												</tr>';
									
									$sheetPM = '<table style = "width:100%;border-spacing:0;font-family:oswald; border-collapse:collapse;">';
									$sheetPM .= '<tr style = "background-color:rgb(121, 137, 141);color:white;">
													<td class="dataHeader1" style ="padding-left:5px;"></td>
													<td class="dataHeader1" style="padding:0px 5px;">Year</td>
													<td class="dataHeader1" style="padding:0px 5px;">TN</td>
													<td class="dataHeader1">Claimant</td>
													<td class="dataHeader1">Office</td>
													<td class="dataHeader1">Employees&nbsp;&nbsp;<span style="color:orange; font-weight:normal;">(<span id="payEmpsNum">'.$totalEmpsPM.'</span>)</span></td>
													<td class="dataHeader1" style = "text-align:right;padding-right:10px; white-space:nowrap;">Gross Amount</td>
													<td class="dataHeader1" style = "text-align:right;padding-right:10px; white-space:nowrap;">Net Amount</td>
													<td style="background-color:white;"></td>
												 </tr>
													'.$rowsPM.'
												</table>';
									
									$sheet .= $sheetPM;
									$sheet .='</td></tr>';
								}

								if($docType != "CASH ADVANCE TO PAYMASTER" && $docType != "Infrastructure Payment" && $docType != "BOND - RETENTION MONEY"){
									// attach button here for retention --- RETENTION Tracking
									$sheet .= '<tr>
													<td colspan = "2" style = "padding:5px;">
														<span style  = "font-style:italic;color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Voucher Form</span>
														<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;">
															<span class = "label8">preview DV</span>
														</a>
													</td>
												</tr>';
								}

								// if($docType == "Infrastructure Payment") {
								// 	$sheet .= '	<tr>
								//  				<td colspan = "3" style = "padding-top:10px;">
								//  					<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Printables </span>';
								// 	$sheet .= '		<div style = "line-height:28px;"><a href = "../interface/formDVinfra.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
								// 		 				<span class = "data1 lnk">1. DV Form</span></a></div>';
								// 	$sheet .= '		<div style = "line-height:28px; margin-bottom:10px;"><a href = "../interface/formINFRAPaymentHistory.php?trackingNumber=' . $trackingPartner . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
								// 		 				<span class = "data1 lnk">2. Payment History</span></a></div>'; 
								// 	$sheet .= '	</td>
								// 				</tr>';
								// }

								if($docType == "Infrastructure Payment") {
									$sheet .= '	<tr>
								 				<td colspan = "3" style = "padding-top:10px;">
								 					<span class = "data1" style  = ";color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Printables </span>';

									if(strlen(trim($mxBatchNumber)) > 0) {
										$sheet .= '	<div style = "line-height:28px;">
														<a href = "../interface/formDVinfraMX.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
															<span class = "data1 lnk">1. DV Form</span>
														</a>
													</div>';
									}else {
										$sheet .= '	<div style = "line-height:28px;">
														<a href = "../interface/formDVinfra.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
															<span class = "data1 lnk">1. DV Form</span>
														</a>
													</div>';
									}

									$sheet .= '		<div style = "line-height:28px; margin-bottom:10px;"><a href = "../interface/formINFRAPaymentHistory.php?trackingNumber=' . $trackingPartner . '&officeName=' . $officeName . '" target="_blank" style = "padding-left:10px;text-decoration:none;font-size:22px;letter-spacing:1px;color:black;">
										 				<span class = "data1 lnk">2. Payment History</span></a></div>'; 
									$sheet .= '	</td>
												</tr>';
								}

							}
							
						}else{
								
							$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><span style  = "font-style:italic;color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">2nd Half Voucher</span>
									 	<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview DV</span></a>
									 </td></tr>';
						}
						
					}else{
						$sql1 = "SELECT OBR_Number FROM vouchercurrent WHERE TrackingPartner = '".$trackingNumber."' LIMIT 1";
						$record1 = $this->query($sql1);
						if($this->num_rows($record1) > 0) {
							$data1 = $this->fetch_array($record1);
							$obrNumber = $data1['OBR_Number'];
						}else {
							$obrNumber = '';
						}

						$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><span  style  = "color:rgb(64, 161, 202);font-weight:bold;font-size:18px;font-family:Oswald;letter-spacing:1px;">Liquidated Expense/s Breakdown</span>
									 	<a href = "../interface/formLiquidation.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;">&nbsp;<span class="data1 lnk" style = "letter-spacing:1px;font-size:23px;font-family:Oswald;color:black">Preview Liquidation</span></a>
									 	&nbsp;<span class="data1 lnk" style = "letter-spacing:1px; font-size:23px; font-family:Oswald; color:black; cursor:pointer;" onclick="generateLiqPrintView(\''.$trackingNumber.'\','.$trackYear.', \''.$trackingPartner.'\', \''.$obrNumber.'\', \''.addslashes($officeName).'\')">Actual Expense</span>
									 </td></tr>';
						$className = "hide";
						// $sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">' .  
						// 			 $this->CreateViewGroupDetailsNLIQ($grp, $trackingPartner) . 
						//  		 '</td></tr>';
						$sheet .= '	<tr>
										<td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">' .  
										$this->CreateViewGroupDetailsNLIQ($trackingNumber, $trackingPartner) . 
									'	</td>
									</tr>';
					}	
			}else{
				
				$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><span style  = "font-style:italic;color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">Voucher Form</span>
									 	<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview DV</span></a>
									 </td></tr>';
			}
					 
			/*
			// katong adviser na una wala pa'y adviser module'						 
			if($_SESSION['accountType'] == 9 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7){ // zerni
				if($status == "CAO Released" and $checkNumber == ''){
					$sheet .= '<tr style = "">
								<td colspan= "3"  style = "padding-bottom:0px;padding-top:20px;text-align:center;padding-bottom:20px;">
										 ' . $this->CreateAdviceSheet($trackingNumber,$fund,$netAmount) . '
								</td>
						   <tr>';
				}
			}
			*/
		
			if($trackingType == "NF"){
				
				$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;">' 
							.  $this->remarks($remark,$trackingNumber) . 
					        '</td></tr>';	 
			}
			// $sheet .= '	<tr>
			// 				<td colspan = "3" style = "padding:10px 15px;">'.$this->remarksNote($remarksNote,$trackingNumber).'</td>
			// 			</tr>';
							       
			$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;">' 
						.  $this->pendingNote($pendingNote) . 
				        '</td></tr>';	 				        	
			$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;">' 
						.  $this->logs($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber) .
				        '</td></tr>';
			
			$sheet .= '<tr><td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);">' 
						.  $this->CreateActionsUpdate($status,$trackingNumber,'1',$obrNumber,$trackingType,'1',$adv,$docType,$fund,$periodType,$claimType,$conformDate) .
				        '</td></tr>';
			
			$sheet .= '</table>';
			return $sheet;
		}

		function InfraManpowerSheet($trackingNumber, $trackingType, $status, $office, $nf) {

			$sheet = '';
			$arr  = explode("*!*",$nf);
			$batchNumber = $arr[0];
			$location =  utf8_decode($arr[1]);
			$duration = $arr[2];
			$mode = $arr[3];
			$name = $arr[4];
			$entry = $arr[5];

			$code = $arr[6];
			$amount = $arr[7];
			$fundYear = $arr[8];
			$fundName = $arr[9];
			$title = $arr[10];
			$expenseCode = $arr[11];
			$title = $arr[12];
			$claimant = $arr[13];
			$started = $arr[14];
			$completed = $arr[15];

			$programmer = $arr[16];
			$inspector = $arr[17];
			$extension = $arr[18];
			$barangay = $arr[19];
			$variationOBR = $arr[20];
			
			$checker = $arr[21];
			$surveyor = $arr[22];
			$draftsman = $arr[23];

			$progClass =  $this->permissionClassByField($trackingType,$status,$office,"Programmer"); 
			$inspClass =  $this->permissionClassByField($trackingType,$status,$office,"Inspector");
			$chkrClass =  $this->permissionClassByField($trackingType,$status,$office,"Checker");
			$draftClass =  $this->permissionClassByField($trackingType,$status,$office,"Draftsman");
			$survyClass =  $this->permissionClassByField($trackingType,$status,$office,"Surveyor");

			$sheet .= "	<table border='0' cellpadding='0' style=' border-spacing:0px; width:100%;'>
							<tr>
								<td colspan='3' style='padding:0px; padding-top:10px;'>
									<span class='data1' style='color:rgb(64, 161, 202); font-weight:bold; font-size:20px;'>Project Team</span>
								</td>
							</tr>
							<tr>
								<td style='width:0px; text-align:right; white-space:nowrap; padding:5px 8px 5px 75px;'>
									<span class='data1 genDtlLabel' style='color:black;'>Project Programmer</span>
								</td>
								<td style='border-bottom:1px solid silver; padding-right:25px; min-width:150px;'>
									<span class='data1' style='font-weight:bold; font-size:22px; text-transform:capitalize;'>". strtolower($programmer)."</span>
								</td>
								<td style='width:0px; padding-right:23px;'>
									<span id='editor".$trackingNumber."' class='".$progClass."' style='float:right; margin-right:20px; font-size:12px;' onclick='editManpower(this)'>EDIT</span>
								</td>
							</tr>
							<tr>
								<td style='width:0px; text-align:right; white-space:nowrap; padding:5px 8px 5px 75px;'>
									<span class='data1 genDtlLabel' style='color:black;'>Construction Inspector</span>
								</td>
								<td style='border-bottom:1px solid silver; padding-right:25px; min-width:150px;'>
									<span class='data1' style='font-weight:bold; font-size:22px; text-transform:capitalize;'>". strtolower($inspector)."</span>
								</td>
								<td style='width:0px; padding-right:23px;'>
									<span id='editor".$trackingNumber."' class='".$inspClass."' style='float:right; margin-right:20px; font-size:12px;' onclick='editManpower(this)'>EDIT</span>
								</td>
							</tr>
							<tr>
								<td style='width:0px; text-align:right; white-space:nowrap; padding:5px 8px 5px 75px;'>
									<span class='data1 genDtlLabel' style='color:black;'>Project Checker</span>
								</td>
								<td style='border-bottom:1px solid silver; padding-right:25px; min-width:150px;'>
									<span class='data1' style='font-weight:bold; font-size:22px; text-transform:capitalize;'>". strtolower($checker)."</span>
								</td>
								<td style='width:0px; padding-right:23px;'>
									<span id='editor".$trackingNumber."' class='".$chkrClass."' style='float:right; margin-right:20px; font-size:12px;' onclick='editManpower(this)'>EDIT</span>
								</td>
							</tr>
							<tr>
								<td style='width:0px; text-align:right; white-space:nowrap; padding:5px 8px 5px 75px;'>
									<span class='data1 genDtlLabel' style='color:black;'>Project Draftsman</span>
								</td>
								<td style='border-bottom:1px solid silver; padding-right:25px; min-width:150px;'>
									<span class='data1' style='font-weight:bold; font-size:22px; text-transform:capitalize;'>". strtolower($draftsman)."</span>
								</td>
								<td style='width:0px; padding-right:23px;'>
									<span id='editor".$trackingNumber."' class='".$draftClass."' style='float:right; margin-right:20px; font-size:12px;' onclick='editManpower(this)'>EDIT</span>
								</td>
							</tr>
							<tr>
								<td style='width:0px; text-align:right; white-space:nowrap; padding:5px 8px 5px 75px;'>
									<span class='data1 genDtlLabel' style='color:black;'>Project Surveyor</span>
								</td>
								<td style='border-bottom:1px solid silver; padding-right:25px; min-width:150px;'>
									<span class='data1' style='font-weight:bold; font-size:22px; text-transform:capitalize;'>". strtolower($surveyor)."</span>
								</td>
								<td style='width:0px; padding-right:23px;'>
									<span id='editor".$trackingNumber."' class='".$survyClass."' style='float:right; margin-right:20px; font-size:12px;' onclick='editManpower(this)'>EDIT</span>
								</td>
							</tr>
						</table>";

			return $sheet;

		}

		function PRPOinfo($complex,$subCode,$checkNumber, $checkDate,$trackingType,$status,$officeName,$poNumber,$prNumber,$obrNumber,$className,$trackingNumber,$prTrackingNumber,$prMonth,$adv,$docType,$claimant,$grp,$prData,$record1,$pendingNote,$encodedBy,$dateEncoded,$dateUpdated,$completion,$fund,$periodType,$amount,$office,$netAmount,$programCode,$trackingPartner,$conformDate,$nature,$specifics,$drrmo,$forDrrmo,$remarksNote){
			
			$sheet = '<table class = "doctrackUpdateTable" border ="0" style = "margin:0 auto;min-width:650px;max-width:800px;" >';		
			$sheet .= '<tr style = "background-color:rgb(245, 246, 246);background-color:rgb(23, 207, 253);">
					   		<td colspan ="3"  style = "text-align:left;padding:15px 0px;padding-bottom:10px;" >
					   			<span class = "label7" style = "color:white;padding-left:20px;">Status</span>
					   			
									<span id ="trackType" style = "text-shadow:0px 0px 10px black;color:rgb(42, 122, 172);font-weight:bold;color:white;font-size:34px;" class = "data1">' . $trackingType . ' - </span>
								
									<span id = "labelStatus" style = "text-shadow:0px 0px 10px black;color:rgb(42, 122, 172);font-weight:bold;color:white;font-size:34px;letter-spacing:1px;font-weight:bolder;" class = "data1">' . $status . '</span>
									<div style = "color:black;padding-left:5px;width:110px;display:inline-block;display:none;" >' . $this->ezDate1($dateUpdated) . '</div>
								
								<div style = "padding:5px;padding-left:75px;color:white;text-shadow:0px 0px 1px white;letter-spacing:1px;" class = "data1">' . $officeName .  '</div>
							</td>
					   <tr>';
			$sheet .= '<tr><td colspan = "3" style = "padding:5px;"><hr style = "border:0;border-top:0px solid silver;"/></td></tr>';	//------------------   			   
			
			$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">' 
						.   $this->CreateGenDetails($complex,$checkNumber, $checkDate,$poNumber,$prNumber,$obrNumber,$className,$trackingNumber,$prTrackingNumber,$prMonth,$adv,$trackingType,$claimant,$fund,$amount,$status,$office,$netAmount,$trackingPartner,$nature,$specifics,$drrmo,$forDrrmo)  .
				        '</td></tr>';	

			if($trackingType == "PO") {

				$sql = "SELECT TrackingNumber, Status FROM vouchercurrent WHERE TrackingPartner = '".$trackingNumber."' AND TrackingType = 'PX' GROUP BY TrackingNumber ORDER BY DateEncoded ASC";
				$recordPX = $this->query($sql);

				if($this->num_rows($recordPX) > 0) {

					$pxTNList = "";
					$pxVCDetails = [];
					while ($data = $this->fetch_array($recordPX)) {
						$pxTN = $data['TrackingNumber'];
						$status = $data['Status'];

						$pxTNList .= ",'".$pxTN."'";
						$pxVCDetails[$pxTN] = $status;
					}

					$sql = "SELECT * FROM pxvouchertax WHERE TrackingNumber IN (".substr($pxTNList, 1).")";
					$recordPX = $this->query($sql);


					$sheet .= "	<tr>
									<td colspan='3' style='padding:5px'>
										<div style='margin-top:20px;padding-top:20px;'>
											<span class='data1' style='color:rgb(64, 161, 202);font-weight:bold;font-size:18px;'>Payment History</span>
										</div>
									</td>
								</tr>
								<tr>
									<td colspan='3' style='padding:5px 15px;'>";
					$sheet .= "		<table border='0' cellpadding='0' style='border-spacing:0px; width:100%; border-collapse:collapse; font-family:Oswald;'>
										<tr style='border:1px solid silver; background-color:rgb(121, 137, 141); color:white;'>
											<td style='font-weight:bold; padding:2px 5px; white-space:nowrap;'>TN</td>
											<td style='font-weight:bold; padding:2px 5px; white-space:nowrap;'>Status</td>
											<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Gross</td>
											<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>LD</td>
											<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Total Tax</td>
											<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Retention</td>
											<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Adjustment</td>
											<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Net</td>
										</tr>
										";

					$curPXTN = "";
					$pxTN = "";
					$pxTotalTax = 0;
					$numRows = $this->num_rows($recordPX);
					$row = 0;

					while ($data = $this->fetch_array($recordPX)) {
						$pxTN = $data['TrackingNumber'];
						$taxAmount = $data['PercentageAmount'];
						$row++;

						if($curPXTN != $pxTN) {

							if($curPXTN != '') {
								$amount = $data['Amount'];
								$ld = $data['LiquidatedDamages'];
								$gross = $amount + $ld;
								$netAmount = $data['NetAmount'];
								$retention = $data['Retention'];

								$adjType = $data['AdjustmentType'];
								$adjAmount = $data['AdjustmentAmount'];
								$adj = "";
								if(strlen(trim($adjType)) > 0) {
									$adjT = "ADD";
									if($adjType == 'Deduct') {
										$adjT = "LESS";
									}
									$adj = "<span style='color:orange; font-weight:bold;'>".$adjT."</span> : ".number_format($adjAmount, 2);
								}

								$sheet .= "	<tr style='border:1px solid silver;'>
												<td style='border-right:1px solid silver; padding:2px 5px; white-space:nowrap;' class='hover' onclick='searchThisPartner(this)'>".$pxTN."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; padding:2px 5px;'>".$pxVCDetails[$pxTN]."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($gross, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($ld, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($pxTotalTax, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($retention, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".$adj."</td>
												<td style='width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($netAmount, 2)."</td>
											</tr>";
							}

							$curPXTN = $pxTN;
							$pxTotalTax = $taxAmount;

						}else {
							$pxTotalTax += $taxAmount;

							if($row == $numRows) {
								$amount = $data['Amount'];
								$ld = $data['LiquidatedDamages'];
								$gross = $amount + $ld;
								$netAmount = $data['NetAmount'];
								$retention = $data['Retention'];

								$adjType = $data['AdjustmentType'];
								$adjAmount = $data['AdjustmentAmount'];
								$adj = "";
								if(strlen(trim($adjType)) > 0) {
									$adjT = "ADD";
									if($adjType == 'Deduct') {
										$adjT = "LESS";
									}
									$adj = "<span style='color:orange; font-weight:bold;'>".$adjT."</span> : ".number_format($adjAmount, 2);
								}

								$sheet .= "	<tr style='border:1px solid silver;'>
												<td style='border-right:1px solid silver; padding:2px 5px; white-space:nowrap;' class='hover' onclick='searchThisPartner(this)'>".$pxTN."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; padding:2px 5px;'>".$pxVCDetails[$pxTN]."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($gross, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($ld, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($pxTotalTax, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($retention, 2)."</td>
												<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".$adj."</td>
												<td style='width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($netAmount, 2)."</td>
											</tr>";
							}
						}
					}

					$sheet .= '			</table>
									</td>
								</tr>';

				}

			}
			
			$sheet .= '<tr><td colspan = "3" style = "padding:5px;padding-top:20px;"><hr style = "border:0;border-top:1px solid silver;"/></td></tr>';	//------------------
			
			if($_SESSION['accountType'] == 9 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7){ // zerni
				if($status == "CAO Released" and $checkNumber == ''){
					$sheet .= '<tr style = "">
								<td colspan= "3"  style = "padding-bottom:0px;padding-top:20px;text-align:center;padding-bottom:20px;">
										 ' . $this->CreateAdviceSheet($trackingNumber,$fund,$netAmount) . '
								</td>
						   <tr>';
				}
			}
			
			
			
			if($trackingType == "PO"){
				//$tracking = $prTrackingNumber;
				$sheet .= '<tr><td colspan = "3" style = "padding:5px;"><span class = "data1" style  = "color:rgb(64, 161, 202);font-weight:bold;font-size:18px;">OBR Information</span>
						 	<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' . urlencode($claimant) . '&officeName=' . $officeName . '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">OBR Form</span></a>
						 	<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk"  style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">DV Form</span></a>
						 </td></tr>';
				
			}elseif($trackingType == "PX"){
				//$tracking = $prTrackingNumber;
				$sheet .= '<tr><td colspan = "3" style = "padding:5px;"><span class = "data1" style  = "color:rgb(64, 161, 202);font-weight:bold;font-size:18px;">OBR Information</span>
						 	<a href = "../interface/formDVgoods.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk"  style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">DV Form</span></a>
						 </td></tr>';
				
			}else{
				$tracking = $trackingNumber;
				$claimant = urlencode($claimant);
				$sheet .= '<tr><td colspan = "3" style = "padding:5px;"><span class = "data1" style  = "color:rgb(64, 161, 202);font-weight:bold;font-size:20px;">OBR Information</span>
					 	<a href = "../interface/formOBR.php?trackingNumber=' . $tracking . '&payee=' . $claimant . '&officeName=' . $officeName . '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">OBR Form</span></a>
					 	
					 </td></tr>';
				
			}
			
					 
					 
			$sheet .= '<tr><td colspan = "3" style = "padding:5px 15px;background-color1:rgb(253, 245, 229);">' 
						.  $this->CreateViewGroupDetails($grp)  .
				        '</td></tr>';	
			
			
			$className =  $this->permissionClassByField($trackingType,$status,$office,"PRdetails"); 
			/*$sheet .= '<tr><td colspan = "2" style = "padding:5px ;padding-top:20px;"><span style  = "color:rgb(64, 161, 202);font-weight:bold;font-style:italic;font-size:20px;">' . $trackingType  . ' Details </span>
							<a href = "../interface/formPR.php?data=' . $prData .  '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview pr</span></a>
							<a href = "../interface/formPRnew.php?tn=' . $trackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview pr new</span></a>
							';*/
			$sheet .= '<tr><td colspan = "2" style = "padding:5px ;padding-top:20px;"><span class = "data1" style  = "color:rgb(64, 161, 202);font-weight:bold;font-size:18px;">' . $trackingType  . ' Details </span>';
			if($trackingType == "PO"){
				$sheet .= '<a href = "../interface/formPRnew.php?tn=' . $prTrackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">PR Form</span></a>';	
				$sheet .= '<a href = "../interface/formPO.php?tn=' . $trackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">PO Form</span></a>';
				$sheet .= '<a href = "../interface/formAR.php?tn=' . $trackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">Acceptance Form</span></a>';
			}elseif($trackingType == "PX") {
				$sheet .= '<a href = "../interface/formPRnew.php?tn=' . $prTrackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">PR Form</span></a>';	
				$sheet .= '<a href = "../interface/formPO.php?tn=' . $trackingPartner .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">PO Form</span></a>';
			}else{
				$sheet .= '<a href = "../interface/formPRnew.php?tn=' . $trackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">PR Form</span></a>';
				$sheet .= '<a href = "../interface/formRFQ.php?tn=' . $trackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">RFQ Form</span></a>';
				$arr =  explode('~',urldecode($prData));
				$category = $arr[3];
				if($category == "CAT 10" || $category == "CAT 10.1" || $category == "CAT 12"){
					//$sheet .=   	'<a href = "../interface/formRecommendation.php?tn=' . $trackingNumber .  '" target="_blank" style = "text-decoration:none;"><span class = "data1 lnk" style = "margin-left:10px;font-size:22px;letter-spacing:1px;color:black;">Recommendation Form</span></a>';
				}
			}


			$computeLd = "";
			// if($trackingType == 'PO') {		 
			// 	$classNameLD =  $this->permissionClassByField($trackingType,$status,$office,"computeLD"); 
			// 	$computeLd = '<span id = "prEdit' . $trackingNumber   . '" class = "button1 ' . $classNameLD . '" style = "width:200px;text-shadow:0px 0px 1px GREY; padding:5px 10px;font-weight:bold;color:white;letter-spacing:1px;font-size:14px;background-color:rgb(18, 184, 240); margin-right:8px;" onclick = "revertForComputeLD(this)">Adjust&nbsp;for&nbsp;Liquidated&nbsp;Damages</span></a>';
			// 	$sqld = "SELECT Id FROM porecordoriginal WHERE TrackingNumber = '".$trackingNumber."' LIMIT 1";
			// 	$recordd = $this->query($sqld);
			// 	$rowsLD = $this->num_rows($recordd);
			// 	if($rowsLD > 0) {
			// 		$computeLd = "";
			// 	}
			// }
			
			
			// $sheet .= '	</td>	
			// 			<td style = "padding-right:16px;padding-top:25px;text-align:right;">
			// 				<span id = "prEdit' . $trackingNumber   . '" class = "button1 ' . $className . '" style = "width:75px;text-shadow:0px 0px 1px GREY; padding:5px 10px;font-weight:bold;color:white;letter-spacing:1px;font-size:14px;background-color:rgb(18, 184, 240); " onclick = "editPR(this)">Edit&nbsp;items</span></a>
			// 		 		'.$computeLd.'
			// 			</td>
			// 		</tr>';
			
			// $sheet .= '<tr><td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);padding:5px 15px;">' 
			// 			.  $this->CreateViewListPRPO($record1) .
			// 	        '</td></tr>';

			if($trackingType == 'PX') {
				$sheet .= '	</td>	
								<td style = "padding-right:16px;padding-top:25px;text-align:right;">
									<span id = "pxEdit' . $trackingNumber.'*'. $trackingPartner . '" class = "button1 ' . $className . '" style = "width:75px;text-shadow:0px 0px 1px GREY; padding:5px 10px;font-weight:bold;color:white;letter-spacing:1px;font-size:14px;background-color:rgb(18, 184, 240); " onclick = "editPX(this)">Edit&nbsp;items</span></a>
								</td>
							</tr>';
			}else {
				$sheet .= '	</td>	
								<td style = "padding-right:16px;padding-top:25px;text-align:right;">
									<span id = "prEdit' . $trackingNumber   . '" class = "button1 ' . $className . '" style = "width:75px;text-shadow:0px 0px 1px GREY; padding:5px 10px;font-weight:bold;color:white;letter-spacing:1px;font-size:14px;background-color:rgb(18, 184, 240); " onclick = "editPR(this)">Edit&nbsp;items</span></a>
									<span id="prSeq'.$trackingNumber.'" class="button1 '.$className.'" style="width:95px; text-shadow:0px 0px 1px GREY;  padding:5px 10px; font-weight:bold; color:white; letter-spacing:1px; font-size:14px; background-color:rgb(18, 184, 240); margin-right:8px;" onclick="itemSequence(this)">Sequence&nbsp;items</span></a>
									'.$computeLd.'
								</td>
							</tr>';
			}

			if($trackingType == 'PX') {
				$sheet .= '	<tr>
								<td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);padding:5px 15px;">'. $this->CreateViewListPX($record1).'</td>
							</tr>';
			}else {
				$sheet .= '	<tr><td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);padding:5px 15px;">' 
							.  $this->CreateViewListPRPO($record1) .
							'</td></tr>';
			}

			$className = $this->permissionClassByField($trackingType,$status,$office,"Remarks1"); 
			$sheet .= '	<tr>
							<td colspan="3" style="padding:5px 15px;">'.$this->remarksNote($remarksNote,$trackingNumber,$className).'</td>
						</tr>';
			
			$sheet .= '<tr><td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);padding:5px 15px;">' 
						.  $this->pendingNote($pendingNote) .
				        '</td></tr>';
			
				        	
			$sheet .= '<tr><td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);padding:5px 15px;">' 
						.  $this->logs($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber) .
				        '</td></tr>';
			
			$sheet .= '<tr><td colspan = "3" style = "background-color1:rgba(238, 244, 247,.8);padding:5px 15px;">' 
						.  $this->CreateActionsUpdate($status,$trackingNumber, $prNumber,$obrNumber,$trackingType,$poNumber,$adv,$docType,$fund,$periodType,$docType,$conformDate)  .
				        '</td></tr>';
			
			$sheet .= '</table >';
			return $sheet;
		} 

		function remarksNote($remarksNote,$trackingNumber,$className) {

			$sheet = '	<table border="0" cellpadding="0" style="border-collapse:collapse; width:100%;">
							<tr>
								<td class="label7" style="color:black; font-weight:bold; padding-left:14px; width:0px;">Remarks</td>
								<td>
									<span id="remarksNote'.$trackingNumber.'" class="'.$className.'" style="font-size:16px; color:rgb(23, 207, 253); text-shadow:0px 0px 1px grey; cursor:pointer; font-family:mainFont;" onclick="createRemarkAllTNs(this)">✚</span>
								</td>
							</tr>
							<tr style="border-bottom:1px solid silver;">
								<td colspan="2" style="padding-top:10px;"></td>
							</tr>
							<tr style="">
								<td colspan="2" style="padding:0px; padding-top:10px; padding-left:70px;">'.$remarksNote.'</td>
							</tr>
						</table>';

			return $sheet;

		}

		function pendingNote($pendingNote){
			if(strlen($pendingNote) > 0){
				$sheet = '<table style = "width:100%;"><tr>
						   	    <td colspan ="3" style = "vertical-align:top;width:10px;text-align:left;padding-left:12px;padding-top:10px;"><span class = "label7" style = "color:black;font-weight:bold;">Pending&nbsp;Note</span></td>
						   </tr>
						   <tr><td colspan = "3" style = "padding:0px;"><hr style = "border:0;border-top:1px solid silver;"/></td></tr>	   
						   <tr>
								<td colspan ="3" style = "padding-left:60px;"><span   id = "oldPending" class = "data1"  style = "white-space: pre-line;word-wrap: break-word;color:red;font-family:NOR;">' . $pendingNote . '</span></td>
						   <tr>';
				$sheet .= '<tr><td colspan = "3" style = "padding:5px;border-bottom:1px solid silver;"></td></tr></table>';	//------------------
				return $sheet;
			}	
		}
		function remarks($note,$trackingNumber){
		
			$sheet = '<table style = "width:100%;"><tr>
					   	    <td colspan ="3" style = "vertical-align:top;width:10px;text-align:left;padding-left:12px;padding-top:10px;">
					   	    	<span class = "label7" style = "color:black;font-weight:bold;">Remarks</span>
					   	    	<span id ="remarkTN' . $trackingNumber . '"  class ="" style = "margin-right:20px;font-size:16px;color:rgb(23, 207, 253);text-shadow:0px 0px 1px grey;cursor:pointer;" onclick = "createRemark(this)">✚</span>
					   	    </td>
					   </tr>
					   <tr><td colspan = "3" style = "padding:0px;"><hr style = "border:0;border-top:1px solid silver;"/></td></tr>	   
					   <tr>
							<td colspan ="3" style = "padding-left:60px;font-family:NOR;"><span id ="remarkRemark' . $trackingNumber . '" style = "white-space: pre-line;word-wrap: break-word;">' .$note . '</span></td>
					   <tr>';
			$sheet .= '<tr><td colspan = "3" style = "padding:5px;"></td></tr></table>';	//------------------
			return $sheet;
			
		}
		function logs($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber){
			$sheet = '<table style= "margin-left:16px;"><tr>
					   	       <td colspan = "3" style = "padding-left:10px;"  ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Encoded By</div><span  style = "font-size:13px;padding-left:5px;font-weight:bold;" class = "data1">' . $encodedBy . '</span></td>
					   <tr>
					   <tr>
					   		<td colspan = "3"  style = "padding-left:10px;"  ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Date Encoded</div><span id = "trackingEncoded"  style = "padding-left:5px;font-size:12px;letter-spacing:1px;" class = "data1">' . $dateEncoded . '</span></td>
					   <tr>
					   
					   <tr>
					   		<td colspan = "3"   style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Date Updated</div><span id = "trackingModified"  style = "padding-left:5px;font-size:12px;font-weight:bo1d;letter-spacing:1px;" class = "data1">' . $dateUpdated . '</span></td>
					   <tr>
					   
					   ';
					/*   if(strlen($completion)> 0){
						   $sheet .= '<tr>
						   				<td colspan = "3" style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">123Processed Time</div><span style = "font-size:13px;margin-left:5px;font-weight:bold;color:red;" class = "data1">' . $completion . '</span></td>
					  	 		     <tr>';
					   }*/
					     if(strlen($completion)> 0){
						   $sheet .= '<tr>
						   			<td colspan = "3" style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Processed Time</div>
						   				<span style = "font-size:13px;margin-left:5px;font-weight:bold;color:red;" class = "data1">' . $completion . '</span>';
						   if($completion > 3){
						 	$sheet .= '<span style = "font-size:11px; color:grey;font-family:oswald;"> (including non working days)</span>';		
						   }			
						   $sheet .= '	</td><tr>';
					   }
					   
			$sheet .= '<tr>
					   		<td colspan = "3"   style = "padding-left:100px;" >
					   			<span id = "history' . $trackingNumber .'"  style = "font-size:13px;cursor:pointer;font-weight:bold;" class = "data1" onclick = "viewHistory(this)">
					   				<span id = "historyArrow"style = "color:rgb(249, 65, 105);">&#9658;</span> View History
					   			</span>
					   			<div id = "historyContainer"  style = "padding:0px 20px;"></div>
					   		</td>
					   <tr></table>';
			return $sheet;
		}

        function logs_AcceptanceReport($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber){
            $sheet = '<table style= "margin-left:16px;"><tr>
					   	       <td colspan = "3" style = "padding-left:10px;"  ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Encoded By</div><span  style = "font-size:13px;padding-left:5px;font-weight:bold;" class = "data1">' . $encodedBy . '</span></td>
					   <tr>
					   <tr>
					   		<td colspan = "3"  style = "padding-left:10px;"  ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Date Encoded</div><span id = "trackingEncoded"  style = "padding-left:5px;font-size:12px;letter-spacing:1px;" class = "data1">' . $dateEncoded . '</span></td>
					   <tr>
					   
					   <tr>
					   		<td colspan = "3"   style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Date Updated</div><span id = "trackingModified"  style = "padding-left:5px;font-size:12px;font-weight:bo1d;letter-spacing:1px;" class = "data1">' . $dateUpdated . '</span></td>
					   <tr>
					   
					   ';
            if(strlen($completion)> 0){
                $sheet .= '<tr>
						   				<td colspan = "3" style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Processed Time</div><span style = "font-size:13px;margin-left:5px;font-weight:bold;color:red;" class = "data1">' . $completion . '</span></td>
					  	 		     <tr>';
            }
            $sheet .= '<tr>
					   		<td colspan = "3"   style = "padding-left:100px;" >
					   			<span id = "history' . $trackingNumber .'"  style = "font-size:13px;cursor:pointer;font-weight:bold;" class = "data1" onclick = "viewHistoryThis(this)">
					   				<span id = "historyArrowNew"style = "color:rgb(249, 65, 105);">&#9658;</span> View History
					   			</span>
					   			<div id = "historyContainerThis"  style = "padding:0px 20px;"></div>
					   		</td>
					   <tr></table>';
            return $sheet;
        }

      	function CreateActionsUpdate($status,$trackingNumber,$prNumber,$obrNumber,$trackingType,$poNumber,$adv,$docType,$fund,$periodType,$claimType,$conformDate){
      		
   			// 38 - BAC Secretariat
			// 39 - BAC Chairman
			// 40 - CEO PDD
			// 41 - CEO Construction
			// 42 - CEO Admin
			$perm = $_SESSION['perm'];
			$office = $_SESSION['gso'];

			$sheet ='<table style = "width:100%;">';
			if($_SESSION['accountType'] == 2 and $_SESSION['gso'] == '1061' or $_SESSION['accountType'] == 7){ //gso matters
				if($trackingType == "PR"){
					if($status == "Encoded"){
						/*$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PR&nbsp;#</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $prNumber . '"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   <tr>';*/
					}else if($status == "CBO Received"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PR&nbsp;#</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $prNumber . '"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   <tr>';
					}else if($status == "Pending at GSO"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
									</td>
							   	<tr>';
					}else if($status == "Pending Released - GSO"){
						if($prNumber != ''){
							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   	<tr>';
						}else{
							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding:40px 0px;text-align:center;">
											<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PR&nbsp;#</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $prNumber . '"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											</div>'  .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
									</td>
							   <tr>';
						}
					}else if($status == "GSO Received"){
						// $sheet .= '<tr style = "">
						// 			<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
						// 				<div id = "prEncodedUpdater">
						// 					<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
						// 					<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
						// 				</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
						// 			</td>
						// 	   <tr>'; 
						/*$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
									</td>
							   <tr>';*/	 
							   
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
										</td>
									<tr>'; 
						
					}else if($status == "GSO Released"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
										</td>
							   		<tr>';
					}else if($status == "Pending Released - Admin"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}else if($status == "Pending Released - CTO"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}
					
					// else if($status == "Pending Released - Admin" || $status == "Pending Released - CTO"){
					// 	if($prNumber != ''){
					// 		$sheet .= '<tr style = "">
					// 				<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
					// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
					// 				</td>
					// 		   	<tr>';
					// 	}else{
					// 		$sheet .= '<tr style = "">
					// 				<td colspan= "3"  style = "padding:40px 0px;text-align:center;">
					// 						<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PR&nbsp;#</span>
					// 						<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $prNumber . '"  style = ""/>
					// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
					// 						<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 						</div>'  .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
					// 				</td>
					// 		   <tr>';
					// 	}
					// }

				}
				if($trackingType == "PO"){
					if($status == "Encoded"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PO&nbsp;#</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $poNumber . '"  style = ""/>';
							$sheet .= '				<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;width:130px;"  onclick="updateTracking(this)">Receive<span style = "font-size:14px;color:#1A8EC4;">(New)</div>';
							$sheet .= '				<div class = "button1" id = "button*' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;width:130px;"  onclick="updateTracking(this)">Receive<span style = "font-size:14px;color:#1A8EC4;">(Payment)</span></div>';
							$sheet .= '			</td>
							   <tr>';

					// --------------------------------------------------  - Doctrack Status Flow	  		   
					} else if($status == "GSO Received"){  // check - ok 
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Forward</div>
										</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
									</td>
							   <tr>';
					} else if ($status == 'Forwarded to CMO') {

							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Approved</div>
										</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
									</td>
							   <tr>';

					} else if ($status == 'CMO Approved') {

							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Served</div>
										</div>
									</td>
							   <tr>';

					} else if ($status == 'Served to Supplier') {

							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<span style ="color:rgb(248, 68, 92);font-weight:bold; white-space:nowrap;" class  = "label7">Date Conformed</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$conformDate.'"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Conformed</div>
										</div>
									</td>
							   <tr>';
		   	
					} else if ($status == 'Supplier Conformed' || $status == "GSO Conformed") {
							//si gso mag release sa office
							/*$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Released</div>
										</div>
									</td>
							   <tr>';*/


					}else if ($status == 'Waiting for Delivery' || $status == "GSO Released For Delivery") {
							if($perm == 10){
						        $sheet .= '<tr style = "">
													<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
														<div id = "prEncodedUpdater">
															<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:230px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Received for Inspection</div>
														</div>
													</td>
											   <tr>';
							}
					       	
					} else if ($status == 'For Inspection' || $status == "Voucher Encoded") {
							if($perm == 10){
									$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
												<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													
												<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block; width:165px; padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Mark as Inspected</div>
												</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber)  . '
													
											</td>
									   <tr>';
							}
					}  else if ($status == 'Inspected' || $status == "GSO Received - Voucher(Inspection)") { //changes
							/*$sheet .= '<tr>
						   		<td style = "padding-bottom:40px;width:10px;text-align:center;" colspan = "2">
						   			
										<div id = "prEncodedUpdater">
												<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
												
														<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Submit</div>
										</div> '.  $this->CreatePendingNote("VoucherPendingGSO_Inspection",$trackingNumber)  . '

								</td>
							<tr>';*/
							// if($perm == 10){
							// 	$sheet .= '<tr style = "">
							// 					<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
							// 						<div id = "prEncodedUpdater">
							// 						<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
							// 						</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber)  . '
														
							// 					</td>
							// 			   <tr>';
							// }

							if($perm == 10){
								$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater">
														<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
														<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:105px;padding:5px 10px;font-size:22px; white-space:nowrap;" onclick="updateTracking(this)">For Payment</div>
													</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber)  . '
														
												</td>
										   <tr>';
							}
							if($perm == 11){
								$sheet .= '<tr>
							   		<td style = "padding-bottom:40px;width:10px;text-align:center;" colspan = "2">
							   			
											<div id = "prEncodedUpdater">
													<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</div> '.  $this->CreatePendingNote("inspectionPending",$trackingNumber)  . '
									</td>
								<tr>';
							}
					} else if ($status == 'Inventory' || $status == "GSO Received - Voucher(Inventory)") { //changes
							// if($perm == 11){
							// 		$sheet .= '<tr>
							// 	   		<td style = "padding-bottom:40px;width:10px;text-align:center;" colspan = "2">
								   			
							// 					<div id = "prEncodedUpdater">
							// 							<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>

							// 					</div> '.  $this->CreatePendingNote("inventoryPending",$trackingNumber)  . '

							// 			</td>
							// 		<tr>';
							// }

							if($perm == 11){
								$sheet .= '<tr>
									   <td style = "padding-bottom:40px;width:10px;text-align:center;" colspan = "2">
										   
											<div id = "prEncodedUpdater">
													<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:105px;padding:5px 10px;font-size:22px; white-space:nowrap;" onclick="updateTracking(this)">For Payment</div>
											</div> '.  $this->CreatePendingNote("inventoryPending",$trackingNumber)  . '

									</td>
								<tr>';
							}
									
					}else if($status == "Pending at GSO - Inspection" || $status == "Pending at GSO - Voucher(Inspection)"){ // changes
							if($perm == 10){
								$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px 10px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
											</td>
									   	<tr>';
							}	
					} else if($status == "Pending Released - Inspection" || $status == "Pending Released - GSO Voucher(Inspection)"){ // changes
							if($perm == 10){
								$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
														<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
												</td>
										   <tr>';
							}
					}else if($status == "Pending at GSO - Inventory" || $status == "Pending at GSO - Voucher(Inventory)"){  // changes
							if($perm == 11){
								$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px 10px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
											</td>
									   	<tr>';
							}
					
					}else if($status == "Pending Released - Inventory" || $status == "Pending Released - GSO Voucher(Inventory)"){ // changes
							if($perm == 11){
								$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>	
												</td>
										   <tr>';
							}	
									   	// Voucher GSO Received (Inventory)
				
					}else if($status == "Pending at GSO"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
									</td>
							   	<tr>';
					}else if($status == "Pending Released - GSO"){
						if($poNumber != ''){
							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<input id = "inputNumber" type = "hidden" maxlength = "10" class ="text3" value = "' . $poNumber . '"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   	<tr>';
						}else{
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PO&nbsp;#</span>
													<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $poNumber . '"  style = ""/>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
													<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													</div>'  .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
											</td>
									   <tr>';
						}
					}
				}
				if($trackingType == "PY"){
					
					if($status == "Encoded"){
						if($docType == "LIQUIDATION"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}
					if($status == "GSO Received"){
						$sheet .= '<tr style = "">
								<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
									<div id = "prEncodedUpdater">
										<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
								</td>
						   <tr>';
					}
					if($status == "Pending at GSO"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
									</td>
							   	<tr>';
					}
					if($status == "Pending Released - GSO"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}	
					if($status == "CBO Received" ){
						if($docType == "REIMBURSEMENT" or $docType == "REPLENISHMENT"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}
				}
			}

			if($trackingType == "NF"){
				if($_SESSION['accountType'] >= 2){
					if($status == "Project Encoded"){
						
						if($perm == 40){
							/*$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="callNFRequestorForm(\''.$trackingNumber.'\')">Request Certificate</div>
												<span style="display:none;" id = "button' . $trackingNumber . '">Request Certificate</span>
											</td>
									   <tr>'; */
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;" id = "button' . $trackingNumber . '" onclick="updateTracking(this)">Request Certificate</div>
											</td>
									   <tr>'; 
						}
					}elseif($status == "Requesting for Fund Certification"){
						if($perm == 43){
							if($fund == "Trust Fund"){
								$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:130px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Acknowledge</div>
											</td>
									   <tr>';
							}
						}
						if($perm == 44 || $perm == 31){
							if($fund == "General Fund" || $fund == "SEF" ){
								$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:130px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Acknowledge</div>
											</td>
									   <tr>';
							}
						}
					}elseif($status == "Acknowledge Certification Request"){
						if($perm == 43 ){
							if($fund == "Trust Fund"){
								$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
							}
						}
						if($perm == 44 || $perm == 31){
							if($fund == "General Fund" || $fund == "SEF" ){
								$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
							}
						}
					}elseif($status == "Fund Certification Signed"){
						if($perm == 43){
							if($fund == "Trust Fund"){
								$sheet .= '<tr style = ""> 
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release Certificate</div>
												</td>
										   <tr>';
							}
						}
						if($perm == 44 || $perm == 31){
							if($fund == "General Fund" || $fund == "SEF" ){
								$sheet .= '<tr style = ""> 
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release Certificate</div>
												</td>
										   <tr>';
							}
						}
					}elseif($status == "Schedule for Inspection"){
						if($perm == 40){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:140px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">For Inspection</div>
											</td>
									   <tr>';
						}
					}elseif($status == "For Inspection"){
						if($perm == 40){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:140px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Not Feasible</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Prepare</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Inspected - Not Feasible"){
						if($perm == 40){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
										</td>
								   <tr>';	
						}
					}elseif($status == "Preparation of Plans, PoW, and Detailed Estimates"){
						if($office == "1031"){
							$sheet .= '<tr style = ""> 
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';	
						}
					}elseif($status == "Plans, PoW, and Detailed Estimates for Approval"){
						if($office == "1031"){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Plans, PoW, and Detailed Estimates Signed"){
						if($office == "1031"){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "For BAC Procedures"){
						if($perm == 38){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Drafting Invitation to Bid"){
						if($perm == 40){
							$sheet .= '<tr style = ""> 
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Checking Invitation to Bid"){
						if($perm == 40){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">For Adjustment</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:110px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">For Pick-up</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Invitation to Bid for Adjustment"){
						if($perm == 40){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Invitation to Bid for Pick-up"){
						if($perm == 40){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Invitation to Bid for Transmit"){
						if($perm == 39){
							$sheet .= '<tr style = ""> 
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Invitation to Bid for Signature"){
						if($perm == 39){
							$sheet .= '<tr style = ""> 
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Invitation to Bid Signed"){
						if($perm == 39){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Posting"){
						if($perm == 38){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Schedule</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Bidding Schedule"){
						if($perm == 38){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:170px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Post Qualification</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Post Qualification"){
						if($perm == 38){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:130px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">For Signature</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Letters for Signature"){
						if($perm == 39){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Letters Signed"){
						if($perm == 39){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Notice of Award for Transmit"){
						if($office == "1031"){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Notice of Award for Admin Signature"){
						if($office == "1031"){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Notice of Award Admin Signed"){
						if($office == "1031"){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "NoA and Contract for Contractor's Signature"){
						if($perm == 38){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "NoA and Contract Released to Contractor"){
						if($perm == 38){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "NoA and Contract Contractor Signed"){
						if($perm == 38){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
										</td>
								   <tr>';
						}elseif($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == 'Obligation Request Preparation') {
						if($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:130px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">For Signature</div>
											</td>
									   <tr>';
						}
					}elseif($status == 'OBR for Implementing Office Signature') {
						if($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
						}
					}elseif($status == 'OBR Implementing Office Signed') {
						if($office == "1071"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;OBR&nbsp;#</span>
													<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $obrNumber . '"  style = ""/>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}elseif($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
											</td>
									   <tr>';
						}
					}elseif($status == "CBO Received"){
						if($office == "1071"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
													<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:110px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">For Pick-up</div>
													<div class = "button1" style = "margin-left:10px;display:inline-block;width:120px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
												</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Pending at CBO"){
						if($office == "1071"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Pending Released - CBO"){
						if($office == "1071"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Obligation Request for Pick-up"){
						if($office == "1071"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Obligation Request Signed"){
						if($perm == 42){
							$sheet .= '<tr style = ""> 
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Contract and NTP for City Engineer's Signature"){
						if($perm == 42){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Contract and NTP Signed"){
						if($perm == 42){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Document Filing"){
						if($office == "1081"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "CAO Received"){
						if($office == "1081"){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:110px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">For Pick-up</div>
												<div class = "button1" style = "margin-left:10px;display:inline-block;width:120px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
												</div>' .  $this->CreatePendingNote("caoPending",$trackingNumber)  . '
											</td>
									   <tr>';
						}
					}elseif($status == "Pending at CAO"){
						if($office == "1081"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Pending Released - CAO"){
						if($office == "1081"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>		
										</td>
								   <tr>';
						}
					}elseif($status == "Document for Pick-up - CAO"){
						if($office == "1081"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Contract and NTP Transmit to Admin" || $status == "Pending Released - Admin"){
						if($office == "1031"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Contract and NTP for Admin Signature"){
						if($office == "1031"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
													<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:110px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">For Pick-up</div>
													<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													</div>' .  $this->CreatePendingNote("admPending",$trackingNumber)  . '
												</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Pending at Admin"){
						if($office == "1031"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Document for Pick-up - Admin"){
						if($office == "1031"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
												<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Contract for Notarization"){
						if($perm == 38){
							$sheet .= '<tr style = ""> 
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Released to Contractor for Notarization"){
						if($perm == 38){
							$sheet .= '<tr style = ""> 
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Contract Notarized"){
						if($perm == 42){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
						}
					}elseif($status == "Prepare Letter for Pick-up NTP"){
						if($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Forward</div>
											</td>
									   <tr>';
						}
					}elseif($status == "Forwarded Letter for Pick-up NTP"){
						if($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											</td>
									   <tr>';
						}
					}elseif($status == "NTP Released to Contractor"){
						if($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}elseif($status == "NTP Received from Contractor"){
						if($perm == 42){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Forward</div>
											</td>
									   <tr>';
						}
					}
				}
			}

			if($trackingType == 'PX') {
				
				if($_SESSION['accountType'] == 4 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) {
					if($status == "Encoded"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}
					
					if($status == "Pending Released - CAO"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>		
									</td>
							<tr>';
					}
				}

				if($_SESSION['accountType'] == 6 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) {
					if($status == "CAO Received"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											</div>' .  $this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
									<tr>';
					}
					if($status == "Pending at CAO"){
							$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
											</td>
										<tr>';
					}
				}

				if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == 7) {
					if(strtoupper($status) == "FORWARDING TRANSMITTAL"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}

					if($status == "Check Preparation - CTO"){
						$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "c~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To SP - Admin</div>
												<div class = "button1" id = "a~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Operation</div>
												<div class = "button1" id = "b~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Administration</div>
												
											</td>
									<tr>';
					}

					if($status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin"){
						$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "x~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">Revert</div>
											</td>
									<tr>';
					}

					if($status == "Check Advised"){
						$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="ctoClaim(this)">Release&nbsp;Check</div>
											</td>
									<tr>';
					}

					if($status == "Check Released"){
						$sheet .= '<tr style = "">
							<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
								<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimRevert(this)">Revert</div>
								<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimReProcess(this)">Reprocess</div>
								
							</td>
					   <tr>';
					}

					if($status == "Check Preparation - CTO" || $status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin" || $status == "Check Advised"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = "background-color:rgb(249, 227, 238); margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="cancelCheck(this)">Cancel Cheque</div>
										</td>
								   <tr>';
					}

					if($status == "Cancelled Check"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "' . $trackingNumber . '" style = " margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="reissueCheck(this)">Reissue Check</div>
										</td>
								   <tr>';
					}
				}


			}
			
			if($_SESSION['gso'] == '1061' and $_SESSION['accountType'] == 2){	
				
				if($status == "Admin Received" || $status == "Forwarded to SP Admin" || $status == "Forwarding to BAC" || $status == "Forwarded to SP Admin - PR"){
					$sheet .= '<tr style = "">
								<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
								</td>
						   	<tr>';
				}else if($status == "BAC Received"){
					/*$sheet .= '<tr style = ""> // for clarification
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Queue</div>
										</div>' .  $this->CreatePendingNote("bacPending",$trackingNumber)  . '
									</td>
							   <tr>';*/
					$sheet .= '<tr style = ""> 
								<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
									<div id = "prEncodedUpdater">
										<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">For P.O</div>
									</div>' .  $this->CreatePendingNote("bacPending",$trackingNumber)  . '
								</td>
						   <tr>';	
					
				}else if($status == "Pending at BAC"){
					$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
									</td>
							   	<tr>';
				}else if($status == "Pending Released - BAC"){
					$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   	<tr>';
				}else if($status == "BAC Deliberation"){
					$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:205px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Save&nbsp;Procurement&nbsp;Type</div>
											<select class = "text3" style = "border-top:1px solid grey;border-left:1px solid grey;border-bottom:1px solid silver;text-align:left;font-family:Oswald;font-weight:normal;font-size:17px;width:200px;background-color:rgb(237, 234, 195);">
												<option value = "0"></option>
												<option value = "1">Competitive Bidding</option>
												<option style = "background-color:rgb(226, 222, 224)" value = "2">Alternative</option>
											    <option style = "background-color:rgb(226, 222, 224)" value = "3">Negotiated</option>
											    <option style = "background-color:rgb(226, 222, 224)" value = "4">Negotiated Procurement 53.9</option>
											    <option style = "background-color:rgb(226, 222, 224)" value = "5">Negotiated Procurement 53.1(TFB)</option>
											    <option style = "background-color:rgb(226, 222, 224)" value = "6">Negotiated Procurement 53.6(MS)</option>
											    <option style = "background-color:rgb(226, 222, 224)" value = "7">Negotiated Procurement 53.7</option>
											    <option style = "background-color:rgb(226, 222, 224)" value = "8">Shopping</option>   
											    
											    <option value = "15">Agency to Agency</option>
											    <option value = "16">Direct Contracting</option>
											    <option value = "17">Postal Office</option>
											    <option value = "18">Repeat Order</option>
											</select>
										</div>' .  $this->CreatePendingNote("delPending",$trackingNumber)  . '
									</td>
							   <tr>';
				}else if($status == "Pending at Deliberation"){
					$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
									</td>
							   	<tr>';
				}else if($status == "For P.O"){
					$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
									</td>
							   <tr>';
				}else if($status == "BAC Released"){
					$sheet .= '<tr style = "">
						<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
							<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
						</td>
				   <tr>';
				}
				// else if($status == "Pending Released - Admin"){
				// 	$sheet .= '	<tr style = "">
				// 					<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
				// 							<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
				// 					</td>
				// 				<tr>';
				// }

			}

			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1071' or $_SESSION['accountType'] == 7) { //cbo matters
				if($trackingType =="PR"){
					if($status == "GSO Received"){
						/*$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;OBR&nbsp;#</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $obrNumber . '"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   <tr>';*/ //wala na ni sa budget 
					}else if($status == "Encoded"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;OBR&nbsp;#</span>
											<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $obrNumber . '"  style = ""/>
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
							   <tr>';
					}else if($status == "CBO Received"){
						/*$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
									</td>
							   <tr>';*/
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
									</td>
							   <tr>';
					}else if($status == "Pending at CBO"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
					}else if($status == "Pending Released - CBO"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
							   		<tr>';
					}else if($status == "CBO Released"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
										</td>
							   		<tr>';
					}else if($status == "Pending Released - Admin"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}else if($status == "Pending Released - CTO"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}else if($status == "Pending Released - BAC"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}
					
				}

				if($trackingType =="PY"){

					if($status == "Encoded"){
						if($docType != "LIQUIDATION"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;OBR&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $obrNumber . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
						}
						
					}else if($status == "CBO Received"){
						
						if($docType == "INFRASTRUCTURE - CONTRACT" ){
								$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
									</td>
							   <tr>';
						}else{
							$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
									</td>
							   <tr>';
						}
					}else if($status == "Pending at CBO"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
					}else if($status == "Pending Released - CBO"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
							   		<tr>';
					}else if($status == "CBO Released"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Revert</div>
										</td>
							   		<tr>';
					}

				}

				if($trackingType == "PO"){
					if ($status == 'Supplier Conformed' || $status == "GSO Conformed") {
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;OBR&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $obrNumber . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}else if($status == "Fund Control"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
										</div>
									</td>
							   <tr>';
					}else if($status == "Pending at CBO"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
					}else if($status == "Pending Released - CBO"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}
				}
				

			}

			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == 7) { //cbo matters
				if($trackingType =="PR"){
					// if($status == "CBO Received" || $status == "CBO Released"){
					// 	$sheet .= '<tr style = "">
					// 				<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
					// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
					// 				</td>
					// 		   <tr>';
					// }
					if($status == "GSO Received" || $status == "GSO Released"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="prCTOreceive(this)">Receive</div>
									</td>
							   <tr>';
					}else if($status == "CTO Received"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											<div  id = "' . $trackingNumber . '" class = "button1" style = "margin-left:10px;display:inline-block;width:200px;padding:5px;font-size:22px;" onclick="prCTOforward(this)">Forward to SP Admin</div>
											
										</div>' .  $this->CreatePendingNote("ctoPending",$trackingNumber)  . '
									</td>
							   <tr>';
					}else if($status == "Pending at CTO"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
					}

				}else{
					if($trackingType != "PX") {
						if($status == "Check Preparation - CTO"){
							$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "c~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To SP - Admin</div>
													<div class = "button1" id = "a~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Operation</div>
													<div class = "button1" id = "b~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Administration</div>
													
												</td>
										<tr>';
						}
						if($status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin"){
							$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "x~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">Revert</div>
												</td>
										<tr>';
						}
						if($status == "Check Advised"){
							$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="ctoClaim(this)">Release&nbsp;Check</div>
												</td>
										<tr>';
						}
						if($status == "Check Released"){
							$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimRevert(this)">Revert</div>
													<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimReProcess(this)">Reprocess</div>
													
												</td>
										<tr>';
						}
						
						if(strtoupper($status) == "FORWARDING TRANSMITTAL"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									<tr>';
						}

						if($status == "Draft"){
							if($docType == "CASH ADVANCE TO PAYMASTER"){
								$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
														<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Encode</div>
												</td>
										<tr>';
							}
						}
						if($status == "Check Preparation - CTO" || $status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin" || $status == "Check Advised"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "' . $trackingNumber . '" style = "background-color:rgb(249, 227, 238); margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="cancelCheck(this)">Cancel Cheque</div>
											</td>
									<tr>';
						}
						if($status == "Cancelled Check"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "' . $trackingNumber . '" style = " margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="reissueCheck(this)">Reissue Check</div>
											</td>
									<tr>';
						}
					}

				}
				
			}

			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1031' or $_SESSION['accountType'] == 7) { //admin matters
				if($trackingType =="PR"){
					// if($status == "CTO Received"){
					// 	$sheet .= '<tr style = "">
					// 				<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
					// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
					// 				</td>
					// 		   <tr>';
					// }
					// if($status == "CTO Received" || $status == "Pending Released - Admin"){
					if($status == "CTO Received"){
						$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									<tr>';
					}else if($status == "Admin Received"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;padding:5px;font-size:22px;width:155px;"  onclick="adminForward(this)">Forward&nbsp;to&nbsp;BAC</div>
										</div>' .  $this->CreatePendingNote("admPending",$trackingNumber)  . '
									</td>
							   <tr>';
					}else if($status == "Pending at Admin"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								   <tr>';
					}else if($status == "Forwarding to BAC"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;padding:5px;font-size:22px;width:90px;"  onclick="revertAdmin(this)">Revert</div>
										</td>
								   <tr>';
					}else if($status == "Pending Released - Admin"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
									<tr>';
					}
					
				}
			}
			
			if($_SESSION['accountType'] == 4 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) { //cao matters

				if($trackingType == "PO"){
					if($status == "GSO Received"){
						
						/*$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';*/
					}

					if($status == "Pending Released - CAO"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>		
									</td>
							   <tr>';
					}
				}
				
				if( trim(strtoupper($status)) == "INSPECTED"  ||  trim(strtoupper($status)) == "INVENTORY" ||  $status == "GSO Received - Voucher(Inventory)" || $status == "GSO Received - Voucher(Inspection)"){
					
					$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
				}

				if($trackingType =="PY"){

					if($status == "CBO Received"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}

					if($status == "CBO Released"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = ""  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}

					if($docType == "LIQUIDATION"){
						if($status == "Encoded" or $status == "GSO Received"){
							if($fund != "Trust Fund"){
								$sheet .= '<tr style = "">
												<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
														<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
														<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
														<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
												</td>
										   <tr>';
							}
						}		   
					}

					if($docType == "REIMBURSEMENT" or $docType == "REPLENISHMENT"){
						if($status == "GSO Received"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
													<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}	
					}

					if($status == "Encoded"){
						if($fund == "Trust Fund"){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
													<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
						
						if($docType != 'BOND - RETENTION MONEY' && $docType != 'Liquidation') {
							// $sql = "Select * from type where Type = '" . strtoupper($docType) . "' limit 1";
							$sql = 'SELECT * FROM Type WHERE Type = "'.strtoupper($docType).'" LIMIT 1';
							$record = $this->query($sql);
							$data = $this->fetch_array($record);
							$obrType = $data['OBRType'];
						}else {
							$obrType = 0;
						}
						
						
						if($obrType == 0){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
													<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					
						
						if($periodType  == 2){
							$sheet .= '<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
													<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
											</td>
									   <tr>';
						}
					}

					if($status == "Pending Released - CAO"){
						$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
													<div id = "prEncodedUpdater">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>		
											</td>
									<tr>';
					}

					// if($status == "CAO Received"){
					// 	if(substr($trackingNumber,0,4) == 'LING') {
					// 		$sheet .= '	<tr style = "">
					// 						<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
					// 							<div id = "prEncodedUpdater">
					// 								<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateDateTagTaxifier(this)">Taxify</div>
					// 							</div>		
					// 						</td>
					// 					<tr>';
					// 	}

					// }

					if($status == "CAO Received"){
						if(substr($trackingNumber,0,4) == 'LING') {
							// $sheet .= '	<tr style = "">
							// 				<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
							// 					<div id = "prEncodedUpdater">
							// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateDateTagTaxifier(this)">Taxify</div>
							// 					</div>		
							// 				</td>
							// 			<tr>';

							$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
													<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateDateTagTaxifier(this)">Taxify</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:135px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">On Evaluation</div>
												</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
											</td>
										<tr>';
						}else {
							$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
													<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:135px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">On Evaluation</div>
												</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
											</td>
										<tr>';
						}

					}


					if($status == "On Evaluation - Accounting"){

						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Evaluated</div>
											</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
									<tr>';

					}

					if($status == "Carded - Accounting"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
											</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
									<tr>';
					}

					if($status == "Evaluated - Accounting"){

						if(substr($trackingNumber, 0, 4) == 'LING') {
							
							$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-right:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateDateTagTaxifier(this)">Taxify</div>
													<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
												</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
											</td>
										<tr>';

						}else {

							$sheet .= '	<tr style = "">
											<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater">
													<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
													<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
												</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
											</td>
										<tr>';

						}

					}

					if($status == "Fund Correction"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="updateFundCorrected(this)">Fund Corrected</div>
											</div>
										</td>
									</tr>';
					}

				}

				if($trackingType == "IP"){
					if($status == "Encoded"){
						$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
												<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
												<input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $adv . '"  style = ""/>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
										</td>
								   <tr>';
					}
					
					if($status == "Pending Released - CAO"){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>		
									</td>
							   <tr>';
					}

					if($status == "CAO Received"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:135px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">On Evaluation</div>
											</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
									<tr>';
					}

					if($status == "On Evaluation - Accounting"){

						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
												<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Evaluated</div>
											</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
									<tr>';

					}

					if($status == "Evaluated - Accounting"){
						$sheet .= '	<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">
												<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											</div>'.$this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
									<tr>';
					}

				}

			}

			if($_SESSION['accountType'] == 6 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) { //cao matters
				if($trackingType != 'PX') {
					if($status == "CAO Received" || $status == "Carded - Accounting"){
						
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div id = "prEncodedUpdater">';

							if($trackingType == "NF"){
								$sheet .= '<div class = "button1" id = "button' . $trackingNumber . '" style="margin-left:10px; display:inline-block; width:80px; padding:5px; font-size:22px;"  onclick="updateTracking(this)">Release</div>';
							}
												
							if(strtoupper($docType) == "LIQUIDATION"){
								$sheet .= '					 <div class = "button1"  id = "skipAndSave' . $trackingNumber .'" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = "skipAndSave(this)")\'>Release</div>
												&nbsp;&nbsp;&nbsp;&nbsp;';
							} 	
							
												
							$sheet .= '	<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											</div>' .  $this->CreatePendingNote("caoPending",$trackingNumber)  . '
										</td>
								<tr>';
					}
					if($status == "Pending at CAO"){
							$sheet .= '<tr style = "">
										<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
										</td>
								<tr>';
					}
				}
			}

			if($_SESSION['accountType'] == 5 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) { // jopet 
				if($status == "CAO Received"){
					//ayaw i activate para dili diri ka release
					/*$sheet .= '<tr>
						   		<td style = "padding-bottom:40px;width:10px;text-align:center;" colspan = "2">
								 	 <div id = "cancelRelease">	
										 <span style = "padding:5px 10px; "  id = "button' . $trackingNumber .'" class = "button1" onclick = "viewControl(this)">Release</span>
									 </div>
									 <div style = "display:none;" class = "pendingContainer">	
									 	
										 <span id = "control' . $trackingNumber .'" class = "button1" onclick = "saveControl(this)">Save Control<div class = "" id ="divCtrl" >wait</div></span>
										 &nbsp;&nbsp;&nbsp;&nbsp;
										 &nbsp;&nbsp;&nbsp;&nbsp;
										 <span id = "skipAndSave' . $trackingNumber .'" class = "button1" onclick = "skipAndSave(this)">Skip & Save</span>
										  &nbsp;&nbsp;&nbsp;&nbsp;
										 &nbsp;&nbsp;&nbsp;&nbsp;
										 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this,\'cancelRelease\')">Cancel</span>
									 </div>
								</td>
							<tr>';*/
				}
			}

			if($_SESSION['accountType'] == 8 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) { // alvin
				if($status == "CAO Received" || $status == "Carded - Accounting"){
					if($periodType <= 0 or $periodType > 3 ){
						$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											 ' . $this-> CreateSLPsheet($trackingNumber,$claimType) . '
									</td>
							   <tr>';
					}
					$sheet .= '<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "" style = "margin-left:10px;display:inline-block;width:60px;padding:5px;font-size:22px;"  onclick="updateTrackingToSLP('."'".$trackingNumber."'".')">SLP</div>
									</td>
							   <tr>';
				}
			}

			if($_SESSION['privy'] == 1 || $_SESSION['accountType'] == 7){
				if($status != "Cancelled - Fund Reverted") {
					// $sheet .= '	<tr style = "">
					// 				<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
					// 					<div id = "prEncodedUpdater">
					// 						<div class = "button1" id = "' . $trackingNumber . '" style="background-color:rgb(249, 227, 238); margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="cancelFundReverted(this)">Cancel</div>
					// 					</div>
					// 				</td>
					// 			<tr>';
				}

			}

			$sheet .= '</table>' ;
			return $sheet;
		}


		function CreateAdviceSheet($trackingNumber,$fund,$netAmount){
			
			$sql = "Select * from bankaccount where Fund = '" . $fund . "'";
			$record = $this->query($sql);
			$count = $this->num_rows($record);
			if($count == 1){
					$data = $this->fetch_array($record);
					$sheet1 = '<tr>
								<td style = "padding:0px 15px;text-align:right;"><span class =  "label17" style = "font-size:16px;">Account Number</span></td><td>
								<input  id = "addCheckAccount" value  ="' . $data['AccountNumber'] . '" maxlength ="10" class =  "inputText" style = "text-align:center;font-size:16px;width:170px;"  disabled   /></td>
							</tr>';
			}else{
					$sheet2 = '<tr>
								<td style = "padding:0px 15px;text-align:right;"><span class =  "label17" style = "font-size:16px;">Account Number</span></td>
								<td>
									<select id = "addCheckAccount" class = "inputText" style = "width:170px;">';
									while($data =  $this->fetch_array($record)){
										$sheet2 .= '<option >' . $data['AccountNumber'] . '</option>';
									}
					$sheet2 .= '
									</select>
								</td>
							</tr>';
					$sheet1 =$sheet2;		
			}
			$sheet = '<table style = "margin:0 auto;border:1px solid silver;padding-bottom:15px;" border ="0">';
			
			$sheet .= '<tr>
						<td  colspan ="3" style ="padding:10px;background-color:rgb(55, 151, 224);border-bottom:1px solid grey;"><span class =  "label3" style = "font-size:16px;font-weight:bold;color:white;">Adding check Info</span></td>
					</tr>';
			$sheet .= '<tr>
						<td  colspan ="3" style = "padding:5px;"></td>
					</tr>';
			$sheet .= $sheet1;
			$sheet .= '<tr>
						<td  style = "padding:0px 15px;text-align:right;"><span class =  "label17" style = "font-size:16px;">Net Amount</span></td><td>
						<input id = "addCheckAmount" value  ="' . number_format($netAmount,2) . '"  maxlength ="12" class =  "inputText" onkeydown="" onkeypress="keypressAndWhat1(this,event,gotoCheckAmount,1)"  style = "text-align:center;font-size:16px;width:170px;color:red;" /></td>
						<td  rowspan = "3" style = "padding:0px 15px;"><span id = "check'  . $trackingNumber .  '" class =  "button1" style = "font-size:16px;" onclick ="saveCheckDetails(this)">Save</span></td>
					</tr>';
			$sheet .= '<tr>
						<td  style = "padding:0px 15px;text-align:right;"><span class =  "label17" style = "font-size:16px;">Check Number</span></td><td>
						<input id = "addCheckNumber" value  =""  maxlength ="10" class =  "inputText" onkeydown="return isValueNumber(this,event)" onkeypress="keypressAndWhat1(this,event,gotoCheckDate,1)"  style = "text-align:center;font-size:16px;width:170px;" /></td>
						
					</tr>';
			$sheet .= '<tr>
						<td style = "padding:0px 15px;text-align:right;"><span class =  "label17" style = "font-size:16px;">Check Date</span></td><td>
						<input  id = "addCheckDate" value  ="' . date("m/d/Y") . '" maxlength ="10" class =  "inputText" onkeypress="keypressAndWhat1(this,event,gotoSaveCheck,1)" style = "text-align:center;font-size:16px;width:170px;"/></td>
					</tr>';
					
			$sheet .= '</table style = "margin:0 auto;" border ="0">';
			return $sheet;
			
		}
		function CreateSLPsheet($trackingNumber,$claimType){
			$sheet = '<table style = "margin:0 auto;" border ="0">
					<tr><td colspan = "3" style = "font-size:22px;font-weight:bold;">SLP options</td></tr>
					<tr><td style = "vertical-align:top;">';
			
			$sheet .= '<table style ="border:1px solid rgb(231, 235, 237);">';
			$sheet .= '<tr  style ="background-color:rgb(207, 208, 209);"><td colspan = "3" style = "font-weight:bold;padding:5px;">One period salary</tr>';	
			
			
			$sheet .= '<tr><td style = "text-align:right;padding-top:10px;">Net Amount</td>
					  <td style = "padding-top:10px;padding-right:5px;"><input style = "padding:5px;width:100px;" type = "text"  id  = "netAmount" onkeydown="keypressNext1(event,\'payeeNumberA\')"/></td>
					  </tr>';
			
			$sheet .= '<tr><td style = "text-align:right;">Payee&nbsp;number</td><td><input style = "padding:5px;width:100px;" id = "payeeNumberA" type = "text"/></td></tr>';	
			$sheet .= '<tr><td colspan = "3" style = "text-align:right;" ><div id = "slp1~' . $trackingNumber . '" class = "button2" onclick="saveSLP(this)"   style = "margin:10px; margin-right:35px;">Save</div></tr>';	
			$sheet .= '</table></td><td>';
			
			
			$sheet .= '<td><table style ="border:1px solid rgb(231, 235, 237);">';
			$sheet .= '<tr style ="background-color:rgb(207, 208, 209);"><td colspan = "3" style = "font-weight:bold;padding:5px;">Two period salary</tr>';	
			$sheet .= '<tr><td style = "text-align:right;padding-top:10px;">First</td>
					  <td style = "padding-top:10px;"><input type = "text" style = "padding:5px;width:100px;" id  = "netAmount1" onkeydown="keypressNext1(event,\'netAmount2\')"/></td></tr>';
			$sheet .= '<tr><td style = "text-align:right;">Second</td>
					  <td><input type = "text" style = "padding:5px;width:100px;" id  = "netAmount2"  onkeydown="keypressNext1(event,\'payeeNumberB\')"/></td>
					  <td rowspan = "2" style = "padding:10px;"></tr>';
			$sheet .= '<tr><td>Payee&nbsp;number</td><td><input id = "payeeNumberB" style = "padding:5px;width:100px;" type = "text" /></td></tr>';	
			$sheet .= '<tr><td colspan = "3" style = "text-align:right;"><div id = "slp2~' . $trackingNumber . '" class = "button2" onclick="saveSLP(this)" style = "margin:10px; margin-right:50px;margin-top:10px;" >Save</div></tr>';
			$sheet .= '</table>';
			
			
			$sheet .= '</td></tr><table>';
			if($claimType == "Check"){
				return $sheet;
			}else{
				return "<div style = 'font-size:22px;font-family:Oswald; letter-spacing:1px;text-align:right;font-weight:bold;'>\"SLP not applicable...\"</div>";
			}
			
		}
		
		function CreatePendingNote($pend,$trackingNumber){
			$sheet ='<div id="pendingContainer" style="display: none;margin:0 auto;width:600px;" id = "pendingEditor">
						<div class="label6" "="" style="color:red;float:left;padding-bottom:10px;">● Write pending reason</div>
						<textarea id="pendingNote" class="textarea1">	</textarea>
						<br>
						<br>
						<span id = "' . $pend . $trackingNumber .'" class="button1" onclick="savePending(this)" onclick="savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;
						<span class="button1"  style = "width:80px" onclick=\'cancelPending(this,"prEncodedUpdater")\'>Cancel</span>
					</div>';
			return $sheet;
		}
		
		function CreateGenDetailsPY($complex,$batchTracking,$subCode,$checkNumber, $checkDate,$obrNumber,$className,$trackingNumber,$adv,$claimant,$fund,$docType,$claimType,$period,$amount,$netAmount,$payeeNumber,$periodType,$trackingPartner,$status,$office,$programCode,$controlNo,$trackingType,$nf,$peorOfc,$variation,$trackYear,$variation1,$variation2,$variationOBR2,$drrmo,$forDrrmo){
			
			$logOffice = $_SESSION['gso'];
			$acct = $_SESSION['accountType'];
			
			// $trackingType = "PY"; 12-22-2021 removed for CO purposes
			$sheet = '<table style = "width:100%;" border ="0">';
			$payee =  '';
			$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >TN</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $trackingNumber .  '</span>		
							</td>
							<td style = "width:10px;">
							</td>
					   <tr>';
			$className =  $this->permissionClassByField($trackingType,$status,$office,"Complex");	
			if($complex == 1 ){
				$complexity = "Simple Transaction";
			}else if($complex == 2 ){
				$complexity = "Complex Transaction";
			}else{
				$complexity = "Simple Transaction";
			}
			$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;white-space:nowrap;" >Transaction Classification</span></td>
							<td style = "border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;color:rgb(22, 178, 217);" >' . $complexity . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "margin-right:20px;font-size:12px;"  onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
			if($payeeNumber != ''){
				$payee = '<span style = "font-size:12px;letter-spacing:1px;padding-left:5px;">('  . $payeeNumber .  ')</span>';
			}
			if($trackingType != "NF"){
				if($claimant != '' ){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"Claimant"); 
					$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Claimant</span></td>
								<td style = "border-bottom:1px solid silver;padding-right:25px;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . strtoupper($claimant) .  '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';	
				}
			}
			
			$className = 'hide';
			if($trackingPartner != ''){
				if($trackingType != "IP") {
					$sheet .= '<tr>
									<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >TN Partner</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span  id = "pyTrackingPartner" class = "data1" style = "font-weight:bold;font-size:22px;color:red;cursor:pointer;" onclick = "searchThisPartner(this)" >' . $trackingPartner . '</span>		
									</td>
								<tr>';
				}else {
					$sql = "SELECT InfraTracking FROM infrapayment WHERE TrackingNumber = '".$trackingNumber."' GROUP BY InfraTracking";
					$infRecord = $this->query($sql);

					$infLinks = "";
					while($data1 = $this->fetch_array($infRecord)) {
						$infLinks .= '<span class="hover" style="margin-right:10px;font-family:NOR;cursor:pointer;" onclick="searchThisPartner(this)">' . $data1['InfraTracking'] . '</span>';
					}
					$sheet .= '	<tr>
									<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >TN Partners</span></td>
									<td style = "border-bottom:1px solid silver;">
										<div style="text-align:center;margin-right:5px;width:20px;height:20px;background-color:rgb(46, 160, 226);color:white;display:inline-block;">'.$this->num_rows($infRecord).'</div>
										'.$infLinks.'
									</td>
								<tr>';
				}
				
			}
			if($batchTracking != ''){
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >SLP&nbsp;Tracking</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span  id = "pyTrackingPartner" class = "data1" style = "font-weight:bold;font-size:22px;color:red;cursor:pointer;" onclick = "searchThisPartner(this)" >' . $batchTracking . '</span>		
								</td>
						   <tr>';
			}
			if($controlNo > 0 and $logOffice == "1081"){
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Ctrl&nbsp;Number</span></td>
								<td  colspan = "2" style = "border-bottom:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $controlNo  .  '</span>		
								</td>
								
						   <tr>';
			}
			//if($adv > 0 ){
			if($trackingType != "NF"){
				
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Adv"); 
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >ADV&nbsp;Number</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span id = "advTrack"  class = "data1" style = "font-weight:bold;font-size:22px;">' . $adv . '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';

			}
			//}
			if($trackingType != "NF"){
				
				if($obrNumber != '' ){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"OBRNumber"); 
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">OBR&nbsp;Number</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span id  = "prOBRNumber"class = "data1" style = "font-weight:bold;font-size:22px;">' . $obrNumber . '</span>
									</td>
									<td>
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
									</td>
							   <tr>';
				}
				
			}
			if($trackingType == "NF" ){
				$arr  = explode("*!*",$nf);
				$batchNumber = $arr[0];
				$location =  utf8_decode($arr[1]);
				$duration = $arr[2];
				$mode = $arr[3];
				$name = $arr[4];
				$entry = $arr[5];
				
				$code = $arr[6];
				$amount = $arr[7];
				$fundYear = $arr[8];
				$fundName = $arr[9];
				$title = $arr[10];
				$expenseCode = $arr[11];
				$title = $arr[12];
				$claimant = $arr[13];
				$started = $arr[14];
				$completed = $arr[15];
				
				$programmer = $arr[16];
				$inspector = $arr[17];
				$extension = $arr[18];
				$barangay = $arr[19];
				$variationOBR = $arr[20];
				if($fund != 'Trust Fund' ){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"OBRNumber"); 
					$sheet .= '<tr style ="line-height:19px;">
							   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">OBR&nbsp;Number</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span id  = "prOBRNumber"class = "data1" style = "font-weight:bold;font-size:22px;">' . $obrNumber . '</span>
									</td>
									<td>
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
									</td>
							   <tr>';
					if($variation > 0){
						$className =  $this->permissionClassByField($trackingType,$status,$office,"Variation"); 
						$sheet .= '<tr style ="line-height:19px;">
							   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">Variation 1 OBR Number</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span id  = ""class = "data1" style = "font-weight:bold;font-size:22px;">' . $variationOBR . '</span>
									</td>
									<td>
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
									</td>
							   <tr>';
					}

					if($variation2 > 0){
						$className =  $this->permissionClassByField($trackingType,$status,$office,"Variation2"); 
						$sheet .= '	<tr style ="line-height:19px;">
										<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">Variation 2 OBR Number</span></td>
										<td style = "border-bottom:1px solid silver;">
											<span id  = ""class = "data1" style = "font-weight:bold;font-size:22px;">' . $variationOBR2 . '</span>
										</td>
										<td>
											<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
										</td>
									<tr>';
					}
					
				}
			}
			$className =  $this->permissionClassByField($trackingType,$status,$office,"Document"); 
			$sheet .= '<tr>
				   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Document</span></td>
						<td  style = "border-bottom:1px solid silver;">
							<span id = "pyDocType"  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;">' . $docType . '</span>		
						</td>';
						
						
					
			if(strtoupper($docType) != "LIQUIDATION"){
				$sheet .= '	<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>';
			}			
			$sheet .= '<tr>';
			
			if($trackingType == "NF"){
				
				/*$arr  = explode("*!*",$nf);
				$batchNumber = $arr[0];
				$location =  utf8_decode($arr[1]);
				$duration = $arr[2];
				$mode = $arr[3];
				$name = $arr[4];
				$entry = $arr[5];
				
				$code = $arr[6];
				$amount = $arr[7];
				$fundYear = $arr[8];
				$fundName = $arr[9];
				$title = $arr[10];
				$expenseCode = $arr[11];
				$title = $arr[12];
				$claimant = $arr[13];
				$started = $arr[14];
				$completed = $arr[15];
				
				$programmer = $arr[16];
				$inspector = $arr[17];
				$extension = $arr[18];
				$barangay = $arr[19];*/
				if($entry == "Regular"){
					$entry = '';
				}else{
					$entry = '( ' . $entry . ' )';
				}
				if(strlen($fundName) > 0){
					$fundName = '<br/>' . $fundName;
				}
				
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;"><span class="data1 genDtlLabel" style="color:black;" >Project Title</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;line-height:24px;padding-bottom:5px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;color:rgb(95, 192, 234);">' . $name .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';
				

				if($trackingType != "NF"){
					$labelClaimant = 'Claimant';
				}else{
					$labelClaimant = 'Contractor';
				}
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Claimant"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;"><span class = "data1 genDtlLabel" style = "color:black;" >' . $labelClaimant . '</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . strtoupper($claimant) .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';	
				   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"BatchNumber"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Batch&nbsp;No.</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;" id = "displayInfraBatchNumber">' . $batchNumber .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';	
				
				if(strlen($batchNumber) > 8){
					$sql = "select TrackingNumber from  infra where batchNumber = '" . $batchNumber . "'";	   
					$record = $this->query($sql);
					$count = $this->num_rows($record);
					if($count > 1){
						$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Batch Trackings</span></td>
								<td style = "border-bottom:1px solid silver;padding-right:25px;" colspan ="2"><div style = "text-align:center;margin-right:5px;width:20px;height:20px;background-color:rgb(46, 160, 226);color:white;display:inline-block;">' . $count . '</div>';
								while($data = $this->fetch_array($record)){
									$sheet .=  '<span class ="hover" style = "margin-right:10px;font-family:NOR;cursor:pointer;" onclick="searchThisPartner(this)">' .   $data['TrackingNumber'] . '</span>';
								}	 	
						$sheet .= '</td>
								
						   </tr>';		
						
					}
				}
				
				  
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Barangay"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;"><span class = "data1 genDtlLabel" style = "color:black;" >Barangay</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;line-height:24px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $barangay .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';	   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Location"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;"><span class = "data1 genDtlLabel" style = "color:black;" >Location</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;line-height:24px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $location .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Started"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;white-space:nowrap; "><span class = "data1 genDtlLabel" style = "color:black;" >Construction Start Date</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;line-height:24px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $started.  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';	   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Completed"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;"><span class = "data1 genDtlLabel" style = "color:black;" >Construction End Date</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;line-height:24px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $completed.  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';	 
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Extension"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;white-space:nowrap;"><span class = "data1 genDtlLabel" style = "color:black;" >Construction Extension Date</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;line-height:24px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px; ">' . $extension.  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';	 
					   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Duration"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Duration</span></td>
							<td style = "border-bottom:1px solid silver;padding-right:25px;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $duration .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';

				// $className =  $this->permissionClassByField($trackingType,$status,$office,"Programmer"); 
				// $sheet .= '<tr>
				// 	   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Project Programmer</span></td>
				// 			<td style = "border-bottom:1px solid silver;padding-right:25px;">
				// 				<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $programmer .  '</span>		
				// 			</td>
				// 			<td>
				// 				<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
				// 			</td>
				// 	   </tr>';
				// $className =  $this->permissionClassByField($trackingType,$status,$office,"Inspector"); 
				// $sheet .= '<tr>
				// 	   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Construction Inspector</span></td>
				// 			<td style = "border-bottom:1px solid silver;padding-right:25px;">
				// 				<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $inspector .  '</span>		
				// 			</td>
				// 			<td>
				// 				<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
				// 			</td>
				// 	   </tr>';

					   		
			}
			$per = '';
			if($periodType != ''){
				if($periodType == 1){
					$per = '<span style = "font-size:12px;padding-left:5px;">(1-15)</span>';
				}
				if($periodType == 2){
					$per = '<span style = "font-size:12px;">(16-31)</span>';
				}
				if($periodType == 4){
					$per = '<span style = "font-size:12px;">(1-15)</span>';
				}
				if($periodType == 5){
					$per = '<span style = "font-size:12px;">(16-31)</span>';
				}
				//$per = '';
			}

			if($trackingType != "NF"){
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Period"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Period</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $period . $per . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
			}
			
			if($trackingType != "NF"){
				$className =  $this->permissionClassByField($trackingType,$status,$office,"ClaimType"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Claim&nbsp;Type</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $claimType . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
			}

			if($docType == "CASH ADVANCE TO PAYMASTER"){
				$pmSql = "SELECT `Window`, CashRelease FROM particulars WHERE TrackingNumber = '".$trackingNumber."' LIMIT 1";
				$pmRecord = $this->query($pmSql);
				$pmData = $this->fetch_array($pmRecord);
				$window = $pmData['Window']; 
				$cashRelease = $pmData['CashRelease']; 

				$className =  $this->permissionClassByField($trackingType,$status,$office,"Window"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Window</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px; color:rgb(64, 161, 202);">' . $window . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
				
				$className =  $this->permissionClassByField($trackingType,$status,$office,"CashRelease"); 
				$sheet .= '<tr>
								<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black; white-space:nowrap;" >Cash Release</span></td>
								<td  style = "border-bottom:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $cashRelease . '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
							<tr>';
			}

			// if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE"){
			if($claimType == "Window"){
				$pmSql = "SELECT PTRSNo, OfficeAssigned from particulars where TrackingNumber = '".$trackingNumber."'";
				$pmRecord = $this->query($pmSql);
				$pmData = $this->fetch_array($pmRecord);
				$ptrs = $pmData['PTRSNo'];
				$officeAssigned = $pmData['OfficeAssigned'];

				$className = ""; 
				$sheet .= '<tr>
								<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >PTRS</span></td>
							<td  style = "border-bottom:1px solid silver; width:">
								<span  class = "data1" style = "font-weight:bold; font-size:22px;">' . $ptrs . '</span>		
							</td>
							<td>
							</td>
						<tr>';

				$className =  $this->permissionClassByField($trackingType,$status,$office,"OfficeAssigned"); 
				$sheet .= '<tr>
								<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black; white-space:nowrap;" >Office Assigned</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $officeAssigned . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
						<tr>';
			}

			if($fund == "Trust Fun" or strtoupper($docType) == "LIQUIDATION"){ // 2023-01-25 "Trust Fun" jud ni?
				$cashAdvance = 0;
				$spent = 0;
				$ORdetails = '';
				$reim = 0;
				$refund = 0;

				$sql = "SELECT if(TotalAmountMultiple > 0, TotalAmountMultiple, Amount) as CashAdvance, Fund FROM vouchercurrent WHERE TrackingPartner = '".$trackingNumber."' GROUP BY TrackingNumber";
				$record = $this->query($sql);
				while ($data = $this->fetch_array($record)) {
					$cashAdvance += floatval($data['CashAdvance']);
					$fund = $data['Fund'];
				}

				$sql = "SELECT * FROM liquidation where TrackingNumber = '".$trackingNumber."'";
				$record = $this->query($sql);
				while ($data = $this->fetch_array($record)) {
					$ORdetails .= "";
					if($data['ORdetails'] != ""){
						$ORdetails .= ",".strtoupper($data['ORdetails']);
					}
					$refund += floatval($data['Refund']);
					$reim += floatval($data['Reimbursement']);
					$spent += floatval($data['Spent']);
				}
				$ORdetails = substr($ORdetails, 1);
				$count = $this->num_rows($record);
				
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Fund"); 	      
				$sheet .= '<tr>
				   		<td style = "padding-top:20px;width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Fund</span></td>
						<td  style = "padding-top:20px;border-bottom:0px solid silver;border-bottom:1px solid silver;">
							<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;">' . $fund  . '</span>		
						</td>
						
				   <tr>';
			}else{
				
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Fund"); 	      
				
				if($trackingType == "NF"){
					
					$className =  $this->permissionClassByField($trackingType,$status,$office,"ModeOfProcurement"); 
					$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black; white-space: nowrap;" >Mode of Procurement</span></td>
							<td style = "padding-right:25px;border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $mode .  '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   </tr>';	
					$sheet .= '<tr style = "line-height:10px;">
				   		<td style = "padding-top:0px;width:10px;text-align:right;padding-left:30px;padding-top:10px;"><span class = "data1 genDtlLabel" style = "color:black;" >Fund Year</span></td>
						<td  style = "padding:10px 0px;padding-top:15px;padding-left:5px;border-bottom:1px solid  silver;font-weight:bold;font-size:22px;">
							<span  class = "data1"  id = "displayFund">' . $fund .  '</span> <span class = "data1" style = "color:rgb(0, 96, 128);">' . $fundYear  .'</span>		
						</td>
						
						<td style = "padding-top:0px;">
							
						</td>
				   <tr>';   
				   if($subCode > 0){

						$sql = "SELECT * FROM peace WHERE OfficeId = '".$peorOfc."' AND Code = '".$subCode."' LIMIT 1";
						$record = $this->query($sql);
						$data = $this->fetch_array($record);
						$ofcName = $data['Name'];
						$subName = $data['Fund'];
						$des = "<span style='color:rgb(35, 116, 157);'>".$ofcName."</span>".$subName;
						$className =  $this->permissionClassByField($trackingType,$status,$office,"SubProg"); 	      
						$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Sub&nbsp;Program</span></td>
								<td  style = "border-bottom:0px solid silver;border-bottom:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;">' . $des  . '</span>		
								</td>
								<td >
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
					}   
				   $sheet .= '<tr>
				   		<td style = "padding-top:0px;width:10px;text-align:right;padding-left:30px;vertical-align:top;"><span class = "data1 genDtlLabel" style = "color:black;" >Fund Code</span></td>
						<td  style = "padding-top:0px;line-height:24px;border-bottom:1px solid  silver;padding-bottom:5px;">
							<span  class = "data1" style = "font-weight:bold;font-size:22px;" id = "displayFund">'  .  $code  . '  ' . $entry  . $fundName . '</span>		
						</td>
						
						<td style = "padding-top:0px;">
							
						</td>
				   <tr>';
				
				   $sheet .= '<tr style ="line-height:14px;">
				   		<td style = "padding-top:0px;width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Expense Code</span></td>
						<td  style = "padding-top:5px;">
							<span  class = "data1" style = "font-weight:bold;font-size:22px;" id = "displayFund">'  .  $expenseCode  . '</span>		
						</td>
						<td style = "padding-top:0px;">
						</td>
				   <tr>';
				    $sheet .= '<tr style ="line-height:22px;">
				   		<td style = "padding-top:0px;width:10px;text-align:right;padding-left:30px;"><span class = "data1" style = "color:black;" ></span></td>
						<td  style = "padding-top:0px;">
							<span  class = "data1" style = "font-weight:bold;font-size:22px;" id = "displayFund">'  .  $title  . '</span>		
						</td>
						<td style = "padding-top:0px;">
						</td>
				   <tr>';
				    $sheet .= '	<tr style = "line-height:25px;">
										<td style = "padding-top:0px;width:10px;text-align:right;padding-left:30px;padding-top:10px;"><span class = "data1 genDtlLabel" style = "color:black;" >Budget Amount</span></td>
										<td  style = "padding-top:0px;border-top:1px solid silver;padding-top:10px;">
											<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;color:red;" id = "displayFund">'  . number_format($amount,2) .   '</span>		
										</td>
										
										<td style = "padding-top:0px;">
										
										</td>
								<tr>';
				 
					$className =  $this->permissionClassByField($trackingType,$status,$office,"NetAmount"); 
					$sheet .= '	<tr style = "">
										<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Actual Cost</span></td>
										<td  style = "border-top:1px solid silver;">
											<span id = "adviceNetAmount"  class = "data1" style = "font-weight:bold;font-size:22px;color:red; padding-right:25px;">' .number_format($netAmount,2)  . '</span>		
										</td>
										<td>
											<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
										</td>
								<tr>';
					$className = "hide";

					

					
				   
				}else{
					$sheet .= '	<tr>
									<td style = "padding-top:20px;width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Fund</span></td>
									<td  style = "padding-top:20px;border-bottom:1px solid silver;">
										<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;" id = "displayFund">'  .  $fund  . '</span>		
									</td>
									<td style = "padding-top:20px;">
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
									</td>
								</tr>';
				}
				
				if($trackingType != "NF"){
					if($subCode > 0 && $peorOfc != ''){ // added $peorOfc condition due to error in query where $peorOfc is empty/null - 06-10-2022
						// $sql = "select * from subprogramcode where Subcode = " . $subCode . "";
						// $record = $this->query($sql);
						// $data = $this->fetch_array($record);
						// $des = $data['Description'];
						// $className =  $this->permissionClassByField($trackingType,$status,$office,"SubProg"); 	      
						// $sheet .= '<tr>
						//    		<td style = "padding-top:20px;width:10px;text-align:right;padding-left:30px;"><span class = "data1" style = "color:black;" >Sub&nbsp;Program</span></td>
						// 		<td  style = "padding-top:20px;border-bottom:0px solid silver;border-bottom:1px solid silver;">
						// 			<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;">' . $des  . '</span>		
						// 		</td>
						// 		<td style = "padding-top:20px;">
						// 			<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
						// 		</td>
						//    <tr>';

						$sql = "SELECT * FROM peace WHERE OfficeId = '".$peorOfc."' AND Code = '".$subCode."' LIMIT 1";
						$record = $this->query($sql);
						$data = $this->fetch_array($record);
						$ofcName = $data['Name'];
						$subName = $data['Fund'];
						$des = "<span style='color:rgb(35, 116, 157);'>".$ofcName."</span> ".$subName;
						$className =  $this->permissionClassByField($trackingType,$status,$office,"SubProg"); 	      
						$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;padding-top:5px;"><span class = "data1 genDtlLabel" style = "color:black;" >Sub&nbsp;Program</span></td>
								<td  style = "border-bottom:0px solid silver;border-bottom:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;">' . $des  . '</span>		
								</td>
								<td >
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "showSubCodeSelectionEditDirect(this)">EDIT</span>
								</td>
						   <tr>';
					}   
				} 
				
				if($forDrrmo > 0) {
					$className = $this->permissionClassByField($trackingType,$status,$office,"DRRMO"); 
					$sheet .= '	<tr>
									<td style = "width:10px;text-align:right;padding-left:30px; vertical-align:top; padding-top:6px;"><span class = "data1 genDtlLabel" style = "color:black; white-space:nowrap;">DRRM Project</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span class = "data1" style = "font-weight:bold;font-size:22px;">' . $drrmo . '</span>
									</td>
									<td>
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editDRRMO(this)">EDIT</span>
									</td>
								<tr>';
				}
				
			}
			
			if($checkNumber != ''){	   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"CheckNumber"); 
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Check&nbsp;Number</span></td>
								<td  style = "border-bottom:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $checkNumber . '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			}
			if($checkDate != ''){	   	   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"CheckDate"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Check&nbsp;Date</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;font-size:16px;">' . $checkDate . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
			}

			

			$className = "hide";
			if($fund == "Trust Fun" or strtoupper($docType) == "LIQUIDATION"){ // 2023-01-25 same gihapon "Trust Fun" jud ni?
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Cash&nbsp;Advance</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span id = "caAmount"  class = "data1" style = "font-weight:bold;font-size:22px;color:red; padding-right:25px;">' .number_format($cashAdvance,2)  . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
				if($acct > 2){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"NetAmount"); 
					$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Net&nbsp;Amount</span></td>
							<td  style = "border-bottom:1px solid silver;">
								<span id = "adviceNetAmount"  class = "data1" style = "font-weight:bold;font-size:22px;color:red; padding-right:25px;">' .number_format($netAmount,2)  . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
					$className = "hide";
				}
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Spent");
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Amount spent</span></td>
							<td style = "">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;color:red;">' . number_format($spent,2) . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
				if($ORdetails != ''){
					$sheet .= '<tr>
					   		<td style = "padding-top:20px;width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Refund</span></td>
							<td  style = "padding-top:20px;border-bottom:0px solid silver;border-bottom:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;padding-right:25px;color:red;">' . number_format($refund,2)  . '</span>		
							</td>
					   <tr>';
					   
					$className =  "";
					$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >OR details</span></td>
							<td style = "">
								<span id ="orDetailsDis" class = "data1" style = "font-weight:bold;font-size:18px;color:black;">' . $ORdetails . '</span>		
							</td>
							
					   <tr>';
				}
				if($reim > 0){
					
					$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >To&nbsp;be&nbsp;reimbursed</span></td>
							<td style = "">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;color:red;">' . number_format($reim,2) . '</span>		
							</td>
							
					   <tr>';
				}	   
				
			}else{
				if($programCode == ''){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"GrossAmount");
					if($docType == 'CASH ADVANCE TO PAYMASTER' && $acct != 2){
						$className = 'hide';
					}

					$sheet .= '<tr>
									<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Gross&nbsp;Amount</span></td>
									<td style = "">
										<span  class = "data1" style = "font-weight:bold;font-size:22px;color:red;">' . number_format($amount,2) . '</span>		
									</td>
									<td>
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>
									</td>
								<tr>';

				}

				if($acct > 1 || substr($docType, 0, 5) == 'WAGES'){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"NetAmount");
					
					if($trackingType != "NF"){

						$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Net&nbsp;Amount</span></td>
								<td  style = "">
									<span id = "adviceNetAmount"  class = "data1" style = "font-weight:bold;font-size:22px;color:red; padding-right:25px;">' .number_format($netAmount,2)  . '</span>		
								</td>
								<td>';
						// if($docType == "LTO COMPUTER FEE"){ //allow edit except LTO second part , kay sa mother voucher lng mag edit
						// 	//$sheet .= '	<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>';
						// }else if($docType == "REGISTRATION - LTO"){ 
						// 	//
						// 	if($netAmount < 1){	
						// 		$className =  $this->permissionClassByField($trackingType,$status,$office,"LTO"); 
						// 		$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="button1 ' . $className . '" style = "margin-left:10px;font-size:16px;width:80px;" onclick = "editThis(this)">SPLIT&nbsp;LTO</span>';
						// 	}else{
						// 		$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>';
						// 	}	
						// }else{

							$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "float:right;margin-right:20px;font-size:12px;" onclick = "editThis(this)">EDIT</span>';

						// }

					}
					
					
					$sheet .= '		</td>
					   <tr>';
					$className = "hide";
				}
				
			}

			if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE" || $docType == "ASSISTANCE - FINANCIAL"){
				
				$sql = "SELECT * FROM particulars WHERE TrackingNumber = '".$trackingNumber."' LIMIT 1";
				$record = $this->query($sql);
				$data = $this->fetch_array($record);

				$dispDocType = "";
				
				$temp = explode(" - ", $docType);
				$genType = $temp[0];
				$spcType = $temp[1];

				$dispDocType = $spcType." ".$genType;
				if($genType == 'WAGES') {
					$dispDocType = $spcType;
					if($spcType == 'SALARY PLANTILLA') {
						$dispDocType = "salaries of officials and employees";
					}elseif(substr($spcType, 0, 10) == 'SALARY J.O') {
						$dispDocType = "services rendered of J.O/Contract of Service";
					}elseif($spcType == 'OVERTIME PAY (J.O)') {
						$dispDocType = "OVERTIME PAY of J.O/Contract of Service";
					}elseif($spcType == 'OVERTIME PAY (Plantilla)') {
						$dispDocType = "OVERTIME PAY of officials and employees";
					}elseif($spcType == 'SALARY DIFFERENTIAL') {
						$dispDocType = $spcType." of officials and employees";
					}elseif($spcType == 'BACK PAY') {
						$dispDocType = 'salaries of officials and employees';
					}
				}

				if($genType == 'ALLOWANCE') {
					if($spcType == "CELLCARD" ){
						$dispDocType = "CELLCARD EXPENSE of officials and employees";
					}elseif( $spcType == "TRAVEL"){
						$dispDocType = "TRAVELLING EXPENSE of officials and employees";
					}elseif( $spcType == "TRANSPORTATION"){
						$dispDocType = "TRANSPORTATION EXPENSE of officials and employees";
					}else {
						$dispDocType = $spcType." ".$genType;
					}
				}

				if($genType == 'BENEFITS') { 
					$dispDocType = $spcType." ".$genType." of officials and employees";

					if($docType == "BENEFITS - ELAP"){
						$dispDocType = "ELAP granted to employees of the City Government of Davao";
					}
				}



				$p = "";
				if($periodType  == 1 ){
					$p = "1-15 ";
				}else if($periodType  == 2){
					$p = "16-31 ";
				}else if($periodType  == 3){
					$p = "";
				}else{
					$p = "";
				}

				$explanation = "To payment of ".$dispDocType." for the month of ".$period." ".$p.$trackYear.", as per supporting papers hereto attached in the amount of";

				if($genType == 'ASSISTANCE') { 
					if($spcType == 'FINANCIAL') {
						$explanation = "To payment of FINANCIAL ASSISTANCE to ".trim($claimant).", as per supporting papers hereto attached in the amount of";
					}
				}

				if(strlen(trim($data['Particulars'])) > 0) {
					// $explanation = $this->charEncoder( nl2br($data['Particulars']) );
					$explanation = $data['Particulars'];
				}

				$className =  $this->permissionClassByField($trackingType,$status,$office,"WGSParticulars"); 

				$sheet .= "	<tr>
								<td style='vertical-align:top; text-align:right;'>
									<span style='padding:0px 0px 5px 5px; font-size:16px; font-family:Oswald;'>Particulars</span>
								</td>
								<td colspan='2'></td>
							</tr>
							<tr>
								<td colspan='2' style='padding-left:105px;'>
									<div id='wgsNewExplanation' style='background-color:rgba(249,252,252,1); -moz-appearance: textfield; -webkit-appearance: textfield; white-space:pre-wrap; border:1px solid silver; border-right:1px solid rgba(225,225,225,.9); border-bottom:1px solid rgba(225,225,225,.9); padding:8px 10px; font-size:14px; font-family:Oswald; max-width:1000px; text-align:justify;'>".$explanation."</div>
								</td>
								<td style='width:0px; padding:0px 0px 0px 10px; vertical-align:top;'>
									<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px; margin-right:20px;' onclick='editParticularsForThisWGS(this)'>EDIT</span>
								</td>
							</tr>";
				
			}


			$sheet .= '</table>';	   
			return $sheet;
		}
		function CreateGenDetails($complex,$checkNumber, $checkDate,$poNumber,$prNumber,$obrNumber,$className,$trackingNumber,$prTrackingNumber,$prMonth,$adv,$trackingType,$claimant,$fund,$amount,$status,$office,$netAmount,$trackingPartner,$nature,$specifics,$drrmo,$forDrrmo){
			$logOffice = $_SESSION['gso'];
			$acct = $_SESSION['accountType'];
			
			$sheet = '<table style = "">';
			$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >TN</span></td>
								<td style = "border-bottom:1px solid silver;padding-right:25px;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $trackingNumber  . '</span>		
								</td>
								<td>
								</td>
						   <tr>';

			if($claimant != ''){
				if($trackingType == "PO"){
					$tag = "Supplier"; 
				}else{
					$tag = "Claimant";
				}
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Supplier");
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >' . $tag . '</span></td>
								<td style = "border-bottom:1px solid silver;padding-right:25px;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $claimant  . '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			}
			if($trackingType == "PO"){
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Complex");	
				if($complex == 1 ){
					$complexity = "Simple Transaction";
				}else if($complex == 2 ){
					$complexity = "Complex Transaction";
				}else{
					$complexity = "Simple Transaction";
				}
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;white-space:nowrap;" >Transaction Classification</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span id = "advTrack"   class = "data1" style = "font-weight:bold;font-size:22px;color:rgb(22, 178, 217);" >' . $complexity . '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			}
			//if($adv > 0 ){
				$className =  $this->permissionClassByField($trackingType,$status,$office,"Adv");	
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >ADV&nbsp;Number</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span id = "advTrack"   class = "data1" style = "font-weight:bold;font-size:22px;" >' . $adv . '</span>		
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			//}
			if($trackingType == "PO"){
				
				if($trackingNumber != '' ){
					$sheet .= '<tr>
							   		<td style = "text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >PR&nbsp;Tracking&nbsp;Number</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span  class = "data1" style = "font-weight:bold;font-size:22px;color:red;cursor:pointer;" onclick = "searchThisPartner(this)" >' . $prTrackingNumber . '</span>		
									</td>
							   <tr>';
				}
			}

			// if($trackingPartner != ''){
			// 	$sheet .= '<tr>
			// 		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1" style = "color:black;" >Retention TN </span></td>
			// 		<td style = "border-bottom:1px solid silver;">
			// 		<span  id = "pyTrackingPartner" class = "data1" style = "font-weight:bold;font-size:22px;color:red;cursor:pointer;" onclick = "searchThisPartner(this)" >' . $trackingPartner . '</span>		
			// 		</td>
			// 		<tr>';
			// }

			if($trackingPartner != ''){

				if($trackingType == 'PX') {
					$sheet .= '	<tr>
									<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black; white-space:nowrap;" >PO Tracking Number </span></td>
									<td style = "border-bottom:1px solid silver;">
										<span  id = "pyTrackingPartner" class = "data1" style = "font-weight:bold;font-size:22px;color:red;cursor:pointer;" onclick = "searchThisPartner(this)" >' . $trackingPartner . '</span>		
									</td>
								<tr>';
				}else{
					$sheet .= '	<tr>
									<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Retention TN </span></td>
									<td style = "border-bottom:1px solid silver;">
										<span  id = "pyTrackingPartner" class = "data1" style = "font-weight:bold;font-size:22px;color:red;cursor:pointer;" onclick = "searchThisPartner(this)" >' . $trackingPartner . '</span>		
									</td>
								<tr>';
				}

			}

			if($poNumber != '' ){
				$className =  $this->permissionClassByField($trackingType,$status,$office,"PONumber");		
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >PO&nbsp;Number</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $poNumber . '</span>
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			}
			if($obrNumber >= 0 ){
				$className =  $this->permissionClassByField($trackingType,$status,$office,"OBRNumber");
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">OBR&nbsp;Number</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span id  = "prOBRNumber"class = "data1" style = "font-weight:bold;font-size:22px;">' . $obrNumber . '</span>
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			}
			if($trackingType == "PR"){
				//if($prNumber != '' ){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"PRNumber");
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >PR&nbsp;Number</span></td>
									<td style = "border-bottom:1px solid silver;">
										<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $prNumber . '</span>
									</td>
									<td >
										<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
									</td>
							   <tr>';
				//}
			} 	
			$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">PR&nbsp;Sched</span></td>
							<td style = "border-bottom:1px solid silver;">
								<span id  = "prOBRNumber"class = "data1" style = "font-weight:bold;font-size:22px;">' . 	$this->numberToQuarter($prMonth) . '</span>
							</td>
					   <tr>';
					   
			$className =  $this->permissionClassByField($trackingType,$status,$office,"Fund");
			$sheet .= '<tr >
					   		<td style = "padding-top:20px;width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">Fund</span></td>
							<td style = "padding-top:20px;padding-right:15px;">
								<span id  = "prFundr" class = "data1" style = "font-weight:bold;font-size:22px;">' . 	$fund . '</span>
							</td>
							<td style = " padding-top:20px;">
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';

			if($nature != ''){	   
				$className = $this->permissionClassByField($trackingType,$status,$office,"NatureOfPayment"); 
				$sheet .= '<tr>
								<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black; word-space:nowrap;" >Nature of Payment</span></td>
								<td  style = " border-top:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $nature . '</span>		
								</td>
								<td >
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
							<tr>';
			}	

			if($specifics != ''){	   
				$className = $this->permissionClassByField($trackingType,$status,$office,"Specifics"); 
				$sheet .= '<tr>
								<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Specifics</span></td>
								<td  style = " border-top:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $specifics . '</span>		
								</td>
								<td></td>
							<tr>';
			}

			if($checkNumber != ''){	   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"CheckNumber"); 
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Check&nbsp;Number</span></td>
								<td  style = " border-top:1px solid silver;">
									<span  class = "data1" style = "font-weight:bold;font-size:22px;">' . $checkNumber . '</span>		
								</td>
								<td >
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
			}
			if($checkDate != ''){	   	   
				$className =  $this->permissionClassByField($trackingType,$status,$office,"CheckDate"); 
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black;" >Check&nbsp;Date</span></td>
							<td  style = "border-top:1px solid silver;">
								<span  class = "data1" style = "font-weight:bold;font-size:22px;font-size:16px;">' . $checkDate . '</span>		
							</td>
							<td>
								<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;" onclick = "editThis(this)">EDIT</span>
							</td>
					   <tr>';
			}
			if($trackingType == "PO"){
				if($acct > 2){
					$className =  $this->permissionClassByField($trackingType,$status,$office,"NetAmount"); 	
					$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;padding-left:30px;"><span class = "data1 genDtlLabel" style = "color:black">Net&nbsp;Amount</span></td>
								<td style = "border-top:1px solid silver;">
									<span id  = "adviceNetAmount"class = "data1" style = "font-weight:bold;font-size:22px;color:red;">' .  	number_format($netAmount,2) . '</span>
								</td>
								<td style = "">
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;" onclick = "editThis(this)">EDIT</span>
								</td>
						   <tr>';
				}
			}
			if($trackingType == "PR"){ //---------------------------------------------------------------------------------------------------------------------------------------------------------------Supplier
				$sql = 'Select * from vouchercurrent where PR_TrackingNumber = "' .  $trackingNumber  . '" group by trackingnumber';
				$result = $this->query($sql);
				$poTN = '';
				
				if($this->num_rows($result) >= 1){
					while($data = $this->fetch_array($result)){
						$tp = $data['TrackingNumber'];
						$poTN .=  '<span class = "data1" style = "cursor:pointer;display:block;  font-weight:bold;font-size:22px;color:red;" onclick = "searchThisPartner(this)" >' .  $tp . '</span>';
					}
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;padding-top:8px;"><span class = "data1 genDtlLabel" style = "color:black">PO&nbsp;Tracking&nbsp;Number</span></td>
									<td style = "border-top:1px solid silver;">
										' .  $poTN . '
									</td>
							   <tr>';
				}
				
			}

			if($forDrrmo > 0) {
				$className = $this->permissionClassByField($trackingType,$status,$office,"DRRMO"); 
				$sheet .= '	<tr>
									<td style = "width:10px;text-align:right;padding-left:30px; vertical-align:top; padding-top:6px;"><span class = "data1 genDtlLabel" style = "color:black; white-space:nowrap;">DRRM Project</span></td>
								<td style = "border-bottom:1px solid silver;">
									<span class = "data1" style = "font-weight:bold;font-size:22px;">' . $drrmo . '</span>
								</td>
								<td>
									<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" style = "font-size:12px;"  onclick = "editDRRMO(this)">EDIT</span>
								</td>
							<tr>';
			}

			
			
			// if($trackingType == "PO"){ //---------------------------------------------------------------------------------------------------------------------------------------------------------------Supplier
			// 	$sql = 'Select * from vouchercurrent where TrackingPartner = "' .  $trackingNumber  . '" group by trackingnumber';
			// 	$result = $this->query($sql);
			// 	$poTN = '';
				
			// 	if($this->num_rows($result) >= 1){
			// 		while($data = $this->fetch_array($result)){
			// 			$tp = $data['TrackingNumber'];
			// 			$poTN .=  '<span class = "data1" style = "cursor:pointer;display:block;  font-weight:bold;font-size:22px;color:red;" onclick = "searchThisPartner(this)" >' .  $tp . '</span>';
			// 		}
			// 		$sheet .= '<tr>
			// 				   		<td style = "width:10px;text-align:right;padding-left:30px;vertical-align:top;padding-top:8px;"><span class = "data1"  style = "color:black">PX&nbsp;Tracking&nbsp;Number</span></td>
			// 						<td style = "border-top:1px solid silver;">
			// 							' .  $poTN . '
			// 						</td>
			// 				   <tr>';
			// 	}
				
			// }

			$sheet .= '</table>';



			return $sheet;
		}
    		

        function CreateDoctrackInfo($record){
			$className = 'invi';
			$sign = ' - ';
			$data = $this->fetch_array($record);
			$docType = $data['TrackingType'];
			$trackingNumber = $data['TrackingNumber'];
			$status = $data['Status'];
			
			$year = $data['Year'];
			$office = $data['Office'];
			if($status == "Encoded" or $status == "Pending at CBO"){
				if($office == $_SESSION['officeCode']){
					$className = 'label19';
				}
			}
			if( $_SESSION['accountType'] >= 2 and $_SESSION['officeCode'] == '1071' or $_SESSION['accountType'] == 7){
				$className = 'label19';
			}
			
			if($_SESSION['accountType'] >= 2 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7 or $_SESSION['accountType'] == 5){
				$className = 'label19';
			}
			
			$officeName = $data['OfficeName'];	
			$fund = $data['Fund'];
				
				$advField = '';
				if($data['ADV2'] != 0){
					$advNumber= $data['ADV2'];
					$advField = 'ADV2'; 	
				}else{
					$advNumber= $data['ADV1'];
					$advField = 'ADV1'; 	
				}	
				
				$trackingPartner = $data['TrackingPartner'];
				$prNumber = $data['PR_Number'];
				$poNumber = $data['PO_Number'];
				$obrNumber = $data['OBR_Number'];
				$ctrlNumber = $data['ControlNo'];
				$prTrackingNumber = $data['PR_TrackingNumber'];
				
				$pendingNote =  $data['Remarks'];
				$claimant = $data['Claimant'];
				$claimType  = $data['ClaimType'];
				
				$transactionType  = $data['TransactionType'];
				$periodType = $data['PeriodType'];
				$periodValue = $data['PeriodMonth'];
				$period = $periodType . ' - ' . $periodValue;
				$claimType  = $data['ClaimType'];
				
				$programCode = $data['PR_ProgramCode'];
				$accountCode = $data['PR_AccountCode'];
				$title = $data['Title'];
				$program = $data['Program'];
				$chargeType = $data['ChargeType'];
				if($chargeType == 3){
					
					$programCode = '';
					$program = 'Multiple';
					$sign = '';
				}
				
				$ppmpCategoryCode = $data['PR_CategoryCode'];
				$ppmpCategoryName = $data['CategoryName'];
				$prMonth = $data['PR_Month'];
				$payrollAmountFirst = $data['PayrollAmountFirst'];
				
				
				
				if($docType == "PO"){
					if($chargeType == 2 || $chargeType == 3){
						$amount = $data['TotalAmountMultiple'];
					}else{
						$amount = $data['PO_Amount'];
					}
				}else{
					if($chargeType == 2 || $chargeType == 3){
						$amount = $data['TotalAmountMultiple'];
						if($docType == "PY"){
							$accountCode = 'Multiple';
						}
					}else{
						$amount = $data['Amount'];
					}	
				}
				
				
				if($payrollAmountFirst != 0){
					$amount = $payrollAmountFirst;
				}
				
				$encodedBy = $data['FirstName'] . ' ' . $data['MiddleName'] . ' ' . $data['LastName'] ;
				$dateEncoded = $data['DateEncoded'];
				$dateUpdated = $data['DateModified'];
				$completion = $data['Completion'];
				
				$sheet = '<table class = "doctrackUpdateTable" border ="0" >';
				$sheet .= '<tr style = "background-color:rgb(245, 246, 246);background-color:rgb(23, 207, 253);">
						   		<td width="1" style = "text-align:right;padding:15px 0px" ><span class = "label7" style = "color:white;">Status</span></td>
								<td style = "padding:15px 0px;">
								<span id = "labelStatus" style = "text-shadow:0px 0px 10px white;color:rgb(42, 122, 172);font-weight:bold;color:white;font-size:34px;" class = "label6">' . $status . '</span>
								<span style = "color:black;padding-left:5px;" >' . $this->ezDate1($dateUpdated) . '</span></td>
						   <tr>';
						   
				if($status == "PR Encoded"){
					if($_SESSION['accountType'] == '2' && $_SESSION['gso'] == '1061'){
						
							
						$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
						$sheet .= '<tr>
								   		<td style = "padding:10px 0px;width:10px;text-align:right;"><span style ="color:black" class  = "label7">Type PR&nbsp;#</span></td>
										<td style = "padding:10px 0px;"><input id = "inputNumber" maxlength = "10" class ="text3" value = "' . $prNumber . '" /></td>
								   <tr>';
					}
				}else if($status == "Pending at GSO"){
					
					
					
					
				}else if($status == "PR - GSO Received"){
					if($_SESSION['accountType'] == '2' && $_SESSION['cbo'] == '1071'){
						$sheet .= '<tr>
								   		<td style = "padding:10px 0px;width:10px;text-align:right;"><span style ="color:black" class  = "label7">Type OBR&nbsp;#</span></td>
										<td style = "padding:10px 0px;"><input id = "inputNumber" maxlength = "10" class ="text3" /></td>
								   <tr>';
					}		   
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">PR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $prNumber . '</span>';
									
									if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071' or  $_SESSION['accountType'] == 2 && $_SESSION['gso'] == '1061' or $_SESSION['accountType'] == 7){
										$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
									}
									
									
					$sheet .= '</td><tr>';
				}else if($status == "PO Encoded"){
					if($_SESSION['accountType'] == '2' && $_SESSION['gso'] == '1061'){
						$sheet .= '<tr>
								   		<td style = "padding:10px 0px;width:10px;text-align:right;"><span style ="color:black" class  = "label7">Type PO&nbsp;#</span></td>
										<td style = "padding:10px 0px;"><input id = "inputNumber" maxlength = "10" class ="text3" /></td>
								   <tr>';
					}		   
					$sheet .= '<tr>
						   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">PR Tracking&nbsp;#</span></td>
								<td style = "padding-top:15px;"><span class = "label6">' . $prTrackingNumber . '</span></td>
						   <tr>';
					   
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">PR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $prNumber . '</span></td>
							   <tr>';
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
				}else if($status == "PO - GSO Received"){
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">PR Tracking&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $prTrackingNumber . '</span></td>
							   <tr>';
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">PO&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $poNumber . '</span></td>
							   <tr>';
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">PR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $prNumber . '</span></td>
							   <tr>';
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
				}else if($status == "Encoded" && $fund  == 'General Fund' or $status == "Encoded" && $fund  == 'SEF' or $status == "PR Pending Returned" && $fund  == 'General Fund' ){
					if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071' ){
						
						$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					
						$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding:10px 0px;"><input id = "inputNumber"   maxlength = "10" class ="text3" value = "' . $obrNumber .  '" /></td>
							   <tr>';
					
					}else{
						if($obrNumber != ''){
						$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
						
							$sheet .= '<tr>
								   		<td style = "padding-top:10px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
										<td style = "padding-top:10px;"><span class = "label6">' . $obrNumber . '</span></td>
								   <tr>';
						}
					}
					
					
				}else if($status == "Pending at CBO"){
					
					if($_SESSION['accountType'] == 2 && $_SESSION['officeCode'] == '1071'){
						if(strlen($obrNumber) == 0){
							$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding:10px 0px;"><input id = "inputNumber" maxlength = "10" class ="text3" /></td>
							   <tr>';
						}else{
							$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
						}
					}else{
						if(strlen($obrNumber) != 0){
							$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
						}
					}
					
					
				}else if($status == "CBO Received"){
					$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					$sheet .= '<tr>
							   		<td style = "padding-top:15px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:15px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
					
				}else if($status == "CAO Received"){
					
					if($_SESSION['accountType'] == 4 && $_SESSION['officeCode'] == '1081'){
						$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
					
						$sheet .= '<tr>
								   		<td style = "padding-top:10px;width:10px;text-align:right;"><span class = "label7">ADV&nbsp;#</span></td>
										<td style = "padding:10px 0px;"><input id = "inputNumber" maxlength = "10" class ="text3" />
										<div id = "button' . $trackingNumber .'" class = "button1" style = "margin-left:200px;display:inline-block;width:auto;" onclick = "updateTracking(this)">Process</div>
										</td>
								   <tr>';
					}
					$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
					$sheet .= '<tr>
							   		<td style = "padding-top:5px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:5px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
					if($trackingPartner != ''){
						$sheet .= '<tr>
							   		<td style = "padding-top:0px;width:10px;text-align:right;"><span class = "label7" >Tracking&nbsp;Partner</span></td>
									<td style = "padding-top:0px;"><span class = "label6" style = "color:red;font-weight:bold;">' . $trackingPartner . '</span></td>
							   <tr>';
					}
					
				}else if($status == "Pending at CAO"){
					$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';   
					$sheet .= '<tr>
							   		<td style = "padding-top:5px;width:10px;text-align:right;"><span class = "label7">ADV&nbsp;#</span></td>
									<td style = "padding-top:5px;">
									<span class = "label6" style = "">' . $advNumber . '</span>';
									
					if($_SESSION['accountType'] == 6 && $_SESSION['officeCode'] == '1081'){				
						$sheet .= '		<div id = "' . $status . '~' . $trackingNumber .'" class = "button1" style = "margin-left:250px;width:auto;display:inline-block;" onclick = "updateTracking1(this)">Release Pending</div></td>';
					}
					
					$sheet .= '		   <tr>';
					$sheet .= '<tr>
							   		<td style = "padding-top:5px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
									<td style = "padding-top:5px;"><span class = "label6">' . $obrNumber . '</span></td>
							   <tr>';
				
				}else if($status == "Pending Returned"){
						
							$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
						
							$sheet .= '<tr>
									   		<td style = "width:5px;text-align:right;"><span class = "label7">ADV&nbsp;#</span></td>
											<td style = ""><span class = "label6" style = "">' . $advNumber . '</span>';
											if($_SESSION['accountType'] == 2 && $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7){
												$sheet .= '<span id = "editor' . $trackingNumber . '*' . $advField . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
											}
											if($_SESSION['accountType'] == 4 && $_SESSION['officeCode'] == '1081'){				
												$sheet .= '		<div id = "' . $status . '~' . $trackingNumber .'" class = "button1" style = "margin-left:250px;width:auto;display:inline-block;" onclick = "updateTracking1(this)">Reprocess</div></td>';
											}
											
							$sheet .= '</td></tr>';
						
						$sheet .= '<tr>
								   		<td style = "padding-top:5px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
										<td style = "padding-top:5px;"><span class = "label6">' . $obrNumber . '</span></td>
								   <tr>';
				
				}else if($status == "CAO Released"){
						
							$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
						
							$sheet .= '<tr>
									   		<td style = "width:5px;text-align:right;"><span class = "label7">ADV&nbsp;#</span></td>
											<td style = ""><span class = "label6" style = "">' . $advNumber . '</span>';
							if($_SESSION['accountType'] == 2 && $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7){
								$sheet .= '<span id = "editor' . $trackingNumber . '*' . $advField . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
							}				
							$sheet .= '</td></tr>';
						
							$sheet .= '<tr>
									   		<td style = "padding-top:5px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
											<td style = "padding-top:5px;"><span class = "label6">' . $obrNumber . '</span></td>
									   <tr>';
							$sheet .= '<tr>
									   		<td style = "padding-top:5px;width:10px;text-align:right;"><span class = "label7">Ctrl&nbsp;#</span></td>
											<td style = "padding-top:5px;"><span class = "label6">' . $ctrlNumber . '</span></td>
									   <tr>';
							if($trackingPartner != ''){
								$sheet .= '<tr>
									   		<td style = "padding-top:0px;width:10px;text-align:right;"><span class = "label7">Tracking&nbsp;Partner</span></td>
											<td style = "padding-top:0px;"><span class = "label6" style = "color:red;font-weight:bold;">' . $trackingPartner . '</span></td>
									   <tr>';
							}
				
				}else {
					
					if($docType == "PR"){   
						$sheet .= '<tr>
								   		<td style = "padding-top:10px;width:10px;text-align:right;"><span class = "label7">PR&nbsp;#</span></td>
										<td style = "padding-top:10px;"><span class = "label6">' . $prNumber . '</span>';
										
										if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071' or  $_SESSION['accountType'] == 2 && $_SESSION['gso'] == '1061' or $_SESSION['accountType'] == 7){
											$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
										}
										
										
						$sheet .= '</td>
								   <tr>';
						$sheet .= '<tr>
								   		<td style = "padding-top:10px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
										<td style = "padding-top:10px;"><span class = "label6">' . $obrNumber . '</span></td>
								   <tr>';
					}else if($docType == "PY" or $docType == "PO"){
						$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';
						if($trackingPartner != ''){
							$sheet .= '<tr>
								   		<td style = "padding-top:0px;width:10px;text-align:right;"><span class = "label7">Tracking&nbsp;Partner</span></td>
										<td style = "padding-top:0px;"><span class = "label6">' . $trackingPartner . '</span></td>
								   <tr>';
						}
						if($advNumber != 0){
							$sheet .= '<tr>
								   		<td style = "padding-top:0px;width:10px;text-align:right;"><span class = "label7">ADV&nbsp;#</span></td>
										<td style = "padding-top:0px;"><span class = "label6">' . $advNumber . '</span>';
										
							if($_SESSION['accountType'] >= 2 && $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7){
								$sheet .= '<span id = "editor' . $trackingNumber . '*' . $advField . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
							}
							$sheet .= '</td><tr>';
								   		   
						}
						
						if($obrNumber != ''){
							$sheet .= '<tr>
								   		<td style = "padding-top:0px;width:10px;text-align:right;"><span class = "label7">OBR&nbsp;#</span></td>
										<td style = "padding-top:0px;"><span class = "label6">' . $obrNumber . '</span></td>
								   <tr>';
						}		   
					}
				}
				
				$sheet .= '<tr><td colspan = "2" style = "padding:5px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
				
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Office</span></td>
								<td style = ""><span class = "label6">' . $officeName . '</span></td>
						   <tr>';
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Fund</span></td>
								<td style = ""><span class = "label6">' . $fund . '</span>';
								
				if($docType == "PY"){
					
						$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
					
				}
								
				
				$sheet .= '	</td><tr>';
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Program&nbsp;Code</span></td>
								<td style = ""><span class = "label6">' . $programCode . $sign . $program . '</span></td>
						   <tr>';
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Account&nbsp;Code</span></td>
								<td style = ""><span class = "label6">' . $accountCode . '</span></td>
						   <tr>';
				
				$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
				
				if($docType =="PR"){
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;"><span class = "label7">Category</span></td>
									<td style = ""><span class = "label6">' . $ppmpCategoryCode . $sign . $ppmpCategoryName . '</span></td>
							   <tr>';   
					$sheet .= '<tr>
									<td style = "width:10px;text-align:right;"><span class = "label7">Amount</span></td>
									<td style = ""><span id = "trackingAmount" style = "font-weight:bold;color:rgb(47, 141, 196);" class = "label6">' . number_format($amount,2) . '</span>
									<span id = "' . $year . '~' . $office . '~' . $ppmpCategoryCode . '~' . $prMonth .  '~'  . $docType .  '~'  . $trackingNumber .  '~' . $programCode  . '" style = "" class ="label8" onclick = "showPPMPdetails(this)">view details</span>';
									if($fund == 'General Fund'){
										$sheet .= '				<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' . $claimant . '&officeName=' . $officeName . '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview obr</span></a>';
									}
					
					$data = urlencode($year . '~' . $office . '~' . $officeName . '~' . $ppmpCategoryCode .'~' . $prMonth . '~' . $ppmpCategoryName . '~' . $trackingNumber );				
					$sheet .= '		<a href = "../interface/formPR.php?data=' . $data .  '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview pr</span></a>';
									
					$sheet .= '</td>
							   <tr>';
				}else if($docType =="PO"){
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;"><span class = "label7">Claimant</span></td>
									<td style = "font-weight:bold;"><span class = "label6">' . $claimant . '</span></td>
							   <tr>';   
					$sheet .= '<tr>
									<td style = "width:10px;text-align:right;"><span class = "label7">Amount</span></td>
									<td style = ""><span id = "trackingAmount" style = "font-weight:bold;color:rgb(47, 141, 196);" class = "label6">' . number_format($amount,2) . '</span>
									<span id = "' . $year . '~' . $office . '~' . $ppmpCategoryCode . '~' . $prMonth .  '~'  . $docType .  '~'  . $trackingNumber .  '" style = "" class ="label8" onclick = "showPPMPdetails(this)">view details</span>
							              <a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview DV</span></a></td>
						
							   <tr>';
							   
				}else if($docType =="PY"){
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;"><span class = "label7">Transaction&nbsp;Type</span></td>
									<td style = ""><span class = "label6">' . $transactionType . '</span>';
					if($_SESSION['accountType'] >= 2 && $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7){
						$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span>';
					}			
									
					$sheet .= '		</td>
							   <tr>';
					if($transactionType == "Payroll"){
							$sheet .= '<tr>
									   		<td style = "width:10px;text-align:right;"><span class = "label7">Period</span></td>
											<td style = ""><span class = "label6">' . $period . '</span></td>
									   <tr>';
					}
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;"><span class = "label7">Claim&nbsp;Type</span></td>
									<td style = ""><span class = "label6">' . $claimType . '</span><span class = "label"></span></td>
							   <tr>';     
					$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
				
					$sheet .= '<tr>
							   		<td style = "width:10px;text-align:right;"><span class = "label7">Claimant</span></td>
									<td style = "font-weight:bold;"><span class = "label6">' . $claimant . '</span><span id = "editor' . $trackingNumber . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span></td>
							   <tr>';
					     
					$sheet .= '<tr>
									<td style = "width:10px;text-align:right;"><span class = "label7">Amount</span></td>
									<td style = ""><span id = "trackingAmount" style = "font-weight:bold;color:rgb(47, 141, 196);" class = "label6">' . number_format($amount,2) . '</span>';
									
					if($fund == 'General Fund' or $fund == 'SEF'){
						$sheet .= '			<a href = "../interface/formOBR.php?trackingNumber=' . $trackingNumber . '&payee=' . $claimant . '&officeName=' . $officeName . '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview OBR</span></a>';
					}
					$sheet .= '				<a href = "../interface/formDV.php?trackingNumber=' . $trackingNumber . '" target="_blank" style = "text-decoration:none;"><span class = "label8">preview DV</span></a>';
					
					$sheet .= '<span id = "editor' . $trackingNumber . '"  class ="' . $className . '" onclick = "editThis(this)">EDIT</span></td><tr>';
				}
						   
				if($docType != 'PY'){
					$sheet .= '<tr>
						   		<td id = "ppmpDetails" style = "text-align:center;background-color:rgba(238, 244, 247,.8);padding:5px 10px;" colspan = "2"></td>
						   <tr>';
				}		   
				
				
				if(strlen($pendingNote) > 0){
					$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(243, 247, 249);"/></td></tr>';		   
					$sheet .= '<tr>
							   		<td style = "vertical-align:top;width:10px;text-align:right;"><span class = "label7">Note</span></td>
									<td style = ""><span style = "white-space: pre-line;word-wrap: break-word;" class = "label3" id = "oldPending">' . $pendingNote . '</span></td>
							   <tr>';
				}
						   
				$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(243, 247, 249);"/></td></tr>';		   
				
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Encoded By</span></td>
								<td style = ""><span style = "" class = "label3">' . $encodedBy . '</span></td>
						   <tr>';
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Date Encoded</span></td>
								<td style = ""><span id = "trackingEncoded" style = "" class = "label3">' . $dateEncoded . '</span></td>
						   <tr>';
				$sheet .= '<tr>
						   		<td style = "width:10px;text-align:right;"><span class = "label7">Date Updated</span></td>
								<td style = ""><span id = "trackingModified" style = "" class = "label3">' . $dateUpdated . '</span></td>
						   <tr>';
				if(strlen($completion)> 0){
				$sheet .= '<tr>
					   		<td style = "width:10px;text-align:right;"><span class = "label7">Processed&nbsp;Time</span></td>
							<td style = ""><span id = "trackingModified" style = "" class = "label3">' . $completion  . '</span></td>
					   <tr>';
				}		   
				
				$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';		   
				
				//buttons
				if($status == "PR Encoded"){
					if($_SESSION['accountType'] == 2 && $_SESSION['gso'] == '1061'){
						$sheet .= '<tr>
							   		 <td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
										 <div style = "display:none1;">	
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "updateTracking(this)">Receive</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>
										 </div>
										 <div style = "display:none;" class = "pendingContainer">	
										 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;"">&#9679; Write pending reason</span>
										 	<textarea class = "textarea1" id = "pendingNote">
											</textarea>
											 <br/><br/>	
											 <span id = "gsoPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									 </td>
								   </tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
					
					
				}else if($status == "Pending at GSO"){
					
					if($_SESSION['accountType'] == 2 && $_SESSION['gso'] == '1061'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									<span id = "' . $status . '~' . $trackingNumber .'" class = "button1" onclick = "updateTracking1(this)">Release Pending</span></td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
						
				}else if($status == "PR - GSO Received" or $status == "PR Pending Returned"){
					if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									<span id = "button' . $trackingNumber .'" class = "button1" onclick = "updateTracking(this)">Receive</span></td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}else if($_SESSION['accountType'] == 2 && $_SESSION['gso'] == '1061'){
						if($status == "PR - GSO Received"){
							$sheet .= '<tr>
								   		 <td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
											 <div style = "display:none1;">	
												 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>
											 </div>
											 <div style = "display:none;" class = "pendingContainer">	
											 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;"">&#9679; Write pending reason</span>
											 	<textarea class = "textarea1" id = "pendingNote">
												</textarea>
												 <br/><br/>	
												 <span id = "gsoPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
												 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
											 </div>
										 </td>
									   </tr>';
							$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
						}
					}
				}else if($status == "PR - CBO Received"){
					
					
					
					if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071'){
						$sheet .= '<tr>
							   		 <td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
										 <div style = "display:none1;">	
											<span id = "button' . $trackingNumber .'" class = "button1" onclick = "updateTracking(this)">Release</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>
										 </div>
										 
										 <div style = "display:none;" class = "pendingContainer">	
										 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;"">&#9679; Write pending reason</span>
										 	<textarea class = "textarea1" id = "pendingNote">
											</textarea>
											 <br/><br/>	
											 <span id = "budgetPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									 </td>
								   </tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
					
				}else if($status == "PO Encoded"){
					if($_SESSION['accountType'] == '2' && $_SESSION['gso'] == '1061'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									<span id = "button' . $trackingNumber  .'" class = "button1" onclick = "updateTracking(this)">Save</span></td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
				}else if($status == "Encoded" && $fund  == 'General Fund' or $status == "Encoded" && $fund  == 'SEF' ){
					if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071'){
						$sheet .= '<tr>
							   		 <td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
										 <div style = "display:none1;">	
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "updateTracking(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>
										 </div>
										 <div style = "display:none;" class = "pendingContainer">	
										 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;"">&#9679; Write pending reason</span>
										 	<textarea class = "textarea1" id = "pendingNote">
											</textarea>
											 <br/><br/>	
											 <span id = "budgetPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									 </td>
								   </tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
				}else if($status == "Pending at CBO"){
					if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									<span id = "' . $status . '~' . $trackingNumber .'" class = "button1" onclick = "updateTracking1(this)">Release Pending</span></td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
				}else if($status == "CBO Received"){
					if($_SESSION['accountType'] == 2 && $_SESSION['cbo'] == '1071'){
						$sheet .= '<tr>
							   		 <td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
										 <div style = "display:none1;">	
											 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>
										 </div>
										 <div style = "display:none;" class = "pendingContainer">	
										 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;"">&#9679; Write pending reason</span>
										 	<textarea class = "textarea1" id = "pendingNote">
											</textarea>
											 <br/><br/>	
											 <span id = "budgetPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									 </td>
								   </tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
				}else if($status == "CAO on Process"){
					if($_SESSION['accountType'] == 4 && $_SESSION['officeCode'] == '1081'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									 	 <div style = "display:none1;">	
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "viewSLP(this)">SLP</span>
										 </div>
									</td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}else if($_SESSION['accountType'] == 6 && $_SESSION['officeCode'] == '1081'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									 	 <div style = "display:none1;">	
											 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>';
						
						if(strtoupper($claimType) == 'LIQUIDATION'){
							$sheet .= '			 <span id = "buttonPending' . $trackingNumber .'" style = "margin-left:20px;" class = "button1" onclick = "updateTracking(this)">Release</span>';
						}				
						
											 
						$sheet .= '		 </div>
										 <div style = "display:none;" class = "pendingContainer">	
										 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;">&#9679; Write pending reason</span>
										 	<textarea class = "textarea1" id = "pendingNote">
											</textarea>
											 <br/><br/>	
											 <span id = "caoPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									</td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}else if($_SESSION['accountType'] == 5 && $_SESSION['officeCode'] == '1081'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									 	 <div style = "display:none1;">	
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "viewControl(this)">Release</span>
										 </div>
										 <div style = "display:none;" class = "pendingContainer">	
										 	
											 <span id = "control' . $trackingNumber .'" class = "button1" onclick = "saveControl(this)">Save Control<div class = "" id ="divCtrl">101</div></span>
											 &nbsp;&nbsp;&nbsp;&nbsp;
											 &nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "skipAndSave' . $trackingNumber .'" class = "button1" onclick = "skipAndSave(this)">Skip & Save</span>
											  &nbsp;&nbsp;&nbsp;&nbsp;
											 &nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									</td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
				}else if($status == "CAO Received"){
					if($_SESSION['accountType'] == 5 && $_SESSION['officeCode'] == '1081'){
						$sheet .= '<tr>
							   		<td style = "padding:15px 0px;padding-top:10px;width:10px;text-align:center;" colspan = "2">
									 	 <div style = "display:none1;">	
											 <span id = "buttonPending' . $trackingNumber .'" class = "button1" onclick = "pendingThis(this)">Pending</span>
										 </div>
										 <div style = "display:none;" class = "pendingContainer">	
										 	<span class = "label6" style ="color:red;float:left;padding-bottom:10px;">&#9679; Write pending reason</span>
										 	<textarea class = "textarea1" id = "pendingNote">
											</textarea>
											 <br/><br/>	
											 <span id = "caoPending' . $trackingNumber .'" class = "button1" onclick = "savePending(this)">Save</span>&nbsp;&nbsp;&nbsp;&nbsp;
											 <span id = "button' . $trackingNumber .'" class = "button1" onclick = "cancelPending(this)">Cancel</span>
										 </div>
									</td>
								<tr>';
						$sheet .= '<tr><td colspan = "2" style = "padding:10px;"><hr style = "border:0;border-top:1px solid rgb(245, 246, 246);"/></td></tr>';	
					}
				}				
				$sheet .= '</table>';
				return $sheet;
				
		}
		
		function CreateEditorOBR($record){
			$sheet = '<table  border = "0" id = "editorTableOBR">';
			$sheet .= '<tr><td colspan = "2">Change only the incorrect value.</td></tr>';
			
			$sheet .= '<tr><td class ="tdHeader1" style="padding:7px 10px;text-align:center;">Account Code</td>
						   <td class ="tdHeader1" style = "padding:7px 10px;text-align:center;padding:5px;">Amount</td>
						   </tr>';
			while($data = $this->fetch_array($record)){
					$id = $data['Id'] .'~' . $data['TrackingNumber'] ;
					$obr = $data['PR_AccountCode'];
					$amount = $data['Amount'];
					$sheet .= '<tr id = "' . $id . '">';
					$sheet .= '<td style = "text-align:center;padding:2px;"><input class = "text2" style = "width:100px;text-align:center;" maxlength="12" value = "' . $obr . '"/></td> 
							   <td style = "text-align:center;padding:2px;"><input class = "text2" style = "width:150px;padding-right:10px;" value = "' . $amount . '"  onkeydown="return isAmount(this,event)" maxlength="15"/></td></tr>';
			}
			$sheet .= '<tr><td colspan = "2" style = "text-align:center;padding-top:20px;"><span class = "button1"  onclick = "saveEditOBR()" >Save</span></td></tr>';		
			$sheet .= '</table>';
			return $sheet;
		}
		
		
		//------------------------------------------------------------------------------approriation status
		function CreateAppropriationStatus($record){
			$count = $this->num_rows($record);
			if($count > 0){
				$header = '';
				$footer = '';
				$fundTotalBalance = 0;
				$paidAmountTotal = 0;
				$obrAmountTotal = 0;
				$abTotal = 0;
				
				$savingsTotal = 0;
				$expenseTotal = 0;
				
				$prTotal = 0;
				
				
				$gTotalAB = 0;
				$gTotalOBR = 0;
				$gTotalBalance = 0;
				$gTotalPO = 0;
				$gTotalPR = 0;
				
				$gTotalExpense = 0;
				$gTotalSavings = 0;
				
				$sheet = '<table style = "width:100%;padding:10px 15px;border-spacing:3;" border = "0">';
				
				while($data = $this->fetch_array($record)){
					$office = $data['OfficeCode'];
					$program = $data['ProgramCode'];
					$name = $data['Name'];
					$fundName = $data['FundName'];
					$ab = $data['AB'];
					$prAmount = $data['PRAmount'];
					$obrTotal = $data['OBRTotal'] - $prAmount;
					$paidAmount = $data['PaidAmount'];
					
					
					
					$balance = $ab - ($obrTotal + $paidAmount);
					$savings = ($prAmount - $paidAmount);
					$expense = ($obrTotal + $paidAmount);
					
					if($header != $program ){
						if($footer == 1 ){
							$sheet .= '<tr>';
							$sheet .= '<td ></td>';
							$sheet .= '<td style = "text-align:right;padding-right:5px;">&nbsp;</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($abTotal) . '</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($obrAmountTotal) . '</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($prTotal) . '</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($paidAmountTotal) . '</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($expenseTotal) . '</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($savingsTotal) . '</td>';
							$sheet .= '<td class = "label11">' . $this->toNumberFormat($fundTotalBalance) . '</td>';
							$sheet .= '</tr>';
							
							$abTotal = 0; 
							$obrAmountTotal = 0;
							$paidAmountTotal = 	0;
							$fundTotalBalance = 0;	
							$savingsTotal = 0;	
							$expenseTotal = 0;	
							$prTotal = 0;		
							$footer = 0; 
							
						}
						
						$sheet .= '<tr style = "background-color:rgba(74, 93, 106,.8);">';
						$sheet .= '<td colspan = "9" style = "padding:12px;text-shadow:0px 0px 2px black;font-weight:bold;">
						           <span class = "label3" style = "color:white;"><font size = "5px">' . $program . '</font> ' . $name .  '</span></td>';
						$sheet .= '</tr>';
						
						$sheet .= '<tr>';
						$sheet .= '<td style = "border-right:1px solid white;"></td>';
						$sheet .= '<td style = "text-align:right;" class = "tdHeader4">Fund</td>';
						$sheet .= '<td style = "text-align:right;" class = "tdHeader4">Annual&nbsp;Budget</td>';
						$sheet .= '<td style = "text-align:right;width:90px;" class = "tdHeader4">OBR&nbsp;Total</td>';
						$sheet .= '<td style = "text-align:center;width:90px;" class = "tdHeader4">PR&nbsp;Total</td>';
						$sheet .= '<td style = "text-align:center;width:90px;" class = "tdHeader4">PO&nbsp;Total</td>';
						
						
						$sheet .= '<td style = "text-align:center;padding:5px 0px;width:115px;" class = "tdHeader4">Expense<div style = "font-weight:normal;">(OBR&nbsp;+&nbsp;PO)</div></td>';
						
						$sheet .= '<td style = "text-align:center;padding:5px 0px;width:115px;" class = "tdHeader4">PR&nbsp;Balance<div style = "font-weight:normal;">(PR - PO)</div></td>';
						
						$sheet .= '<td style = "text-align:center;padding:5px 0px;" class = "tdHeader4">Balance <div style = "font-weight:normal;">AB - (OBR + PO)</div></td>';
						$sheet .= '</tr>';
						
						$header = $program;
						$footer = 1;
					}
					
				
					
					$fundTotalBalance = $fundTotalBalance + $balance;
					$paidAmountTotal = $paidAmountTotal + $paidAmount;
					$obrAmountTotal = $obrAmountTotal +  $obrTotal;
					$abTotal = $abTotal + $ab;
					
					$savingsTotal = $savingsTotal + $savings;
					$expenseTotal = $expenseTotal + $expense;
					$prTotal = $prTotal +$prAmount;
					
					$gTotalAB = $gTotalAB + $ab;
					$gTotalOBR = $gTotalOBR + $obrTotal;
					$gTotalBalance = $gTotalBalance + $balance;
					$gTotalPO = $gTotalPO + $paidAmount;
					$gTotalPR = $gTotalPR + $prAmount; 
					$gTotalExpense = $gTotalExpense + $expense;
					$gTotalSavings = $gTotalSavings + $savings;
					
					
					$sheet .= '<tr>';
					$sheet .= '<td class = "label12" id = "' . $office . '~' . $program . '~' . $fundName .  '" onclick = "fundBreakdown(this)">+</td>';
					$sheet .= '<td style = "width:250px;" class = "label9">' . $fundName . '</td>';
					$sheet .= '<td style = "" class = "label9">' . $this->toNumberFormat($ab) . '</td>';
					$sheet .= '<td style = "width:50px;background-color:rgb(239, 219, 232);" class = "label9">' . $this->toNumberFormat($obrTotal) . '</td>';
					$sheet .= '<td style = "width:50px;" class = "label9">' . $this->toNumberFormat($prAmount) .  '</td>';
					$sheet .= '<td style = "width:50px;background-color:rgb(239, 219, 232);" class = "label9">' . $this->toNumberFormat($paidAmount) . '</td>';
					$sheet .= '<td style = "" class = "label9">' . $this->toNumberFormat($expense) .  '</td>';
					$sheet .= '<td style = "" class = "label9">' . $this->toNumberFormat($savings) .  '</td>';
					
					$sheet .= '<td style = "background-color:rgb(248, 203, 203);font-style:italic;color:black;" class = "label9">' . $this->toNumberFormat($balance) . '</td>';
					$sheet .= '</tr>';
						
					$sheet .= '<tr><td  colspan = "10" id = "fundBreakdownContainer" style = "text-align:center;padding:2px;"></td><tr>';
						
						
				}
				$sheet .= '<tr>';
				$sheet .= '<td ></td>';
				$sheet .= '<td style = "text-align:right;padding-right:5px;">&nbsp;</td>';
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($abTotal) . '</td>';
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($obrAmountTotal) . '</td>';
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($prTotal) . '</td>';
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($paidAmountTotal) . '</td>';
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($expenseTotal) . '</td>';
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($savingsTotal) . '</td>';
				
				$sheet .= '<td class = "label11">' . $this->toNumberFormat($fundTotalBalance) . '</td>';
				$sheet .= '</tr>';
				
				$sheet .= '<tr>';
				$sheet .= '<td ></td>';
				$sheet .= '<td style = "text-align:right;font-size:22px;padding-right:10px;">Total</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;" >' . $this->toNumberFormat($gTotalAB,2) . '</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;">' . $this->toNumberFormat($gTotalOBR,2) . '</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;">' . $this->toNumberFormat($gTotalPR,2) . '</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;">' . $this->toNumberFormat($gTotalPO,2) . '</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;">' . $this->toNumberFormat($gTotalExpense,2) . '</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;">' . $this->toNumberFormat($gTotalSavings,2) . '</td>';
				$sheet .= '<td class = "label10" style = "border-top:4px double silver;">' . $this->toNumberFormat($gTotalBalance,2) . '</td>';
				$sheet .= '</tr>';
				return $sheet .= '</table>';
			}else{
				return "<div style = 'padding:30px;'>On process...</div>";
				
			}
			
			
			
		}
		
		function CreateAppropriationStatusbyFund($record){
			$sheet1 ='';
			$sheet2 ='';
			$sheet3 ='';
			$sheet0 ='';
			
			
			$sheet0 = '<table style = "border:1px solid rgba(192, 192, 192,1);box-shadow:0px 0px 12px 2px grey;
							background-color:white;width:90%;padding:25px 15px;border-spacing:1;margin:25px auto;" border = "0">';
			$sheet = '<tr>';
			$sheet .= '<td class = "tdHeader1">Code</td>';
			$sheet .= '<td class = "tdHeader1">Title</td>';
			$sheet .= '<td class = "tdHeader1" style = "text-align:center">Annual&nbsp;Budget</td>';
			$sheet .= '<td class = "tdHeader1" style = "text-align:center">OBR</td>';
			$sheet .= '<td class = "tdHeader1" style = "text-align:center">PR</td>';
			$sheet .= '<td class = "tdHeader1" style = "text-align:center">PO</td>';
			$sheet .= '<td class = "tdHeader1" style = "text-align:center">Balance</td>';
			
			$sheet .= '</tr>';
			
			while($data = $this->fetch_array($record)){
			
				$accountCode = $data['AccountCode'];
				$fund = $data['FundName'];
				$title = $data['Title'];
				$ab = $this->zeroToNothing($data['AB']);
				$pr = $this->zeroToNothing($data['PR']);
				$obr = $this->zeroToNothing(($data['OBRTotal'] - $pr));
				
				
				$po = $this->zeroToNothing($data['PO']);
				
				$balance = $this->zeroToNothing($ab - ($obr + $po));
				
				$sheet1 = '<tr>
							<td colspan = "7" class = "label5">' . $fund . ' - <span style = "font-weight:normal;font-style:italic;">Breakdown</span></td>
							<tr>';
				
				$sheet2 .= '<tr>';
				$sheet2 .= '<td class = "tableDataRows" style = "width:30px;text-align:center;">' . $accountCode . '</td>';
				$sheet2 .= '<td class = "tableDataRows" style = "padding-left:8px;">' . $title . '</td>';
				$sheet2 .= '<td class = "tableDataRows" style = "padding:5px 8px;text-align:right;">' . $this->toNumberFormat($ab) . '</td>';
				$sheet2 .= '<td class = "tableDataRows" style = "padding:5px 8px;text-align:right;">' . $this->toNumberFormat($obr) . '</td>';
				$sheet2 .= '<td class = "tableDataRows" style = "padding:5px 8px;text-align:right;">' . $this->toNumberFormat($pr) . '</td>';
				$sheet2 .= '<td class = "tableDataRows" style = "padding:5px 8px;text-align:right;">' . $this->toNumberFormat($po) . '</td>';
				$sheet2 .= '<td class = "tableDataRows" style = "padding:5px 8px;text-align:right;">' . $this->toNumberFormat($balance) . '</td>';
				$sheet2 .= '</tr>';
			}
			$sheet3 .= '</table>';
			return $sheet0 . $sheet1 . $sheet . $sheet2 . $sheet3;
		}
		//----------------------------------------------------------------------------------------------------- tracker
		function CreateTrackerData($record){
			$receive = 0;
			$receive1 = 0;
			
			$count = $this->num_rows($record);
			$sheet = '<table id = "trackerDataTable" style = "width:100%;" >';
						$sheet .= '<tr>
										<td class = "tdHead1" style = "width:70px;background-color:rgb(28, 98, 118);">TN#</td>
										<td class = "tdHead1" style = "background-color:rgb(28, 98, 118);">Document</td>	
										<td class = "tdHead1" style = "width:220px;background-color:rgb(28, 98, 118);">Claimant</td>	
										<td class = "tdHead1" style = "width:190px;background-color:rgb(28, 98, 118);">Status</td>	
										<td class = "tdHead1" style = "width:140px;background-color:rgb(28, 98, 118);">Updated</td>	
										<td class = "tdHead1" style = "width:95px;background-color:rgb(28, 98, 118);">Completion</td>		
									 	<td class = "tdHead1" style = "background-color:rgb(28, 98, 118);">&nbsp;</td>		
									  </tr>';
						while($data = $this->fetch_array($record)){
							$id = $data['Id'];
							$trackingNumber = $data['TrackingNumber'];
							$trackingType = $data['TrackingType'];
							$claimType = $data['ClaimType'];
							$fund = $data['Fund'];
							
							$claimant = $data['Claimant'];
							$title = $data['Title'];
							$status = $data['Status'];
							$dateModified = $data['DateModified'];
							$completion = $data['Completion'];
							$amount = $data['Amount'];
							$chargeType = $data['ChargeType'];
							$obrType = $data['OBRType'];
							
							$checkNumber = '';
							$checkDate = '';
							
							if($data['checknumber'] != ''){
								$checkNumber = '<div style = "padding:2px 5px;text-align:right;border-top:1px solid grey;background-color:rgb(251, 249, 191);">Check #: <span style = "font-weight:bold;color:rgb(35, 116, 157);">' . $data['checknumber'] . '&nbsp;          &nbsp;        &nbsp;</span>';
								$checkDate = '<br/>&nbsp;Date #: <span style = "font-weight:bold;color:rgb(35, 116, 157);">' . $data['checkdate'] . '</span></div>';
							}
							
							
							$timeCount = $this->ezDate1($dateModified);
							
							if($data['ADV2'] != 0){
								$adv = $data['ADV2'];
							}else{
								$adv = $data['ADV1'];
							}
							$obr = $data['OBR_Number'];
							
							if($trackingType == "PO"){
								$claimType = $title;
								$fund = "General Fund";
								
								if($chargeType != 0){
									$amount = $data['TotalAmountMultiple'];
								}else{
									$amount = $data['PO_Amount'];
								}
							}else if($trackingType == "PR"){
								$claimType = $title;
								if($chargeType != 0){
									$amount = $data['TotalAmountMultiple'];
								}
								
								$fund = "General Fund";
							}else if($trackingType == "PY"){
								$trackingType = $data['DocumentType'];
								$amount = $data['Amount'];
								if($chargeType == 2){
									$amount = $data['TotalAmountMultiple'];
								}else if($chargeType == 3){
									$amount = $data['TotalAmountMultiple'];
								}
							}
							$sheet .= '<tr>
										<td class = "tableDataRows4" style = "width:70px;" ><span onclick = "searchThis(this)" class ="label3" style = "cursor:pointer;">' . $trackingNumber . '</span></td>
										<td class = "tableDataRows4" style = "width:220px;"><span class = "label3">' . $trackingType . '</span>
										<br/>' . $claimType . 
										'<div style = "margin-top:10px;">' . $fund;
										if(isset($_SESSION['employeeNumber'])){
											$sheet .= '<br/><span style = "color:red;">' . number_format($amount,2) . '</span>';
											$sheet .=  $checkNumber . $checkDate;			
										}
										
							$sheet .= '	</div></td>	
										<td class = "tableDataRows4" style = "width:220px;"><span class ="label3">' . $claimant . '</span>';
							
							
										
							$sheet .= '	</td>	
										<td class = "tableDataRows4" style = "width:150px;"><span class ="label3">' . $status . '</span>
										<br/>OBR #: ' . $obr .
										'<br/>ADV #: ' . $adv .
										'</td>	
										<td class = "tableDataRows4" style = "width:140px;"><span class = "label3">' . $timeCount . '</span><br/>' .  $dateModified . '</td>	
										<td class = "tableDataRows4" style = "width:95px;"><span class = "label3">' . $completion . '</span></td>';		
										
							if($status == "PO - GSO Received" || $status == "CBO Received"){
								$sheet .= ' <td class = "tableDataRows4" style = ""><input id = "check' . $id . '" type = "checkbox" name = "trackerCheck" /></td>';
								$receive++;
							
							}else if($status == "Encoded"){
								if($fund != 'General Fund'){
									$sheet .= ' <td class = "tableDataRows4" style = ""><input id = "check' . $id . '" type = "checkbox" name = "trackerCheck" /></td>';
									$receive++;
								}else if($fund == 'General Fund'){
									if($obrType == 0){
										$sheet .= ' <td class = "tableDataRows4" style = ""><input id = "check' . $id . '" type = "checkbox" name = "trackerCheck" /></td>';
										$receive++;
									}
								}else{
									$sheet .= ' <td class = "tableDataRows4" style = "">&nbsp;</td>';
								}
							}else{
								$sheet .= ' <td class = "tableDataRows4" style = "">&nbsp;</td>';
							}
							
							
							
							
									
							$sheet .= '</tr>';
						}
						
			$sheet .= '</table>';
			
			if($receive > 0){
				if(isset($_SESSION['accountType'] )){
					if($_SESSION['accountType'] == 4 &&  $_SESSION['officeCode'] == '1081'){
						
						$sheet .= '<div style="padding:10px; text-align:right;">';
						$sheet .= '				<div class ="button2" onclick = "receiveDocument()">Receive</div>';
						$sheet .= '</div>';
					}
				}
			}
			if($receive1 > 0){
				if(isset($_SESSION['accountType'] )){
					if($_SESSION['accountType'] == 2 &&  $_SESSION['officeCode'] == '1071'){
						
						$sheet .= '<div style="padding:10px; text-align:right;">';
						$sheet .= '				<div class ="button2" onclick = "receiveDocument()">Receive</div>';
						$sheet .= '</div>';
					}
				}
			}
			
			$sheet .= '<div style="padding:10px; text-align:center;">';
			if($count>1){
				$sheet .= '				<span id = "' . $id . '" class = "label13" onclick = "viewMore(this)">Load More</span>';
			}	
		
			$sheet .= '</div>';
		
			return $sheet;
		}
		function CreateOfficeSelectTracker($record){
			
			$sheet = '<table  style ="float:right;">';
			$sheet .= '<tr >';
			$sheet .= '<td><span class = "label5" style ="padding-right:4px;">Office</span></td>';
			$sheet .= '<td ><input id = "maskOffice" class= "text3" onkeydown="keypressAndWhat1(this,event,SelectOfficeTracker,1)" /><select id = "selectOfficeCode2" class = "select3" style ="text-align:left;" onchange = "SelectOfficeTracker(this)">';
			
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select></td>';
			$sheet .= '</tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		function CreateClaimTypeOptions($record){
			$sheet = '<option></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option>' . ucwords(strtolower($data['Type'])) . '</option>';
			}
			return $sheet;
		}
		//------------------------------------------------------------------------------------ Doctrack Transmittal 
		
		public function createViewSheetReport($rec,$fundType,$status,$claimType,$sDate,$count,$dbYear){
			
			if($count == 1){
				$label =  ' record';
			}else{
				$label =  ' records';
			}
			
			$sheet = "";
			$sheet .= '<table id = "resultTable">';
			$j = 1;
			$i = 1;
			while($data = $this->fetch_array($rec)){
				if($i == 1){
					$sheet .= '<tr><td colspan = "6" style ="padding-top:40px;">' . $this->headerReport($fundType,$status,$claimType,$sDate,$count,$label,$dbYear) . '</td></tr>';
					$sheet .= '<tr>' . $this->headerField() . '</tr>';	
				}
				$sheet .= '		<tr class ="trData">';
				if($data['ADV2'] == 0){
					$adv = $data['ADV1'];
				}else{
					$adv = $data['ADV2'];
				}
				if(strlen($adv) == 1){
					$adv = "0000" . $adv;
				}else if(strlen($adv) == 2){
					$adv = "000" . $adv;
				}else if(strlen($adv) == 3){
					$adv = "00" . $adv;
				}else if(strlen($adv) == 4){
					$adv = "0" . $adv;
				}
				
				$tn =  $data['TrackingNumber'];
				$sheet .= '			<td class ="" style = "width:10px;text-align:right;">'.  $j++ .'</td>';
				$sheet .= '			<td class ="tdData" style = "padding-left:10px;">'.  $tn .'</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:center;">' . $adv . '</td>';
				
				
				$claimant = substr($data['Claimant'],0,50);
				$last =  substr(strrev($data['Claimant']),0,1);
				
				if($last == '2'){
					$amount = $data['Amount'];
				}else if($last == '1'){
					$amount = $data['PayrollAmountFirst'];
				}else{
					if($data['TotalAmountMultiple'] > 0){
						$amount = $data['TotalAmountMultiple'];
					}else{
						$amount = $data['Amount'];
					}
				}
				
				if($data['PO_Amount'] > 0){
					$amount = $data['PO_Amount']; 
					
				}	
				if($data['NetAmount'] > 0){
					$amount =  $data['NetAmount'];	
				}
				
				$sheet .= '			<td class ="tdData" style = "padding-left:5px;">'. strtoupper($claimant) . '</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:right;padding-right:5px;">'.  number_format($amount,2) .'</td>';
				
				if(strlen($data['ClaimType']) >= 21){
					$claimTypeInternal = substr($data['ClaimType'],0,20) . '_';
				}else{
					$claimTypeInternal = $data['ClaimType'];
				}
				
				//$sheet .= '			<td class ="tdData" style = "text-align:center;">'.  $data['Office'] .'</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:center;">'.  $data['ControlNo'] .'</td>';
				$sheet .= '		</tr>';
				if($i == 33){
					$sheet .= '<tr><td colspan = "6" style ="padding-top:40px;">' . $this->headerReport($fundType,$status,$claimType,$sDate,$count,$label,$dbYear) . '</td></tr>';
					$sheet .= '<tr>' . $this->headerField() . '</tr>';	
					$i = 1;
				}
				$i++;
			}
			$sheet .= '<tr><td colspan ="8" style ="text-align:center;padding-top:15px;letter-spacing:2px;">- Nothing Follows -</td></tr>';	
			$sheet .= '	</table>';
			echo $sheet;
		}
		
		public function createViewSheetReportAll($rec,$fundType,$status,$claimType,$sDate,$count,$dbYear){	
			if($count == 1){
				$label =  ' record';
			}else{
				$label =  ' records';
			}
			
			$sheet = "";
			$sheet .= '<table id = "resultTable">';
			$i = 1;
			while($data = $this->fetch_array($rec)){
				if($i == 1){
					$sheet .= '<tr>';
					$sheet .= '<td colspan = "6" style ="padding-top:40px;">' .  $this->headerReport($fundType,$status,$claimType,$sDate,$count,$label,$dbYear) .  '</td>';
					$sheet .= '</tr>';
					$sheet .= '<tr>' . $this->headerFieldAll() . '</tr>';	
				}
				$sheet .= '		<tr class ="trData">';
				if($data['ADV2'] == 0){
					$adv = $data['ADV1'];
				}else{
					$adv = $data['ADV2'];
				}
				
				if(strlen($adv) == 1){
					$adv = "0000" . $adv;
				}else if(strlen($adv) == 2){
					$adv = "000" . $adv;
				}else if(strlen($adv) == 3){
					$adv = "00" . $adv;
				}else if(strlen($adv) == 4){
					$adv = "0" . $adv;
				}
				
				//$sheet .= '			<td class ="tdData" style = "text-align:left;padding-left:5px;">' . $data['TrackingNumber'] . '</td>';
				
				$sheet .= '			<td class ="tdData" style = "text-align:left;padding-left:5px;">' . $data['TrackingNumber'] . '</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:center;">' . $adv . '</td>';
				
				$claimant = substr($data['Claimant'],0,35);
				$last =  substr(strrev($data['Claimant']),0,1);
				if($last == '2'){
					$amount = $data['Amount'];
				}else if($last == '1'){
					$amount = $data['PayrollAmountFirst'];
				}else{
					if($data['TotalAmountMultiple'] > 0){
						$amount = $data['TotalAmountMultiple'];
					}else{
						$amount = $data['Amount'];
					}
				}
				if(isset($data['NetAmount'])){
					$amount = $data['NetAmount'];
				}
				
				$sheet .= '			<td class ="tdData" style = "padding-left:5px;">'.  strtoupper($claimant) . '</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:right;padding-right:5px;">'.  number_format($amount,2) .'</td>';
				
				if(strlen($data['ClaimType']) >= 8){
					$claimTypeInternal = substr($data['ClaimType'],0,7) . '_';
				}else{
					$claimTypeInternal = $data['ClaimType'];
				}
				
				$sheet .= '			<td class ="tdData" style = "padding-left:5px;">'.  $claimTypeInternal .'</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:center;">'.  $data['Office'] .'</td>';
				
				$sheet .= '		</tr>';
				if($i == 38){
					$sheet .= '<tr>';
					$sheet .= '<td colspan = "6" style ="padding-top:40px;">' .  $this->headerReport($fundType,$status,$claimType,$sDate,$count,$label,$dbYear) .  '</td>';
					$sheet .= '</tr>';
					$sheet .= '<tr>' . $this->headerFieldAll() . '</tr>';	
					$i = 1;
				}
				$i++;
			}
			$sheet .= '<tr><td colspan ="8" style ="text-align:center;padding-top:15px;letter-spacing:2px;">- Nothing Follows -</td></tr>';	
			$sheet .= '	</table>';
			echo $sheet;
		}
		public  function headerReport($fundType,$status,$claimType,$sDate,$count,$label,$dbYear){
			 
			 if($claimType == "Window"){
				$v = "Payroll";
			}else{
				$v = "Voucher";
			}
			 $dt = strtotime("+8 hours");
		 	 $date =   date('Y-m-d h:i A', $dt);		
		 	 $today = '<span style ="font-size:12px;">Printed : ' . $date . '</span>' ;	
			 
			 $recordCount = '<span style ="font-size:12px;">' .$count . $label . '</span>';
			 $sheet = '<table class= "tableHeader">';
			 $sheet .= '		<tr>';
			 $sheet .= '			<td colspan = "3" style = "font-size:25px;">Office of the City Accountant</td>';
			 $sheet .= '		</tr>';
			 $sheet .= '		<tr>';
			 $sheet .= '			<td colspan = "3" style = "font-size:18px;">Document Tracking System <span style = "font-weight:bold;font-size:25px;">' . $dbYear .  '</span></td>';
			 $sheet .= '		</tr>';
			 $sheet .= '		<tr>';
			 //$sheet .= '			<td colspan = "3" style = "font-size:28px;">List of ' . $status . ' ' . $claimType . '</td>';
			 $sheet .= '			<td colspan = "3" style = "font-size:28px;">List of ' . $status . ' ' . $v .  '</td>';
			 $sheet .= '		</tr>';
			 $sheet .= '		<tr>';
			 $sheet .= '			<td colspan = "3" style = "font-size:25px;">' . $fundType . ' - ' . $claimType . ' Claim</td>';
			 $sheet .= '		</tr>';
			 $sheet .= '		<tr>';
			 
			
			 if($sDate == 2 or $sDate == 1){//all
				$sheet .= '			<td colspan = "3" style = "font-size:15px;letter-spacing:2px;">' .  $count . $label . '</td>';
				$recordCount = "";
			 }else{
					$sheet .= '			<td colspan = "3" style = "font-size:15px;letter-spacing:2px;">' . $sDate .  '</td>';
			 }
			
			 $sheet .= '		</tr>';
			 $sheet .= '		<tr><td style ="width:300px;text-align:left;">' . $today . '</td><td style = "font-size:15px;letter-spacing:2px;"></td><td style ="width:300px;text-align:right">'  . $recordCount . '</td></tr>'; 
			 $sheet .= '</table>';
			 	 
			 return $sheet;
		}	
		public function headerFieldAll(){
				
				
				$sheet = '			<td class ="tdFieldHeader" style ="border-left:2px solid silver;text-align:left;">TN#</td>';
				$sheet .= '			<td class ="tdFieldHeader" style ="text-align:center">ADV</td>';
				
				$sheet .= '			<td class ="tdFieldHeader">Claimant</td>';
				$sheet .= '			<td class ="tdFieldHeader" style ="text-align:right;">Amount</td>';
				$sheet .= '			<td class ="tdFieldHeader">Claim Type</td>';
				$sheet .= '			<td class ="tdFieldHeader" style = "text-align:center;">Office</td>';
				return $sheet;
		}
		public function CreateViewSheetSearch($rec,$fundType,$status,$claimType,$count,$dbYear){
		
			if($count == 1){
				$label =  ' record';
			}else{
				$label =  ' records';
			}
		
			$sheet = "";
			$sheet .= '<table id = "resultTable" class = "tableField">';
			$i = 1;
			while($data =  $this->fetch_array($rec)){
				$trackType = $data['TrackingType'];
				if($i == 1){
					$sheet .= '<tr><td colspan = "10" style ="padding:0px;">' . $this->headerReport($fundType,$status,$claimType,1,$count,$label,$dbYear) . '</td></tr>';
					$sheet .= '<tr>' . $this->headerField1() . '</tr>';	
				}
				$sheet .= '		<tr class ="trData">';
				$sheet .= '			<td class ="tdData" style = "text-align:center;">' . $i . '</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:center;">' . $data['TrackingNumber'] . '</td>';
				if($data['ADV2'] == 0){
					$adv = $data['ADV1'];
				}else{
					$adv = $data['ADV2'];
				}
				if(strlen($adv) == 1){
					$adv = "00000" . $adv;
				}else if(strlen($adv) == 2){
					$adv = "0000" . $adv;
				}else if(strlen($adv) == 3){
					$adv = "000" . $adv;
				}else if(strlen($adv) == 4){
					$adv = "00" . $adv;
				}else if(strlen($adv) == 5){
					$adv = "0" . $adv;
				}
				$type  =  $data['ChargeType'];
				if($type > 1){
					$amount = $data['TotalAmountMultiple'];
				}else{
					$amount = $data['Amount'];
				}
				if($dbYear>=2017){
					if($data['NetAmount'] > 0){
						$amount = $data['NetAmount']; 
					}
				}
				$docType = '';
				if(isset($data['DocumentType'])){
					$docType = $data['DocumentType'];
				}
				if($dbYear<2017){
					$docType = $data['TransactionType'];
				}

				$sheet .= '			<td class ="tdData" style = "text-align:center;">' . $data['PR_Number'] . '</td>';

				
				$sheet .= '			<td class ="tdData" style = "text-align:center;">' . $adv . '</td>';
				$sheet .= '			<td class ="tdData">' . $docType  . '</td>';
				$sheet .= '			<td class ="tdData">'.  $data['Claimant'] .'</td>';
				$sheet .= '			<td class ="tdData" style = "text-align:right;padding-right:5px;">'.  number_format($amount,2) .'</td>';
				$sheet .= '			<td class ="tdData" style = "padding-left:5px;font-size:15px;">'.  $data['ClaimType'] .'</td>';
				$sheet .= '			<td class ="tdData">'.  $data['Status'] .'</td>';
				$d = explode("-", $data['DateModified']);
				$sheet .= '			<td class ="tdData">'.  $d[1] .'-'. substr($d[2],0,2) . '-' . $d[0] . '<br/><span style ="color:#FA1E9E;font-size:12px;">' .  $time_in_12_hour_format  = DATE("g:i a", STRTOTIME($data['DateModified'] ))   .'</span></td>';
				$sheet .= '			<td class ="tdData">'.  $data['Office'] .'</td>';
				
				$sheet .= '		</tr>';
				$i++;
			}
			$sheet .= '	</table>';
			return $sheet;
		}
		public function headerField1(){
				$sheet = '			<td class ="tdFieldHeader" style = "text-align:center;">Row</td>';
				$sheet .= '			<td class ="tdFieldHeader" style = "text-align:center;">TN#</td>';	
				$sheet .= '			<td class ="tdFieldHeader" style = "text-align:center;">PR#</td>';	
				$sheet .= '			<td class ="tdFieldHeader" style = "text-align:center;">ADV</td>';
				$sheet .= '			<td class ="tdFieldHeader">Type</td>';
				$sheet .= '			<td class ="tdFieldHeader">Claimant</td>';  
				$sheet .= '			<td class ="tdFieldHeader" style ="text-align:right;">Amount</td>';
				$sheet .= '			<td class ="tdFieldHeader">Claim Type</td>';
				
				$sheet .= '			<td class ="tdFieldHeader">Status</td>';
				$sheet .= '			<td class ="tdFieldHeader">Date</td>';
				$sheet .= '			<td class ="tdFieldHeader">Office</td>';
				
				
				return $sheet;
		}
		public function headerField(){
				$sheet = '			<td></td>';
				$sheet .= '			<td class ="tdFieldHeader" style = "border-left:2px solid silver;padding-left:5px;">Office/TN</td>';
				$sheet .= '			<td class ="tdFieldHeader" style ="text-align:center;">ADV</td>';
				$sheet .= '			<td class ="tdFieldHeader">Claimant</td>';
				$sheet .= '			<td class ="tdFieldHeader" style ="text-align:right;">Amount</td>';
				
				//$sheet .= '			<td class ="tdFieldHeader" style = "text-align:center;">Office</td>';
				$sheet .= '			<td class ="tdFieldHeader" style = "text-align:center;">Ctrl</td>';
				return $sheet;
		}
		//---------------------------------------------------------------------------------------- forum
		public function CreateForumView($record){
			
			$count = $this->num_rows($record);
			$employeeId = $_SESSION['employeeNumber'];
			$officeName = $_SESSION['officeName'];
			$accountType = $_SESSION['accountType'];
			$sheet = '';
			$i = 0;
			
			if($count > 0){
					while($data =  $this->fetch_array($record)){		
						//$fullName = $data['FirstName'] . ' ' . $data['MiddleName'] . ' ' . $data['LastName'];		
						$id = $data['Id']	;	
						$fullName =  ucwords( utf8_encode($data['SenderName']));	
					
						$senderOffice = $data['SenderOffice']	;
						$sender =$data['Sender'];
						$receiver = strtoupper($data['Receiver']);
						$messageType = $data['MessageType'];
						if($receiver == "ALLTHREE"){
							$receiver = 'CAO, CBO, GSO, CTO, Admin';
							
						}else if($receiver == "ALL"){
							$receiver = "All Offices";
						}
						$message = $data['Message'];
						$date = $data['Date'];
						$replies = $data['Replies'];
						
						
						if($i == 0){
							$sheet .= '<table id = "tableResult' . $id . '" class = "tableResult" style = "background-color:#F9FBFC">';
							$i = 1;
						}else{
							$sheet .= '<table id = "tableResult' . $id . '" class = "tableResult" style = "background-color:#FBFBF6">';
							$i = 0;
						}	
						
						$sheet .= '<tr id ="trForum">';
						$sheet .= '<td rowspan ="2" style ="vertical-align:top;width:45px;">';
						
						if($sender == '501573'){
							$sheet .= '<div id = "idResult" style = "color:red;text-shadow:0px 0px 6px rgb(9, 183, 246);">' . $id . '</div>';
						}else{
							$sheet .= '<div id = "idResult">' . $id . '</div>';
						}
						
						
						$sheet .= '</td><td colspan = "2"><div id = "officeResult">' .$senderOffice. '</div></td><td style ="width:10px;">&nbsp;</td>';
						$sheet .= '</tr>';
						
						$sheet .= '<tr>';
						
						
						$ago = $this->ezDate1($date);
						if(substr($ago,0,4)== "week"){
							$posted = $this->dateFormat($date);
						}else{
							$posted = $ago;
						}
						
						$sheet .= '<td colspan ="3"><span id = "fullnameResult" style = "font-size:10px;">' . $fullName . '</span><span id="forumPosted" style = "font-size:12px;">' .  $posted . '</span></td>';
						$sheet .= '</tr>';
						
												
						$sheet .= '<tr>';
						
						if($data['MessageType'] == 7){
							$sheet .= '<td class = "tdAdmin" style = "">&nbsp;</td>';
						}else{
							$sheet .= '<td>&nbsp;</td>';
						}
						
						$sheet .= '<td colspan = "2"><div id = "messageResult">';
					
						$sheet .= '<span style = "font-size:14px;color:grey">To : ' . $receiver . '</span><br/><br/>';
						//emoticons				
						$sheet .=  htmlspecialchars($message);
											
						$sheet .= '<div id ="repliesResult' . $id .  '" class = "repliesResult" onclick = "showReplies(this)" >';
						if($data['Replies'] == 1){
							$sheet .=  '&#9658; ' . $replies . ' Reply';
						}else if($data['Replies']> 1){
							$sheet .= '&#9658; ' .  $replies . ' Replies';
						}
						
						$sheet .= '</div></div></td><td>&nbsp;</td>';
						$sheet .= '</tr>';
						
						$sheet .= '<tr>';
						$sheet .= '<td >&nbsp;</td><td id = "forumButtons">';
						
						$sheet .= '<div id ="divRemoveReply"><div class = "editorButtons" onclick ="showReplyEditor(this)">Reply</div>';
						
						if($accountType > 2){
							$sheet .= '<div id ="removeForumMessage' . $id .'" class = "editorButtons" onclick = "removeForumMessage(this)">Remove</div>';
						}else{
							if($sender== $employeeId){
								$sheet .= '<div id ="removeForumMessage' .  $id .'" class = "editorButtons" onclick = "removeForumMessage(this)">Remove</div>';
							}
						}
						$sheet .= '</div><div id ="divReplyEditor" style = "display:none;"><textarea class = "inputReply" id ="inputReply"></textarea>';
						$sheet .= '<div id ="submitReply' .  $id. '" style ="margin-top:5px;"  onclick ="submitReply(this)" class = "editorButtons">Submit</div><div style ="margin-top:5px;" class = "editorButtons" onclick = "hideReplyEditor(this)" >Cancel</div>';
						$sheet .= '</div>';
						
						$sheet .= '<div id ="divReplyContainer' .  $id . '" class= "divReplyContainer">';
						

						$sheet .= '</div>';		
						$sheet .= '</td>';
						$sheet .= '</tr>';
						$sheet .= '</table>';
					}
					
			}else{
				echo '<div style ="padding-left:60px;padding-bottom:20px;color:orange;padding-top:15px;"> - Nothing follows. -</div>';
			}
			echo $sheet;
		}
		public function CreateViewReplies($record){
		
			$sheet = '';
			$i = 1;
			while($data = $this->fetch_array($record)){
				$fullName = ucwords(strtolower(utf8_encode($data['SenderFullname'])));
				$senderOffice = $data['SenderOffice'];				
				$sheet .= '<div class = "replyContainerResult">';
				$sheet .= '<div class = "replyMessageResult"><div id = "repSequence" class = "repSequence">' . $i . '</div>' . nl2br(htmlspecialchars($data['Message'])) . '</div>';
				$sheet .= '<div id = "replyInfo"><font color = "black">' . $senderOffice . '</font>  <font color = "#FA637C" ><br/>' . $fullName . '</font> <font color ="grey">' . $this->ezDate($data['DateEncoded']) . '</font></div>';
				$sheet .= '</div>';
				$i++;
			}
		
			echo $sheet;
		}
		
		
		public function DisplayAnnouncement($record){
			$ctr = 0;
			$count = $this->num_rows($record);
			if($count == 0){
				$ctr = 0;
			}
			$sheet = '<table style ="border-spacing:0;margin:0 auto;margin-left:12px;width:92%;font-family:Oswald;">';	
			$sheet .= '<tr><td style = "padding:0;">
					 	<div id ="" style = "text-align:center;letter-spacing:2px;font-size:16px;padding:5px;background-color:rgba(23, 73, 60,.8);color:white;border-radius:5px 5px 0px 0px;">Announcement</div>
					 </td></tr>';
			$sheet .=  '<tr><td style = "padding:2px 1px;vertical-align:top;background-color:rgba(61, 60, 60,.7);background-color:rgba(0, 0, 0,.5)">';
				while($data = $this->fetch_array($record)){
					$office =$data['Office'];
					$datePosted  =$data['DatePosted'];
					if($office == '1081'){
						$officeName = 'Accounting Office';
					}else if($office == '1071'){
						$officeName = 'Budget Office';
					}else if($office == '1061'){
						$officeName = 'General Service Office';
					}else{
						$officeName = '---';
					}
					$message = $data['Message'];
					
					if($message != '0'){
						$sheet .=  '<table style = "border-spacing:0;width:100%;margin-bottom:5px;" border ="0">
									<tr>
										<td style = "border-top:1px solid rgba(27, 66, 45,.5); border-bottom:1px solid rgba(27, 66, 45,.5); padding:0;background-color:rgb(24, 33, 28);">
											<span style = "color:rgb(223, 170, 56);font-size:14px;padding:5px;padding-bottom:2px;">' . $officeName . '</span>
											<span style = "text-align:right;font-size:12px;padding-bottom:10px;color:silver;">' .  $this->ezDate1($datePosted) . '</span>
										</td>
									</tr>
									<tr>
										<td style = "padding:0;margin:0;">
											<div style = "font-size:14px;min-height:20px; max-height:200px; white-space: pre-line; word-wrap:break-word;padding:5px;padding-right:0px;padding-bottom:0px;overflow-y:auto; color:silver;">' . $message . '</div>
										</td>
									</tr>	
								   </table>';	
					 }else{
						$ctr++;
					}
				}
			$sheet .=  '</td></tr>';
			$sheet .= '</table>';
		
			if( $ctr == $count){
				return '';
			}else{
				return $sheet;
			}
			return $sheet;
		}

		public function DisplayStatuses($record){
			if($this->num_rows($record) > 0){		
				
				$sheet = '<table style ="margin-left:5px;width:98%;font-family:Oswald;">';	
					$sheet .=  '<tr><td style = "padding:5px;">
								<div id ="" style = "font-size:16px;padding:5px;background-color:rgba(8, 69, 142,.6);color:white;border-radius:5px 5px 0px 0px;text-shadow:0px 0px 2px blue; text-align:center; letter-spacing:1px;">Tracking Summary
									<span id ="infoStatus" onclick = "showMessage(this)" style = "display:none;" >&nbsp;</span>
									<div id ="mesCont" style = "margin-left:215px;position:absolute;opacity:.7;" ></div>
								</div>
								<div style = "padding:5px;padding-right:0px;padding-bottom:10px; color:white;background-color:rgba(61, 60, 60,.7); background-color:rgba(1, 1, 1,.7);">';
									$sheet .= '<table style ="border-spacing:0;width:100%;color:silver;font-size:16px;" border="0">';
									while($data = $this->fetch_array($record)){
										$status  =$data['Status'];
										$statusAlias = $status;
										if($status == "Forwarded to Admin - Administration"){
											$statusAlias = "Admin - Administration";
										}else if($status == "Forwarded to Admin - Operation"){
											$statusAlias = "Admin - Operation";
										}else if($status == "Forwarded to SP - Admin"){
											$statusAlias = "Admin - SP";
										}
										
										
										$trackingNumber = $data['TrackingNumber'];
										$count = $data['Count']; 
										if(substr($status,0,7) == 'Pending'){
											$count = '<span style = "color:red;">' .  $count . '</span>';
										}else{
											$count = '<span style = "color:rgb(10, 112, 155);">' .  $count . '</span>';
										}
										$sheet .= '<tr  id = "status' . $status .  '" onclick ="showByStatus(this)"><td class = "onhover"  colspan = "2" style = "text-align:right;font-weight:b1old;font-size:20px;border-bottom:1px solid rgba(68, 69, 69,.5);vertical-align:bottom;">' .  $count . '</td><td class = "onhover"  style = "vertical-align:bottom;border-bottom:1px solid rgba(68, 69, 69,.5);padding-left:5px;">  ' .   $statusAlias .'</td></tr>';						
									}
									$sheet .= '</table>';
				$sheet .= '</div></td></tr></table>';
				
				return $sheet;
			}
		}
		
		public function DisplayInbox($record,$record1){
			$x = 0;
			
			$sheet = '<table style ="margin-left:5px;width:98%;font-family:Oswald;">';	
			
			$sheet .=  '<tr><td style = "padding:5px;">
						<div id ="" style = "font-size:16px;padding:5px;background-color:rgba(146, 145, 142,.5);background-color:rgba(240, 30, 103,.4); color:white;border-radius:5px 5px 0px 0px;text-shadow:0px 0px 2px red;letter-spacing:2px;text-align:center;">Forum</div>
						<div style = "background-color:rgba(61, 60, 60,.7);padding:5px 0px;background-color:rgba(1, 1, 1,.4);">';
								$sheet .= '<table style =" margin:0 auto;border-spacing:0;width:90%;color:silver;" border="0">';
								if($this->num_rows($record) > 0){		
										$data = $this->fetch_array($record);	
										$count = $data['Count'];
										if($count > 0){	
												$forumId = $data['ForumId'];
												if($count > 1){
													$label = "new messages";
												}else{
													$label = "new message";
												}
												$sheet .= '<tr id = "lastForumId" class = "onhover">
															<td  onclick ="gotoForum(this)" id = "' . $forumId . '"  style = "text-align:right;width:30%;padding-right:10px;">
																<span style = "font-size:32px;color:white;text-shadow:1px 1px 2px white; font-style:italic;">' . $count  . '</span> 
															</td>
															<td  onclick ="gotoForum(this)" id = "' . $forumId . '"  style = "vertical-align:bottom;padding-bottom:5px;">
																<span style = "font-style:italic;">' . $label . '</span> 
															</td>
														</tr>';						
										}else{
											$x++;
										}
								}else{
									$x++;
								}
								if($this->num_rows($record1) > 0){		
										$counter = 0;
										$ids = '';
										$label = "reply";
										$markDate = '';
										$i =0;
										while($data = $this->fetch_array($record1)){
											$forumId = $data['ForumId'];
											$dateEncoded = $data['DateEncoded'];
											$count = $data['Count'];
											if($i == 0){
												$markDate = $dateEncoded;
											}
											$counter = $counter + $count;
											$ids .= $forumId . ',';
											if($counter > 1){
												$label = 'new replies';
											}
											$i++;
										}			
										$sheet .= '<tr id = "' . $markDate . '"  class = "onhover" onclick ="gotoReplies(this)">
													<td  id = "' . $forumId . '"  style = "text-align:right;padding-right:5px;width:35%;">
														<span style = "font-size:28px;color:white;text-shadow:1px 1px 2px white; font-style:italic;">' . $counter  . '</span> 
													</td>
													<td style = "vertical-align:top;padding-top:4px;">
														<span style = "font-style:italic;padding-left:3px;">' . $label . '</span> 
														<input id ="repliesId" value = "' . $ids . '" type = "hidden">
													</td>
												</tr>';	
								}else{
									$x++;
								}
								$sheet .= '</table>';
			$sheet .= '</div></td></tr></table>';
			
			if($x == 2){
				return '' ;		
			}else{
				return $sheet ;		
			}
			
		}
		
		//------------------------------------------------------------------settings
		public function CreateFundTable($record){
			
				$sheet = '<table id = "" style ="border-spacing:0;margin:0 auto;">';
				$sheet .= '<tr><td colspan = "2"><span class ="label1">List of Account Titles</span></td></tr>';	
				$sheet .= '<tr>';
				$sheet .= '	<td style="text-align:center;" class ="tdHeader1" >Fund</td>';
				$sheet .= '	<td style="text-align:left;padding-left:15px;"class ="tdHeader1">Code</td>';
				$sheet .= '	<td style="width:60%;padding-left:15px;" class ="tdHeader1">Title</td>';
				$sheet .= '</tr>';	
				while($data = $this->fetch_array($record)){
					$sheet .= '<tr class = "">';
					$sheet .= '<td style = "width:9%;text-align:center;" class = "tableDataRows">' . $data['Fund'] . '</td>';
					$sheet .= '<td style = "width:9%;text-align:left;padding-left:15px;" class = "tableDataRows">' . $data['Code'] . '</td>';
					$sheet .= '<td style = "width:32%;padding-left:15px;" class = "tableDataRows">' . $data['Title'] . '</td>';
					$sheet .= '</tr>';
				}
				$sheet .= '</table>';
				return $sheet;
		}
		public function CreateProgramTable($record){
			
				$sheet = '<table id = "" style ="border-spacing:0;">';
				$sheet .= '<tr><td colspan = "2"><span class ="label1">List of Programs</span></td></tr>';
				$sheet .= '<tr>';
				$sheet .= '	<td style=""class ="tdHeader1">Code</td>';
				$sheet .= '	<td style="width:80%;" class ="tdHeader1">Name</td>';
				$sheet .= '</tr>';	
				while($data = $this->fetch_array($record)){
					$sheet .= '<tr class = "">';
					$sheet .= '<td style = "width:9%;padding-left:10px;" class = "tableDataRows">' . $data['Code'] . '</td>';
					$sheet .= '<td style = "width:9%;padding-left:10px;" class = "tableDataRows">' . $data['Name'] . '</td>';
					$sheet .= '</tr>';
				}
				$sheet .= '</table>';
				return $sheet;
			
		}
		
		//----------------------------------------------------------------------------------Message Container
		function CreateObrMessages($message){
			echo $sheet = '<table class ="messageContainer"><tr><td class ="sideBrace">{</td><td class= "messageBox">' . $message . '</td><td class ="sideBrace">}</td></tr></table>';
		}
		//------------------------------------------------------------------settings
		
		function CreateForApprovalBudget($record){
			$sheet = '<table style = "width:100%;">';
			$sheet .= '	<tr>';
			$sheet .= '		<td colspan = "2" style ="border-radius:5px 5px 0px 0px; border-bottom:1px solid grey;padding:10px;background-color:rgb(44, 51, 43);"><span class = "label1" style ="font-size:16px;color:white;letter-spacing:1px;font-weight:normal;" >Budget For Approval</span></td>';
			$sheet .= '	</tr>';
			$sheet .= '	<tr>';
			$sheet .= '		<td colspan = "2">';
			$i = 1;
								$sheet .= '<table class = "table1">';
								$sheet .= '<tr class = "">';
								$sheet .= '</tr>';
								while($data = $this->fetch_array($record)){
									$sheet .= '<tr class = "">';
									$sheet .= '<td style = "width:40px;text-align:center;" >' . $i . '</td>';
									$sheet .= '<td style = "width:400px;padding-left:5px;" class = "tableDataRows">' . $data['Name'] . '</td>';
									$sheet .= '</tr>';
									$i++;
								}
								$sheet .= '</table>';
			
			$sheet .= '		</td>';
			$sheet .= '	</tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		
		function CreateAllOBRs($record){
			$sheet = '<table style ="border-spacing:0;" id = "obrAllTable" >';
			$sheet .= '<tr><td colspan = "6"><span class ="label1">All transactions with OBR number</span></td></tr>';	
			$sheet .= '<tr>';
			$sheet .= '	<td class ="tdHeader1" style="width:50px;">&nbsp;</td>';
			$sheet .= '	<td class ="tdHeader1" style="width:80px;">TN#</td>';
			$sheet .= '	<td class ="tdHeader1" style="width:70px;text-align:center;">OBR#</td>';
			$sheet .= '	<td class ="tdHeader1" style="width:400px;">Claimant</td>';
			$sheet .= '	<td class ="tdHeader1" style="width:100px;text-align:center;" >Amount</td>';
			$sheet .= '	<td class ="tdHeader1" style="width:130px;" >Status</td>';
			$sheet .= '</tr>';	
			$i = $this->num_rows($record);
			while($data = $this->fetch_array($record)){
				$trackingNumber = $data['TrackingNumber'];
				$obrNo = $data['OBR_Number'];
				$claimant = strtoupper($data['Claimant']); 
				$amount = $data['Amount'];
				$status = $data['Status'];
				if($data['TotalAmountMultiple'] > 0){
					$amount = $data['TotalAmountMultiple'];
				}else{
					$amount = $data['Amount'];
				}
				$sheet .= '<tr class = "OBRrow">';
				$sheet .= '<td class = "tableDataRows" style = "padding:3px 8px;font-size:10px;text-align:center;">' . $i--  . '</td>';
				$sheet .= '<td class = "tableDataRows" style = "padding:3px 8px;">' . $trackingNumber . '</td>';
				$sheet .= '<td id  = "' . $trackingNumber . '~' . $obrNo  . '" class = "tableDataRows" style = "padding:3px 8px;text-align:center;" ondblclick = "changeOBRno(this)">' . $obrNo . '</td>';
				$sheet .= '<td class = "tableDataRows" style = "padding:3px 8px;" >' . $claimant . '</td>';
				$sheet .= '<td class = "tableDataRows" style = "padding:3px 8px;text-align:right;" >' . number_format($amount,2) . '</td>';
				$sheet .= '<td class = "tableDataRows" style = "padding:3px 8px;" >' . $status . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet;
		}
		function CreateManualFundBreakdown($record){

			$sheet3 = ''; 
			$sheet0 = '<table id = "manualPOtable" style = "border-spacing:0;margin:0 auto;"  border= "0">';
			$sheet2 = '<tr>
							<td class = "tdHeader3" style="padding:10px;">&nbsp;</td>
							<td class = "tdHeader3" style="padding:10px;">Fund</td>
							<td class = "tdHeader3" style="padding:10px;">Account Code</td>
							<td class = "tdHeader3" style="padding:10px;">OBR Amount</td>
							<td class = "tdHeader3" style="padding:10px;text-align:center;">PO Amount</td>
						</tr>';
					  $gTotal = 0;	
					   while($data = $this->fetch_array($record)){
					   		$prAccountCode = $data['PR_AccountCode'];
							$programCode = $data['PR_ProgramCode'];
							$amount = $data['Amount'];
							$description = $data['description'];
							
							$category = $data['PR_CategoryCode'];
							
							$obrNumber = $data['OBR_Number'];
							$prNumber = $data['PR_Number'];
							$fund = $data['Fund'];
							
					   		$sheet3 .= '<tr>
											<td class = "tableDataRows3" style="padding:10px;"><input id = "poFund' . $programCode . '" type = "checkbox" checked ="checked" onclick = "selectCalculate(this)"/></td>
											<td class = "tableDataRows3" style="padding:10px;"><span class ="label2">' . $programCode .  '</span></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:center;"><span class ="label2">' . $prAccountCode . '</span></td>
											<td class = "tableDataRows3" style="padding:10px;text-align:center;"><span class ="label2">' . $amount . '</span></td>	
											<td class = "tableDataRows3" style="padding:10px;"><input id ="" class = "text2" style = "width:120px;text-align:right;" onclick="clickInput(this)" value = "0" onkeydown="return isAmount(this,event)" onkeyup = "calculateManual(this)"/></td>
										</tr>';
										
							$gTotal = $gTotal+$amount;
					   }
					   if($category == 'Multiple'){
							$sheet1 = '<div style = "padding:10px;text-align:left;"><span class = "label1">PR details :</span>
										<div id = "prManualdetails" style = "padding:10px;padding-left:20px;">'  . $description . '</div></div>';
					   }else{
							$sheet1 = '';
					   }
			$sheet4 = '<tr>
							<td colspan="5" style="padding:10px;text-align:right;padding-right:20px;"><input id = "prManualHidden" type = "hidden" value ="' . $obrNumber . '~' . $prNumber  . '~' . $fund . '" />
							<span id = "manualPOTotal" class = "label2" style = "color:red;padding-left:20px;">0.00</span></td>
							
					  </tr></table>';
			return $sheet1 . $sheet0 . $sheet2 .  $sheet3 .$sheet4 ;
		
		}
		//-------------------------------------------------------------- appro changes
		function CreateOfficeOption($record){
			$sheet = '<select class="select2" style = "width:283px;" onchange = "getOfficeProgramCOde(this)">';
			
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Name'] . ' - (' . $data['Code'] .')';
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		
		}	
		function CreateOfficeSelectOfficial($record,$class,$func){
			$sheet = '<select class="select2 ' . $class . '" onchange = "' . $func . '(this)">';
			$sheet .= '<option value = ""></option>';
			$sheet .= '<option value = "AllCodes">All Codes</option>';
			$sheet .= '<option value = "All">All Programs</option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Name'] . ' - (' . $data['Code'] .')';
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateOfficeSelectOfficialB($record,$class,$func){
			$sheet = '<select class="select2 ' . $class . '" onchange = "' . $func . '(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .= $data['Name'] . ' - (' . $data['Code'] .')';
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateProgramSelectOfficial($record,$class,$func){
			$sheet = '<select class="select2 ' . $class . '" onchange = "' . $func . '(this)">';
			$sheet .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '">';
				$sheet .=    $data['Code']  . ' - ' . $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
			
		}
		//------------------------------------------------------------------SaabOBR
		function CreateDisbursementsTable($record){
			$row = 0;
			$gTotal = 0;
			$sheet = '<table border = "0" style = "border-spacing:0px;">';
			
			
			$same = '';	
			while($data = $this->fetch_array($record)){
				$chargeType = $data['ChargeType'];
				if($data['ADV2'] == 0){
					$adv = $data['ADV1'];
				}else{
					$adv = $data['ADV2'];
				}
				$accountCode = $data['PR_AccountCode']; 
				
				$obr =  $data['OBR_Number'];
				$claimant =trim($data['Claimant']);
				$month = str_replace(0,'', substr($data['OBR_Date'],5,2));
				$gTotal = $gTotal  + $data['Amount'];
				$amount = number_format($data['Amount'],2);
				
				$totalAmount = number_format($data['TotalAmountMultiple'],2);
				if($totalAmount == 0){
					$totalAmount = '';
				}
				$sheet .= '<tr>';
				if($obr != $same){
					$row++;
					$same = $obr;
					$rowVal = $row;
					if($row % 2 == 0){
						$sheet .= '<tr style = "background-color:rgb(231, 249, 223);" >';
					}
					if($totalAmount == ''){
						$amount = '<span style = "color:rgb(249, 22, 90);font-weight:bold;">' . $amount . '</span>';
					}
					$sheet .= '<td style = "width:44px;font-weight:bold;color:gray;" class = "tdSAAOBContent number">' . $rowVal . '</td>';
					$sheet .= '<td style = "width:62px" class = "tdSAAOBContent">' . $month . '</td>';
					$sheet .= '<td style = "width:72px" class = "tdSAAOBContent">' . $obr . '</td>';
					$sheet .= '<td style = "width:72px" class = "tdSAAOBContent">' . $adv . '</td>';
					$sheet .= '<td style = "width:352px; text-align:left;padding-left:10px;" class = "tdSAAOBContent">' . $claimant  . '</td>';
					$sheet .= '<td style = "width:132px" class = "tdSAAOBContent">' . $accountCode . '</td>';
					$sheet .= '<td style = "width:152px; text-align:right;padding-right:10px;" class = "tdSAAOBContent">' . $amount . '</td>';
					$sheet .= '<td style = "width:152px; text-align:right;padding-right:10px;color:rgb(249, 22, 90);font-weight:bold;" class = "tdSAAOBContent">' . $totalAmount . '</td>';
					
				}else{
					$rowVal = '';
					$obr = '';
					$adv = '';
					$claimant = '';
					$month = '';
					if($row % 2 == 0){
						$sheet .= '<tr style = "background-color:rgb(231, 249, 223);">';
					}
					$sheet .= '<td style = "width:30px;" class = "tdSAAOBContent">' . $rowVal . '</td>';
					$sheet .= '<td style = "width:50px" class = "tdSAAOBContent">' . $month . '</td>';
					$sheet .= '<td style = "width:60px" class = "tdSAAOBContent">' . $obr . '</td>';
					$sheet .= '<td style = "width:60px" class = "tdSAAOBContent">' . $adv . '</td>';
					$sheet .= '<td style = "width:350px; text-align:left;" class = "tdSAAOBContent">' . $claimant  . '</td>';
					$sheet .= '<td style = "width:120px" class = "tdSAAOBContent">' . $accountCode . '</td>';
					$sheet .= '<td style = "width:150px; text-align:right;padding-right:10px;" class = "tdSAAOBContent">' . number_format($data['Amount'],2) . '</td>';
					$sheet .= '<td style = "width:150px; text-align:right;padding-right:10px;" class = "tdSAAOBContent"></td>';
				}
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet . '~!~' . $row . '~!~' . number_format($gTotal,2);
			
		}
		
		function CreateDisbursementsOfficeOBR($record){
			$row = 0;
			$gTotal = 0;
			$sheet = '<table border = "0" style = "border-spacing:0px;">';
			
			
			$same = '';	
			while($data = $this->fetch_array($record)){
				
				if($data['ADV2'] == 0){
					$adv = $data['ADV1'];
				}else{
					$adv = $data['ADV2'];
				}
				$obr =  $data['OBR_Number'];
				$claimant =trim($data['Claimant']);
				$program =  $data['PR_ProgramCode'];
				
				$month = str_replace(0,'', substr($data['OBR_Date'],5,2));
				$gTotal = $gTotal  + $data['AmountTotal'];
				$amount = number_format($data['AmountTotal'],2);
				
				$totalAmount = number_format($data['TotalAmountMultiple'],2);
				if($totalAmount == 0){
					$totalAmount = '';
				}
				$sheet .= '<tr>';
				if($obr != $same){
					$row++;
					$same = $obr;
					$rowVal = $row;
					if($row % 2 == 0){
						$sheet .= '<tr style = "background-color:rgb(231, 249, 223);" >';
					}
					if($totalAmount == ''){
						$amount = '<span style = "color:rgb(249, 22, 90);font-weight:bold;">' . $amount . '</span>';
					}
					$sheet .= '<td style = "width:44px;font-weight:bold;color:gray;" class = "tdSAAOBContent number">' . $rowVal . '</td>';
					$sheet .= '<td style = "width:62px" class = "tdSAAOBContent">' . $month . '</td>';
					$sheet .= '<td style = "width:72px" class = "tdSAAOBContent">' . $obr . '</td>';
					$sheet .= '<td style = "width:72px" class = "tdSAAOBContent">' . $adv . '</td>';
					$sheet .= '<td style = "width:352px; text-align:left;padding-left:10px;" class = "tdSAAOBContent">' . $claimant  . '</td>';
					$sheet .= '<td style = "width:132px" class = "tdSAAOBContent">' . $program . '</td>';
					$sheet .= '<td style = "width:152px; text-align:right;padding-right:10px;" class = "tdSAAOBContent">' . $amount . '</td>';
					$sheet .= '<td style = "width:152px; text-align:right;padding-right:10px;color:rgb(249, 22, 90);font-weight:bold;" class = "tdSAAOBContent">' . $totalAmount . '</td>';
					
				}else{
					$rowVal = '';
					$obr = '';
					$adv = '';
					$claimant = '';
					$month = '';
					if($row % 2 == 0){
						$sheet .= '<tr style = "background-color:rgb(231, 249, 223);">';
					}
					$sheet .= '<td style = "width:30px;" class = "tdSAAOBContent">' . $rowVal . '</td>';
					$sheet .= '<td style = "width:50px" class = "tdSAAOBContent">' . $month . '</td>';
					$sheet .= '<td style = "width:60px" class = "tdSAAOBContent">' . $obr . '</td>';
					$sheet .= '<td style = "width:60px" class = "tdSAAOBContent">' . $adv . '</td>';
					$sheet .= '<td style = "width:350px; text-align:left;" class = "tdSAAOBContent">' . $claimant  . '</td>';
					$sheet .= '<td style = "width:132px" class = "tdSAAOBContent">' . $program . '</td>';
					$sheet .= '<td style = "width:150px; text-align:right;padding-right:10px;" class = "tdSAAOBContent">' . $amount . '</td>';
					$sheet .= '<td style = "width:150px; text-align:right;padding-right:10px;" class = "tdSAAOBContent"></td>';
				}
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet . '~!~' . $row . '~!~' . number_format($gTotal,2);
		}
		
		function CreateSearchBySAAOBOBR($record){
			
			$pCode = '1';
			
			$status = 0;
			$trackingType = '';
			$chargeType = '';
			$dateReleased = '';
			$claimant = '';
			$categoryName = '';
			
			$sheet1 = '<table id  = "tableEncodeJev" style = "margin:0 auto;margin-top:10px;width:100%;">';	
			$sheet1 .= '<tr>
						<td class = "tdSAAOBHeader" style = "padding:5px;">Program</td>
						<td class = "tdSAAOBHeader" style = "padding:5px;">Code</td>
						<td class = "tdSAAOBHeader" style = "padding:5px;">Amount</td>
						<td class = "tdSAAOBHeader" style = "padding:5px;">&nbsp;</td>
						</tr>';
			
			$sheet2 = '';
			
			$sheet5 = '';
			$sheetJev = '';		
			$pr = 0;
			$po = 0;
			
			$poMark ='';
			
			$row5 =0;
			
			$sheet5 = '<table id ="tablePOmark" style = "border-spacing:1;width:100%;"><tr>';
			
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">JEV#</td>';
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">TN#</td>';
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">ADV#</td>';
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">CHK#</td>';
			
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">Claimant</td>';
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">Program</td>';
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">Code</td>';
			
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">Amount</td>';
			$sheet5 .= '<td class="tdSAAOBHeader" style="padding:5px;">Total</td>';
			$sheet5 .= '</tr>';
			
			
			while($data = $this->fetch_array($record)){
				
				$id =  $data['Id'];
				
				$claimant = strtoupper($data['Claimant']);
				$status = $data['Status'];
				$obrNumber = $data['OBR_Number'];
				$chargeType = $data['ChargeType'];
				$trackingNumber = $data['TrackingNumber'];
				$trackingType = $data['TrackingType'];
				$checkNumber = $data['CheckNumber'];
				$checkDate = $data['CheckDate'];
				
				
				
				$category = $data['Category'];
				
				$claimType = $data['ClaimType'];
				
				//$transactionType = $data['DocumentType'];
				$transactionType = '';
				
				$categoryName = $data['CategoryName'];
				
				$claim = '<span id = "saaobEncodeClaimType">' . $claimType . '</span> ( ' . $transactionType . ')';
				
				if($trackingType == "PR"){
					$pr = 1;
					$claim = $category . ' - ' . $categoryName;
				}
				
				$amount = $data['Amount'];
				
				
				if($trackingType == "PO"){
					$amount = $data['PO_Amount'];
					$po = 1;
					$claim = '<span id = "saaobEncodeClaimType">' . $category . ' - ' . $categoryName . '</span>';
				}
				 
				
				$dateReleased = substr($data['DateModified'],0,10);
				//$jevDate = $data['JevDate'];
				$jevDate = '';
			
				$jevNo = $data['JevNo'];
				
				$programCode = $data['PR_ProgramCode'];
				$accountCode = $data['PR_AccountCode'];
				
				$amountTotal = number_format($data['TotalAmountMultiple'],2);
				
				
				
				if($data['ADV2'] == 0){
					$adv = $data['ADV1'];
				}else{
					$adv = $data['ADV2'];
				}
				
				if($jevNo != '' ){
					$sheetJev .= '<tr>';
					$sheetJev .= '<td style = "text-align:right;"><span class = "label7">JEV #  </span></td><td style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6">' . $jevNo . '</td>';
					$sheetJev .= '</tr>';
				}
				
				if($chargeType <= 1){
					
						$sheet2 .= '<tr>';
						$sheet2 .= '<td style = "text-align:right;"><span class = "label7">Program </span></td><td id = "saaobEncodeProgramCode" style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6">' . $programCode . '</td>';
						$sheet2 .= '</tr>';
						
						$sheet2 .= '<tr>';
						$sheet2 .= '<td style = "text-align:right;"><span class = "label7">Code  </span></td><td id = "saaobEncodeAccountCode" style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6">' . $accountCode . '</td>';
						$sheet2 .= '</tr>';
						
						$sheet2 .= '<tr>';
						$sheet2 .= '<td style = "text-align:right;"><span class = "label7">Amount<input id = "type' . $id . '" type = "hidden" value = "' . $trackingType . '-' . $chargeType . '"></span></td>
									<td id = "saaobEncodeAmount" style = "border-bottom:1px solid rgb(227, 234, 224);color:red;" class = "label6">' . number_format($amount,2) . '
									<div onclick = "editInLiquidated(this)" id = "theId' . $id . '" class = "label19a" style = "font-size:16px;display:inline-block;margin-bottom:3px;">Edit</div></td>';
						$sheet2 .= '</tr>';
					
					$sheet1 = '';
				}else {
					if($pCode == 1){
						$pCode = $programCode;
					}else{
						$pCode = '';
					}
					if($chargeType == 3){
						$pCode = $programCode;
					}
					$sheet1 .= '<tr>';
					$sheet1 .= '<td style = "padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">' . $pCode . '</td>';
					$sheet1 .= '<td style = "padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);" id ="code' . $id . '" >' . $accountCode . '</td>';
					$sheet1 .= '<td style = "padding:5px;text-align:right;padding-right:20px;border-bottom:1px solid rgb(227, 234, 224);" id = "amount' . $id . '" >' . number_format($amount,2) . '</td>';
					$sheet1 .= '<td style = "padding:5px;text-align:right;padding-right:20px;border-bottom:1px solid rgb(227, 234, 224);"><input id = "type' . $id . '" type = "hidden" value = "' . $trackingType . '-' . $chargeType . '">
								<div class = "label19" style = "font-size:14px;margin:2px;" id = "theId' . $id . '" onclick = "editInLiquidated(this)" >EDIT</div>
								</td>';
					
					$sheet1 .= '</tr>';
					
					
				}
				
				if($adv != 0){
					if($poMark != $trackingNumber){
						$row5++;
						if($row5 % 2 == 0){
							$sheet5 .= '<tr style = "background-color:rgb(231, 249, 223);">';
						}else{
							$sheet5 .= '<tr style = "background-color:rgb(246, 248, 247);">';
						}
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">' . $jevNo . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">' . $trackingNumber . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">' . $adv . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">
									<span style = "color:rgb(219, 77, 25);cursor:pointer;" onclick = "viewThisSAAOB(this)">' . $checkNumber . '</span></td>';
						
						$sheet5 .= '<td  style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);text-align:left;">' . $claimant . '
									<div style = "font-size:12px;color:rgb(47, 201, 50);"> ' . $claim  . '</div>' . '</td>';
						
						$sheet5 .= '<td style="padding:5px;text-align:left;border-bottom:1px solid rgb(227, 234, 224);">' . $programCode . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">' . $accountCode . '</td>';
						
						$sheet5 .= '<td style="padding:5px;text-align:right;border-bottom:1px solid rgb(227, 234, 224);">' . number_format($amount,2) . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);color:rgb(216, 60, 86);font-weight:bold;">' . $amountTotal . '</td>';
						$sheet5 .= '</tr>';
						$poMark = $trackingNumber;
					}else{
						if($row5 % 2 == 0){
							$sheet5 .= '<tr style = "background-color:rgb(231, 249, 223);">';
						}else{
							$sheet5 .= '<tr style = "background-color:rgb(246, 248, 247);">';
						}
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">&nbsp;</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">&nbsp;</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">&nbsp;</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">&nbsp;</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">&nbsp;</td>';
						$sheet5 .= '<td style="padding:5px;text-align:left;border-bottom:1px solid rgb(227, 234, 224);">' . $programCode . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">' . $accountCode . '</td>';
						
						$sheet5 .= '<td style="padding:5px;padding-left:10px;text-align:right;border-bottom:1px solid rgb(227, 234, 224);">' . number_format($amount,2) . '</td>';
						$sheet5 .= '<td style="padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);">&nbsp;</td>';
						$sheet5 .= '</tr>';
					}
					
				}
			}
			$sheet5 .= '</table>';
			
			if($chargeType > 1){
				$sheet1 .= '<tr>';
						$sheet1 .= '<td colspan = "3" style = "padding:5px;text-align:center;text-align:right;padding-right:20px;font-size:20px;color:red;"><span class ="label7">Total </span>' . $amountTotal . '</td>';
						$sheet1 .= '</tr>';
			}
			
			$sheet1 .= '</table>';
			
			$sheet = '<table style = "width:100%;border-spacing:0;border-top:4px solid rgb(240, 241, 231);">';
			
			$sheet .= '<tr>';
			$sheet .= '<td style = "width:150px;padding:15px 0px;; text-align:right;background-color:rgb(253, 251, 229);border-bottom:1px solid rgb(240, 241, 231);"><span  class = "label7">Status  </span></td>
						<td style = " background-color:rgb(253, 251, 229); font-weight:bold;border-bottom:1px solid rgb(240, 241, 231);" class = "label6"><span id = "saaobOBRstatus">' . $status . '</span>
						<span style = "font-size:14px;color:gray;letter-spacing:1px;font-weight:normal;">' . $dateReleased . '</span>
						<input id = "chargeTypeSAAOB" type = "hidden" value = "' . $chargeType . '"></td>';
			$sheet .= '</tr>';
			
			if($trackingType != 'PR'){
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:right;"><span class = "label7">Claimant  </span></td>
						   <td id = "saaobEncodeClaimant" style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6">' . $claimant  . '</td>';
				$sheet .= '</tr>';
			}
			
			$sheet .= '<tr>';
			$sheet .= '<td style = "text-align:right;vertical-align:top;"><span class = "label7">Claim  </span></td>
					   <td style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6">' . $claim . '</td>';
			$sheet .= '</tr>';
			
			$sheet .= '<tr>';
			$sheet .= '<td style = "text-align:right;"><span class = "label7">TN # </span></td>
							<td id = "saaobTrackingNo" style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6">' . $trackingNumber . '</td>';
			$sheet .= '</tr>';
			if($trackingType != 'PR'){
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:right;"><span class = "label7">ADV # </span></td><td style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6"><span id = "saaobOBRadv">' . $adv . '</adv></td>';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr>';
			$sheet .= '<td style = "text-align:right;"><span class = "label7">OBR # </span></td>
					   <td style = "border-bottom:1px solid rgb(227, 234, 224);font-weight:bold;color:red;" class = "label6"><span id = "saaobOBRNo" >' . $obrNumber . '</span>
					   </td>';
			$sheet .= '</tr>';
			
			$sheet .= '<tr>';
			$sheet .= '<td style = "text-align:right;"><span class = "label7">CHK # </span></td>
					   <td style = "border-bottom:1px solid rgb(227, 234, 224);" class = "label6"><span id = "saaobCHKNo" >' . $checkNumber . '</span>
					   <span style = "font-size:14px;color:gray;letter-spacing:1px;font-weight:normal;">' . $checkDate . '</span>
					   </td>';
			$sheet .= '</tr>';
			
			if($jevNo != ''){
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:right;"><span class = "label7">JEV #  </span></td><td style = "padding:7px 0px;font-size:16px;border-bottom:1px solid rgb(227, 234, 224);color:red;font-weight:bold;" class = "label6">' . $jevNo . '
							<span style = "font-size:14px;color:gray;letter-spacing:1px;font-weight:normal;">' . $jevDate . '</span></td>';
				$sheet .= '</tr>';
			}
			
			$sheet .= $sheet2;
		
			$sheet .= '</table>';
			
			
			
			
			$type = $pr + $po;
			if($type >= 2){
				return $sheet5;
			}else{
				return $sheet . $sheet1 ;
			}
			
			
			
		}
		function CreateAccountCodesHeader($record){
			$sheet1 = '';
			$sheet2 = '';
			$sheet2a = '';
			
			$sheet3 = '';
			$sheet3a = '';
			
			$sheet4 = '';
		
			$sheet5 = '';
			
			$i = 1;
			
			
			$totalObligated = 0;
			$totalLiquidated = 0;
			$totalAB = 0;
			$totalUnliquidated = 0;
			$totalSavings = 0;
			
			$j =1;
			while($data = $this->fetch_array($record)){
				$code = $data['AccountCode'];
				$title = $data['Title'];
				$annualBudget =  $data['AnnualBudget'];
				$obligated = $data['Obligated'];
				$liquidated =$data['Liquidated'];
				$savings = $data['Savings'];
				$unliquidated = $data['Unliquidated'];
				
				$totalObligated = ($totalObligated + $obligated);
				$totalLiquidated = ($totalLiquidated + $liquidated);
				$totalAB =  ($totalAB + $annualBudget);
				$totalUnliquidated =  ($totalUnliquidated + $unliquidated);
				$totalSavings =  ($totalSavings + $savings);
				
			   
				if($unliquidated < 0){
					$color ='red';
				}else{
					$color = 'grey';
				}
				if($savings < 0){
					$color1 ='red';
				}else{
					$color1 = 'grey';
				}
				
				
				if($i == 1){
					$sheet1 .= '<td style = "0px;"><div style = "position:absolute;background-color:whi1te;height:150px;width:87px;margin-left:-89px;margin-top:-20px;color:black;"><span class = "number">3</span><span class = "label3"  style = "font-size:16px;">Account</span></div></td>';
					$sheet2 .= '<td><div style = "display:none;font-size:12px;position:absolute;width:45px;margin-left:-70px;margin-top:-11px;padding:2px;padding-right:10px;background-color:rgb(223, 229, 223);border-right:1px solid silver;color:rgb(41, 164, 78);text-align:right;">DESC</div></td>';
					
					$sheet2a .= '<td style = "background-color:rgb(237, 242, 244);"><div style = "font-weight:bold; font-size:12px;position:absolute;width:55px;background-color:rgb(223, 229, 223); border-right:1px solid silver;color:rgb(41, 164, 78);margin-left:-75px;margin-top:-10px;padding:2px;padding-right:5px;text-align:right;">AB</div></td>';
					$sheet3 .= '<td style = "background-color:rgb(237, 242, 244);"><div style = "font-weight:bold; font-size:12px;position:absolute;width:55px;background-color:rgb(223, 229, 223); border-right:1px solid silver;color:rgb(41, 164, 78);margin-left:-75px;margin-top:-10px;padding:2px;padding-right:5px;text-align:right;">Obligated</div></td>';
					
					$sheet3a .= '<td style = "background-color:rgb(237, 242, 244);"><div style = "font-weight:bold; font-size:12px;position:absolute;width:55px;background-color:rgb(223, 229, 223); border-right:1px solid silver;color:rgb(41, 164, 78);margin-left:-75px;margin-top:-10px;padding:2px;padding-right:5px;text-align:right;">Savings</div></td>';
					
					$sheet4 .= '<td style = "background-color:rgb(237, 242, 244);"><div style = "font-weight:bold;font-size:12px;position:absolute;width:55px;background-color:rgb(223, 229, 223);border-right:1px solid silver;color:rgb(41, 164, 78);margin-left:-75px;margin-top:-10px;padding:2px;padding-right:5px;text-align:right;">Liquidated</div></td>';
				
					//$sheet5 .= '<td style = "background-color:rgb(237, 242, 244);">UnLqd</td>';
					$sheet5 .= '<td style = "background-color:rgb(237, 242, 244);"><div style = "font-weight:bold;font-size:12px;position:absolute;width:55px;background-color:rgb(223, 229, 223);border-right:1px solid silver;color:rgb(41, 164, 78);margin-left:-75px;margin-top:-10px;padding:2px;padding-right:5px;text-align:right;">UnLqd</div></td>';
					
					$i = 2;
				}
				$sheet1 .= '<td><div class = "headerCodes" onclick = "selectThisLiquidatedCode(this)" style = " border-top:1px solid rgb(239, 241, 239);border-left:1px solid rgb(239, 241, 239);   border-right:1px solid rgb(206, 213, 205);border-bottom:1px solid rgb(206, 213, 205);">' . $code . '</div></td>';	
				$sheet2 .= '<td style = "vertical-align:top;font-size:12px;padding-left:5px; background-color:rgb(217, 239, 214);padding:5px;padding-bottom:0px;"><span class ="number" style = "padding:0px 8px;font-size:12px;background-color:rgb(144, 177, 139);border-radius:3%;color:white;">' . $j . '</span>' . $title . '</td>';	
				
				$sheet2a .= '<td class ="label3" style = "font-size:14px;text-align:right;padding-right:10px;border-top:1px solid silver;">' . $this->zeroToNothing(number_format($annualBudget,2)) . '</td>';	
				$sheet3 .= '<td class ="label3" style = "color: green;font-size:14px;text-align:right;padding-right:10px;border-top:1px solid silver;">' . $this->zeroToNothing(number_format($obligated,2)) . '</td>';	
				$sheet3a .= '<td class ="label3" style = "font-size:13px;text-align:right;padding-right:10px;border-top:1px solid silver; color:' . $color1 . '">' . $this->zeroToNothing(number_format($savings,2)) . '</td>';	
				$sheet4 .= '<td class ="label3" style = "color: green;font-size:14px;text-align:right;padding-right:10px;border-top:1px solid silver;border-bottom:1px solid rgb(213, 211, 211);">' . $this->zeroToNothing(number_format($liquidated,2)) . '</td>';	
				$sheet5 .= '<td class ="label3" style = "font-size:13px;text-align:right;padding-right:10px;color:' . $color . ';">' . $this->zeroToNothing(number_format($unliquidated,2)) . '</td>';	
				$j++;
			}
			
			
			$sheet = '<table  style = "margin:2px;margin-bottom:5px;">';
			$sheet .= '<tr>' . $sheet1 . '</tr>';
			$sheet .= '<tr>' . $sheet2 . '</tr>';
			$sheet .= '<tr style = "background-color:rgb(216, 219, 216);">' . $sheet2a . '</tr>';
			
			$sheet .= '<tr style = "background-color:rgb(227, 234, 227)">' . $sheet3 . '</tr>';
			$sheet .= '<tr style = "background-color:rgb(216, 219, 216)">' . $sheet3a . '</tr>';
			
			$sheet .= '<tr style = "background-color:rgb(255, 255, 255)">' . $sheet4 . '</tr>';
			$sheet .= '<tr style = "">' . $sheet5 . '</tr>';
			$sheet .= '</table>';
			
			if($totalSavings < 0){
				$totalSavingsForm =   '<span style = "color:red;">' . 	number_format(($totalSavings),2) . '</span>' ;
			}else{
				$totalSavingsForm = $this->zeroToNothing(number_format($totalSavings,2));
			}
			
			if($totalUnliquidated < 0){
				$unliquidatedForm =   '<span style = "color:red;">' . 	number_format($totalUnliquidated,2) . '</span>' ;
			}else{
				$unliquidatedForm =  	$this->zeroToNothing(number_format($totalUnliquidated,2));
			}
			return $sheet . '~!~' . $j . '~!~' . $this->zeroToNothing(number_format($totalObligated,2)) . '~!~' . $this->zeroToNothing(number_format($totalLiquidated,2)) . '~!~' .  $unliquidatedForm  . '~!~' . number_format(($totalAB),2)    . '~!~' . $totalSavingsForm ;  
			
			
		}
		function CreateDisbursementFromLiquidated($record){
			$count = $this->num_rows($record);
			$sheet0 = '<table  border="0" style="border-spacing:1;width:100%;">
							<tr >
							<td class="tdSAAOBHeader3" style="width:35px;padding:5px; ">&nbsp;</td>
							<td class="tdSAAOBHeader3" style="width:76px;padding:5px;text-align:left;">TN#</td>
							<td class="tdSAAOBHeader3" style="width:51px;padding:5px;text-align:center;">ADV#</td>
							<td class="tdSAAOBHeader3" style="width:51px;padding:5px;text-align:center;">OBR#</td>
							<td class="tdSAAOBHeader3" style="width:51px;padding:5px;text-align:center;">Month</td>
							
							<td class="tdSAAOBHeader3" style="width:167px;padding:5px 0px;text-align:center;">JEV#</td>
							<td class="tdSAAOBHeader3" style="padding:5px;text-align:left;">Claimant</td>	
							<td class="tdSAAOBHeader3" style="width:137px;padding:5px 0px;text-align:center;">Amount</td>
							</tr>
						</table>';
			if($count > 0){
				$sheet = '<table id="tableLiquidated" style="border-spacing:1;width:100%;" border = "0">';
				
				
				$i = 1;
				while($data = $this->fetch_array($record)){
					
					if($data['ADV2'] > 0){
						$adv = $data['ADV2'];
					}else{
						$adv = $data['ADV1'];
					}
					$jevNo = $data['JevNo'];
					$obrMonth = number_format(substr($data['DateModified'],5,2));
					
					$class = '';
					if($jevNo == ""){
						$class = "noData";
					}else{
						
						$class = "withData";
					}
					
					$sheet .= '<tr  class = "rowColor ' . $class . '">';
					$sheet .= '<td style="width:34px;padding:5px;color:grey;text-align:center;border-right:1px solid rgb(227, 234, 224)">' . $i++ . '</td>';
					$sheet .= '<td style="width:75px;padding:5px;border-bottom:1px solid rgb(227, 234, 224);border-right:1px solid rgb(227, 234, 224);">' . $data['TrackingNumber'] . '</td>';
					$sheet .= '<td style="width:50px;background-color:rgb1(239, 239, 238);padding:5px;text-align:left;border-bottom:1px solid rgb(227, 234, 224);border-right:1px solid rgb(227, 234, 224);">' . $adv . '</td>';
					$sheet .= '<td style="width:50px;padding:5px;text-align:left;border-bottom:1px solid rgb(227, 234, 224);border-right:1px solid rgb(227, 234, 224);">' . $data['OBR_Number'] . '</td>';
					$sheet .= '<td style="width:50px;padding:5px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);border-right:1px solid rgb(227, 234, 224);">' . $obrMonth . '</td>';
					
					$sheet .= '<td style="width:166px;background-color:rgb1(239, 239, 238); padding:5px 0px;text-align:center;border-bottom:1px solid rgb(227, 234, 224);border-right:1px solid rgb(227, 234, 224);">' . $jevNo . '</td>';
					$sheet .= '<td style="padding:5px;border-bottom:1px solid rgb(227, 234, 224);border-right:1px solid rgb(227, 234, 224);">' . $data['Claimant'] . '</td>';
					$sheet .= '<td style="width:110px;background-color:rgb1(229, 234, 228);padding:5px;text-align:right;border-bottom:1px solid rgb(227, 234, 224);">' . number_format($data['Amount'],2) . '</td>';
					
					
					$sheet .= '</tr>';
				}
				$sheet .= '</table>';
			}else{
				$sheet = "<div style ='padding:20px'>No record found.</div>";
			}
			
			$sDate = '<table>
						<tr>
							<td>From</td>
							<td>
								<select>
									<option>1</option>
									<option>2</option>
									<option>3</option>
									<option>4</option>
									<option>5</option>
									<option>6</option>
									<option>7</option>
									<option>8</option>
									<option>9</option>
									<option>10</option>
									<option>11</option>
									<option>12</option>
								</select>
							</td>
							<td>
								<select>
									<option>1</option>
									<option>2</option>
									<option>3</option>
									<option>4</option>
									<option>5</option>
									<option>6</option>
									<option>7</option>
									<option>8</option>
									<option>9</option>
									<option>10</option>
									<option>11</option>
									<option>12</option>
									<option>13</option>
									<option>14</option>
									<option>15</option>
									<option>16</option>
									<option>17</option>
									<option>18</option>
									<option>19</option>
									<option>20</option>
									<option>21</option>
									<option>22</option>
									<option>23</option>
									<option>24</option>
									<option>25</option>
									<option>26</option>
									<option>27</option>
									<option>28</option>
									<option>29</option>
									<option>30</option>
									<option>31</option>
								</select>
							</td>
						</tr>
					</table>';
			
			$sheet1 = '<table border="0" style="border-spacing:0;margin:0 auto;width:400px;">
						<tr>
							<td colspan = "2" style = "border-bottom:1px solid rgb(231, 234, 231);"><span class = "number">4</span><span class = "label2">View Options</span></span>
						</tr>
						<tr>
							<td style = "text-align:right;width:100px;padding-top:15px;"><span class = "label1">Display</span></td>
							<td style = "text-align:center;padding-top:15px;">
								<span style = "margin-right:20px;">
									<input type="radio" name="selectDisplayType" id="l1" class="radio1" checked onclick="showHideRow(this)" />
									<label  for="l1" class = "labelOption2">All</label>
								</span>
								<span style = "margin-right:20px;">
									<input  type="radio" name="selectDisplayType" id="l2" class="radio1" onclick="showHideRow(this)" />
									<label  for="l2" class = "labelOption2">JEV</label>
								</span>
								<span>
									<input  type="radio" name="selectDisplayType" id="l3" class="radio1" onclick="showHideRow(this)" />
									<label  for="l3" class = "labelOption2">None</label>
								</span>
							</td>
						</tr>
						<tr id = "trMonth" style = "display:none;">
							<td style = "text-align:right;vertical-align:top;padding:10px 0px;background-color:rgb(247, 250, 250);"><span class = "label1">Selection</span></td>
							<td style = "text-align:center;padding:10px 0px;background-color:rgb(247, 250, 250);">
								<table id = "tableMonth" border = "0" style = "margin:0 auto;width:250px;background-color:rgb(240, 241, 240);padding:0px;">
									<tr>
										<td class = "tdMonth"><input type = "checkbox" id = "mJan" onclick = "filterMonth(this)"><label  for="mJan" class = "label3">Jan</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mFeb" onclick = "filterMonth(this)"><label  for="mFeb" class = "label3">Feb</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mMar" onclick = "filterMonth(this)"><label  for="mMar" class = "label3">Mar</label></td>	
									</tr>
									<tr>
										<td class = "tdMonth"><input type = "checkbox" id = "mApr" onclick = "filterMonth(this)"><label  for="mApr" class = "label3">Apr</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mMay" onclick = "filterMonth(this)"><label  for="mMay" class = "label3">May</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mJun" onclick = "filterMonth(this)"><label  for="mJun" class = "label3">Jun</label></td>	
									</tr>
									<tr>
										<td class = "tdMonth"><input type = "checkbox" id = "mJul" onclick = "filterMonth(this)"><label  for="mJul" class = "label3">Jul</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mAug" onclick = "filterMonth(this)"><label  for="mAug" class = "label3">Aug</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mSep" onclick = "filterMonth(this)"><label  for="mSep" class = "label3">Sep</label></td>	
									</tr>
									<tr>
										<td class = "tdMonth"><input type = "checkbox" id = "mOct" onclick = "filterMonth(this)"><label  for="mOct" class = "label3">Oct</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mNov" onclick = "filterMonth(this)"><label  for="mNov" class = "label3">Nov</label></td>
										<td class = "tdMonth"><input type = "checkbox" id = "mDec" onclick = "filterMonth(this)"><label  for="mDec" class = "label3">Dec</label></td>	
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan ="2" style = "padding:2px;"></td>
						</tr>
						<tr>
							<td style = "text-align:right;width:100px;"></td>
							<td style = "border-top:1px solid rgb(231, 234, 231);">
								<table border ="0" style = "float:right;margin-right:20px;margin-top:15px;">
									<tr>
										<td style = "text-align:right;border-bottom:1px solid rgb(235, 239, 235);"><span id = "monthlyRow" style = "font-size:17px;font-weight:bold;font-style:italic; " ></span><span id  = "rowLabel" style = "color:grey;font-style:italic; font-size:12px;">&nbsp;Row&nbsp;</span></td>
									</tr>
									<tr>
										<td><span id = "monthlyTotal" style = "font-size:18px;color:rgb(194, 18, 65);font-weight:bold;letter-spacing:1px;" ></span><span id  = "rowLabel" style = "color:grey;font-size:12px;">&nbsp;Total</span></td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan = "2" style = "border-bottom:1px solid rgb(231, 234, 231);"><span class = "number">5</span><span class = "label2">Convert to Excel Consolidated</span></td>
						</tr>
						<tr>
							<td colspan = "2" style = "padding-top:20px;"><div class = "button1" style ="font-size:14px;" onclick = "SaveToExcel()">Save</div>
						</tr>
						<tr>
							<td colspan = "2" style = "border-bottom:1px solid rgb(231, 234, 231);"><span class = "number">6</span><span class = "label2">Convert to Excel Periodic</span></td>
						</tr>
						<tr>
							<td colspan = "2" style = "padding-top:20px;">
								<div>
									<table style = "padding:15px;margin:10px auto;padding-bottom:25px;background-color:rgb(229, 236, 233);  ">
										<tr>
											<td>From</td>
											<td><input id = "fromDate" maxlength = "10" class = "select2" style = "font-size:16px;width:105px;text-align:center;font-weight:bold;"/></td>
											<td>To</td>
											<td><input id = "toDate" maxlength = "10"  class = "select2" style = "font-size:16px;width:105px;text-align:center;font-weight:bold;"/></td>
										</tr>
										<tr>
											<td colspan = "4" style = "padding-top:15px;text-align:center;"><i>Format search Month-Day</i> (2018-04-20)</td>
										</tr>
									</table>
								</div>
								<div class = "button1" style ="font-size:14px;" onclick = "SaveToExcelPeriodically()">Save</div>
							</td>
						</tr>
						
						<tr>
							<td colspan = "2" style = "border-bottom:1px solid rgb(231, 234, 231);">
								<span class = "number">7</span><span class = "label2">View Summary</span>
							</td>
						</tr>
						<tr>
							<td colspan = "2" style = "padding-top:20px;"><div class = "button1" style ="font-size:14px;" onclick = "PreviewSummarySAAOB()">Preview</div></td>
						</tr>
					   </table>'; 
			
			$sheet2 = '<table border="0" style="width:100%;">
						<tr>
							<td>
								<div style = "">' . $sheet0 . '</div>
								<div style = "height:630px;overflow-y:scroll;">' . $sheet . '</div>
							</td>
							<td  width = "500px" style = "vertical-align:top;">' . $sheet1 . '</td>
						</tr>
					   </table>'; 
			
			
			

			return $sheet2;
			
		}
		
		function CreateCategoryList($record){
			$sheet1 = '<table style = "border-spacing:0;width:400px; " border ="0">';
			$sheet1 .= '</tr>';
			$sheet1 .= '<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;width:255px;background-color:rgb(121, 137, 141);">Category</td>
						<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Item/s</td>';
			$sheet1 .= '</tr>';
			$sheet1 .= '</table>';
						
			$sheet = '<table id ="tableSelectCategory" style = "border-spacing:0;width:400px;  " border ="0">';
			while($data = $this->fetch_array($record)){
				$sheet .= '<tr>';
				$sheet .= '<td style = "width:10px;padding:10px;border-bottom:1px solid rgb(225, 229, 231);"><input type = "checkbox"  onclick = "getCategoryItems(this)"/></td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:1px solid rgb(225, 229, 231);">' . $data['Category'] . '</td>';
				$sheet .= '<td style = "width:100px;padding:0 10px;border-bottom:1px solid rgb(225, 229, 231);">' . $data['Count'] . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			
			$sheet0 = '<div style = "border-left:1px solid rgb(225, 229, 231); width:398px;height:200px;overflow:hidden; overflow-y:scroll;background-color:white;">';
			$sheet2 = '</div>';
			
			$sheet3 = '<table id = "tableMonth" border = "0" style = "margin:0 auto;width:250px;background-color:rgb(240, 241, 240);">
									<tr>
									    <td class = "tdHeader1" colspan = "3" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Schedule</td>
									</tr>
			
									<tr>
										<td class = "tdMonth">
											<input id="m1" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m1">Jan</label>
										</td>
										<td class = "tdMonth">
											<input id="m2" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m2">Feb</label>
										</td>
										<td class = "tdMonth">
											<input id="m3" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m3">Mar</label>
										</td>
									</tr>
									<tr>
										<td class = "tdMonth">
											<input id="m4" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)" name="selectMonth">
											<label class="labelOption2" for="m4">Apr</label>
										</td>
										<td class = "tdMonth">
											<input id="m5" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m5">May</label>
										</td>
										<td class = "tdMonth">
											<input id="m6" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m6">Jun</label>
										</td>	
									</tr>
									<tr>
										<td class = "tdMonth" >
											<input id="m7" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m7">Jul</label>
										</td>
										<td class = "tdMonth">
											<input id="m8" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m8">Aug</label>
										</td>
										<td class = "tdMonth">
											<input id="m9" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m9">Sep</label>
										</td>		
									</tr>
									<tr>
										<td class = "tdMonth">
											<input id="m10" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m10">Oct</label>
										</td>
										<td class = "tdMonth">
											<input id="m11" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m11">Nov</label>
										</td>
										<td class = "tdMonth">
											<input id="m12" class="radio2" type="radio" onclick="getCategoryItemsByMonth(this)"  name="selectMonth">
											<label class="labelOption2" for="m12">Dec</label>
										</td>	
									</tr>
								</table>';
								
			$sheet4 = '<table style = "margin:0 auto; background-color:rgb1(246, 249, 251);padding:10px 20px;">
						  <tr>
						  	<td style ="box-shadow:0px 0px 2px 0px grey;padding:5px;">' . $sheet1 . $sheet0  . $sheet .$sheet2 .'</td>
							<td style ="padding:10px;"></td>
							<td style = "vertical-align:top;box-shadow:0px 0px 2px 0px grey;padding:3px 5px;">' . $sheet3 .'</td>
							
						  </tr>
					   </table>';					
			
			return  $sheet4;	
		}
		function CreateCategoryItems($record){		
			$sheet = '<table id = "prItemsTable" style = "border-spacing:0;" border ="0">';
			$sheet .= '<tr>';
			$sheet .= '<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px; background-color:rgb(121, 137, 141);">&nbsp;</td>
						<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Code</td>
						
						
						<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Description</td>
						<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">&nbsp;</td>
						<td colspan = "5" class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Qty x Price</td>';
			$sheet .= '</tr>';	
			$i = 1;
			$totalAmount = 0;
			while($data = $this->fetch_array($record)){
				
				$amount =  $data['amount'];
				$qtyX =  $data['quantity'];
				$qty =  $data['qty'];
				
				$price = $amount / $qtyX;
				$price = round($price,2);
				
				$amountX =  $qty * $price;
				$totalAmount += $amountX;
				$sheet .= '<tr style = "background-color:rgb(239, 242, 244);">';
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
							<span class = "number" 
								style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">' . $i++ . '</span></td>';
				
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
							<input onclick = "clickInput(this)" style = "font-weight:bold;font-size:12px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;" value ="' . $data['program_code'] . '"/>
							<input onclick = "clickInput(this)" style = "font-size:12px;width:80px;border:0;background-color:transparent;" value = "' . $data['account_code'] . '"/></td>';
				
				$sheet .= '<td style = "width:450px;padding:10px 10px;border-bottom:2px solid white;">
						  <div style = "background-color: rgb(220, 234, 242); font-size:12px;">' . strtoupper($data['item_category']) . '</div>' .
						  '<textarea onclick = "this.style.backgroundColor=\'white\';" style = "width:100%;font-size:14px; resize:vertical; " class = "select2">' . $data['item_description'] . '</textarea>' . '</td>';
				$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
							<input onclick ="selectCalculateAddPR(this)" type = "checkbox" checked/>
						   </td>';
				$sheet .= '<td style = "border-bottom:2px solid white;width:10px;">
								<input onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value = "' . $qty . '" maxlength = "8" 
										style = "color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:14px;border-bottom:1px solid silver;background-color:transparent;padding:2px;"/>
						   		<br/>
								<input onclick = "clickInput(this)" value = "' . $data['quantity_unit'] . '" style = "color:grey; font-size:14px;border:0;background-color:transparent; text-align:center;width:85px;"/>
						   </td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
				                x
						   </td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
							<input onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value  = ' . number_format($price,2) . '  
							style = "color:rgb(45, 90, 118);text-align:left;font-weight:bold;width:90px;border:0;font-size:14px;
									background-color:transparent;padding:2px;"/></td>';
				$sheet .= '<td style = "width:20px;border-bottom:2px solid white;">=</td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
							<input value = ' . number_format($amountX,2) . ' disabled 
							  style = "background-color:rgb(220, 228, 232);  width:100px;text-align:right;color:black;border:0;font-size:14px;;padding:5px; 2px;"/></td>';
				$sheet .= '</tr>';	
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan = "7"></td><td colspan ="2"  style = "padding:5px  10px;border-top:4px  double silver;">
					   <input id ="totalAmountItems" value = ' . number_format($totalAmount,2) . ' disabled 
					   style = "font-size:14px;border:0;background-color:transparent;width:120px;text-align:right;font-weight:bold;letter-spacing:1px;color:rgb(7, 90, 142);"/>	
					   </td>';
			$sheet .= '</tr>';
			
			$sheet .= '</table>';
			$sheet0 = '<div style = " ">';
			$sheet2 = '</div>';
			return   $sheet0  . $sheet .$sheet2 ;	
		}
	function CreateCategoryItemsEdit($record){		
		$office = $_SESSION['gso'];
		$acct = $_SESSION['accountType'];
		$sheet = '<table id = "prItemsTable" style = "border-spacing:0; margin-bottom:20px;" border ="0">';
		$sheet .= '<tr class ="dataHeader1">';
		$sheet .= '<td style = "padding:5px 10px;font-size:18px; background-color:grey;">&nbsp;</td>
					<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Code</td>
					<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Description</td>
					<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">&nbsp;</td>
					<td colspan = "5"  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Qty x Price</td>
					<td  style = "padding:5px 10px;font-size:22px; background-color:rgb(108, 111, 113);cursor:pointer;" onclick = "AddPRItem(this)">+</td>';
		$sheet .= '</tr>';	
		$i = 1;
		$totalAmount = 0;
		while($data = $this->fetch_array($record)){
			
			$id = $data['Id'];
			$trackingNumber = $data['TrackingNumber'];
			$trackingType = substr($trackingNumber,0,2);
			$amount =  $data['Amount'];
			$total = $data['Total'];
			
			
			$qty =  intval($data['Qty']);
			$unit =  $data['Unit'];
			$item =  $data['ItemDescription'];
			$itemId =  $data['ItemId'];
			
			$desc =  $data['Description'];
			$program =  $data['ProgramCode'];
			$code =  $data['Code'];
			$category = $data['Category'];
			$totalAmount = $totalAmount + $total;
			
			
			$sheet .= '<tr  style = "background-color:rgb(206, 215, 218);">';
			$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
						<span class = "number" 
							style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">' . $i++ . '</span></td>';
			
			if($trackingType == "PR"){
				$sheet .= '<td  style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
						<input class = "data1" onclick = "clickInput(this)" style = "font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;" value ="' . $program . '"/>
						<input class = "data1" onclick = "clickInput(this)" style = "display:block;font-size:14px;width:80px;border:0;background-color:transparent;" value = "' . $code . '"/></td>';
				
				$sheet .= '<td style = "width:450px;padding:10px 10px;border-bottom:2px solid white;font-family:Oswald;">
							<div style = "text-align:right;" ><span style ="font-size:12px;">Category Code : </span><input class = "catcat" onkeyup = "changeCat(this)" maxlength = "8" style = "width:200px;font-family:Oswald;padding-left:5px;border:1px solid silver; background-color:transparent;font-size:12px;background-color:white;" value = "' . strtoupper($category) . '"/></div>
							<div style = "text-align:right;"><span style ="font-size:12px;">
							<input id = "itemA' . $id . '" type = "hidden" value = "' . $itemId . '" />Additional details :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item Name : </span>
							<input  id = "itemB' . $id . '"  style = "width:200px;font-family:Oswald;padding-left:5px;border:1px solid silver; background-color:transparent;font-size:12px;background-color:white;" value = "' .  $item . '"   onclick = "viewItemList(this)"/></div>
							<textarea id = "itemC' . $id . '"  onclick = "this.style.backgroundColor=\'white\';" style = "margin-top:5px;border:1px solid silver;width:100%;font-size:14px; resize:vertical;padding:2px;padding-left:5px; " class = "data1">' . $desc . '</textarea></td>';
			}else{
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
						<input class = "data1"  onclick = "clickInput(this)"  style = "font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;color:black;" value ="' . $program . '"/>
						<input class = "data1"  onclick = "clickInput(this)" style = "color:black;display:block;font-size:14px;width:80px;border:0;background-color:transparent;" value = "' . $code . '"/></td>';
				
				/*$sheet .= '<td style = "width:450px;padding:10px 10px;border-bottom:2px solid white;">
						<div style = "background-color: rgb(220, 234, 242); font-size:12px;"><input  class = "data1"   disabled style = "border:0; background-color:transparent;display:none;" value = "' . strtoupper($category) . '"/></div>' .
						'<textarea onclick = "this.style.backgroundColor=\'white\';" style = "width:100%;font-size:17px; resize:vertical;padding-left:5px; " class = "data1">' . $desc . '</textarea>' . '</td>';*/
				$sheet .= '<td style = "width:450px;padding:10px 10px;border-bottom:2px solid white;font-family:Oswald;">
							<div style = "text-align:right;" ><span style ="font-size:12px;">Category Code : </span><input  style = "width:200px;font-family:Oswald;padding-left:5px;border:1px solid silver; background-color:transparent;font-size:12px;background-color:white;" readonly value = "' . strtoupper($category) . '"/></div>
							<div style = "text-align:right;"><span style ="font-size:12px;">
							<input id = "itemA' . $id . '" type = "hidden" value = "' . $itemId . '" />Item Name : </span>
							<input  id = "itemB' . $id . '"  style = "width:200px;font-family:Oswald;padding-left:5px;border:1px solid silver; background-color:transparent;font-size:12px;background-color:white;" value = "' .  $item . '"   onclick = "viewItemList(this)"/></div>
							<textarea id = "itemC' . $id . '"  onclick = "this.style.backgroundColor=\'white\';" style = "margin-top:5px;border:1px solid silver;width:100%;font-size:14px; resize:vertical;padding:2px;padding-left:5px; " class = "data1">' . $desc . '</textarea></td>';
			}
			
			
			
						
			/*if($office == '1081' and $acct >1 ){
				$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
						<input  disabled onclick ="selectCalculateAddPRtracker(this)" type = "checkbox" checked/>
						</td>';
			}else{
				$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
						<input  onclick ="selectCalculateAddPRtracker(this)" type = "checkbox" checked/>
						</td>';
			}		*/ 
			$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
						<input  onclick ="selectCalculateAddPRtracker(this)" type = "checkbox" checked/>
						</td>';
			
			$sheet .= '<td style = "border-bottom:2px solid white;width:10px;">
							<input class = "data1"  onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value = "' . $qty . '" maxlength = "8" 
									style = "color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:16px;border-bottom:1px solid silver;background-color:transparent;padding:2px;"/>
							<br/>
							<input class = "data1"  onclick = "clickInput(this)" value = "' . $unit . '" style = " font-size:16px;border:0;background-color:transparent; text-align:center;width:85px;"/>
						</td>';
			$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
							x
						</td>';
			$sheet .= '<td style = "padding:0 2px;border-bottom:2px solid white;">
						<input class = "data1"  onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value  = ' . number_format($amount,2) . '  
						style = "color:rgb(45, 90, 118);text-align:left;font-weight:bold;width:90px;border:0;font-size:16px;
								background-color:transparent;padding:2px;"/></td>';
			$sheet .= '<td style = "width:20px;border-bottom:2px solid white;">=</td>';
			$sheet .= '<td style = "padding:0 5px;border-bottom:2px solid white;">
						<input class = "data1" value = ' . number_format($total,2) . ' disabled 
							style = " width:105px;text-align:left;color:black;border:0;font-size:17px;padding:5px; 2px;font-weight:bold;"/></td>';
							
			$sheet .= '<td style = "border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">&nbsp;</td></tr>';	  
			$sheet .= '</tr>';	
		}
		$sheet .= '<tr>';
		$sheet .= '<td colspan = "7"></td><td colspan ="2"  style = "padding:2px  10px;padding-right:20px;">
					<input class = "data1" id ="totalAmountItems" value = ' . number_format($totalAmount,2) . ' disabled 
					style = "font-size:20px;border:0;background-color:transparent;width:120px;text-align:right;font-weight:bold;letter-spacing:1px;color:red;"/>	
					</td>';
		$sheet .= '</tr>';
		$sheet .= '</table>';

		// TERMS AND CONDITIONS sa PR and PO - 2023-06-21
		$sql = "SELECT Header, Terms FROM particulars WHERE TrackingNumber = '".$trackingNumber."' LIMIT 1";
		$record1 = $this->query($sql);
		$data = $this->fetch_array($record1);
		$terms = $data['Terms'];
		$prHeader = $data['Header'];

		$sheet .= $this->CreateHeaderNewSheet('editPR', $prHeader);
		$sheet .= "<br></br>";
		$sheet .= $this->CreateTermsNConditionsSheet('editPR', $terms);

		$sheet .= '<div style = "text-align:center; margin-top:40px;"><div style = "width:60px;font-size:16px;display:inline-block;margin-right:10px;" class  = "button1" onclick = "cancelEditPR(this)" id = "editPR' . $trackingNumber  .'">Cancel</div>
					<div style = "width:60px;font-size:16px;display:inline-block;" class  = "button1" onclick = "updatePR()" >Update</div>
					<input id = "prEditTracking" type = "hidden" value = "' . $trackingNumber . '"></div>';
		
		$sheet0 = '<div style = " ">';
		$sheet2 = '</div>';
		return   $sheet0  . $sheet . $sheet2 . '*v*'  ;	
	}




	function CreateOBRAmountEdit($record, $type, $office, $acct){		
		
		$sheet = '<table id = "obrItemsTable" style = "border-spacing:0;margin:0 auto;" border ="0">';
		$sheet .= '<tr>';
		$sheet .= '<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px; background-color:rgb(121, 137, 141);">&nbsp;</td>
					
					<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Program</td>
					<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Code</td>
					<td class = "tdHeader1" style = "text-align:center;padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Amount</td>
					<td class = "tdHeader1" style = "padding:5px 10px;font-size:18px; background-color:rgb(108, 111, 113);cursor:pointer;" onclick = "AddOBR()">+</td>
					';

		$sheet .= '</tr>';	
	
		$totalAmount = 0;
		$sub = 0;

		
		// if($type == 2){
		// 	if($office == "PSCC"||$office == "104A"||$office == "LSBD"||$office == "TMCD"||$office == "8731"||$office == "4411"||$office == "8852"||$office == "CARC"||$office == "ANSU"||$office == "DISA"||$office == "VIRU"||$office == "PESO"||$office == "911C"||$office == "REHA"||$office == "1014"||$office == "1091"||$office == "PAOH"||$office == "SOCC"||$office == "9993"||$office == "RPO1"||$office == "MTCC"||$office == "COA1"||$office == "HALL"){
		// 		$disabled = "";
		// 	}else{
		// 		$disabled = "disabled";
		// 	}
		// }

		// if($office == "1081"||$office == "1071"){
		// 	if($acct == 2 || $acct == 4 || $acct == 7){
		// 		$disabled = "";
		// 	}
		// }


		while($data = $this->fetch_array($record)){
			$office = $data['Office'];	
			$trackingNumber = $data['TrackingNumber'];
			$title = $data['Title'];
			$name = $data['Name'];
			
			$amount =  $data['Amount'];
			$program =  $data['PR_ProgramCode'];
			$code =  $data['PR_AccountCode'];
			$subCode = $data['SubCode'];
			if($subCode > 0){
				$sub = $subCode;
			}
			$peorId = $data['PeaceOfficeId'];
			$docType = $data['DocumentType'];
			$totalAmount = $totalAmount + $amount;


			$disabled = "";
			if($type == 2){
				if($office != "COA1" && $office != "STEP" && $office != "ROD1" && $office != "PEFI"){
					if(substr($docType, 0, 5) == "WAGES" || (substr($docType, 0, 8)  == "BENEFITS" && $docType != "BENEFITS - ELAP") || substr($docType, 0, 9)  == "ALLOWANCE"){
						$disabled = "disabled";
					}
				}
			}

			if($_SESSION['cbo'] == '1071' && $_SESSION['accountType'] != 1) {
				$disabled = "";
			}

			// 2023-09-27 - gi-add para kay HRMO LINGAP pag mag change ug charges kay ma-change ang net so gi-apil pud ni para dli siya mka change ug amount.
			if($office == 'LING') {
				$disabled = "disabled";
			}

			$sheet .= '<tr style = "background-color:rgb(239, 242, 244);">';
			$sheet .= '<td style = "padding:10px 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
						<input  onclick ="removeOBR(this)" type = "checkbox" checked/>
					   </td>';
			$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;text-align:center;width:260px;vertical-align:top;">
						<div onclick = "clickInputProgram(this)" class = "select2" style = "width:95%;font-size:16px;text-align:left;background-color:white;">' . $program .  '<br/><span style = "color:rgb(64, 179, 219);"> ' . $name . '</span></div>
					</td>
					<td style = "padding:10px 10px;text-align:center;border-bottom:2px solid white;width:260px;vertical-align:top;">
						<div onclick = "clickInputAccount(this)"  class = "select2" style = "width:95%;font-size:16px;text-align:left;background-color:white;" >' . $code . '<br/><span style = "color:rgb(64, 179, 219);"> ' . $title . '</span></div>
					</td>
					<td style = "padding:10px 10px;text-align:center;border-bottom:2px solid white;vertical-align:top;">
						<input onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup="calculateAddOBR(this)" maxlength ="15"  class = "select2" style = "padding-right:10px;font-size:18px;width:95%;text-align:right;" value = "' . $amount . '" '.$disabled.'/>
					</td>';
			$sheet .= '<td style = "border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">&nbsp;</td></tr>';
		}
		
		$sheet .= '<tr>';
		$sheet .= '<td colspan = "2" style = "border-top:1px solid rgb(226, 223, 223);"></td><td style = "border-top:1px solid rgb(226, 223, 223);" colspan ="2" >
					<input id ="totalAmountItems" value = ' . number_format($totalAmount,2) . ' disabled style = "width:100%; font-size:18px;text-align:right;font-weight:bold;letter-spacing:1px;color:rgb(7, 90, 142);padding-right:10px;background-color:transparent;border:0;"/>	
				   </td><td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-top:1px solid rgb(226, 223, 223);">&nbsp;</td> ';
		$sheet .= '</tr>';
		
	
		$sheet .= '<tr>  
							<td colspan = "5" style = "text-align:center;">
							<div style = "width:60px;font-size:16px;display:inline-block;margin-right:10px;" class  = "button1" onclick = "cancelEditPR(this)" id = "editOBR' . $trackingNumber  .'">Cancel</div>
							<div style = "width:60px;font-size:16px;display:inline-block;" class  = "button1" onclick = "updateOBR()" >Update</div>
							<input id = "obrEditTracking" type = "hidden" value = "' . $trackingNumber . '"/>
					  </td>';
		$sheet .= '</tr>';
		$sheet .= '</table>';
		if($type == 2){
			$sheet .= "<input id='selectDocTypeWGS1' style='display:none;' value='".$docType."' disabled>";
		}

		
		if($sub > 0){
			// $sql = "select * from subprogramcode order by description asc";
			// $record = $this->query($sql);
			// $sheet2 = '';
			// while($data = $this->fetch_array($record)){
			// 	$code = $data['SubCode'];
			// 	$des = $data['Description'];
			// 	if($sub == $code){
			// 		$opt = '<option value = "' . $code . '">' . $des . '</option>';
			// 	}else{
			// 		$sheet2 .= '<option value ="' . $code . '">' . $des . '</option>';
			// 	}
				
			// }
			// $sheet1 = ' <select id  = "editOBRsubCodeSelect" style = "padding:5px;font-family:Oswald;font-size:20px;width:200px;">';
			// $sheet1 .= $opt;
			// $sheet1 .= $sheet2;
			// $sheet1 .= '</select>';
			
			// $sheet .= '<div id = "editSubContainer" style = "font-family:Oswald;font-size:20px;background-color:rgb(236, 232, 232);margin-top:30px;padding:5px;">
			// 			<span>Select Sub Program</span>' . $sheet1 . '</div>';

			$sql = "SELECT * FROM peace WHERE OfficeId = '".$peorId."' and Code = '".$sub."' LIMIT 1";
			$record = $this->query($sql);
			$data = $this->fetch_array($record);
			$peorId = $data['OfficeId'];
			$peorSub = $data['Code'];
			$peorName = $data['Name'];
			$peorFund = $data['Fund'];

			$sheet1 = "<table id='peorCodeRow' border='0' cellpadding='0' cellspacing='0' style='width:100%; padding:20px 0px;'>
							<tr>
								<td style='width:130px;'>Select&nbsp;Sub&nbsp;Code</td>
								<td>
									<input id='peorSubCodeEDIT' type ='hidden' value='".$peorSub."'/>
									<input id='peorOfcIdEDIT' type ='hidden' value='".$peorId."'/>
									<div class = 'data2 checkPY' style = 'text-align: left;padding-left:10px;font-weight: bold;text-transform:uppercase; cursor:pointer; height:26px; width:95%; border:0px; border-bottom:1px solid black;'  id  = 'peorCodesEDIT'  onclick='showSubCodeSelectionEdit(\"EDIT\")'>
										<span style='color:rgb(35, 116, 157);'>".$peorName."</span> ".$peorFund."
									</div>
								</td>
							</tr>
						</table>";

			$sheet .= "<div id='editSubContainer' style=''>".$sheet1."</div>";
		}else{
			// $sheet .= '<div id = "editSubContainer" style = "display:none; font-family:Oswald;font-size:20px;background-color:rgb(236, 232, 232);margin-top:30px;padding:5px;">
			// 			<span>Select Sub Program</span>
			// 			<select id  = "editOBRsubCodeSelect" style = "padding:5px;font-family:Oswald;font-size:20px;width:200px;">
			// 				<option value ="0">&nbsp;</option>
			// 			</select>
			// 	   </div>';
			$sheet .= "	<div id='editSubContainer' style='display:none;'>
							<input id='peorSubCodeEDIT' type ='hidden' value='0'/>
							<input id='peorOfcIdEDIT' type ='hidden' value='0'/>
						</div>";
		}
		
		
		
		
		if($_SESSION['perm'] == 31 || $_SESSION['perm'] == 46){
			$sql = "SELECT a.OfficeCode,a.ProgramCode,a.AccountCode,b.Name FROM funds a left join programcode b on a.ProgramCode = b.Code 
					group by a.ProgramCode ";
		}else{
			$sql = "SELECT a.OfficeCode,a.ProgramCode,a.AccountCode,b.Name FROM funds a left join programcode b on a.ProgramCode = b.Code 
					where a.OfficeCode = '" . $office . "' or a.OfficeCode = 'LUMP' group by a.ProgramCode ";
		}
		
		/*	$sql = "SELECT a.OfficeCode,a.ProgramCode,a.AccountCode,b.Name FROM funds a left join programcode b on a.ProgramCode = b.Code 
					where a.OfficeCode = '" . $office . "' or a.OfficeCode = 'LUMP' group by a.ProgramCode ";*/
					
					
					
					
		$record = $this->FetchThis($sql);
		$fundSelect = '<div  id = "fundHidden" style = "display:none;"><select class = "select2" style = "width:95%;font-size:16px;" onchange = "checkProgram(this)">';
		$fundSelect .= '<option ></option>';
		while($data = $this->fetch_array($record)){
			$fundSelect .= '<option value = "' . $data['ProgramCode'] . '">' . $data['ProgramCode'] . '  ' . $data['Name'] . '</option>';
		}
		$fundSelect .= '</select></div>';
		
		$sql = "SELECT a.AccountCode,b.Title FROM funds a left join fundtitles b on a.AccountCode = b.Code where a.OfficeCode = '" . $office . "' or   a.OfficeCode = 'LUMP'  group by a.AccountCode order by b.Title ";
		$record = $this->FetchThis($sql);
		$accountSelect = '<div  id = "accountHidden" style = "display:none;"><select class = "select2" style = "width:95%;font-size:16px;"  onchange = "checkPair(this)"  >';
		$accountSelect .= '<option ></option>';
		while($data = $this->fetch_array($record)){
			$accountSelect .= '<option value = "' . $data['AccountCode'] . '">' . $data['AccountCode'] . '  ' . $data['Title'] . '</option>';
		}
		$accountSelect .= '</select></div>';
		$sheet .= $fundSelect .$accountSelect;
		
		$sheet0 = '<div style = " ">';
		$sheet2 = '</div>';
		return   $sheet0  . $sheet . $sheet2 . '*v*' ;
			
	}

	


		function CreatePRgendetails($record){		
			$data = $this->fetch_array($record);
			$trackingNumber = $data['TrackingNumber'];
			$prNumber = $data['PR_Number'];
			$obrNumber = $data['OBR_Number'];
			$description  = $data['Description'];
			
			$prMonth = $data['PR_Month'];
			if($prMonth == 1){
				$prMonth = "1st Quarter";
			}else if($prMonth == 4){
				$prMonth = "2nd Quarter";
			}else if($prMonth == 7){
				$prMonth = "3rd Quarter";
			}else{
				$prMonth = "4th Quarter";
			}
			$monthName = $prMonth;
			//$monthName = $this->numberToMonth($prMonth);
			
			$chargeType = $data['ChargeType'];
			if($chargeType == 4){
				$category = "Multiple";
			}else{
				$category = $data['PR_CategoryCode'];
			}
			$fund = $data['Fund'];
			
			$sheet  = '<table style = "margin:5px auto;margin-bottom:20px;padding-bottom:5px;" >';
			$sheet  .= '<tr>
						<td style = "text-align:right;"><span class = "data1">TN #</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span id = "prTrackingNumber" class = "data1" style = "font-weight:bold;">' . $trackingNumber . '</span></td>
						<td rowspan = "3" style = "padding:0px 20px;"></td>
						<td style = "text-align:right;"><span class = "data1">Fund</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span id  = "fundType" class = "data1" style = "font-weight:bold;">' . $fund . '</span></td>
					  </tr>';
			$sheet  .= '<tr>
						<td style = "text-align:right;"><span class = "data1">PR  #</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span id = "prNumber" class = "data1" style = "font-weight:bold;">' . $prNumber . '</span></td>
						<td style = "text-align:right;"><span class = "data1">Quarter</span></td>
						<td id ="prMonth" style = "border-bottom:1px solid silver;padding:2px 10px;"><span id ="prMonth' . $prMonth . '" class = "data1" style = "font-weight:bold;">' . $monthName . '</span></td>
						
					  </tr>';
			$sheet  .= '<tr>
						<td style = "text-align:right;"><span class = "data1">OBR #</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span  id = "obrNumber" class = "data1" style = "font-weight:bold;">' . $obrNumber . '</span></td>
						<td style = "text-align:right;"><span class = "data1">Category</span></td>
						
						
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span id =  "prCategoryNew" class = "data1" style = "font-weight:bold;">' . $category .  '</span> <span  class = "data1" style = "font-weight:normal;">' . $description  . '</span></td>
						
					  </tr>';
					  
					  
			/*$sheet  .= '<tr>
						<td style = "text-align:right;"><span>Fund</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span class = "label3" style = "font-weight:bold;">' . $fund . '</span></td>
					  </tr>';
			$sheet  .= '<tr>
						<td style = "text-align:right;"><span>Category</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span class = "label3" style = "font-weight:bold;">' . $category . '</span></td>
					  </tr>';
			$sheet  .= '<tr>
						<td style = "text-align:right;"><span>PR Month</span></td>
						<td style = "border-bottom:1px solid silver;padding:2px 10px;"><span class = "label3" style = "font-weight:bold;">' . $prMonth . '</span></td>
					  </tr>';*/
			
			$sheet  .= '</table>';
			return $sheet;
		
		}
		function CreatePOItems($record){		
			$count = $this->num_rows($record);
			$sheet = '<table id = "poItemsTable" style = "border-spacing:0;" border ="0">';
			$sheet .= '<tr class = "dataHeader1" >';
			$sheet .= '<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(128, 128, 128) ">&nbsp;</td>
						<td  style = "padding:5px 10px;font-size:18px;">Code</td>
						<td  style = "padding:5px 10px;font-size:18px;">Description<span style = "padding-left:2px;font-size:16px;font-weight:normal;color:orange;">(' . $count . ')</span></td>
						<td style = "padding:5px 10px;font-size:18px;background-color:rgb(119, 122, 122);border:1px solid silver;"><input onclick ="selectAll(this)" type = "checkbox" checked/></td>
						<td colspan = "5"  style = "padding:5px 10px;font-size:18px;">Qty x Price</td>';
			$sheet .= '</tr>';	
			$i = 1;
			$totalAmount = 0;
			while($data = $this->fetch_array($record)){
				$amount =  $data['Amount'];
				$qty =  intval($data['Qty']);
				$price =  $data['Amount'];
				$amountX =  $data['Total'];
				
				$itemDes =  $data['Item'];
			
				$description = $data['Description'];
				$category  =  $data['Category'];
				$program = $data['ProgramCode'];
				$accountCode = $data['Code'];
				$unit = $data['Unit'];
				
				$totalAmount += $amountX;
				
				$sheet .= '<tr style = "background-color:rgb(206, 215, 218);">';
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
							<span class = "number" 
								style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">' . $i++ . '</span><input type = "hidden" value = "' . $itemDes . '"></td>';
				
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
							<input class = "data1" onclick = "clickInput(this)" style = "font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;" value ="'  . $program . '"/>
							<input class = "data1" onclick = "clickInput(this)" style = "font-size:15px;width:80px;border:0;background-color:transparent;" value = "' . $accountCode . '"/></td>';
				
				$sheet .= '<td style = "width:450px;padding:10px 10px;border-bottom:2px solid white;">
						 
						 <textarea onclick = "this.style.backgroundColor=\'white\';" style = "width:100%;font-size:16px; resize:vertical; color:black;" class = "data1">' . $description. '</textarea>' . '</td>';
				$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
							<input onclick ="selectCalculateAddPR(this)" type = "checkbox" checked/>
						   </td>';
				$sheet .= '<td style = "border-bottom:2px solid white;width:10px;">
								<input class = "data1" onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value = "' . $qty . '" maxlength = "8" 
										style = "color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:16px;border-bottom:1px solid silver;background-color:transparent;padding:2px;"/>
						   		<br/>
								<input class = "data1" onclick = "clickInput(this)" value = "' . $unit . '" style = " font-size:16px;border:0;background-color:transparent; text-align:center;width:85px;"/>
						   </td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
				                x
						   </td>';
				$sheet .= '<td style = "padding:0 2px;border-bottom:2px solid white;">
							<input class = "data1" onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" value  = ' . number_format($price,2) . '  
							style = "color:rgb(45, 90, 118);text-align:left;font-weight:bold;width:90px;border:0;font-size:15px;background-color:transparent;padding:2px;"/></td>';
				$sheet .= '<td  class = "data1"  style = "width:10px;border-bottom:2px solid white;text-align:center;padding:0 2px;">=</td>';
				$sheet .= '<td style = "padding:0 2px;border-bottom:2px solid white;">
							<input class = "data1" value = ' . number_format($amountX,2) . ' disabled 
							  style = "background-color:rgb(220, 228, 232);  width:100px;text-align:left;color:black;border:0;font-size:15px;font-weight:bold;padding:5px; 2px"/></td>';
				$sheet .= '</tr>';	
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan ="9"  style = "padding:0px  10px;padding-right:20px;">
					   <input class = "data1" id ="totalAmountItems" value = ' . number_format($totalAmount,2) . ' disabled 
					   style = "font-size:20px;border:0;background-color:transparent;width:100%;text-align:right;font-weight:bold;letter-spacing:1px;color:red;"/>	
					   </td>';
			$sheet .= '</tr>';
			
			$sheet .= '</table>';
			$sheet0 = '<div style = " ">';
			$sheet2 = '</div>';
			return   $sheet0  . $sheet .$sheet2 ;	
		}
		function CreateHistory($record){
			$i = 1;
			$count =  $this->num_rows($record);
			$col = "white";
			$sheet = '<table class = "data1" style = "width:500px;margin:20px 0px;border-spacing:0;" >';
			
			
			$sheet .= '<tr class = "dataHeader1">';
			$sheet .= '	<td  style = "background-color:grey;"></td>';
			$sheet .= '	<td  style = "padding:3px 10px;color:white;">Date</td>';
			$sheet .= '	<td  style = "padding:3px 10px;color:white;">Status <span class = "countTotal"> (' . $count . ')</span></td>';
			$sheet .= '	<td  style = "padding:3px 10px;color:white;">Completion</td>';
			$sheet .= '</tr>';
			$sheet .= '</tr>';
			while($data = $this->fetch_array($record)){
				if($i % 2 == 0){
					$sheet .= '<tr>';
					$col = "rgb(199, 212, 217)";
				}else{
					$col = "white";
				}
				
				$sheet .= '	<td style = "font-size:12px;">' . $i++ . '</td>';
				$sheet .= '	<td   style = "white-space:nowrap; font-size:14px;padding:4px 15px;background-color:' . $col . '">' . $data['DateModified'] . '</td>';
				$sheet .= '	<td   style = "white-space:nowrap;font-size:12px;font-weight:bold; letter-spacing:1px;padding:4px 15px;background-color:' . $col . '">' . $data['Status'] . '</td>';
				$sheet .= '	<td  style = "font-size:12px;font-weight:bold;padding:4px 15px;border-right:1px solid silver;background-color:' . $col . '">' . $data['Completion'] . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr class = "" ><td colspan = "100%" style = "text-align:right;font-size:12px; font-family:NOR;padding-top:5px;"> Number of days reflected above includes Saturday, Sunday and Non-working holidays.</td></tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		// function CreatePublicInfo($record,$count){
		// 	if($count ==1){
		// 		$period = '';
		// 		$data= $this->fetch_array($record);
		// 		$type = $data['TrackingType'];
		// 		$status = $data['Status'];
		// 		$claimant = $data['Claimant'];
		// 		$year = $data['Year'];
				
		// 		$docType = $data['DocumentType'];
		// 		if($type == 'PR'){
		// 			$docType = 'Purchase Request';
		// 		}
		// 		$fund = $data['Fund'];
		// 		$claimType =  $data['ClaimType'];

		// 		$office = $data['Office'];
		// 		$sql = "SELECT Name FROM office WHERE Code = '".$office."' LIMIT 1";
		// 		$record = $this->query($sql);
		// 		$data0 = $this->fetch_array($record);
		// 		$office = $data0['Name'];


		// 		$category = $data['PR_CategoryCode'];
		// 		$sql = "SELECT Description FROM ppmpcategories WHERE Code = '".$category."' LIMIT 1";
		// 		$record = $this->query($sql);
		// 		$data1 = $this->fetch_array($record);
		// 		$catName = $data1['Description'];


		// 		$encodedBy = $data['EncodedBy'];
		// 		$sql = "SELECT CONCAT(LastName,', ', FirstName, ' ', MiddleName) as encodedBy 
		// 				FROM citydoc.employees WHERE EmployeeNumber = '".$encodedBy."' LIMIT 1";
		// 		$record = $this->query($sql);
		// 		$data2 = $this->fetch_array($record);
		// 		$encodedBy = utf8_encode($data2['encodedBy']);

				
		// 		$tn = $data['TrackingNumber'];
		// 		$obr = $data['OBR_Number'];
		// 		$po = $data['PO_Number'];
		// 		$pr = $data['PR_Number'];
		// 		$adv = $data['ADV1'];
		// 		$remark = $data['Remarks'];
				
		// 		$dateEncoded = $data['DateEncoded'];
		// 		$dateModified = $data['DateModified'];
		// 		$completion = $data['Completion'];
		// 		if($type == 'PY'){
		// 			$periodType = $data['PeriodType']; 
		// 			$periodMonth= $data['PeriodMonth']; 
		// 			if($periodType == 1){
		// 				$period = $periodMonth . ' (1 - 15)';
		// 			}else if ($periodType == 2){
		// 				$period = $periodMonth . ' (16 - 31)';
		// 			}else{
		// 				$period = $periodMonth;
		// 			}
		// 		}else {
		// 			$period =  $this->numberToQuarter($data['PR_Month']);
		// 		}

		// 		return $this->CreatePublicTable($status,$office,$dateModified,$claimant,$docType,$claimType,$fund,$period,$category,$tn,$pr,$obr,$po,$adv,$dateEncoded,$encodedBy,$completion,$catName,$year,$remark);
		// 	}else{
		// 		return $this->CreatePublicTableMultiple($record);
		// 	}
			
		// }
	// 	function CreatePublicTable($status,$office,$dateModified,$claimant,$docType,$claimType,$fund,$period,$category,$tn,$pr,$obr,$po,$adv,$dateEncoded,$encodedBy,$completion,$catName,$year,$remark){
	// 		$sheet = '<table style = " padding:10px;border-spacing:0; margin:0 auto;min-width:500px;" border = "0">';
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td class = "td1" style = "vertical-align:middle;"></td>
	// 				<td class = "td2" style = "background-color:rgba(0, 0, 0,.5);padding:0;padding-top:10px;padding-bottom:1;border:0;">
	// 					<span class = "label5" style = "color:white;font-size:36px;margin-left:10px;">' .  $status  .  '</span> 
	// 					<span class = "label6" style = "display:none;" >' .  $this->ezDate($dateModified)  . '</span>
						
	// 				</td></tr>';
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td style = "padding:8px;" colspan = "2"></td>';
	// 		$sheet .= '</tr>';
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td class = "td1"><span class ="label4">Office</span></td><td class = "td2" style = "padding-right:20px;"><span class = "label5">' . $office . '</span></td>';
	// 		$sheet .= '</tr>';
	// 		if($claimant != ''){
	// 			$sheet .= '<tr>';
	// 			$sheet .= '<td class = "td1"><span class ="label4">Claimant</span></td><td class = "td2" style = "padding-right:20px;"><span class = "label5">' . strtoupper($claimant) . '</span></td>';
	// 			$sheet .= '</tr>';
	// 		}
			
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td class = "td1"><span class ="label4">Document</span></td><td class = "td2"><span class = "label5">' .  $docType . '</span></td>';
	// 		$sheet .= '</tr>';
			
			
	// 		$window = '';
	// 		$cashRelease = '';
	// 		if($claimType == "Window"){
	// 			$sql = "select TrackingPartner from vouchercurrent where trackingnumber = '" . $tn . "' limit 1";
	// 			$record = $this->query($sql);
	// 			$data = $this->fetch_array($record);
	// 			$trackingPartner = $data['TrackingPartner'];
				
	// 			$sql = "select Status from vouchercurrent  where trackingnumber = '" . $trackingPartner . "' limit 1";
	// 			$record = $this->query($sql);
	// 			$data = $this->fetch_array($record);
	// 			$status = $data['Status'];
				
				
	// 			$sql = "select Window,CashRelease from particulars  where trackingnumber = '" . $trackingPartner . "' limit 1";
	// 			$record = $this->query($sql);
	// 			$data = $this->fetch_array($record);
	// 			$cashReleaseRemarks = $data['CashRelease'];
	// 			$window = $data['Window'];
	// 			if(strlen($window) > 0){
	// 				$window = '<span style = "color:red;font-size:22px;">('  . $window . ')</span>';
	// 			}
				
				
				
	// 			$sheet .= '<tr><td colspan ="100%">&nbsp;</td></tr>';
	// 			$sheet .= '<tr><td class = "td1"><span class ="label4">Paymaster Tracking</span></td><td class = "td2"><span class = "label5" style ="color:rgb(9, 120, 248);font-size:22px;">' .  $trackingPartner. '</span></td>';
	// 			$sheet .= '</tr>';
				
	// 			$sheet .= '<tr><td class = "td1"><span class ="label4">Paymaster Status</span></td><td class = "td2"><span class = "label5" style ="font-size:18px;">' .  $status. '</span></td>';
	// 			$sheet .= '</tr>';
				
	// 			if(strlen($cashReleaseRemarks) > 0){
	// 				$cashRelease .= '<tr>';
	// 				$cashRelease .= '<td class = "td1"><span class ="label4">Cash Release Date</span></td><td class = "td2"><span class = "label5" style = "color:rgb(247, 66, 108);">' .     $cashReleaseRemarks     . '</span></td>';
	// 				$cashRelease .= '</tr><tr><td colspan ="100%">&nbsp;</td></tr>';
	// 			}	
	// 		}
	// 		if($claimType !=''){
	// 			$sheet .= '<tr>';
	// 			$sheet .= '<td class = "td1"><span class ="label4">Claim Type</span></td><td class = "td2"><span class = "label5">' .  $claimType . $window . '</span></td>';
	// 			$sheet .= '</tr>';
	// 		}
	// 		$sheet .= $cashRelease;
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td class = "td1"><span class ="label4">Fund</span></td><td class = "td2"><span class = "label5">' .  $fund . '</span></td>';
	// 		$sheet .= '</tr>';
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td class = "td1"><span class ="label4">Period</span></td><td class = "td2"><span class = "label5">' .  $period . '</span></td>';
	// 		$sheet .= '</tr>';
	// 		$sheet .= '<tr>';
	// 		$sheet .= '<td class = "td1" style="vertical-align:top;"><span class ="label4">Pending Note</span></td><td class = "td2" style="font-size:14px; font-weight:normal;border-bottom:0px;">' .  $remark . '</td>';
	// 		$sheet .= '</tr>';
			
	// 		if($category != ''){
	// 			$sheet .= '<tr>';
	// 			$sheet .= '<td class = "td1"><span class ="label4">Category</span></td><td class = "td2"><span class = "label5">' .  $category . '</span></td>';
	// 			$sheet .= '</tr>';
	// 		}
	// 		if($catName != ''){
	// 			$sheet .= '<tr>';
	// 			$sheet .= '<td class = "td1"><span class ="label4">Category Name</span></td><td class = "td2"><span class = "label5">' .  $catName . '</span></td>';
	// 			$sheet .= '</tr>';
	// 		}
			
	// 		if($docType == "Purchase Request"){
	// 			$db  = "citydoc" . $year;
	// 			$sql = "Select Status, TrackingNumber from $db.vouchercurrent where PR_TrackingNumber = '" . $tn . "'";
	// 			$record = $this->query($sql);
			
	// 			while($data = $this->fetch_array($record)){
	// 				$poStatus = $data['Status'];
	// 				$partner = $data['TrackingNumber'];
	// 				$sheet .= '<tr>';
	// 				$sheet .= '<td class = "td1"><span class ="label4">PO Tracking</span></td><td class = "td2"><span class = "label5" onclick = "searchPOTracking(this)" style = "cursor:pointer;">' .  $partner . '</span></td>';
	// 				$sheet .= '</tr>';
	// 				$sheet .= '<tr>';
	// 				$sheet .= '<td class = "td1"></td><td style = "padding-left:10px;"><span style = "font-size:18px;">' .  $poStatus . '</span></td>';
	// 				$sheet .= '</tr>';
	// 			}
	// 		}
			
	// 		$sheet .= '</table>';
			
	// 		$sheet1 = '<table style = "padding:10px;border-spacing:0; margin:0 auto;min-width:500px;margin-top:60px;" border = "0">';
	// 		$sheet1 .= '<tr>
	// 					<td colspan = "2" class = "td2" style = "padding:0px;padding-top:10px;padding-bottom:1px;border-bottom:1px solid black;">
	// 						<span class = "label5" style = "margin-left:10px;">Reference Numbers</span> 
							
	// 					</td>
	// 				</tr>';
			
	// 		$sheet1 .= '<tr><td colspan = "2" style ="">&nbsp;</td></tr>';
	// 		$sheet1 .= '<tr>';
	// 		$sheet1 .= '<td class = "td1" style ="width:10px;"><span class ="label4">Tracking&nbsp;Number</span></td>
	// 					<td class = "td2" style = "background-color:rgb1a(0, 0, 0,.3);">
	// 					<span id ="trackingNumberPublic" class = "label5" style = "color:rgb(9, 120, 248);">' .  $tn  .  '</span> </td>';
	// 		$sheet1 .= '</tr>';
	// 		if($pr != '' and $pr != 0){
	// 			$sheet1 .= '<tr>';
	// 			$sheet1 .= '<td class = "td1"><span class ="label4">PR Number</span></td><td class = "td2" style="background-color:rg1ba(0, 0, 0,.3);">
	// 					<span class = "label5" style = "color:rgb(9, 120, 248);">' .  $pr . '</span></td>';
	// 			$sheet1 .= '</tr>';
	// 		}
	// 		if($obr != '' and $obr != 0){
	// 			$sheet1 .= '<tr>';
	// 			$sheet1 .= '<td class = "td1"><span class ="label4">OBR&nbsp;Number</span></td>
	// 					<td class = "td2" style="background-color:rgb1a(0, 0, 0,.3);">
	// 						<span class = "label5" style = "color:rgb(9, 120, 248);">' .  $obr . '</span></td>';
	// 			$sheet1 .= '</tr>';
	// 		}
	// 		if($po != '' and $po != 0){
	// 			$sheet1 .= '<tr>';
	// 			$sheet1 .= '<td class = "td1"><span class ="label4">PO&nbsp;Number</span></td><td class = "td2" style="background-color:rgb1a(0, 0, 0,.3);">
	// 					<span class = "label5" style = "color:rgb(9, 120, 248);">' .  $po . '</span></td>';
	// 			$sheet1 .= '</tr>';
	// 		}
	// 		if($adv != '' and $adv != 0){
	// 			$sheet1 .= '<tr>';
	// 			$sheet1 .= '<td class = "td1"><span class ="label4">ADV&nbsp;Number</span></td>
	// 					<td class = "td2" style="background-color:rgb1a(0, 0, 0,.3);" ><span class = "label5" style = "color:rgb(9, 120, 248);">' .  $adv . '</span></td>';
	// 			$sheet1 .= '</tr>';
	// 		}
	// 	$sheet1 .= '</table>';
		
	// 	$sheet2 = '<table style = "line-height:12px; border-spacing:0; float:right;margin-right:20px;;margin-top:5px;font-size:12px;" border = "0">';
	// 		$sheet2 .= '<tr>
	// 						<td class = "td1"  style = "vertical-align:bottom;"><span style = "font-size:10px;">Encoded By</span>
	// 						</td><td class = "td2"><span class = "label5" style = "">' .  $encodedBy . '</span></td>
	// 					</tr>';
	// 		$sheet2 .= '<tr>
	// 						<td class = "td1"  style = "vertical-align:bottom;"><span  style = "font-size:10px;">Date Encoded</span>
	// 						</td><td class = "td2"><span class = "label5" style = "">' .  $dateEncoded  . '</span></td>
	// 					</tr>';
	// 		$sheet2 .= '<tr>
	// 						<td class = "td1"  style = "vertical-align:bottom;"><span  style = "font-size:10px;">Date Updated</span>
	// 						</td><td class = "td2"><span class = "label5" style = "">' .  $dateModified  . '</span></td>
	// 					</tr>';
	// 		if($completion != ''){
	// 			$sheet2 .= '<tr style = "display:none;">
	// 						<td class = "td1"  style = "vertical-align:bottom;"><span  style = "font-size:10px;">Duration</span>
	// 						</td><td class = "td2"><span class = "label5" style = "">' .  $completion  . '<span style = "font-size:13px; color:orange;font-family:oswald;"> (including non working days)</span></span></td>
	// 					</tr>';
	// 		}
		
	// 	$sheet2 .= '</table>';
		
	// 	$sheet4 = '<table style = "margin:0 auto;margin-top:20px;background-color:rgb(251, 248, 248);" border ="0">
	// 				<tr>
	// 					<td style = "vertical-align:top;">' . $sheet. '</td>
	// 					<td style = "vertical-align:top;">
						
	// 						' . $sheet1 . ' 
	// 						' . $sheet2 . '
							
	// 					</td>
	// 				</tr>
	// 				<tr>
	// 					<td colspan ="2"><div style = "padding:10px;background-color:white;display:block;background-color:rgb(244, 244, 225);border-top:2px dashed silver;text-align:center;cursor:pointer;">
	// 						Send me text updates for this transaction. (
	// 						<span onclick = "saveMyNumber()" style = "font-family:Oswald;color:rgb(248, 7, 99);">click here to register my number</span> )
	// 					</div></td>
	// 				</tr>
	// 			</table>';
		
		
	// 	return $sheet4;
	// }
	// function CreatePublicTableMultiple($record){
	// 	$sheet = '<table style = "border-spacing:0; margin:0 auto;width:98%;">';
	// 	$i =1;
	// 	$sheet .= '<tr >';
	// 	$sheet .= '<td class = "td4"></td>
	// 			<td class = "td4" ><span class = "label7" style = "">TN#</span></td>
	// 			<td class = "td4"><span class = "label7" style = "">OFFICE</span></td>
				
				
	// 			<td class = "td4"><span class = "label7" style = "">CLAIMANT</span></td>
	// 			<td class = "td4"><span class = "label7" style = "">DOCUMENT</span></td>
	// 			<td class = "td4"><span class = "label7" style = "text-align:center;">PERIOD</span></td>
				
	// 			<td class = "td4" style = "text-align:center;" ><span class = "label7" >STATUS</span></td>
	// 			<td class = "td4" ><span class = "label7" style = "">UPDATED</span></td>
	// 			</tr>';
						
	// 	while($data = $this->fetch_array($record)){
	// 		$period = '';
	// 		$office = $data['Name'];
	// 		$type = $data['TrackingType'];
	// 		$status = $data['Status'];
	// 		$claimant = strtoupper($data['Claimant']);
			
	// 		//$docType = $data['DocumentType'];
	// 		//$type = $docType; 
			
	// 		$docType = explode('-',$data['DocumentType']);
	// 		if(sizeof($docType) > 1){
	// 			$dType = $docType[1]; 
	// 		}else{
	// 			$dType = $data['DocumentType']; 
	// 		}
			
			
	// 		if($type == 'PR'){
	// 			$docType = 'Purchase Request';
	// 		}
	// 		$fund = $data['Fund'];
	// 		$claimType =  $data['ClaimType'];
	// 		$category = $data['PR_CategoryCode'];
			
	// 		$tn = $data['TrackingNumber'];
	// 		$obr = $data['OBR_Number'];
	// 		$po = $data['PO_Number'];
	// 		$pr = $data['PR_Number'];
	// 		$adv = $data['ADV1'];
			
	// 		$dateEncoded = $data['DateEncoded'];
	// 		$dateModified = $data['DateModified'];
	// 		$completion = $data['Completion'];
	// 		//$encodedBy = utf8_encode($data['LastName'] . ', ' . $data['FirstName'] . ' ' . $data['MiddleName']);
	// 		$encodedBy = '';
	// 		if($type == 'PY'){
	// 			$periodType = $data['PeriodType']; 
	// 			$periodMonth= $data['PeriodMonth']; 
	// 			if($periodType == 1){
	// 				$period = $periodMonth . ' (1 - 15)';
	// 			}else if ($periodType == 2){
	// 				if(strtoupper($periodMonth) == "FEBRUARY"){
	// 					$period = $periodMonth . ' (16 - 28)';
	// 				}else{
	// 					$period = $periodMonth . ' (16 - 31)';
	// 				}
	// 			}else if($periodType == 4){
	// 				$period = $periodMonth . ' (1 - 15)';
	// 			}else if ($periodType == 5){
	// 				if(strtoupper($periodMonth) == "FEBRUARY"){
	// 					$period = $periodMonth . ' (16 - 28)';
	// 				}else{
	// 					$period = $periodMonth . ' (16 - 31)';
	// 				}

	// 			}else{
	// 				$period = $periodMonth;
	// 			}
	// 		}else {
	// 			$period =  $this->numberToQuarter($data['PR_Month']);
	// 		}
	// 		if($i % 2 == 0){
	// 			$sheet .= '<tr  style = "background-color:rgba(2, 2, 2,.3); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
	// 		}else{
	// 			$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
	// 		}
			
	// 			$sheet .= '<td style = "padding:0px 5px;"><div class = "number" >' . $i++ . '</div></td>
	// 					<td class = "td3"><span class = "label5" style = "font-size:22px;">' . $tn . '</span></td>

	// 					<td  class = "td3"  style = "">
	// 						<span class = "" style = "color:black;font-size:20px;">' . $office . '</span>
	// 					</td>
	// 					<td  class = "td3" style = "background-color:rga(2, 2, 2,.3); padding-right:15px;">
	// 						<span class= "label5" style = "font-size:20px;">' . $claimant . '</span>
	// 					</td>
	// 					<td  class = "td3" style = "padding-left:8px;" >
	// 						<span  style = "color:black;font-size:20px;">' . $dType . '</span>
	// 					</td>
	// 					<td  class = "td3" style = "padding-left:8px;text-overflow:nowrap;white-space: nowrap;" >
	// 						<span  style = "color:white;font-size:20px;text-shadow:0px 0px 2px black;">' . $period . '</span>
	// 					</td>
	// 					<td  class = "td3"  style = "background-color:rgba(2, 2, 2,.6);padding-left:10px;padding-right:10px;text-overflow:nowrap;white-space: nowrap; ">';
	// 					if($status == 'CAO Released'){
	// 						$sheet .= '<span  style = "color:rgb(235, 76, 158);font-size:20px;text-shadow:0px 0px 2px black;">' . $status. '</span>';
	// 					}else {
	// 						if(strpos($status, 'Pending') !== false){
	// 							$sheet .= '<span  style = "color:green;font-size:20px;">' . $status. '</span>';
	// 						}else{
	// 							$sheet .= '<span  style = "color:rgb(23, 183, 236);font-size:20px;">' . $status. '</span>';
	// 						}
	// 						//$sheet .= '<span  style = "font-size:21px;text-shadow:0px 0px 2px white;">' . $status. '</span>';
	// 						//$sheet .= '<span  style = "color:rgb(23, 183, 236);font-size:21px;">' . $status. '</span>';
	// 					}
	// 			/*$sheet .= '</td>
	// 					<td  class = "td3"  style = "background-color:rgb1a(2, 2, 2,.3); ">
	// 						<span  style = "color:white;font-size:12px;font-family:verdana;padding-left:5px;">' . $this->ezDate($dateModified). '</span>
	// 					</td>
	// 				</tr>';*/
	// 			$sheet .= '</td>
	// 					<td  class = "td3"  style = "background-color:rgb1a(2, 2, 2,.3); ">
	// 						<span  style = "text-overflow:nowrap;white-space: nowrap;color:white;font-size:12px;font-family:verdana;padding-left:5px;">' . $dateModified. '</span>
	// 					</td>
	// 				</tr>';
			
	// 	}
	// 	return $sheet .= '</table>';
	// }

		function CreatePublicTable($newRecord){
			$type = $newRecord['TrackingType'];
			$status = $newRecord['Status'];
			$claimant = $newRecord['Claimant'];
			$year = $newRecord['Year'];
			$db = $this->getDB($year);
			$docType = $newRecord['DocumentType'];
			$fund = $newRecord['Fund'];
			$claimType =  $newRecord['ClaimType'];
			// $office = $newRecord['Office'];
			$office = $newRecord['OfficeName'];
			$category = $newRecord['PR_CategoryCode'];
			$catName = $newRecord['PR_CategoryName'];
			// $encodedBy = $newRecord['EncodedBy'];
			$encodedBy = $newRecord['EncodedName'];
			$tn = $newRecord['TrackingNumber'];
			$obr = $newRecord['OBR_Number'];
			$po = $newRecord['PO_Number'];
			$pr = $newRecord['PR_Number'];
			$adv = $newRecord['ADV1'];
			$remark = $newRecord['Remarks'];
			$dateEncoded = $newRecord['DateEncoded'];
			$dateModified = $newRecord['DateModified'];
			$completion = $newRecord['Completion'];
			$period = $newRecord['Period'];

			$sheet = '<table style = " padding:10px;border-spacing:0; margin:0 auto;min-width:500px;" border = "0">';
			$sheet .= '<tr>';
			$sheet .= '<td class = "td1" style = "vertical-align:middle;"></td>
					<td class = "td2" style = "background-color:rgba(0, 0, 0,.5);padding:0;padding-top:10px;padding-bottom:1;border:0;">
						<span class = "label5" style = "color:white;font-size:36px;margin-left:10px;">' .  $status  .  '</span> 
						<span class = "label6" style = "display:none;" >' .  $this->ezDate($dateModified)  . '</span>
						
					</td></tr>';
			$sheet .= '<tr>';
			$sheet .= '<td style = "padding:8px;" colspan = "2"></td>';
			$sheet .= '</tr>';
			$sheet .= '<tr>';
			$sheet .= '<td class = "td1"><span class ="label4">Office</span></td><td class = "td2" style = "padding-right:20px;"><span class = "label5">' . $office . '</span></td>';
			$sheet .= '</tr>';
			if($claimant != ''){
				$sheet .= '<tr>';
				$sheet .= '<td class = "td1"><span class ="label4">Claimant</span></td><td class = "td2" style = "padding-right:20px;"><span class = "label5">' . strtoupper($claimant) . '</span></td>';
				$sheet .= '</tr>';
			}
			
			$sheet .= '<tr>';
			$sheet .= '<td class = "td1"><span class ="label4">Document</span></td><td class = "td2"><span class = "label5">' .  $docType . '</span></td>';
			$sheet .= '</tr>';
			
			
			$window = '';
			$cashRelease = '';
			if($claimType == "Window"){
				$sql = "select TrackingPartner from ".$db.".vouchercurrent where trackingnumber = '" . $tn . "' limit 1";
				$record = $this->query($sql);
				$data = $this->fetch_array($record);
				$trackingPartner = $data['TrackingPartner'];
				
				if($trackingPartner != "") {
					$sql = "select Status from ".$db.".vouchercurrent  where trackingnumber = '" . $trackingPartner . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					$status = $data['Status'];
				}else {
					$status = "";
				}
				
				
				if($year >= 2021) {
					if($trackingPartner != "") {
						$sql = "select Window,CashRelease from ".$db.".particulars  where trackingnumber = '" . $trackingPartner . "' limit 1";
						$record = $this->query($sql);
						$data = $this->fetch_array($record);
						$cashReleaseRemarks = $data['CashRelease'];
						$window = $data['Window'];
						if(strlen($window) > 0){
							$window = '<span style = "color:red;font-size:22px;">('  . $window . ')</span>';
						}
					}else {
						$status = "";
						$cashReleaseRemarks = '';
						$window = '';
					}
				}else {
					$status = "";
					$cashReleaseRemarks = '';
					$window = '';
				}
				
				
				
				
				$sheet .= '<tr><td colspan ="100%">&nbsp;</td></tr>';
				$sheet .= '<tr><td class = "td1"><span class ="label4">Paymaster Tracking</span></td><td class = "td2"><span class = "label5" style ="color:rgb(9, 120, 248);font-size:22px;">' .  $trackingPartner. '</span></td>';
				$sheet .= '</tr>';
				
				$sheet .= '<tr><td class = "td1"><span class ="label4">Paymaster Status</span></td><td class = "td2"><span class = "label5" style ="font-size:18px;">' .  $status. '</span></td>';
				$sheet .= '</tr>';
				
				if(strlen($cashReleaseRemarks) > 0){
					$cashRelease .= '<tr>';
					$cashRelease .= '<td class = "td1"><span class ="label4">Cash Release Date</span></td><td class = "td2"><span class = "label5" style = "color:rgb(247, 66, 108);">' .     $cashReleaseRemarks     . '</span></td>';
					$cashRelease .= '</tr><tr><td colspan ="100%">&nbsp;</td></tr>';
				}	
			}
			if($claimType !=''){
				$sheet .= '<tr>';
				$sheet .= '<td class = "td1"><span class ="label4">Claim Type</span></td><td class = "td2"><span class = "label5">' .  $claimType . $window . '</span></td>';
				$sheet .= '</tr>';
			}
			$sheet .= $cashRelease;
			$sheet .= '<tr>';
			$sheet .= '<td class = "td1"><span class ="label4">Fund</span></td><td class = "td2"><span class = "label5">' .  $fund . '</span></td>';
			$sheet .= '</tr>';
			$sheet .= '<tr>';
			$sheet .= '<td class = "td1"><span class ="label4">Period</span></td><td class = "td2"><span class = "label5">' .  $period . '</span></td>';
			$sheet .= '</tr>';
			$sheet .= '<tr>';
			$sheet .= '<td class = "td1" style="vertical-align:top;"><span class ="label4">Pending Note</span></td><td class = "td2" style="font-size:14px; font-weight:normal;border-bottom:0px;">' .  $remark . '</td>';
			$sheet .= '</tr>';
			
			if($category != ''){
				$sheet .= '<tr>';
				$sheet .= '<td class = "td1"><span class ="label4">Category</span></td><td class = "td2"><span class = "label5">' .  $category . '</span></td>';
				$sheet .= '</tr>';
			}
			if($catName != ''){
				$sheet .= '<tr>';
				$sheet .= '<td class = "td1"><span class ="label4">Category Name</span></td><td class = "td2"><span class = "label5">' .  $catName . '</span></td>';
				$sheet .= '</tr>';
			}
			
			if($docType == "Purchase Request"){
				$db  = "citydoc" . $year;
				$sql = "Select Status, TrackingNumber from $db.vouchercurrent where PR_TrackingNumber = '" . $tn . "'";
				$record = $this->query($sql);
			
				while($data = $this->fetch_array($record)){
					$poStatus = $data['Status'];
					$partner = $data['TrackingNumber'];
					$sheet .= '<tr>';
					$sheet .= '<td class = "td1"><span class ="label4">PO Tracking</span></td><td class = "td2"><span class = "label5" onclick = "searchPOTracking(this)" style = "cursor:pointer;">' .  $partner . '</span></td>';
					$sheet .= '</tr>';
					$sheet .= '<tr>';
					$sheet .= '<td class = "td1"></td><td style = "padding-left:10px;"><span style = "font-size:18px;">' .  $poStatus . '</span></td>';
					$sheet .= '</tr>';
				}
			}
			
			$sheet .= '</table>';
			
			$sheet1 = '<table style = "padding:10px;border-spacing:0; margin:0 auto;min-width:500px;margin-top:60px;" border = "0">';
			$sheet1 .= '<tr>
						<td colspan = "2" class = "td2" style = "padding:0px;padding-top:10px;padding-bottom:1px;border-bottom:1px solid black;">
							<span class = "label5" style = "margin-left:10px;">Reference Numbers</span> 
							
						</td>
					</tr>';
			
			$sheet1 .= '<tr><td colspan = "2" style ="">&nbsp;</td></tr>';
			$sheet1 .= '<tr>';
			$sheet1 .= '<td class = "td1" style ="width:10px;"><span class ="label4">Tracking&nbsp;Number</span></td>
						<td class = "td2" style = "background-color:rgb1a(0, 0, 0,.3);">
						<span id ="trackingNumberPublic" class = "label5" style = "color:rgb(9, 120, 248);">' .  $tn  .  '</span> </td>';
			$sheet1 .= '</tr>';
			if($pr != '' and $pr != 0){
				$sheet1 .= '<tr>';
				$sheet1 .= '<td class = "td1"><span class ="label4">PR Number</span></td><td class = "td2" style="background-color:rg1ba(0, 0, 0,.3);">
						<span class = "label5" style = "color:rgb(9, 120, 248);">' .  $pr . '</span></td>';
				$sheet1 .= '</tr>';
			}
			if($obr != '' and $obr != 0){
				$sheet1 .= '<tr>';
				$sheet1 .= '<td class = "td1"><span class ="label4">OBR&nbsp;Number</span></td>
						<td class = "td2" style="background-color:rgb1a(0, 0, 0,.3);">
							<span class = "label5" style = "color:rgb(9, 120, 248);">' .  $obr . '</span></td>';
				$sheet1 .= '</tr>';
			}
			if($po != '' and $po != 0){
				$sheet1 .= '<tr>';
				$sheet1 .= '<td class = "td1"><span class ="label4">PO&nbsp;Number</span></td><td class = "td2" style="background-color:rgb1a(0, 0, 0,.3);">
						<span class = "label5" style = "color:rgb(9, 120, 248);">' .  $po . '</span></td>';
				$sheet1 .= '</tr>';
			}
			if($adv != '' and $adv != 0){
				$sheet1 .= '<tr>';
				$sheet1 .= '<td class = "td1"><span class ="label4">ADV&nbsp;Number</span></td>
						<td class = "td2" style="background-color:rgb1a(0, 0, 0,.3);" ><span class = "label5" style = "color:rgb(9, 120, 248);">' .  $adv . '</span></td>';
				$sheet1 .= '</tr>';
			}
			$sheet1 .= '</table>';
			
			$sheet2 = '<table style = "line-height:12px; border-spacing:0; margin:0px 0px 10px auto; margin-right:20px; margin-top:5px; font-size:12px;" border = "0">';
				$sheet2 .= '<tr>
								<td class = "td1"  style = "vertical-align:bottom;"><span style = "font-size:10px;">Encoded By</span>
								</td><td class = "td2"><span class = "label5" style = "">' .  $encodedBy . '</span></td>
							</tr>';
				$sheet2 .= '<tr>
								<td class = "td1"  style = "vertical-align:bottom;"><span  style = "font-size:10px;">Date Encoded</span>
								</td><td class = "td2"><span class = "label5" style = "">' .  $dateEncoded  . '</span></td>
							</tr>';
				$sheet2 .= '<tr>
								<td class = "td1"  style = "vertical-align:bottom;"><span  style = "font-size:10px;">Date Updated</span>
								</td><td class = "td2"><span class = "label5" style = "">' .  $dateModified  . '</span></td>
							</tr>';
				if($completion != ''){
					$sheet2 .= '<tr style = "display:none;">
								<td class = "td1"  style = "vertical-align:bottom;"><span  style = "font-size:10px;">Duration</span>
								</td><td class = "td2"><span class = "label5" style = "">' .  $completion  . '<span style = "font-size:13px; color:orange;font-family:oswald;"> (including non working days)</span></span></td>
							</tr>';
				}
			
			$sheet2 .= '</table>';

			$sheet3 = $this->CreatePulicVoucherHistory($tn);
			
			$sheet4 = '<table style = "margin:0 auto;margin-top:20px;background-color:rgb(251, 248, 248);" border ="0">
						<tr>
							<td style = "vertical-align:top;">' . $sheet. '</td>
							<td style = "vertical-align:top; text-align:right;">
								' . $sheet1 . ' 
								' . $sheet2 . '
								' . $sheet3 . '
							</td>
						</tr>
						<tr>
							<td colspan ="2"><div style = "padding:10px;background-color:white;display:block;background-color:rgb(244, 244, 225);border-top:2px dashed silver;text-align:center;cursor:pointer;">
								Send me text updates for this transaction. (
								<span onclick = "saveMyNumber()" style = "font-family:Oswald;color:rgb(248, 7, 99);">click here to register my number</span> )
							</div></td>
						</tr>
					</table>';
			
			
			return $sheet4;
		}

		function CreatePulicVoucherHistory($tn) {

			$sql = "SELECT * FROM voucherhistory WHERE TrackingNumber = '".$tn."' ORDER BY Id DESC";
			$record = $this->query($sql);

			$row = 0;
			$sheet = "";

			$sheet .= "	<span onclick='pubViewHistory(this)' style='margin:10px 20px 0px 0px; font-family:Oswald; font-size:12px; cursor:pointer; font-weight:bold; user-select:none;'><span style='color:red; margin-right:2px;'>&#9658;</span>View History</span>";
			$sheet .= "	<table border='0' cellpadding='0' id='searchedUserHistory' style='font-weight:normal; border-collapse:collapse; font-family:Oswald; font-size:12px; margin:5px 20px 20px auto; display:none;'>
							<tr style='background-color:rgba(0, 0, 0,.5); color:white; font-size:14px;'>
								<td style='border-top:1px solid silver; border-left:1px solid silver;'></td>
								<td style='border-top:1px solid silver; padding:2px 5px;'>Date</td>
								<td style='border-top:1px solid silver; padding:2px 5px;'>Status<span style='color:orange;'>(".$this->num_rows($record).")</span></td>
								<td style='border-top:1px solid silver; border-right:1px solid silver; padding:2px 5px;'>Completion</td>
							</tr>";
			while ($data = $this->fetch_array($record)) {
				$date = $data['DateModified'];
				$status = $data['Status'];
				$completion = $data['Completion'];

				$bgClr = "";
				if($row%2 > 0) {
					// $bgClr = "background-color:rgb(199, 212, 217);";
					$bgClr = "background-color:rgba(0,0,0,.1);";
				}

				$sheet .= "	<tr style='".$bgClr."'>
								<td style='padding:2px 5px; text-align:right; background-color:rgb(251, 248, 248); border-left:1px solid silver;'>".++$row."</td>
								<td style='padding:2px 5px;'>".$date."</td>
								<td style='padding:2px 5px; font-weight:bold;'>".$status."</td>
								<td style='padding:2px 5px; font-weight:bold; border-right:1px solid silver;'>".$completion."</td>
							</tr>";

			}
			$sheet .= "	<tr>
							<td colspan='4' style='font-size:11px; text-align:right; padding-top:5px; border-top:1px solid silver;'>Number of days reflected above includes Saturday, Sunday and Non-working holidays.</td>
						</tr>";
			$sheet .= "</table>";

			return $sheet;

		}

		function CreatePublicTableMultiple($record){
			$sheet = '<table style = "border-spacing:0; margin:0 auto;width:98%;">';
			$sheet .= '<tr >';
			$sheet .= '<td class = "td4"></td>
					<td class = "td4" ><span class = "label7" style = "">TN#</span></td>
					<td class = "td4"><span class = "label7" style = "">OFFICE</span></td>
					
					
					<td class = "td4"><span class = "label7" style = "">CLAIMANT</span></td>
					<td class = "td4"><span class = "label7" style = "">DOCUMENT</span></td>
					<td class = "td4"><span class = "label7" style = "text-align:center;">PERIOD</span></td>
					
					<td class = "td4" style = "text-align:center;" ><span class = "label7" >STATUS</span></td>
					<td class = "td4" ><span class = "label7" style = "">UPDATED</span></td>
					</tr>';
			$i = 0;
			foreach ($record as $tn => $data) {
				$type = $data['TrackingType'];
				$status = $data['Status'];
				$claimant = $data['Claimant'];
				$year = $data['Year'];
				$docType = $data['DocumentType'];
				$fund = $data['Fund'];
				$claimType =  $data['ClaimType'];
				$office = $data['Office'];
				$officeName = $data['OfficeName'];
				$category = $data['PR_CategoryCode'];
				$catName = $data['PR_CategoryName'];
				$encodedBy = $data['EncodedBy'];
				$encodedName = $data['EncodedName'];
				$tn = $data['TrackingNumber'];
				$obr = $data['OBR_Number'];
				$po = $data['PO_Number'];
				$pr = $data['PR_Number'];
				$adv = $data['ADV1'];
				$remark = $data['Remarks'];
				$dateEncoded = $data['DateEncoded'];
				$dateModified = $data['DateModified'];
				$completion = $data['Completion'];
				$period = $data['Period'];
				
				if($i % 2 == 0){
					$sheet .= '<tr  style = "background-color:rgba(2, 2, 2,.3); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}else{
					$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}
				
					$sheet .= '<td style = "padding:0px 5px;"><div class = "number" >' . ++$i . '</div></td>
							<td class = "td3"><span class = "label5" style = "font-size:22px;">' . $tn . '</span></td>

							<td  class = "td3"  style = "">
								<span class = "" style = "color:black;font-size:20px;">' . $office . '</span>
							</td>
							<td  class = "td3" style = "background-color:rga(2, 2, 2,.3); padding-right:15px;">
								<span class= "label5" style = "font-size:20px;">' . $claimant . '</span>
							</td>
							<td  class = "td3" style = "padding-left:8px;" >
								<span  style = "color:black;font-size:20px;">' . $docType . '</span>
							</td>
							<td  class = "td3" style = "padding-left:8px;text-overflow:nowrap;white-space: nowrap;" >
								<span  style = "color:white;font-size:20px;text-shadow:0px 0px 2px black;">' . $period . '</span>
							</td>
							<td  class = "td3"  style = "background-color:rgba(2, 2, 2,.6);padding-left:10px;padding-right:10px;text-overflow:nowrap;white-space: nowrap; ">';
							if($status == 'CAO Released'){
								$sheet .= '<span  style = "color:rgb(235, 76, 158);font-size:20px;text-shadow:0px 0px 2px black;">' . $status. '</span>';
							}else {
								if(strpos($status, 'Pending') !== false){
									$sheet .= '<span  style = "color:green;font-size:20px;">' . $status. '</span>';
								}else{
									$sheet .= '<span  style = "color:rgb(23, 183, 236);font-size:20px;">' . $status. '</span>';
								}
							}
					$sheet .= '</td>
							<td  class = "td3"  style = "background-color:rgb1a(2, 2, 2,.3); ">
								<span  style = "text-overflow:nowrap;white-space: nowrap;color:white;font-size:12px;font-family:verdana;padding-left:5px;">' . $dateModified. '</span>
							</td>
						</tr>';
				
			}
			return $sheet .= '</table>';
		}

		

		function CreatePublicTableMultiple1($record, $empName, $count){
			if($count ==1){
				// $period = '';
				// $data= $this->fetch_array($record);
				// $type = $data['TrackingType'];
				// $status = $data['Status'];
				// $claimant = $data['Claimant'];
				// $year = $data['Year'];
				
				// $docType = $data['DocumentType'];
				// if($type == 'PR'){
				// 	$docType = 'Purchase Request';
				// }
				// $fund = $data['Fund'];
				// $claimType =  $data['ClaimType'];

				// $office = $data['Office'];
				// $sql = "SELECT Name FROM office WHERE Code = '".$office."' LIMIT 1";
				// $record = $this->query($sql);
				// $data0 = $this->fetch_array($record);
				// $office = $data0['Name'];


				// $category = $data['PR_CategoryCode'];
				// $sql = "SELECT Description FROM ppmpcategories WHERE Code = '".$category."' LIMIT 1";
				// $record = $this->query($sql);
				// $data1 = $this->fetch_array($record);
				// $catName = $data1['Description'];


				// $encodedBy = $data['EncodedBy'];
				// $sql = "SELECT CONCAT(LastName,', ', FirstName, ' ', MiddleName) as encodedBy 
				// 		FROM citydoc.employees WHERE EmployeeNumber = '".$encodedBy."' LIMIT 1";
				// $record = $this->query($sql);
				// $data2 = $this->fetch_array($record);
				// $encodedBy = utf8_encode($data2['encodedBy']);

				
				// $tn = $data['TrackingNumber'];
				// $obr = $data['OBR_Number'];
				// $po = $data['PO_Number'];
				// $pr = $data['PR_Number'];
				// $adv = $data['ADV1'];
				// $remark = $data['Remarks'];
				
				// $dateEncoded = $data['DateEncoded'];
				// $dateModified = $data['DateModified'];
				// $completion = $data['Completion'];
				// if($type == 'PY'){
				// 	$periodType = $data['PeriodType']; 
				// 	$periodMonth= $data['PeriodMonth']; 
				// 	if($periodType == 1){
				// 		$period = $periodMonth . ' (1 - 15)';
				// 	}else if ($periodType == 2){
				// 		$period = $periodMonth . ' (16 - 31)';
				// 	}else{
				// 		$period = $periodMonth;
				// 	}
				// }else {
				// 	$period =  $this->numberToQuarter($data['PR_Month']);
				// }

				// return $this->CreatePublicTable($status,$office,$dateModified,$claimant,$docType,$claimType,$fund,$period,$category,$tn,$pr,$obr,$po,$adv,$dateEncoded,$encodedBy,$completion,$catName,$year,$remark);
					
				$newRecord = [];
				$data = $this->fetch_array($record);
				$newRecord['TrackingType'] = $data['TrackingType'];
				$newRecord['Status'] = $data['Status'];
				$newRecord['Claimant'] = $data['Claimant'];
				$newRecord['Year'] = $data['Year'];
				$year = $data['Year'];
				$db = $this->getDB($year);
				
				if($year >= '2017') {
					$newRecord['DocumentType'] = $data['DocumentType'];
					if($newRecord['TrackingType'] == 'PR') {
						$newRecord['DocumentType'] = 'Purchase Request';
					}
				}else {
					$newRecord['DocumentType'] = $data['TransactionType'];
					if($newRecord['TrackingType'] == 'PR') {
						$newRecord['DocumentType'] = 'Purchase Request';
					}
				}
			
			
				$newRecord['Fund'] = $data['Fund'];
				$newRecord['ClaimType'] = $data['ClaimType'];
			
				$newRecord['Office'] = $data['Office'];
				$sql = "SELECT Name FROM ".$db.".office WHERE Code = '".$newRecord['Office']."' LIMIT 1";
				$record0 = $this->query($sql);
				$data0 = $this->fetch_array($record0);
				$newRecord['OfficeName'] = $data0['Name'];
				
				$newRecord['PR_CategoryCode'] = $data['PR_CategoryCode'];
				if($newRecord['PR_CategoryCode'] != "") {

					if($year >= '2018') {
						$sql = "SELECT Description FROM ".$db.".ppmpcategories WHERE Code = '".$newRecord['PR_CategoryCode']."' LIMIT 1";
						$record1 = $this->query($sql);
						$data1 = $this->fetch_array($record1);
						$newRecord['PR_CategoryName'] = $data1['Description'];
					}else {
						$sql = "SELECT category_name FROM ".$bac."item_categories WHERE category_key = '".$newRecord['PR_CategoryCode']."' LIMIT 1";
						$record1 = $this->query($sql);
						$data1 = $this->fetch_array($record1);	
						$newRecord['PR_CategoryName'] = $data1['category_name'];
					}
					
				}else {
					$newRecord['PR_CategoryName'] = '';
				}
				
			
				$newRecord['EncodedBy'] = $data['EncodedBy'];
				$sql = "SELECT LastName, FirstName, MiddleName FROM citydoc.employees WHERE EmployeeNumber = '".$newRecord['EncodedBy']."' LIMIT 1";
				$record2 = $this->query($sql);
				$data2 = $this->fetch_array($record2);
				$newRecord['EncodedName'] = utf8_encode($data2['LastName'].', '.$data2['FirstName'].' '.$data2['MiddleName']);
			
				$newRecord['TrackingNumber'] = $data['TrackingNumber'];
				$newRecord['OBR_Number'] = $data['OBR_Number'];
				$newRecord['PO_Number'] = $data['PO_Number'];
				$newRecord['PR_Number'] = $data['PR_Number'];
				$newRecord['ADV1'] = $data['ADV1'];
				$newRecord['Remarks'] = $data['Remarks'];
				$newRecord['DateEncoded'] = $data['DateEncoded'];
				$newRecord['DateModified'] = $data['DateModified'];
				$newRecord['Completion'] = $data['Completion'];
			
				if($newRecord['TrackingType'] == 'PY'){
					$periodType = $data['PeriodType']; 
					$periodMonth= $data['PeriodMonth']; 
					if($periodType == 1){
						$newRecord['Period'] = $periodMonth . ' (1 - 15)';
					}else if ($periodType == 2){
						$newRecord['Period'] = $periodMonth . ' (16 - 31)';
					}else{
						$newRecord['Period'] = $periodMonth;
					}
				}else {
					$newRecord['Period'] =  $this->numberToQuarter($data['PR_Month']);
				}
				
				echo $this->CreatePublicTable($newRecord);
			
			
			}else{
				$sheet = '<table style = "border-spacing:0; margin:0 auto;width:98%;">';
				$i =1;
				$sheet .= '<tr >';
				$sheet .= ' <td class = "td4"></td>
							<td class = "td4"><span class = "label7" style = "">TN#</span></td>
							<td class = "td4"><span class = "label7" style = "">OFFICE</span></td>
							<td class = "td4"><span class = "label7" style = "">PAYROLL</span></td>
							<td class = "td4"><span class = "label7" style = "">NAME</span></td>
							<td class = "td4"><span class = "label7" style = "">DOCUMENT</span></td>
							<td class = "td4"><span class = "label7" style = "text-align:center;">PERIOD</span></td>
							<td class = "td4" style = "text-align:center;" ><span class = "label7" >STATUS</span></td>
							<td class = "td4" ><span class = "label7" style = "">UPDATED</span></td>
							</tr>';
								
				while($data = $this->fetch_array($record)){
					$period = '';
					$office = $data['Name'];
					$status = $data['Status'];
					$claimant = strtoupper($data['Claimant']);
					
					//$docType = $data['DocumentType'];
					//$type = $docType; 
					
					$docType = explode('-',$data['DocumentType']);
					if(sizeof($docType) > 1){
						$dType = $docType[1]; 
					}else{
						$dType = $data['DocumentType']; 
					}
					
					
					
					
					$tn = $data['TrackingNumber'];
					
					$dateModified = $data['DateModified'];

					$fullName = $empName;

					$periodType = $data['PeriodType']; 
					$periodMonth= $data['PeriodMonth']; 
					if($periodType == 1){
						$period = $periodMonth . ' (1 - 15)';
					}else if ($periodType == 2){
						if(strtoupper($periodMonth) == "FEBRUARY"){
							$period = $periodMonth . ' (16 - 28)';
						}else{
							$period = $periodMonth . ' (16 - 31)';
						}
					}else if($periodType == 4){
						$period = $periodMonth . ' (1 - 15)';
					}else if ($periodType == 5){
						if(strtoupper($periodMonth) == "FEBRUARY"){
							$period = $periodMonth . ' (16 - 28)';
						}else{
							$period = $periodMonth . ' (16 - 31)';
						}

					}else{
						$period = $periodMonth;
					}

					if($i % 2 == 0){
						$sheet .= '<tr  style = "background-color:rgba(2, 2, 2,.3); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
					}else{
						$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
					}
					
						$sheet .= '<td style = "padding:3px 5px;"><div class = "number" style="font-size:18px;">' . $i++ . '</div></td>
								<td class = "td3"><span class = "label5" style = "font-size:15px;">' . $tn . '</span></td>

								<td  class = "td3"  style = "">
									<span class = "" style = "color:black;font-size:15px;">' . $office . '</span>
								</td>
								<td  class = "td3"  style = "">
									<span class = "" style = "color:black;font-size:15px;">' . $claimant . '</span>
								</td>
								<td  class = "td3"  style = "">
									<span class = "" style = "color:black;font-size:15px;">' . $fullName . '</span>
								</td>
								<td  class = "td3" style = "padding-left:8px;" >
									<span  style = "color:black;font-size:15px;">' . $dType . '</span>
								</td>
								<td  class = "td3" style = "padding-left:8px;text-overflow:nowrap;white-space: nowrap;" >
									<span  style = "color:white;font-size:15px;text-shadow:0px 0px 2px black;">' . $period . '</span>
								</td>
								<td  class = "td3"  style = "background-color:rgba(2, 2, 2,.6);padding-left:10px;padding-right:10px;text-overflow:nowrap;white-space: nowrap; ">';
								if($status == 'CAO Released'){
									$sheet .= '<span  style = "color:rgb(235, 76, 158);font-size:15px;text-shadow:0px 0px 2px black;">' . $status. '</span>';
								}else {
									if(strpos($status, 'Pending') !== false){
										$sheet .= '<span  style = "color:green;font-size:15px;">' . $status. '</span>';
									}else{
										$sheet .= '<span  style = "color:rgb(23, 183, 236);font-size:15px;">' . $status. '</span>';
									}
									//$sheet .= '<span  style = "font-size:21px;text-shadow:0px 0px 2px white;">' . $status. '</span>';
									//$sheet .= '<span  style = "color:rgb(23, 183, 236);font-size:21px;">' . $status. '</span>';
								}
						/*$sheet .= '</td>
								<td  class = "td3"  style = "background-color:rgb1a(2, 2, 2,.3); ">
									<span  style = "color:white;font-size:12px;font-family:verdana;padding-left:5px;">' . $this->ezDate($dateModified). '</span>
								</td>
							</tr>';*/
						$sheet .= '</td>
								<td  class = "td3"  style = "background-color:rgb1a(2, 2, 2,.3); ">
									<span  style = "text-overflow:nowrap;white-space: nowrap;color:white;font-size:12px;font-family:verdana;padding-left:5px;">' . $dateModified. '</span>
								</td>
							</tr>';
					
				}
				return $sheet .= '</table>';
			}
		}
		function CreateListResultPrivate2022($newRecord,$status,$count,$i,$id,$prime){
			
			if($prime == 0){
				$sheet = '<table style = "border-spacing:0; margin:0 auto;min-width:900px;max-width:1000px;border-bottom:1px solid rgb(204, 209, 212);">';
				$sheet .= '<tr>';
			}else{
				$sheet = '<tr>';
			}
			$sheet .= '<td class = "td4"></td>
					<td class = "td4" ><span class = "label7tracker" style = "">TN#</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">OBR</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">ADV</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">PR</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">PO</span></td>
					
					<td class = "td4"><span class = "label7tracker" style = "">Claimant</span></td>
					
					<td colspan = "2" class = "td4"  style = "text-align:center;"><span class = "label7tracker">Month</span></td>
					<td class = "td4"><span class = "label7tracker" style = "">Document</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Amount</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Check</span></td>
					
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Status</span></td>
					<td class = "td4" style = "text-align:center;" ><span class = "label7tracker" >Updated</span></td>
					<td class = "td4" style = "text-align:center;display:none;"><span class = "label7tracker" >Completed</span></td>
					</tr>';
			
			foreach ($newRecord as $tn => $value) {
				$id = $value['Id'];
				$office = $value['OfficeName'];
				$type = $value['TrackingType'];
				$status = $value['Status'];
				$claimant = $value['Claimant'];
				$check = $value['checknumber'];
				$docType = $value['DocumentType'];
				$fund = $value['Fund'];
				$claimType = $value['ClaimType'];
				$amount = $value['Amount'];
				$tn = $value['TrackingNumber'];
				$obr = $value['OBR_Number'];
				$po = $value['PO_Number'];
				$pr = $value['PR_Number'];
				$adv = $value['ADV'];
				$dateEncoded = $value['DateEncoded'];
				$dateModified = $value['DateModified'];
				$completion = $value['Completion'];
				$encodedBy = $value['EncodedBy'];
				$period = $value['Period'];
				$periodMonth = $value['PeriodMonth'];

				if($i % 2 == 0){
					$sheet .= '<tr  style = "background-color:rgb(217, 228, 232); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}else{
					$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}
				
				$sheet .= '<td style = "padding:0px 5px;background-color:white;border-left:1px solid rgb(204, 209, 212);">
							<div class = "numberPrivate" style = "text-align:center;">' . $i++ . '</div>
						</td>
						<td class = "td3"  style = "padding:2px 5px;border-left:1px solid rgb(165, 184, 193);border-right:1px solid rgb(165, 184, 193);">
							<span class = "label5tracker" style = "font-style:italic;color:rgb(7, 146, 185);font-size:13px;">' . $tn . '</span>
						</td>
						<td  class = "td3" style = "text-align:center;background-color:rga(2, 2, 2,.3); border-right:1px solid rgb(165, 184, 193);">
							<span class= "label5tracker" style = "color:rgb(225, 74, 127);">' . $obr . '</span>
						</td>
						<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
							<span class= "label5tracker" style = "color:rgb(9, 147, 18);">' . $adv . '</span>
						</td>
						<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
							<span class= "label5tracker" style = "color:rgb(219, 118, 10);">' . $pr . '</span>
						</td>
						<td  class = "td3" style = "padding:2px 6px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
							<span class= "label5tracker" style = "color:rgb(107, 109, 14);">' . $po . '</span>
						</td>
						<td  class = "td3" style = "background-color:rga(2, 2, 2,.3); padding:2px 5px; ">
							<span class= "label5tracker" style = "">' . $claimant . '</span>
						</td>
						<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
							<span class = "label5tracker"  >' . $periodMonth  . '</span>
						</td>
						<td  class = "td3" style = "text-align:left;padding-right:10px;">
							<span  class = "label5tracker"  >' . $period. '</span>
						</td>
						<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
							<span class = "label5tracker"  >' . $docType  . '</span>
						</td>
						<td  class = "td3" style ="text-align:right;border-left:1px solid rgb(204, 209, 212); padding:0px 5px;color:rgb(212, 15, 35);">
							<span class = "label5tracker"  >' . number_format($amount,2) . '</span>
						</td>
						<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
							<span class = "label5tracker"  style = "font-style:italic;letter-spacing:1px;font-size:10px;padding:0px 5px;">' . $check . '</span>
						</td>
						<td  class = "td3"  style ="text-align:center;border-left:1px solid rgb(165, 184, 193); border-right:1px solid rgb(204, 209, 212);padding:0px 5px;">';
						
				if($status == "Check Advised" ){
					$color = "orange;";
				}else if($status == "Forwarded to CTO"){
					$color = "orange;";
				}else{
					$pos = strpos($status,"Pending");
					if ($pos === false) {
						$color = "rgb(7, 146, 185);";
					}else{
						$color = "rgb(250, 64, 85);";
					}	
				}
				$sheet .= '	<span  class = "label5tracker" style = "color: '  . $color . '">' . $status. '</span>';
				$sheet .= '	</td>';
				$sheet .= '	<td  class = "td3" style = "padding:0px 5px;"  ><span class= "label5tracker" style = "font-size:12px;font-family:Oswald;" >' . $dateModified . '</span></td>';
				
				$sheet .= '	<td class = "td3" style = "display:none;border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212); padding-left:10px;"><span class= "label5tracker" style = "font-size:12px;color:rgb(50, 51, 52)" >' . $completion . '</span></td>
							</tr>';
				
			}
							
			
				
			// 	if($i % 2 == 0){
			// 		$sheet .= '<tr  style = "background-color:rgb(217, 228, 232); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
			// 	}else{
			// 		$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
			// 	}
				
			// 		$sheet .= '<td style = "padding:0px 5px;background-color:white;border-left:1px solid rgb(204, 209, 212);">
			// 					<div class = "numberPrivate" style = "text-align:center;">' . $i++ . '</div>
			// 				</td>
			// 				<td class = "td3"  style = "padding:2px 5px;border-left:1px solid rgb(165, 184, 193);border-right:1px solid rgb(165, 184, 193);">
			// 					<span class = "label5tracker" style = "font-style:italic;color:rgb(7, 146, 185);font-size:13px;">' . $tn . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "text-align:center;background-color:rga(2, 2, 2,.3); border-right:1px solid rgb(165, 184, 193);">
			// 					<span class= "label5tracker" style = "color:rgb(225, 74, 127);">' . $obr . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
			// 					<span class= "label5tracker" style = "color:rgb(9, 147, 18);">' . $adv . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
			// 					<span class= "label5tracker" style = "color:rgb(219, 118, 10);">' . $pr . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "padding:2px 6px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
			// 					<span class= "label5tracker" style = "color:rgb(107, 109, 14);">' . $po . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "background-color:rga(2, 2, 2,.3); padding:2px 5px; ">
			// 					<span class= "label5tracker" style = "">' . $claimant . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
			// 					<span class = "label5tracker"  >' . $periodMonth  . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "text-align:left;padding-right:10px;">
			// 					<span  class = "label5tracker"  >' . $period. '</span>
			// 				</td>
			// 				<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
			// 					<span class = "label5tracker"  >' . $doc[1]  . '</span>
			// 				</td>
			// 				<td  class = "td3" style ="text-align:right;border-left:1px solid rgb(204, 209, 212); padding:0px 5px;color:rgb(212, 15, 35);">
			// 					<span class = "label5tracker"  >' . number_format($amount,2) . '</span>
			// 				</td>
			// 				<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
			// 					<span class = "label5tracker"  style = "font-style:italic;letter-spacing:1px;font-size:10px;padding:0px 5px;">' . $check . '</span>
			// 				</td>
			// 				<td  class = "td3"  style ="text-align:center;border-left:1px solid rgb(165, 184, 193); border-right:1px solid rgb(204, 209, 212);padding:0px 5px;">';
							
			// 				if($status == "Check Advised" ){
			// 					$color = "orange;";
			// 				}else if($status == "Forwarded to CTO"){
			// 					$color = "orange;";
			// 				}else{
			// 					$pos = strpos($status,"Pending");
			// 					if ($pos === false) {
			// 						$color = "rgb(7, 146, 185);";
			// 					}else{
			// 						$color = "rgb(250, 64, 85);";
			// 					}	
			// 				}
			// 				$sheet .= '<span  class = "label5tracker" style = "color: '  . $color . '">' . $status. '</span>';
			// 				$sheet .= '</td>';
			// 				$sheet .= '<td  class = "td3" style = "padding:0px 5px;"  ><span class= "label5tracker" style = "font-size:12px;font-family:Oswald;" >' . $dateModified . '</span></td>';
							
			// 		$sheet .= '<td class = "td3" style = "display:none;border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212); padding-left:10px;"><span class= "label5tracker" style = "font-size:12px;color:rgb(50, 51, 52)" >' . $completion . '</span></td>
			// 			</tr>';
			// }

			if(strlen($status) > 1){
				$searchValue = 'Status*!*' . $status;
			}else{
				$searchValue = 'Claimant*!*' . $key;
			}
			if($count == 40){
				$sheet .= '<tr><td  style = "border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212);text-align:center;padding:8px;"  colspan = "50" >
								<div id ="' . $id . '~' . $i . '~' . $searchValue .  '"  class = "loadMore" onclick = "loadMore(this)">Load more </div>
							</td></tr>';
			}

			unset($newRecord);
			if($prime == 0){
				return $sheet .= '</table>*v*' ;
			}else{
				return $sheet .= '</tr>';
			}
		}

		function CreateListResultPrivate($record,$office,$status,$key,$count,$i,$id,$prime){
			if(strlen($status) > 1){
				$searchValue = 'Status*!*' . $status;
			}else{
				$searchValue = 'Claimant*!*' . $key;
			}
			if($prime == 0){
				$sheet = '<table style = "border-spacing:0; margin:0 auto;min-width:900px;max-width:1000px;border-bottom:1px solid rgb(204, 209, 212);">';
				$sheet .= '<tr >';
			}else{
				$sheet = '<tr >';
			}
			$sheet .= '<td class = "td4"></td>
					<td class = "td4" ><span class = "label7tracker" style = "">TN#</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">OBR</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">ADV</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">PR</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">PO</span></td>
					
					<td class = "td4"><span class = "label7tracker" style = "">Claimant</span></td>
					
					<td colspan = "2" class = "td4"  style = "text-align:center;"><span class = "label7tracker">Month</span></td>
					<td class = "td4"><span class = "label7tracker" style = "">Document</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Amount</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Check</span></td>
					
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Status</span></td>
					<td class = "td4" style = "text-align:center;" ><span class = "label7tracker" >Updated</span></td>
					<td class = "td4" style = "text-align:center;display:none;"><span class = "label7tracker" >Completed</span></td>
					</tr>';
			
			$periodMonth = '';
			$periodType = '';
							
			while($data = $this->fetch_array($record)){
				$color = '';
				$period = '';
				$id  = $data['Id'];
				$office = $data['Name'];
				$type = $data['TrackingType'];
				$status = $data['Status'];
				$claimant = strtoupper($data['Claimant']);
				$check = $data['checknumber'];
				
				$docType = $data['DocumentType'];
				$doc = explode("-",$docType);
				if(sizeof($doc) == 1 ){
					$doc[1] = $docType;
				}
				$category = $data['PR_CategoryCode'];
				if($type == 'PR'){
					$docType = 'Purchase Request';
					$doc[1] = $category;
				}
				$fund = $data['Fund'];
				$claimType =  $data['ClaimType'];
				
				$amount  = $data['Amount'];
				if($data['PO_Amount']> 0){
					$amount = $data['PO_Amount'];
				}
				if($data['TotalAmountMultiple'] > 0){
					$amount = $data['TotalAmountMultiple'];
				}
				
				
				$tn = $data['TrackingNumber'];
				$obr = $data['OBR_Number'];
				$po = $data['PO_Number'];
				$pr = $data['PR_Number'];
				$adv = $data['ADV1'];
				if($adv == 0){
					$adv = $data['ADV2'];
					if($adv == 0){
						$adv = '';
					 }
				}
				
				
				$dateEncoded = $data['DateEncoded'];
				$dateModified = $data['DateModified'];
				$completion = $data['Completion'];
				//$encodedBy = utf8_encode($data['LastName'] . ', ' . $data['FirstName'] . ' ' . $data['MiddleName']);
				$encodedBy = '';
				if($type == 'PY'){
					$periodType = $data['PeriodType']; 
					$periodMonth= $data['PeriodMonth']; 
					if($periodType == 1){
						$period =  '(1 -15)';
					}else if ($periodType == 2){
						if(strtoupper($periodMonth) == "FEBRUARY"){
							$period =  ' (16 - 28)';
						}else{
							$period =  ' (16 - 31)';
						}
					}else if($periodType == 4){
						$period =  '(1 -15)';
					}else if ($periodType == 5){
						if(strtoupper($periodMonth) == "FEBRUARY"){
							$period =  ' (16 - 28)';
						}else{
							$period =  ' (16 - 31)';
						}
					}else{
						$period = "";
					}
				}else {
					$period =  $this->numberToQuarter($data['PR_Month']);
					$period  =  "";
				}

				if($i % 2 == 0){
					$sheet .= '<tr  style = "background-color:rgb(217, 228, 232); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}else{
					$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}
				
					$sheet .= '<td style = "padding:0px 5px;background-color:white;border-left:1px solid rgb(204, 209, 212);">
								<div class = "numberPrivate" style = "text-align:center;">' . $i++ . '</div>
							</td>
							<td class = "td3"  style = "padding:2px 5px;border-left:1px solid rgb(165, 184, 193);border-right:1px solid rgb(165, 184, 193);">
								<span class = "label5tracker" style = "font-style:italic;color:rgb(7, 146, 185);font-size:13px;">' . $tn . '</span>
							</td>
							<td  class = "td3" style = "text-align:center;background-color:rga(2, 2, 2,.3); border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(225, 74, 127);">' . $obr . '</span>
							</td>
							<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(9, 147, 18);">' . $adv . '</span>
							</td>
							<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(219, 118, 10);">' . $pr . '</span>
							</td>
							<td  class = "td3" style = "padding:2px 6px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(107, 109, 14);">' . $po . '</span>
							</td>
							<td  class = "td3" style = "background-color:rga(2, 2, 2,.3); padding:2px 5px; ">
								<span class= "label5tracker" style = "">' . $claimant . '</span>
							</td>
							<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
								<span class = "label5tracker"  >' . $periodMonth  . '</span>
							</td>
							<td  class = "td3" style = "text-align:left;padding-right:10px;">
								<span  class = "label5tracker"  >' . $period. '</span>
							</td>
							<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
								<span class = "label5tracker"  >' . $doc[1]  . '</span>
							</td>
							<td  class = "td3" style ="text-align:right;border-left:1px solid rgb(204, 209, 212); padding:0px 5px;color:rgb(212, 15, 35);">
								<span class = "label5tracker"  >' . number_format($amount,2) . '</span>
							</td>
							<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
								<span class = "label5tracker"  style = "font-style:italic;letter-spacing:1px;font-size:10px;padding:0px 5px;">' . $check . '</span>
							</td>
							<td  class = "td3"  style ="text-align:center;border-left:1px solid rgb(165, 184, 193); border-right:1px solid rgb(204, 209, 212);padding:0px 5px;">';
							
							if($status == "Check Advised" ){
								$color = "orange;";
							}else if($status == "Forwarded to CTO"){
								$color = "orange;";
							}else{
								$pos = strpos($status,"Pending");
								if ($pos === false) {
									$color = "rgb(7, 146, 185);";
								}else{
									$color = "rgb(250, 64, 85);";
								}	
							}
							$sheet .= '<span  class = "label5tracker" style = "color: '  . $color . '">' . $status. '</span>';
							$sheet .= '</td>';
							$sheet .= '<td  class = "td3" style = "padding:0px 5px;"  ><span class= "label5tracker" style = "font-size:12px;font-family:Oswald;" >' . $dateModified . '</span></td>';
							
					$sheet .= '<td class = "td3" style = "display:none;border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212); padding-left:10px;"><span class= "label5tracker" style = "font-size:12px;color:rgb(50, 51, 52)" >' . $completion . '</span></td>
						</tr>';
			}
			if($count == 40){
				$sheet .= '<tr><td  style = "border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212);text-align:center;padding:8px;"  colspan = "50" >
								<div id ="' . $id . '~' . $i . '~' . $searchValue .  '"  class = "loadMore" onclick = "loadMore(this)">Load more </div>
							</td></tr>';
			}
			if($prime == 0){
				return $sheet .= '</table>*v*' ;
			}else{
				return $sheet .= '</tr>';
			}
		}
	
		function CreateAdvice($record,$view){
			if($this->num_rows($record)>0){
				$sheet='<table style = "height:100%;width:100%;border-spacing:0;border:0px solid black; border-bottom:0px solid black;font-family:oswald;"  border ="0">';
				$i =1;
				$y = 1;
				$ids = '';
				while($data = $this->fetch_array($record)){
					
					$id = $data['Id'];
					$trackingNumber =$data["TrackingNumber"]; 
					$adviceId = $data['AdviceId'];
					$fund = $data['Fund'];
					$accountNumber = $data['AccountNo'];
					$adv = $data['Adv1'];
					
					$adv2 = $data['Adv2'];
					if($adv ==0 || $adv == ""){
						$adv = $adv2 . 'a';
					}	

					$checkNumber =$data['CheckNumber'];
					$checkDate =$data['CheckDate'];
					$claimant = strtoupper($data['Claimant']);
					$size = strlen($claimant);
					
					
					//$amount =$data['Amount'];
					//$poAmount =$data['PO_Amount'];
					
					//$payee =   $data['Payee'];
					$payee = strtoupper(utf8_encode($data['Payee'])) ;
					
					
					/*if($poAmount >0){
						$amount = $poAmount;
					}
					$multiple =$data['TotalAmountMultiple'];
					if($multiple > 0){
						$amount = $multiple;
					}
					$firstPay =$data['PayrollAmountFirst'];
					if($firstPay > 0){
						$amount = $firstPay;
					}
					$amount = number_format($amount,2);*/
					$amount =  $data['NetAmount'];
					
					$ids .= ',' . $id;
					if($view == 'tba'){
						if($y == 1){
							$sheet .=$this->AdviceHeader();
							$sheet .= $this->AdviceTableHeader($view);
						}else if($y >= 101){
							$sheet .=$this->AdviceFooter();
							$sheet .=$this->AdviceHeader();
							$sheet .= $this->AdviceTableHeader($view);
							$y =1;
						}
					}else{
						if($y == 1){
							if($view == "aAll" ){
								$note = 'All transaction with checks.';
							}else if($view == "ad"){
								$note = 'All adviced checks.';
							}
							$sheet .= '<tr><td colspan = "10" style = "border-bottom:1px solid black;padding-top:30px;height:10px;">' . $note . '</td></tr>';
							$sheet .= $this->AdviceTableHeader($view);
						}
					}
					$sheet .='<tr class = "tdData">';
					$sheet .='<td class = "tdData"  style = "border-left:1px solid black;width:15px;height:10px;">' . $i++  . '</td>';
					if($view != 'tba'){
						$sheet .='<td class = "tdData" style = "width:10px;font-size:14px;" >' . $adviceId . '</td>';
					}
					$sheet .='<td class = "tdData" style = "font-size:14px;">' . $accountNumber  . '</td>';
					$sheet .='<td class = "tdData"style = "font-size:14px;">' .  $adv .  '</td>';
					$sheet .='<td class = "tdData" style = "padding:0px 5px;font-size:16px;letter-spacing:1px;">' . $checkNumber .  '</td>';
					$sheet .='<td class = "tdData" style = "font-size:14px;">' . $checkDate .  '</td>';
					$sheet .='<td class = "tdData" style = "text-align:left;padding-left:5px;"><div  style = "border:0;width:100%; resize:none;wrap:hard;  margin:0;font-size:14px;" >' .  $payee . '</div></td>';
					$sheet .='<td class = "tdData" style = "text-align:right;border-right:1px solid black;font-size:16px;letter-spacing:1px;">' . number_format($amount,2) .  '</td>';
					$sheet .='</tr>';
					$y++;
				}
				$sheet .='<tr><td class = "tdData" colspan = "10" style = "border:0;padding:0;padding-top:5px;text-align:center;font-weight:bold;letter-spacing:2px;" >- Nothing follows -</td></td>';
				if($view == 'tba'){
					$sheet .=$this->AdviceFooter();
				
				}else{
					$sheet .='<tr><td colspan = "10" style = "" ></td></td>';
				}
				
				$sheet .= '</table>';
				$sheet .= '<input id = "adviceHidden" type = "hidden" value = "' . substr($ids,1,strlen($ids)-1) . '"/>';
				
				
				
				$adviceCount = 0;
				if($view == 'tba'){
					if(strtoupper($fund) == "GENERAL FUND"){
						$sql1 = "SELECT max(Adviceno)  as MaxNo  FROM adviceinfo where  substr(AdviceId,1,3) = 100";
					}
					if($fund == "SEF"){
						$sql1 = "SELECT max(Adviceno)  as MaxNo  FROM adviceinfo where  substr(AdviceId,1,3) = 200";
					}
					if(strtoupper($fund) == "TRUST FUND"){
						$sql1 = "SELECT max(Adviceno)  as MaxNo  FROM adviceinfo where  substr(AdviceId,1,3) = 300";
					}
					
					$record1 = $this->query($sql1);
					$data = $this->fetch_array($record1);
					$adviceNo  = $data['MaxNo'];
					
					if($adviceNo == ''){
						$adviceCount =  1;
					}else{
						$adviceNo = $adviceNo + 1;
						$adviceCount =  $adviceNo;
					}
				}
				return $sheet . 'xValx' .  $adviceCount;
			}else{
				return 0;
			}
		}
		function  AdviceHeader(){
			$sheet  ='<tr><td colspan = "8" style = "border-bottom:1px solid black;height:10px;vertical-align:top;"><table id = "tableForm" border="0" style = "margin-top:50px;">
						<tr>
							<td  colspan = "2" >
								<div style = "font-size:18px;text-align:center;font-weight: bold;">REPUBLIC OF THE PHILIPPINES</div>
								<div style = "font-size:14px;text-align:center;">CITY GOVERNMENT OF DAVAO</div>
							</td>
						</tr>
						
						<tr>
							<td  colspan = "2" style = "padding-bottom: 10px;">
								<div style = "font-size:18px;text-align:center;font-weight: bold;padding-top:15px;">ACCOUNTANT\'S ADVICE OF LOCAL</div>
								<div style = "font-size:18px;text-align:center;font-weight: bold;padding-bottom: 20px;padding">CHECK DISBURSEMENT</div>
							</td>
						</tr>
						
						<tr>
							<td  style = "vertical-align: top;">
								<table style="font-size:14px;">
									<tr>
										<td>To:</td>
										<td>The Bank Manager</td>
									</tr>
									<tr>
										<td>&nbsp;</td>
										<td  >LAND BANK OF THE PHILIPPINES</td>
									</tr>
								</table>
							</td>
							<td  >
								<table style = "float:right;font-size:14px;" >
									<tr>
										<td  style = "">Advice No : </td>
										<td style = "font-weight: bold;"><span id = "adviceContainer">xx-x</span></td>
									</tr>
									<tr>
										<td style = "text-align:right">Date : </td>
										<td>' . date("M d, Y") . '</td>
									</tr>
									<tr>
										<td  style = "text-align:right">Time : </td>
										<td  style="">' . date('h:i A')   . '';
							$sheet .='		</td>
									</tr>
								</table>
							</td>
						</tr>
						
						<tr>
							<td colspan="2" style ="padding:5px;padding-left:30px;padding-top:0px;"><input style = "font-family:Oswald;border:0;font-size:14px;width:500px; " value = "Please be informed that the following checks were issued by this office:"/></td>
						</tr></table></td></tr>';
						return $sheet;
		}
		function  AdviceTableHeader($view){
			$sheet ='<tr>';
			if($view != 'tba'){
				$sheet .='<td class = "tdHeader" style = "border-left:1px solid black;width:10px;" colspan = "2">ADVICE&nbsp;NO.</td>';
				$sheet .='<td class = "tdHeader" style = "width:10px;">ACCOUNT&nbsp;NO.</td>';
			}else{
				$sheet .='<td class = "tdHeader" colspan = "2" style = "border-left:1px solid black;width:10px;">ACCOUNT&nbsp;NO.</td>';
			}
			$sheet .='<td class = "tdHeader" style = "width:10px;height:10px;">ADV&nbsp;NO.</td>';
			$sheet .='<td class = "tdHeader" style = "width:10px;">CHECK&nbsp;NO.</td>';
			$sheet .='<td class = "tdHeader" style = "width:10px;">DATE</td>';
			$sheet .='<td class = "tdHeader" style ="text-align:left;">PAYEE</td>';
			$sheet .='<td class = "tdHeader" style = "border-right:1px solid black;width:10px;">AMOUNT</td>';
			$sheet .='</tr>';
			return $sheet;
		}
		function  AdviceFooter(){
			$sheet = '<tr><td colspan = "8" style = "vertical-align:bottom;padding-bottom:30px;"><table style = "width:100%;height:100px;" border ="0">
							<tr>
								<td style = "">
									<table style = "margin-top:20px;" border ="0">
										<tr>
											<td  style = "font-size:14px;">Certified Correct : </td>
										</tr>
										<tr>
											<td>&nbsp;</td>
											<td style = "padding-top:10px;">
												<div ><input value = "VINGELIN A. BAJAN"  style = "font-size:14px;border:0;width:200px;margin:0 auto;text-align:center;"/></div>
												<div style = "border-top:1px solid black;font-size:13px;text-align: center;"> City Accountant</div>
											</td>
										</tr>
										
										<tr>
											<td  style = "font-size:14px;">Delivered by : </td>
										</tr>
										<tr>
											<td>&nbsp;</td>
											<td style = "padding-top:0px;font-size:14px;">
												<div style = "text-align: center;"><input value ="" style = "text-align:center; border:0;width:200px;"/></div>
												<div style = "border-top:1px solid black;font-size:13px;text-align: center;">Accountant\'s Representative</div>
											</td>
										</tr>
										
									</table>
								</td>
								<td style = "vertical-align: bottom;padding-right:10px;">
									<table style = "float:right;" border ="0">
										<tr>
											<td>&nbsp;</td>
											<td style = "padding-top:10px;font-size:14px;">
												<div style = "border-top:1px solid black;">Bank&nbsp;Representative</div>
											</td>
										</tr>
										<tr>
											<td style = "padding-top:10px;font-size:14px;">Date&nbsp;Received&nbsp;: </td>
											<td style = "padding-top:10px;font-size:14px;border-bottom: 1px solid black;"></td>
										</tr>
										
										
									</table>
								</td>
							</tr>
						</table></td></tr>';
						return $sheet;
		}	
		function CreateSearchAdvice($record){
			if($this->num_rows($record)>0){
				$sheet='<table style = "height:100%;width:100%;border-spacing:0;font-family:Oswald;" border ="0" >';
				/*$sheet .='<tr>';
					$sheet .='<td class = "tdHeader" colspan = "2">Account No.</td>';
					$sheet .='<td class = "tdHeader">ADV No.</td>';
					$sheet .='<td class = "tdHeader">Check No.</td>';
					$sheet .='<td class = "tdHeader">Date</td>';
					$sheet .='<td class = "tdHeader" style ="text-align:left;">Payee</td>';
					$sheet .='<td class = "tdHeader" style = "border-right:0px;">Amount</td>';
				$sheet .='</tr>';*/
				
				
				$i =1;
				$y = 1;
				$ids = '';
				while($data = $this->fetch_array($record)){
					
					$id = $data['Id'];
					$trackingNumber =$data["TrackingNumber"]; 
					$adviceId = $data['AdviceId'];
					$accountNumber = $data['AccountNo'];
					$adv =$data['Adv1'];
					$adv2 = $data['Adv2'];
					if($adv ==0 || $adv == ""){
						$adv = $adv2 . 'a';
					}	
					
					$checkNumber =$data['CheckNumber'];
					$checkDate =$data['CheckDate'];
					$claimant = strtoupper($data['Claimant']);
					$payee = strtoupper(utf8_encode($data['Payee'])) ;
					/*$amount =$data['Amount'];
					$poAmount =$data['PO_Amount'];
					if($poAmount >0){
						$amount = $poAmount;
					}
					$multiple =$data['TotalAmountMultiple'];
					if($multiple > 0){
						$amount = $multiple;
					}
					$firstPay =$data['PayrollAmountFirst'];
					if($firstPay > 0){
						$amount = $firstPay;
					}*/
					$amount = number_format( $data['NetAmount'],2);
					
					$ids .= ',' . $id;
					
					
					if($y == 1){
						$sheet .=$this->AdviceHeader();
						$sheet .= $this->AdviceTableHeader("tba");
					}else if($y >= 21){
						/*$sheet .=$this->AdviceFooter();
						/*$sheet .=$this->AdviceHeader();
						$sheet .= $this->AdviceTableHeader("tba");
						$y =1;*/
					}
					
					
					$sheet .='<tr class = "tdData">';
					$sheet .='<td class = "tdData" style = "border-left:1px solid black;height:10px;width:10px;">' . $i++  . '</td>';
					$sheet .='<td class = "tdData" style = "font-size:14px;" >' . $accountNumber  . '</td>';
					$sheet .='<td class = "tdData" style = "width:10px;font-size:14px;">' .  $adv .  '</td>';
					$sheet .='<td class = "tdData" style = "width:10px;font-size:17px;letter-spacing:1px;">' . $checkNumber .  '</td>';
					$sheet .='<td class = "tdData" style = "width:10px;font-size:14px;">' . $checkDate .  '</td>';
					$sheet .='<td class = "tdData" style = "text-align:left;padding-left:5px;font-size:14px;"><div>' . $payee .  '</div></td>';
					$sheet .='<td class = "tdData" style = "text-align:right;border-right:1px solid black;width:10px;font-size:14px;font-size:17px;letter-spacing:1px;">' . $amount .  '</td>';
					$sheet .='</tr>';
					$y++;
				}
				$sheet .='<tr><td class = "tdData" colspan = "10" style = "border:0;padding:0;padding-top:5px;text-align:center;font-weight:bold;letter-spacing:2px;" >- Nothing follows -</td></td>';
				$sheet .=$this->AdviceFooter();
				$sheet .= '</table>';
				return $sheet . 'xValx' . $adviceId ;
			}else{
				return 0;
			}
		}
		function CreateLingapAdded($record){
			$data = $this->fetch_array($record);
			$id = $data['Id'];
			$name = $data['Name'];
			$raf = $data['RAF'];
			$amount = number_format($data['Amount'],2);
			
			if($id % 2 == 0){
				$color = "rgb(211, 233, 199)";
			}else{
				$color = "";
			}
			$sheet = '
					<td class = "tdData" style= "background-color:' . $color . ';text-align:center;">' . $id . '</td>
					<td class = "tdData" style= "background-color:' . $color . ';text-align:center;">' . $raf . '</td>
			                <td class = "tdData" style= "background-color:' . $color . '">' . $name . '</td>
			                <td class = "tdData" style= "background-color:' . $color . ' ; text-align:right;">' . $amount . '</td>';
			return $sheet ;
		}
		function CreateLingapEncoded($record){
			$sheet ='<table id =  "beneficiaryTable" style = "width:100%;border-spacing:0;">';
			$sheet .='<tr>
						<td class = "tdHeader" style = "text-align:center;">ID</td>
						<td class = "tdHeader">RAF</td>
						<td class = "tdHeader" style = "text-align: left;">NAME</td>
						
						<td class = "tdHeader">AMOUNT</td>
						<td class = "tdHeader" style = "background-color:rgb(13, 65, 5)"><input id = "mainLingapCheck" type = "checkbox" checked onclick = "computeAll(this)"></td>
					<tr>';	
			$i =1;
			$total = 0;		
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$name = $data['Name'];
				$raf = $data['RAF'];
				$amount = $data['Amount'];
				$total = $total + $amount;
				if($i % 2 == 0){
					$color = "rgb(229, 236, 225)";
				}else{
					$color = "";
				}
				$sheet .= '<tr style= "background-color:' . $color . ';">
							<td class = "tdData" style= "text-align:center;">' . $id . '</td>
							<td class = "tdData" style= "text-align:center;">' . $raf . '</td>
					                <td class = "tdData" style= "">' . $name . '</td>
					                <td class = "tdData" style= " text-align:right;">' . number_format($amount,2) . '</td>
					                 <td class = "tdData" style= " text-align:center;"><input type = "checkbox" checked onclick = "computeTotal(this)"></td>
					         </tr>';
				$i++;	         
			}
			if($i == 1){
				$sheet .= '<tr style= "">
							<td colspan = "5" class = "tdData" style= "text-align:center;">No record.</td>
					         </tr>';
			}
			$sheet .= '<table>';	
			return $sheet  . '~!~'  . number_format($total,2) ;
		}
		function CreateLingapTracked($record,$status,$claimant,$fund){
			$count = $this->num_rows($record);
			if($count	> 1){
				$bLing = "buttonRemoveLingap";
			}else{
				$bLing = "hide";
			}
			$sheet ='<table id =  "beneficiaryTable" style = "width:100%;border-spacing:0;">';
			$sheet .='<tr>
						<td colspan = "5"class = "td1Header" style = "text-align:center;width:10px;padding:5px 10px;padding-right:30px;">
							<span style = "float:right;font-family:tahoma;">
								<span style = "color:grey;font-size:13px;">Status&nbsp;:</span>&nbsp;<span style = "font-weight:bold;color:rgb(4, 117, 23);font-size:14px;">' . $status  . '</span>
								<span style = "color:grey;font-size:13px;">Claimant&nbsp;:</span>&nbsp;<span style = "font-weight:bold;color:rgb(4, 117, 23);font-size:14px;" id="lingClaimant">' . $claimant . '</span>
								<input type="hidden" id="lingFund" value="'.$fund.'">
							</span>
						</td>
					</tr>';
			$sheet .='<tr>
						<td class = "tdHeader" style = "text-align:center;width:10px;">ID</td>
						<td class = "tdHeader" style = "text-align: center;width:10px;">RAF</td>
						<td class = "tdHeader" style = "text-align: left;">NAME</td>
						
						<td class = "tdHeader">AMOUNT</td>
						<td class = "tdHeader" style = "width:80px;"></td>
					<tr>';	
			$i =1;
			$total = 0;		
			while($data = $this->fetch_array($record)){
				$trackingNumber =  $data['TrackingNumber'];
				$id = $data['Id'];
				$name = $data['Name'];
				$raf = $data['RAF'];
				$amount = $data['Amount'];
				$total = $total + $amount;
				if($i % 2 == 0){
					$color = "rgb(229, 236, 225)";
				}else{
					$color = "";
				}
				$sheet .= '<tr style= "background-color:' . $color . ';">
							<td class = "tdData" style= "text-align:center;">' . $id . '</td>
							<td class = "tdData" style= "text-align:center;"><input onkeydown="return isAmount(this,event)" style = "background-color:transparent;width:100px;text-align:center;padding:3px 5px;border:0;" maxlength = "8" value ="' . $raf . '"/></td>
					                <td class = "tdData" style= ""><input maxlength = "35" style = "background-color:transparent;width:100%;text-align:left;padding:3px 5px;border:0;;" value ="' . $name . '"/></td>
					                <td class = "tdData" style= " text-align:center;"><input maxlength = "9" onkeydown="return isAmount(this,event)" onkeyup="calculateLingap(this)" style = "width:120px;text-align:center;padding:3px 5px;" value ="' . number_format($amount,2) . '"  /></td>
					                <td class = "tdData" style= "">
					                	<span id = "' . $id . '" class = "button ' . $bLing .'" style = "" onclick = "removeBeneficiary(this)">Remove</span>
					                </td>
					         </tr>';
				$i++;	         
			}
			if($i == 1){
				$sheet .= '<tr style= "">
							<td colspan = "5" class = "tdData" style= "text-align:center;">No record.</td>
					         </tr>';
			}else{
				$sheet .= '<tr>
							<td colspan = "5" class = "tdData" style= "text-align:center;border-bottom:0;"><span id   = "' . $trackingNumber . '" span class= "button" onclick = "updateLingap(this)" style = "font-size:16px;text-align:center;font-family:helvetica;">Update</span></td>
					         </tr>';
			}
			$sheet .= '<table>';	
			return $sheet  . '~!~'  . number_format($total,2) ;
		}

		// function CreateHospitalSelect($record){
		// 	$sheet = '<select  id = "lingapHospital" class = "inputText" style ="width:280px;font-size:18px;letter-spacing:0px;text-align:left;"   >';
		// 	$sheet .= ' <option></option>';
		// 	while($data = $this->fetch_array($record)){
		// 		$sheet .= ' <option >' . $data['Name'] . '</option>';
		// 	}
		// 	$sheet .= '</select>';
		// 	return $sheet;
		// }
		function CreateHospitalSelect($record){
			$sheet = '<select  id = "lingapHospital" class = "inputText" style ="width:280px;font-size:18px;letter-spacing:0px;text-align:left;"   >';
			$sheet .= ' <option></option>';
			while($data = $this->fetch_array($record)){

				$claimant = $data['Name'];
				$oneTax = $data['OneTax'];

				// $sheet .= "<option value='".$claimant."*j*".$oneTax."'>".$claimant."</option>";
				$sheet .= '<option value="'.$claimant.'*j*'.$oneTax.'">'.$claimant.'</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}

		function CreatePPMPview($record,$limit){
			$total = 0;
			$i = 1;
			$x = 1;
			$finish =0;
			$pages = 0;
			$pageLimit =$limit;
			$pageTotal =0;
			$count  = $this->num_rows($record);
			
			$sheet = '';
			
			$page = ceil($count / $limit);
			
			
			while($data = $this->fetch_array($record)){
				$office = $data['Office_code'];
				$program = $data['program_Code'];
				$accountCode = $data['Account_Code'];
				$desc = utf8_encode($data['General']);
				$qty = $data['quantity'];
				$unit = $data['quantity_unit'];
				$type = $data['item_type'];
				
				
				$budget = $data['est_budget'];
				$total += $budget; 
				$pageTotal += $budget;
				$jan = $data['jan'];
				$feb = $data['feb'];
				$mar = $data['mar'];
				$apr = $data['apr'];
				$may = $data['may'];
				$jun = $data['jun'];
				$jul = $data['jul'];
				$aug = $data['aug'];
				$sep= $data['sep'];
				$oct = $data['oct'];
				$nov = $data['nov'];
				$dec = $data['decx'];
				$office = $data['Name'];
				
				if($i == 1){
					$sheet .= '<div style = "margin:0 auto;height:743px;width:1150px; overflow:hidden; border:2px solid white;">
					                <table id = "infraTable" style = "border-spacing:0;">';
					$sheet .= '<tr><td colspan = "20">' .  $this->PPMPheader($office,$count,$type) . '</td></tr>';
					$sheet .= '<tr><td colspan = "20">' . $this->PPMPtableheader() . '</td></tr>';
				}
				$sheet .= '<tr>
							<td class = "tdDataInfra" style = "text-align:center;border-left:1px solid black;">' . $x . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $program . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $accountCode . '</td>
							<td class = "tdDataInfra">' . $desc . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $qty . '</td>
							<td class = "tdDataInfra" style = "text-align:right;width:20px;">' . number_format($budget,2) . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $jan  . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $feb . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $mar . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $apr . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $may . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $jun . '</td>	
							<td class = "tdDataInfra" style = "text-align:center;">' . $jul . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $aug . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $sep . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $oct . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $nov . '</td>
							<td class = "tdDataInfra" style = "text-align:center;">' . $dec . '</td>
						</tr>';
				if($i >= $pageLimit){
					$pages++;
					if($count == $x){
						$sheet .= '<tr>
										<td colspan = "2" style = "">Page ' . $pages . ' of  ' . $page .  ' </td>
										<td colspan = "2" style = "text-align:right;">Page Total</td><td colspan = "2" style = "text-align:right;padding:2px 5px;font-weight:bold;">' . number_format($pageTotal,2) . '</td>
										<td colspan = "9" style = "text-align:right;">Grand&nbsp;Total</td><td colspan = "3" style = "text-align:right;padding:2px 5px;font-weight:bold;">' . number_format($total,2) . '</td>
								</tr>';
						$sheet .= '</table></div>';	
						$sheet .=  $this->PPMPfooter() ; 
						$finish =1;
						
					}
					
					if($count != $x){
						$sheet .= '<tr><td colspan = "2" style = "">Page ' . $pages . ' of  ' . $page .  ' </td><td colspan = "2" style = "text-align:right;">Page Total</td>
								<td colspan = "2" style = "text-align:right;padding:2px 5px;font-weight:bold;">' . number_format($pageTotal,2) . '</td></tr>';
						
					}
					$sheet .= '</table></div>';	
					if($count != $x){
						
						$sheet .=  $this->PPMPfooter() ; 
					}
					$pageTotal = 0;
					$i = 0;
				}
				
				$i++;
				$x++;
			}
			if($finish == 0){
				$pages++;
				$sheet .= '<td colspan = "2" style = "">Page ' . $pages . ' of  ' . $page .  ' </td>
						<td colspan = "2" style = "text-align:right;">Page Total</td><td colspan = "2" style = "text-align:right;padding:2px 5px;font-weight:bold;">' . number_format($pageTotal,2) . '</td>
						<td colspan = "9" style = "text-align:right;">Grand Total</td><td colspan = "3" style = "text-align:right;padding:2px 5px;font-weight:bold;">' . number_format($total,2) . '</td></tr>';
				$sheet .= '</table></div>';	
				$sheet .=  $this->PPMPfooter() ; 
			}
			
			if($count > 0){
				$sheet .=$this->PPMPsignatories($type);
				return $sheet;
			}else{
				return '<div style = "text-align:center;font-size:30px;font-weight:bold;margin-top:60px;font-family: impact;color:grey; letter-spacing:2px;">No record found. </div>';
			}
			
		
		}
		function PPMPtableHeader(){
			$sheet = '<tr>
						<td class = "tdHeaderField" colspan = "2" rowspan = "2" style = "border-left:1px solid black;">Project&nbsp;Code</td>
						<td class = "tdHeaderField" rowspan = "2">Account&nbsp;Code</td>
						<td class = "tdHeaderField" rowspan = "2">Description</td>
						<td class = "tdHeaderField" rowspan = "2" style ="text-align:center;">Qty</td>
						<td class = "tdHeaderField" rowspan = "2" style ="text-align:center;width:20px;">Budget</td>
						<td class = "tdHeaderField" colspan = "12" style = "text-align:center;border-bottom:0px;">Milestone of Activities</td>
					</tr>
					<tr>
						<td class = "tdHeaderField">Jan</td>
						<td class = "tdHeaderField">Feb</td>
						<td class = "tdHeaderField">Mar</td>
						<td class = "tdHeaderField">Apr</td>
						<td class = "tdHeaderField">May</td>
						<td class = "tdHeaderField">Jun</td>
						<td class = "tdHeaderField">Jul</td>
						<td class = "tdHeaderField">Aug</td>
						<td class = "tdHeaderField">Sep</td>
						<td class = "tdHeaderField">Oct</td>
						<td class = "tdHeaderField">Nov</td>
						<td class = "tdHeaderField">Dec</td>
						
					</tr>';
			return $sheet;
		}
		function PPMPheader($office,$count,$type){
			
			if($count > 1){
				$label = '(' . $count . ' items)';
			}else{
				$label = '(' . $count . ' item)';
			}
			$sheet = '<table style = "width:100%;margin-top:75px;"><tr>
							<td style = "text-align:center;">
								<span style = "font-weight:bold;font-size:20px;">City Government of Davao </span>
								<span style = "display:block;">City Hall Drive San Pedro Street, Davao City</span>
							</td>
						</tr>
						<tr>
							<td style = "text-align:center;font-weight:bold;font-size:20px;">PROJECT PROCUREMENT MANAGEMENT PLAN</td>
						</tr>
						<tr>';
			
			if($type == "Infrastructure - Development Fund" || $type == "Regular"){
				$sheet .= '				<td style = "text-align:center;font-size:16px;">Annual Development Fund CY 2023</td>';
			}else if($type == "Infrastructure - SB1" || $type == "SB1"){
				$sheet .= '				<td style = "text-align:center;font-size:16px;">Supplemental Budget No. 1  - CY 2023</td>';
			}else if($type == "Infrastructure - SB2" || $type == "SB2"){
				$sheet .= '				<td style = "text-align:center;font-size:16px;">Supplemental Budget No. 2  - CY 2023</td>';
			}			
			$sheet .= '			</tr>
						<tr>
							<td style = "font-size:14px;font-weight:bold;padding-top:10px;">OFFICE : '  . $office . '<span style = "padding-left:10px;font-style:italic;">' . $label   . '</span></td>
						</tr>
					</table>';
			return $sheet;
		}
		function PPMPheader1($type){
			
			$sheet = '<table style = "width:100%;margin-top:75px;"><tr>
							<td style = "text-align:center;">
								<span style = "font-weight:bold;font-size:20px;">City Government of Davao</span>
								<span style = "display:block;">City Hall Drive San Pedro Street, Davao City</span>
							</td>
						</tr>
						<tr>
							<td style = "text-align:center;font-weight:bold;font-size:20px;">PROJECT PROCUREMENT MANAGEMENT PLAN</td>
						</tr>
							<tr>';
			
							if($type == "Infrastructure - Development Fund" || $type == "Regular"){
								$sheet .= '				<td style = "text-align:center;font-size:16px;">Annual Development Fund CY 2023 </td>';
							}else if($type == "Infrastructure - SB1" || $type == "SB1"){
								$sheet .= '				<td style = "text-align:center;font-size:16px;">Supplemental Budget No. 1  - CY 2023 </td>';
							}else if($type == "Infrastructure - SB1" || $type == "SB2"){
								$sheet .= '				<td style = "text-align:center;font-size:16px;">Supplemental Budget No. 2  - CY 2023 </td>';
							}			
							$sheet .= '</tr>
						
					</table>';
			return $sheet;
		}
		function PPMPfooter(){
			$sheet = '<table style = "width:1150px;margin:0 auto;height:20px;border:0px solid silver;"><tr>
						<td >
							<span style = "font-weight:bold;font-size:12px;color:grey;">NOTE : Technical Specifications for each Item/Project being proposed shall be submitted as part of the PPMP.</span>
						</td>
					</tr></table>';
			return $sheet;
		}
		function PPMPsignatories($type){
			$sheet = '<div style = "margin:0 auto;margin-top:20px;width:1150px;height:756px; overflow:hidden; border:2px solid transaprent;">';
			$sheet .= $this->PPMPheader1($type);		 
			$sheet .= '<table style = "border:1px solid black;width:100%;height:500px;margin-top:40px;" border ="0">
						<tr>
							<td colspan = "6"  style ="text-align:center;font-size:18px;font-weight:bold;font-style:italic;">Signatoriesxxx</td>
						</tr>
						<tr>
							<td style ="width:10px;vertical-align:bottom;text-align:center;">Prepared&nbsp;By&nbsp;:</td>
							<td style ="vertical-align:bottom;"></td>
							<td style ="width:10px;vertical-align:bottom;text-align:center;">Certified&nbsp;Correct&nbsp;By&nbsp;:</td>
							<td style =""></td>
							<td style ="width:10px;vertical-align:bottom;text-align:center;">Submitted&nbsp;By&nbsp;:</td>
							<td style =""></td>
						</tr>
						<tr>
							<td style ="width:10px;vertical-align:bottom;text-align:center;height:40px;"></td>
							<td style ="border-bottom:1px solid black;vertical-align:bottom;"><input style = "width:100%;font-weight:bold;text-align:center;font-size:13px;border:0; " placeholder = "Type Name" /></td>
							<td style ="width:10px;vertical-align:bottom;text-align:center;"></td>
							<td style ="border-bottom:1px solid black;vertical-align:bottom;""><input style = "width:100%;font-weight:bold;text-align:center;font-size:13px;border:0; " placeholder = "Type Name" /></td>
							<td style ="width:10px;vertical-align:bottom;text-align:center;"></td>
							<td style ="border-bottom:1px solid black;vertical-align:bottom;""><input style = "width:100%;font-weight:bold;text-align:center;font-size:13px;border:0; " placeholder = "Type Name" /></td>
						</tr>
						<tr>
							<td style =""></td>
							<td style ="text-align:center;vertical-align:top;width:25%;">Designation PSO</td>
							<td style =""></td>
							<td style ="text-align:center;vertical-align:top;width:25%;">Administrative Officer</td>
							<td style =""></td>
							<td style ="text-align:center;vertical-align:top;width:25%;">Head</td>
						</tr>
					</table>';
			
			$sheet .= '</div>';
			return $sheet;
		}
	
		function CreateBACReports($record){
			if(isset( $_SESSION['accountType'])){
				$acct  = $_SESSION['accountType'];
			}else{
				$acct  =0;
			}
			if($acct == 10){
				$priv = "removeUpload";
			}else{
				$priv = "removeUploadHidden";
			}
			$i  = 1;
			$y ='';
			$m = '';
			$t = '';
			$sheet = '<table border ="0"  style ="border-spacing:0; margin:0 auto;width:95%;margin-top:20px;">';
			while($data = $this->fetch_array($record)){
				
				$year = $data['Year'];
				$mo = $data['Month'];  
				if($mo < 13){
					$month  =  $this->numberToMonth($data['Month']);
				}else if($mo < 17){
					if($mo == 13){
						$month = "1st Quarter";
					}else if($mo == 14){
						$month = "1st Quarter";
					}else if($mo == 15){
						$month = "1st Quarter";
					}elseif($mo == 16){
						$month = "1st Quarter";
					}
				}
				
				$type  = $data['Type'];
				$subject =  $data['Subject'];
				$filename  = '../uploadsBAC/' . $data['Filename'];
				$id  = $data['Id'] . '~!~' .  $data['Filename'];
				if($y != $year){
					$sheet .= '<tr>';
					$sheet .= '	<td  colspan ="4" style = "font-family:helvetica;text-shadow:0px 0px 1px white; font-size:23px;font-weight:bold;color:black text-shadow:0px 0px 1px white;font-style:italic;">' . $year .  '</td>';
					$sheet .= '</tr>';
					$y = $year; 
					
					$i =1;
					$sheet .= '<tr>';
					$sheet .= '<td colspan = "4" style = "color:rgb(205, 36, 73); font-family:helvetica;text-shadow:0px 0px 1px white; font-size:22px;padding-left:20px;font-weight:bold;border-bottom:0px solid silver;background-color:rgb(219, 218, 218)">' . $month .  '</td>';
					$sheet .= '</tr>';
					$sheet .= '<tr>';
					$sheet .= '<td colspan = "4"  style = "padding:8px;"></td>';
					$sheet .= '</tr>';
					$m = $month; 
					
					$sheet .= '<tr>';
					$sheet .= '	<td colspan ="4" style = "font-size:14px;padding-left:40px;padding-bottom:10px;"><span style = "font-weight:bold; font-family:helvetica;color:white;padding:2px 5px;background-color:rgb(157, 158, 158)">' . $type .  '</span></td>';
					$sheet .= '</tr>';
					$sheet .= '<tr class = "hoverThis">';
					$sheet .= '<td style = "text-align:right;width:100px;" class ="number">' . $i . '</td><td style = "border-bottom:1px solid silver;"  >
							<span class = "subject" >' . $subject .  '</span>
							</td>
							<td style = "width:10px;border-bottom:1px solid silver;" >
								<span class = "view"  id = "' . $filename . '" class = "view" onclick = "show(this)">view</span>
							</td>
							<td style = "width:10px;border-bottom:1px solid silver;">
								<span class = "' . $priv . '"  id = "' . $id . '"  onclick = "removeThis(this)">remove</span>
							</td>';
					$sheet .= '</tr>';
				
					$t = $type; 
					
				}else{
					if($m != $month){
						$i =1;
						$sheet .= '<tr>';
						$sheet .= '<td colspan = "4"  style = "padding:8px;"></td>';
						$sheet .= '</tr>';
						$sheet .= '<tr>';
						$sheet .= '<td colspan = "4" style = "color:rgb(205, 36, 73); font-family:helvetica;text-shadow:0px 0px 1px white; font-size:22px;padding-left:20px;font-weight:bold;border-bottom:0px solid silver;background-color:rgb(219, 218, 218)">' . $month .  '</td>';
						$sheet .= '</tr>';
						$sheet .= '<tr>';
						$sheet .= '<td colspan = "4"  style = "padding:8px;"></td>';
						$sheet .= '</tr>';
						$m = $month; 
						
						$sheet .= '<tr>';
						$sheet .= '	<td colspan ="4" style = "font-size:14px;padding-left:40px;font-weight:bold;padding-bottom:10px;"><span  style = "font-weight:bold; font-family:helvetica;color:white;padding:2px 5px;background-color:rgb(157, 158, 158)">' . $type .  '</span></td>';
						$sheet .= '</tr>';
						$sheet .= '<tr class = "hoverThis">';
						$sheet .= '<td style = "text-align:right;width:100px;" class ="number">' . $i . '</td><td style = "border-bottom:1px solid silver;" >
								<span class = "subject">' . $subject .  '</span>
								</td>
								<td style = "border-bottom:1px solid silver;" >
									<span class = "view"  id = "' . $filename . '" class = "view" onclick = "show(this)">view</span>
								</td>
								<td style = "width:10px;border-bottom:1px solid silver;">
									<span class = "' . $priv . '"  id = "' . $id . '"  onclick = "removeThis(this)">remove</span>
								</td>';
						$sheet .= '</tr>';
					
						$t = $type; 
						
					}else{
						if($t != $type){
							$i = 1;
							$sheet .= '<tr>';
							$sheet .= '<td colspan ="4" style = "font-size:14px;padding-left:40px;font-weight:bold;padding-bottom:10px;padding-bottom:10px;padding-top:10px;"><span  style = "font-weight:bold; font-family:helvetica;color:white;padding:2px 5px;background-color:rgb(157, 158, 158)">' . $type .  '</span></td>';
							$sheet .= '</tr>';
							$sheet .= '<tr class = "hoverThis">';
							$sheet .= '<td style = "text-align:right;" class ="number">' . $i . '</td><td style = "border-bottom:1px solid silver;" ><span class = "subject" >' . $subject .  '</span>
									</td>
									<td style = "border-bottom:1px solid silver;" >
										<span id = "' . $filename . '" class = "view" onclick = "show(this)">view</span>
									</td>
									<td style = "width:10px;border-bottom:1px solid silver;">
											<span class = "' . $priv . '"  id = "' . $id . '"  onclick = "removeThis(this)">remove</span>
									</td>';
							$sheet .= '</tr>';
							$t = $type;       
							
						}else{
							$i++;
							$sheet .= '<tr class = "hoverThis">';
							$sheet .= '<td style = "text-align:right;" class ="number">' . $i . '</td><td style = "border-bottom:1px solid silver;" >
									 <span class = "subject" >' . $subject .  '</span>
									 </td>
									 <td style = "border-bottom:1px solid silver;" >
									 	<span class = "view"  id = "' . $filename . '" class = "view" onclick = "show(this)">view</span>
									 </td>
									<td style = "width:10px;border-bottom:1px solid silver;">
										<span class = "' . $priv . '"  id = "' . $id . '"  onclick = "removeThis(this)">remove</span>
									 </td>';
							$sheet .= '</tr>';
						}
					}
				}
					
				
				
				
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan = "4"  style = "padding:10px;"></td>';
			$sheet .= '</tr>';
			$sheet .= '<table>';
			
			$count = $this->num_rows($record);
			if($count == 0){
				$sheet = "<div  style = 'text-align:center;' class = 'norecord' >No record found.</div>";
			}
			return $sheet;
		}
		function CreateLingapNameList($record){
			$sheet ='<table id =  "beneficiaryTable" style = "width:100%;border-spacing:0;">';
			$sheet .='<tr>
						
						<td class = "tdHeader">TN#</td>
						<td class = "tdHeader">RAF</td>
						<td class = "tdHeader" style = "text-align: left;">NAME</td>
						
						<td class = "tdHeader">AMOUNT</td>
						<td class = "tdHeader">CHECK</td>
						<td class = "tdHeader" style = "text-align:left;">STATUS</td>
						<td colspan = "2" class = "tdHeader" style = "text-align:left;text-overflow:nowrap;white-space: nowrap;font-size:13px;">UPDATED - COMPLETION</td>
						
						
					<tr>';	
			$i =1;
			$total = 0;		
			while($data = $this->fetch_array($record)){
				$trackingNumber = $data['TrackingNumber'];
				$name = $data['Name'];
				$raf = $data['RAF'];
				$amount = $data['Amount'];
				$status = $data['Status'];
				$upd = $data['DateModified'];
				$updated= $this->ezDate1($upd);
				$completion = $data['Completion'];
				$check =  $data['checknumber'];
				
				if($i % 2 == 0){
					$color = "rgb(229, 236, 225)";
				}else{
					$color = "";
				}
				if($status == "CAO Released"){
					$color1 = "rgb(8, 141, 33)";
				}else{
					$color1 = "black";
				}
				$sheet .= '<tr style= "background-color:' . $color . ';">
							<td class = "tdData" onclick = "searchThisLingap(this)" style= "text-align:center;border-right:1px solid silver;cursor:pointer;">' . $trackingNumber . '</td>
							<td class = "tdData" style= "font-size:14px;text-align:center;border-right:1px solid silver;">' . $raf . '</td>
					                <td class = "tdData" style= "border-right:1px solid silver;">' . $name . '</td>
					                <td class = "tdData" style= " font-size:14px;text-align:right;border-right:1px solid silver;">' . number_format($amount,2) . '</td>
					                <td class = "tdData" style= " font-size:14px;text-align:right;border-right:1px solid silver;">' . $check . '</td>
					                
					                <td class = "tdData" style= "font-size:16px;text-overflow:nowrap;white-space: nowrap;border-right:1px solid silver;color: ' . $color1 . '">' . $status . '</td>
					                <td class = "tdData" style= "font-weight:normal;font-family:arial;border-right:1px solid silver;"><span style = "font-size:11px; color:black;">' . $upd . '</span><br/><span style = "font-size:11px; color:grey;">'   . $updated . '</span></td>
					                <td class = "tdData" style= "font-weight:normal;font-family:arial;font-size:11px;vertical-align:top;">' . $completion . '</td>
					         </tr>';
				$i++;	         
			}
			if($i == 1){
				$sheet .= '<tr style= "">
							<td colspan = "5" class = "tdData" style= "text-align:center;">No record.</td>
					         </tr>';
			}
			$sheet .= '<table>';	
			return $sheet ;
		}
		function CreateSummaryBalance($record){
			$accountType = $_SESSION['accountType']; 
			if($accountType > 1){
				$nn = "table-row";
			}else{
				$nn = "none";
			}
			
			$d = date("M");
			$dN = intval(date("m"));
			if($dN <10){
				$dN = '0' . $dN;
			}
			$dt = date("d");
			$y = date("Y");
			
			$c = "rgb(186, 196, 194)";
			$sheet = '<table id = "t1" border = "0" style = "width:100%;text-align:right;border-spacing:0;background-color:white;padding:8px;width:750px;">';
			$sheet .= '<tr style = ""><td></td>
							<td  style = "text-align:left;font-weight:bold;">List&nbsp;of&nbsp;Programs</td>
						    <td  style = "font-size:12px;vertical-align:bottom;">
						    	<table  style = "font-size:12px;float:right;">
						    		<tr>
						    			<td style = "display:' . $nn . '">
						    				Select Program <select id = "balanceOffice" style = "border:0;border-bottom:1px solid silver;padding:0px 5px;text-align:left;width:250px;" onchange = "selectWhatOffice(this)">';
						    					
						    					$sql =  "select * from programcode  order BY code asc";
						    					$record1 = $this->query($sql);
						    					$sheet .= '<option value = ""></option>';	
						    					while($data = $this->fetch_array($record1)){
						    						$name = $data['Name'];
						    						$code = $data['Code'];
													$sheet .= '<option value = "' . $code . '">' . $code . ' &nbsp;' . $name .  '</option>';	
												}
												$sheet .= '<option value = "xValx">All Programs</option>';	
			$sheet .= '						</select>
						    			</td>
						    			<td>
						    				View 
						    				<select id = "balancePeriod" style = "border:0;border-bottom:1px solid silver;padding:0px 5px;text-align:center;" onchange = "selectWhatPeriod(this)">
						    					
									    		<option value = "1">All Data</option>
									    		<option value = "2">By Date</option>
									    		<option value = "3">By Month</option>
									    	</select>
						    			</td>
						    			<td style = "vertical-align:bottom;background-color:rgb(222, 223, 223);padding-right:4px;">
						    				<table id = "tableBalanceDate" style = "margin-left:4px;font-size:12px;background-color:rgb(245, 245, 231);padding:0px 2px;display:none;">
								    			<tr>
								    				<td>Month</td>
								    				<td>
								    					<select id ="periodBalanceMonth" style = "border:0;border-bottom:1px solid silver;">
								    						<option value = "' . $dN . '">' . $d . '</option>
												    		<option value = "01">Jan</option>
												    		<option value = "02">Feb</option>
												    		<option value = "03">Mar</option>
												    		<option value = "04">Apr</option>
												    		<option value = "05">May</option>
												    		<option value = "06">Jun</option>
												    		<option value = "07">Jul</option>
												    		<option value = "08">Aug</option>
												    		<option value = "09">Sep</option>
												    		<option value = "10">Oct</option>
												    		<option value = "11">Nov</option>
												    		<option value = "12">Dec</option>
												    	</select>
								    				</td>
								    				<td>Day</td>
								    				<td>
								    					<select id ="periodBalanceDay" style = "border:0;border-bottom:1px solid silver;padding:0px 2px;">
								    					<option >' . $dt . '</option>';
												    	for($i = 1; $i < 32; $i++){
												    		if($i < 10){
																$d = '0' . $i;
															}else{
																$d = $i;
															}
															$sheet .= '<option value = "' . $d . '">' . $i . '</option>';
														}
											  $sheet .= '</select>
								    				</td>
								    				<td>Year</td>
								    				<td>
								    					<select id ="periodBalanceYear" style = "border:0;border-bottom:1px solid silver;padding:0px 2px;">
								    						<option >' . $y . '</option>
								    						<option >' . $y . '</option>
											  			</select>
								    				</td>
								    			</tr>
								    		</table>
						    			</td>
						    		</tr>
						    	</table>
						    </td>
						</tr>';
						
						
			$sheet .= '<tr><td colspan = "3" id = "tableForBalance" ><table border = "0" style = "margin-top:5px;border-spacing:0;margin:0 auto;width:100%;"><tr style = "">';
				$sheet .= '<td style = "border-right:1px solid grey;"></td>
							<td class = "trHead" style = "background-color:rgb(192, 214, 223);color:black;text-align:left;">Program</td>
							
							<td class = "trHead" style = "background-color:' . $c . ';">Beginning</td>
							<td class = "trHead" style = "background-color:' . $c . ';">Obligated</td>
							
							<td class = "trHead" style = "background-color:' . $c . ';">Paid</td>
							
							<td class = "trHead" style = "background-color:' . $c . ';">Liq</td>
							<td class = "trHead" style = "border-right: 1px solid #AEB5B6;background-color:' . $c . ';">UnLiq</td>';
				$sheet .= '</tr>';
			$i = 1;	
			while($data = $this->fetch_array($record)){
				$program = $data['ProgramCode'];
				$name = $data['Name'];
				$ab = $data['AnnualBudget'];
				$obligated = $data['Obligated'];
				
				$ab_obr = $data['Balance1'];
				$ab_issued = $data['Balance2'];
				
				
				$liquidated = $data['Liquidated'];
				$savings = $data['Savings'];
				$unli = $data['Unliquidated'];
				$paid = $data['Paid'];
				if($i % 2 == 0){
					$color = "rgb(235, 241, 244)";
				}else{
					$color = "white";
				}
				$sheet .= '<tr style ="background-color:' . $color . '" id = "' . $program . '" class = "trData" onclick = "clickTR(this)">';
				$sheet .= '<td style = "border:0;text-align:center;">' . $i++ . '</td>
						   <td class = "tdDataBalance"style = "background-c1olor:rgb(227, 232, 234);text-align:left;font-size:12px;border-left: 1px dashed grey;border-right: 1px dashed grey"><b>' . $program . '</b><div style = "text-overflow:nowrap;white-space: nowrap;">' . $name .'</div></td>
						   
						   <td class = "tdDataBalance">' . $this->toNumberFormat($ab) . '</td>
						   <td class = "tdDataBalance"><div style ="color:rgb(32, 186, 214);">' . $this->toNumberFormat($obligated) . '</div><div style = "">' .  $this->toNumberFormat($ab_obr) .'</div></td>
						  
						   <td class = "tdDataBalance"><div style ="color:rgb(255, 110, 0);">' . $this->toNumberFormat($paid) . '</div><div>' .  $this->toNumberFormat($ab_issued) .'</div></td>
						   
						  
						   <td class = "tdDataBalance">' . $this->toNumberFormat($liquidated) . '</td>
						   <td class = "tdDataBalance">' . $this->toNumberFormat($unli) . '</td>';
				$sheet .= '</tr">';
			}
			
			
			
			$sheet .= '</table></td></tr></table>';
			return $sheet;
		}
		function CreateSummaryBalanceAccountTable($record){
			$c = "rgb(186, 196, 194)";
			$sheet = '<table border = "0" style = "margin-top:5px;border-spacing:0;margin:0 auto;width:100%;"><tr style = "">';
			$sheet .= '<td style = "border-right:1px solid grey;"></td>
						<td class = "trHead" style = "background-color:rgb(192, 214, 223);color:black;text-align:left;">Program</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">Beginning</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Obligated</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">Paid</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">Liq</td>
						<td class = "trHead" style = "border-right: 1px solid #AEB5B6;background-color:' . $c . ';">UnLiq</td>';
			$sheet .= '</tr>';
			$i = 1;	
			while($data = $this->fetch_array($record)){
				$program = $data['ProgramCode'];
				$name = $data['Name'];
				$ab = $data['AnnualBudget'];
				$obligated = $data['Obligated'];
				
				$ab_obr = $data['Balance1'];
				$ab_issued = $data['Balance2'];
				
				
				$liquidated = $data['Liquidated'];
				$savings = $data['Savings'];
				$unli = $data['Unliquidated'];
				$paid = $data['Paid'];
				if($i % 2 == 0){
					$color = "rgb(235, 241, 244)";
				}else{
					$color = "white";
				}
				$sheet .= '<tr style ="background-color:' . $color . '" id = "' . $program . '" class = "trData" onclick = "clickTR(this)">';
				$sheet .= '<td style = "border:0;text-align:center;">' . $i++ . '</td>
						   <td class = "tdDataBalance"style = "background-c1olor:rgb(227, 232, 234);text-align:left;font-size:12px;border-left: 1px dashed grey;border-right: 1px dashed grey"><b>' . $program . '</b><div style = "text-overflow:nowrap;white-space: nowrap;">' . $name .'</div></td>
						   <td class = "tdDataBalance">' . $this->toNumberFormat($ab) . '</td>
						   <td class = "tdDataBalance"><div style ="color:rgb(32, 186, 214);">' . $this->toNumberFormat($obligated) . '</div><div style = "">' .  $this->toNumberFormat($ab_obr) .'</div></td>
						   <td class = "tdDataBalance"><div style ="color:rgb(255, 110, 0);">' . $this->toNumberFormat($paid) . '</div><div>' .  $this->toNumberFormat($ab_issued) .'</div></td>
						   <td class = "tdDataBalance">' . $this->toNumberFormat($liquidated) . '</td>
						   <td class = "tdDataBalance">' . $this->toNumberFormat($unli) . '</td>';
				$sheet .= '</tr">';
			}
			$sheet .= '</table>';
			return $sheet;
		}
		
		function CreateSummaryBalanceAccount($record){
			$c = "rgb(186, 196, 194)";
			$sheet = '<table  style = "text-align:right;border-spacing:0;background-color:white;padding:8px;width:100%;" border= "0">';
			$sheet .= '<tr style = ""><td></td><td colspan ="8" style = "text-align:left;">
					   <span class = "hoverPrint" style = "position:absolute;margin-top:-12px;margin-left:-1px;" onclick = "previewBalance()">&#8471;</span>
					   
					   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					   <span  id = "p1" style = "color:green;font-weight:bold;"></span><span id = "p2" style = "font-weight:bold;margin-left:5px;"></span></td></tr>';
			$sheet .= '<td style = "border-right:1px solid grey;"></td>
						<td class = "trHead" style = "background-color:rgb(213, 229, 186);text-align:left;">Account Title</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">Beginning</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Obligated</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">Paid</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">Liq</td>
						<td class = "trHead" style = "border-right:1px solid grey;background-color:' . $c . ';">UnLiq</td>';
			$sheet .= '</tr>';
			$i = 1;	
			while($data = $this->fetch_array($record)){
				$acctCode = $data['AccountCode'];
				$name = $data['Title'];
				$ab = $data['AnnualBudget'];
				$obligated = $data['Obligated'];
				
				$ab_obr = $data['Balance1'];
				$ab_issued = $data['Balance2'];
				
				
				$liquidated = $data['Liquidated'];
			
				$unli = $data['Unliquidated'];
				$paid = $data['Paid'];
				$ab_issued = $this->toNumberFormat($ab_issued);
				if($paid == 0){
					$paid = '';
					$ab_issued = '';
				}
				
				if($i % 2 == 0){
					$color = "rgb(236, 248, 238)";
				}else{
					$color = "white";
				}
				
				$sheet .= '<tr id = "' . $acctCode . '"  class = "trData" style ="background-color:' . $color . '" onclick = "clickTRAcct(this)">';
				$sheet .= '<td style = "border:0;text-align:center;">' . $i++ . '</td>
						   <td class = "tdDataBalance"style = "text-align:left;border-left: 1px dashed grey;border-right: 1px dashed grey;">' . $acctCode . '<div style = "text-overflow:nowrap;white-space: nowrap;">' . $name .'</div></td>
						   
						   <td class = "tdDataBalance">' . $this->toNumberFormat($ab) . '</td>
						   <td class = "tdDataBalance"><div style ="color:rgb(32, 186, 214);">' . $this->toNumberFormat($obligated) . '</div><div style = "">' .  $this->toNumberFormat($ab_obr) .'</div></td>
						   <td class = "tdDataBalance"><div style ="color:rgb(255, 110, 0);">' . $paid . '</div><div>' . $ab_issued   .'</div></td>
						   
						  
						   <td class = "tdDataBalance">' . $this->toNumberFormat($liquidated) . '</td>
						   <td class = "tdDataBalance">' . $this->toNumberFormat($unli) . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet;
		}
		function CreatSummaryDetails($record,$all){

			
			$c = "rgb(186, 196, 194)";
			$sheet = '<table id ="tableBalancesDetails" style = "text-align:center;border-spacing:0;background-color:white;padding:8px;width:100%;" border= "0" >';
			$sheet .= '<tr style = ""><td></td>
						<td colspan ="11" style = "text-align:left;font-weight:bold;text-overflow:nowrap;white-space: nowrap;">
						<span class = "hoverPrint"  style = "position:abs	olute;margin-top:-12px;margin-left:-1px;" onclick = "previewChecks()">&#8471;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<span onclick = "excelChecks()" class = "hoverPrint" style = "cursor:pointer;;margin-left:5px;margin-top:-12px;font-weight:bold;font-size:26px;display:inline-block;position:absolute;">&#8494;</span>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<span  id = "p3" style = "color:green;margin-left:3px;"></span>
						<span id = "p4" style = "font-weight:normal;margin-left:5px;font-size:13px;letter-spacing:1px;"></span></td>
						<td colspan = "2"><span id = "periodT" style = "text-overflow:nowrap;white-space: nowrap;font-size:14px;"></span></td>
						
						</tr>';
			$sheet .= '<td style = "border-right:1px solid grey;"></td>

						<td class = "trHead" style = "background-color:rgb(160, 165, 164);">TN</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">DocType</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Claimant</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Adv&nbsp;No</td>
						<td class = "trHead" style = "background-color:' . $c . ';">ObR&nbsp;No</td>
						<td class = "trHead" style = "background-color:' . $c . ';">ObR&nbsp;Amount</td>
						<td class = "trHead" style = "background-color:' . $c . ';">PO</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Code</td>
						<td class = "trHead" style = "background-color:' . $c . ';">CheckAmt</td>
						<td class = "trHead" style = "background-color:' . $c . ';"><div style = "width:65px;"><input id = "checksOnly" type = "checkbox" onclick = "checksOnly(this)"/>CheckNo</div></td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">CheckDte</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Status</td>
						<td class = "trHead" style = "border-right:1px solid grey;background-color:' . $c . ';">Modified</td>';
			$sheet .= '</tr>';
			$i = 1;	
			
		
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$type = $data['TrackingType'];
				$tn = $data['TrackingNumber'];
				$claim = $data['DocumentType'];
				$claimant = $data['Claimant'];
				
				$obr = $data['Amount'];
				$net = $data['NetAmount'];
				$poAmount = $data['PO_Amount'];
				
				$multiple = $data['TotalAmountMultiple'];
				$charge = $data['ChargeType'];
				$check = $data['CheckNumber'];
				$checkDate = $data['CheckDate'];
			
				$adv = $data['Adv1'];
				$obrNo = $data['OBR_Number'];
				
				if($charge > 1){
					if($type == "PO"){
						$amount = '';
						$codeAmount = $poAmount;
						$poAmount = $multiple;
						
					}else{
						$codeAmount = $obr;
						$obr = $multiple;
						$cost = '';
						$poAmount = '';
					}
				}else{
					if($type == "PO"){
						$codeAmount = $poAmount;
					}else{
						$codeAmount = $obr;
					}
				}
				
				$status = $data['Status'];
			
				$modified = substr($data['DateModified'],0,10);
				
				
				if($i % 2 == 0){
					$color = "rgb(219, 221, 221)";
					$color = "rgb(239, 239, 232)";
				}else{
					$color = "white";
				}
				
				$sheet .= '<tr  class = "trData" style ="background-color:' . $color . '"  >';
				$sheet .= '<td style = "border:0;text-align:center;background-color:white;">' . $i++ . '</td>
						   
						   <td class = "tdDataBalance" style = "border-left: 1px dashed grey;border-right: 1px dashed grey;font-weight:bold;font-size:12px;text-align:left;" onclick = "searchThisBalance(this)" >' . $tn . '</td>
						   <td class = "tdDataBalance" style ="text-align:left;">' . $claim . '</td>
						   <td class = "tdDataBalance" style ="text-align:left;">' . $claimant . '</td>
						   <td class = "tdDataBalance" style ="text-align:center;">' . $this->zeroToNothing($adv) . '</td>
						   <td class = "tdDataBalance" style ="text-align:center;">' . $this->zeroToNothing($obrNo) . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(32, 186, 214);">' . $this->toNumberFormat($obr) . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(32, 186, 214);color:green;">' . $this->toNumberFormat($poAmount) . '</td>
						   <td class = "tdDataBalance" style ="color:black;text-align:right;">' . $this->toNumberFormat($codeAmount) . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(109, 39, 39);text-align:right;">' . $this->toNumberFormat($net) . '</td>
						    <td class = "tdDataBalance"><span style = "color:red;letter-spacing:1px;">' . $check . '</span></td>
						   <td class = "tdDataBalance" style ="color:rgb(109, 39, 39);">' . $checkDate . '</td> 
						   <td class = "tdDataBalance" style ="text-align:left;">' . $status . '</td>
						   <td class = "tdDataBalance">' . $modified . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			
			return $sheet;
		}
		function CreateCheckList($record,$period,$p,$c){
			$count = $this->num_rows($record);
			$sheetA = '<table  style = "font-size:12px;border-spacing:0;width:100%;font-family:Oswald;" border= "0">';
			$sheet = '<tr style = "font-size:14px;font-weight:bold;"><td></td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;"></td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;">TN</td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;">Claimant</td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;">Particulars</td>
						<td style = "text-align:right;border-top:2px solid grey;border-bottom:1px solid grey;">Gross</td>
						<td style ="text-align:right;border-top:2px solid grey;border-bottom:1px solid grey;">Net</td>
						<td style ="text-align:center;border-top:2px solid grey;border-bottom:1px solid grey;">CheckNo</td>
						<td style = "text-align:center;border-top:2px solid grey;border-bottom:1px solid grey;">CheckDate</td>
						';
			$sheet .= '</tr>';
			$i = 1;	
			
			$total = 0;
			$totalGross = 0;
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$type = $data['TrackingType'];
				$tn = $data['TrackingNumber'];
				$claim = $data['DocumentType'];
				$arr = explode('-',$claim);
				$claim =  ucfirst(strtolower($arr[0]));
				$claimant = $data['Claimant'];
				$obr = $data['Amount'];
				$net = $data['NetAmount'];
				
				$total += $net;
				$poAmount = $data['PO_Amount'];
				$multiple = $data['TotalAmountMultiple'];
				$particulars = utf8_encode(trim($data['Particulars']));
				if($type == "PY"){
					if($multiple > 0){
						$o = $multiple;
						$totalGross += $multiple;
					}else{
						$o = $obr;
						$totalGross += $obr;
					}
				}else{
					if($multiple > 0){
						$o = $multiple;
						$totalGross += $multiple;
					}else{
						$o = $poAmount;
						$totalGross += $poAmount;
					}
				}
				$charge = $data['ChargeType'];
				$check = $data['CheckNumber'];
				$checkDate = $data['CheckDate'];
				$sheet .= '<tr  >';
				$sheet .= '<td style = "border:0;text-align:center;background-color:white;">' . $i++ . '</td>
						   <td  style ="text-align:left;border-bottom:1px solid silver;">' . $type . '</td>
						   <td style = "text-align:left;border-bottom:1px solid silver;text-overflow:nowrap;white-space: nowrap;" onclick = "searchThisBalance(this)" >' . $tn . '</td>
						   <td  style ="text-align:left;border-bottom:1px solid silver;">' . $claimant . '</td>
						   <td  style ="text-align:left;border-bottom:1px solid silver;vertical-align:top;font-size:10px;">' . $particulars . '</td>
						   
						   <td  style ="text-align:right;border-bottom:1px solid silver;">' . $this->toNumberFormat($o) . '</td>
						   <td  style ="text-align:right;border-bottom:1px solid silver;">' . $this->toNumberFormat($net) . '</td>
						   <td style ="text-align:center;border-bottom:1px solid silver;"><span >' . $check . '</span></td>
						   <td style ="text-align:center;border-bottom:1px solid silver;">' . $checkDate . '</td> 
						  
						   ';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr><td></td><td colspan = "10" style = "border-top:1px solid grey;"><span>www.davaocityportal.com</span><span style = "float:right;padding-right:15px;">' . date('D d, M Y h:m a') . '</span></td></tr>';
			$sheet .= '</table>';
			$sheetB = '<tr>
							<td></td>	
							<td colspan="3" style = "border-top:1px solid silver;text-overflow:nowrap;white-space: nowrap;"><span style = "font-size:20px;">List of checks issued on&nbsp;</span>&nbsp;<span style = "font-weight:bold;font-size:18px;">' . $period . '</span></td>
							<td colspan="5" style = "border-top:1px solid silver;text-align:right;padding-right:16px;">' . $p . $c . '<span>&nbsp;&nbsp;&nbsp;Rows</span>
								<span style = "font-size:14px;font-weight:bold;">' .$count . '</span>&nbsp;&nbsp;
								<span>Net Total</span>
								<span style = "font-size:16px;font-weight:bold;letter-spacing:1px;">' . number_format($total,2) . '</span>
							<div>
								<span>Gross Total</span>
								<span style = "font-size:16px;font-weight:bold;letter-spacing:1px;">' . number_format($totalGross,2) . '</span>
							</div>	
							</td>	
					   </tr>';
			return $sheetA . $sheetB .  $sheet;
		}
		function CreatSummaryDetailsX($record,$all){
			
			$sql = "SELECT Id,Adv1,OBR_Number,TrackingType,TrackingNumber,ChargeType,NetAmount,CheckNumber,CheckDate,DocumentType,Claimant,Status,Amount, PO_Amount, TotalAmountMultiple,NetAmount,DateModified 
				FROM citydoc2018.vouchercurrent where  checknumber > 0 order by DateModified Desc;";
		/*	$sql = "SELECT Id,Adv1,OBR_Number,TrackingType,TrackingNumber,ChargeType,NetAmount,CheckNumber,CheckDate,DocumentType,Claimant,Status,Amount, PO_Amount, TotalAmountMultiple,NetAmount,DateModified 
				FROM citydoc2018.vouchercurrent where id = '3031' order by DateModified Desc;";	*/
				
			$record = $this->query($sql);
			
			$c = "rgb(186, 196, 194)";
			$sheet = '<table id ="tableBalancesDetails" style = "text-align:center;border-spacing:0;background-color:white;padding:8px;width:100%;" border= "0">';
			$sheet .= '<tr style = ""><td></td>
						<td colspan ="10" style = "text-align:left;font-weight:bold;text-overflow:nowrap;white-space: nowrap;">Transaction Details<span  id = "p3" style = "color:green;margin-left:3px;">
						</span><span id = "p4" style = "font-weight:normal;margin-left:5px;font-size:13px;letter-spacing:1px;"></span></td>
						
						</tr>';
			$sheet .= '<td style = "border-right:1px solid grey;"></td>

						<td class = "trHead" style = "background-color:rgb(160, 165, 164);">TN</td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">DocType</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Claimant</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Adv&nbsp;No</td>
						<td class = "trHead" style = "background-color:' . $c . ';">ObR&nbsp;No</td>
						<td class = "trHead" style = "background-color:' . $c . ';">ObR&nbsp;Amount</td>
						<td class = "trHead" style = "background-color:' . $c . ';">PO</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Code</td>
						<td class = "trHead" style = "background-color:' . $c . ';">CheckAmt</td>
						<td class = "trHead" style = "background-color:' . $c . ';"><div style = "width:65px;"><input type = "checkbox" onclick = "checksOnly(this)"/>CheckNo</div></td>
						
						<td class = "trHead" style = "background-color:' . $c . ';">CheckDte</td>
						<td class = "trHead" style = "background-color:' . $c . ';">CheckDteNew</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Status</td>
						<td class = "trHead" style = "border-right:1px solid grey;background-color:' . $c . ';">Modified</td>';
			$sheet .= '</tr>';
			$i = 1;	
			$checkDateNew = '';
			$updateCase = 'UPDATE vouchercurrent SET checkdate= CASE ';
			$updateCaseA = '';
			$ids = '';
			$t =0;
			$c1='';
			$c2 ='';
			$c3 = '';
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$type = $data['TrackingType'];
				$tn = $data['TrackingNumber'];
				$claim = $data['DocumentType'];
				$claimant = $data['Claimant'];
				
				$obr = $data['Amount'];
				$net = $data['NetAmount'];
				$poAmount = $data['PO_Amount'];
				
				$multiple = $data['TotalAmountMultiple'];
				$charge = $data['ChargeType'];
				$check = $data['CheckNumber'];
				$checkDate = $data['CheckDate'];
				
				if(strlen($checkDate) > 1){
					$t = 1;
					$arr = explode("/",$checkDate);	
					$size = sizeof($arr);
					if(sizeof($arr) == 3){
						
						$c1 = intval($arr[0]);
						//if($c1 == 1){
							
							if(isset($arr[1])){
								$c2 = intval($arr[1]);
							}else{
								$c2 = 'x';
							}
							if(isset($arr[2])){
								$c3 = intval($arr[2]);
							}else{
								$c3 = 'x';
							}
							
							if(strlen($c2) == 1){
								$c2 = '0' . $c2;
							}
							if(strlen($c1) == 1){
								$c1 = '0' . $c1;
							}
							$checkDateNew = $c3 . '-' . $c1 . '-' . $c2;
							$updateCaseA .= ' WHEN checkdate = "' . $checkDate . '" THEN "' . $checkDateNew . '" ';
							$ids .=  ',' . $id ;
						/*}else{
							$updateCaseA .= '';
							$checkDateNew = "wala";
						}*/
						
					}else{
						//$updateCaseA .= ' WHEN checkdate = "' . $checkDate . '" THEN checkdate ';
						//$ids .=  ',' . $id ;
						$checkDateNew = "new";
					}
				}
				
				$adv = $data['Adv1'];
				$obrNo = $data['OBR_Number'];
				
				if($charge > 1){
					if($type == "PO"){
						$amount = '';
						$codeAmount = $poAmount;
						$poAmount = $multiple;
						
					}else{
						$codeAmount = $obr;
						$obr = $multiple;
						$cost = '';
						$poAmount = '';
					}
				}else{
					if($type == "PO"){
						$codeAmount = $poAmount;
					}else{
						$codeAmount = $obr;
					}
				}
				
				$status = $data['Status'];
			
				$modified = substr($data['DateModified'],0,10);
				
				
				if($i % 2 == 0){
					$color = "rgb(219, 221, 221)";
					$color = "rgb(239, 239, 232)";
				}else{
					$color = "white";
				}
				
				$sheet .= '<tr  class = "trData" style ="background-color:' . $color . '"  >';
				$sheet .= '<td style = "border:0;text-align:center;background-color:white;">' . $i++ . '</td>
						   
						   <td class = "tdDataBalance" style = "border-left: 1px dashed grey;border-right: 1px dashed grey;font-weight:bold;font-size:12px;text-align:left;" onclick = "searchThisBalance(this)" >' . $tn . '</td>
						   <td class = "tdDataBalance" style ="text-align:left;">' . $claim . '</td>
						   <td class = "tdDataBalance" style ="text-align:left;">' . $claimant . '</td>
						   <td class = "tdDataBalance" style ="text-align:center;">' . $this->zeroToNothing($adv) . '</td>
						   <td class = "tdDataBalance" style ="text-align:center;">' . $this->zeroToNothing($obrNo) . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(32, 186, 214);">' . $this->toNumberFormat($obr) . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(32, 186, 214);color:green;">' . $this->toNumberFormat($poAmount) . '</td>
						   <td class = "tdDataBalance" style ="color:black;text-align:right;">' . $this->toNumberFormat($codeAmount) . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(109, 39, 39);">' . $this->toNumberFormat($net) . '</td>
						    <td class = "tdDataBalance"><span style = "color:red;letter-spacing:1px;">' . $check . '</span></td>
						   <td class = "tdDataBalance" style ="color:rgb(109, 39, 39);">' . $checkDate . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(109, 39, 39);">' . $checkDateNew . '</td>
						   
						   <td class = "tdDataBalance" style ="text-align:left;">' . $status . '</td>
						   <td class = "tdDataBalance">' . $modified . '</td>';
				$sheet .= '</tr>';
			}
			$updateCaseA .= ' END';
			$updateCase .=  $updateCaseA . ' WHERE Id IN (' . substr($ids,1,strlen($ids)) . ')';
			$sheet .= '</table>';
			if(strlen($ids) > 1){
				$a = $this->query($updateCase);
				$x = $this->affected_rows($a);
			}else{
				$x = '0';
			}
			return $updateCase . $c2 . 'affected=' .  $x . '-'  . ' ----- ' . $checkDate ;
			//return $sheet;
		}
		/*	------------------------------------------------------------------------------ liquidation*/
		function CreateSelectLiquidation($record){
			$sheet = '<select class = "data2" style = "letter-spacing:2px;" onchange = "selectCashAdvance(this)">';
			$sheet .= '<option></option>'; 
			$i = 0;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$period = strtoupper(substr($data['PeriodMonth'],0,3));
				$amount = $data['Gross'];
				$v = $tn ."@" . $amount . "@" . $claimant;
				if($i % 2 == 0){
					$sheet .= '<option value = "' . $v . '" style = "background-color:rgb(223, 226, 228);">' .  $period . '  - ' .$claimant  . '</option>';
				}else{
					$sheet .= '<option value = "' . $v . '">' .  $period . '  - ' .$claimant  . '</option>';
				}
				$i++;
				
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateLiquidated($record){
			$count = $this->num_rows($record);
			$c = "rgb(186, 196, 194)";
			$sheet = '<table id ="tableBalancesDetails" style = "text-align:center;border-spacing:0;background-color:white;padding:8px;width:100%;" border= "0" >';
			$sheet .= '<tr style = ""><td></td>
						<td colspan ="11" style = "text-align:left;font-weight:bold;text-overflow:nowrap;white-space: nowrap;">
						<span class = "hoverPrint"  style = "position:absolute;margin-top:-12px;margin-left:-1px;" onclick = "previewCandL()">&#8471;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						
						
						<span  id = "p3" style = "color:green;margin-left:3px;">Cash Advance & Liquidation</span>
						<span id = "p4" style = "font-weight:normal;margin-left:5px;font-size:13px;letter-spacing:1px;"></span></td>
						<td colspan = "2"><span id = "periodT" style = "text-overflow:nowrap;white-space: nowrap;font-size:14px;"></span></td>
						
						</tr>';
			$sheet .= '<td style = "border-right:1px solid grey;"></td>

						<td class = "trHead" style = "width:10px;background-color:rgb(160, 165, 164);">TN</td>
						
						<td class = "trHead" style = "width:10px;background-color:' . $c . ';width:180px;">Cash Advance Type</td>
						<td class = "trHead" style = "width:10px;background-color:' . $c . ';width:50px;">Liq.&nbsp;Period</td>
						<td class = "trHead" style = "background-color:' . $c . ';">Claimant</td>
						<td class = "trHead" style = "width:10px;background-color:' . $c . ';">Month</td>
						<td class = "trHead" style = "background-color:' . $c . ';width:40px;">Adv&nbsp;No</td>
						<td class = "trHead" style = "background-color:' . $c . ';width:40px;">ObR&nbsp;No</td>
						<td class = "trHead" style = "width:10px;background-color:' . $c . ';">Status</td>
						<td class = "trHead" style = "background-color:' . $c . ';width:80px;">Check Amt</td>
						<td class = "trHead" style = "width:10px;background-color:' . $c . ';"><div style = "width:65px;">CheckNo</div></td>
						
						<td class = "trHead" style = "width:10px;background-color:' . $c . ';">Check&nbsp;Date</td>
						
						<td class = "trHead" style = "width:10px;border-bottom:1px solid silver;background-color:rgb(244, 246, 218);">Liquidate&nbsp;Before</td>
						<td class = "trHead" colspan = "2" style = "border-bottom:1px solid silver;width:10px;background-color:rgb(244, 246, 218);">Due&nbsp;Counter</td>
						
						<td class = "trHead" style = "width:10px;background-color:rgb(135, 154, 163);border-right:1px solid silver;letter-spacing:1px;">Liquidation</td>
						<td class = "trHead" style = "width:10px;background-color:rgb(135, 154, 163);width:100px;">LQ&nbsp;Status</td>
						
						';
						
						
			$sheet .= '</tr>';
			$i = 1;	
			
		
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$type = $data['TrackingType'];
				$tn = $data['TrackingNumber'];
				$claim = $data['DocumentType'];
				$claimant = strtoupper($data['Claimant']);
				$obr = $data['Amount'];
				$net = $data['NetAmount'];
				$poAmount = $data['PO_Amount'];
				$multiple = $data['TotalAmountMultiple'];
				$charge = $data['ChargeType'];
				$check = $data['checknumber'];
				$checkDate = $data['checkdate'];
				
				$trackingPartner = $data['TrackingPartner'];
				$lqStatus = $data['LQstatus'];
				
				$ds = '';
				if($claim == "CASH ADVANCE - PETTY CASH"){
					$dueCtr = "1 year";
				}else if($claim == "CASH ADVANCE - TRAVEL (FOREIGN)"){
					$dueCtr = "60 days";
				}else if($claim == "CASH ADVANCE - TRAVEL (LOCAL)"){
					$dueCtr = "30 days";
				}else if($claim == "CASH ADVANCE - SPECIAL"){
					$dueCtr = "20 days";
				}else{
					$dueCtr = "0 day";
				}
				if($check > 0){
					
					$date= date_create($checkDate);
					date_add($date,date_interval_create_from_date_string($dueCtr));
					$due = date_format($date,"Y-m-d");
					
					if($lqStatus != "CAO Released"){
						$date1= date_create($due);
						$now = date('Y-m-d');
						$date2= date_create($now);
						$dateCtr = date_diff($date2,$date1);
						
						$sign = $dateCtr->format("%R");
						$total = $dateCtr->format("%a");
						if($sign == '-'){
							$color = 'red';
						}else{
							$color = 'green';
						}
						
						if($total == 0){
							$d = '<span color ="orange">Today</span>';
							$ds = '';
						}else if($total == 1){
							$d = '<span style = "color:' . $color . '">' . $total .  '</span>';
							$ds = 'day';
						}else{
							$d = '<span style = "color:' . $color . '">' . $total . '</span>';
							$ds = 'days';
						}
						
						
					}else{
						$d = '&check;';
					}
				}else{
					$due = '';
					$d ='';
					
				}
				$adv = $data['ADV1'];
				$obrNo = $data['OBR_Number'];
				$month = $data['PeriodMonth'];
				
				if($charge > 1){
					if($type == "PO"){
						$amount = '';
						$codeAmount = $poAmount;
						$poAmount = $multiple;
					}else{
						$codeAmount = $obr;
						$obr = $multiple;
						$cost = '';
						$poAmount = '';
					}
				}else{
					if($type == "PO"){
						$codeAmount = $poAmount;
					}else{
						$codeAmount = $obr;
					}
				}
				$status = $data['Status'];
				$modified = substr($data['DateModified'],0,10);
				if($i % 2 == 0){
					$color = "rgb(219, 221, 221)";
					$color = "rgb(239, 239, 232)";
				}else{
					$color = "white";
				}
				$sheet .= '<tr  class = "trData" style ="background-color:' . $color . '"  >';
				$sheet .= '<td style = "border:0;text-align:center;background-color:white;">' . $count-- . '</td>
						   
						   <td class = "tdDataBalance" style = "border-left: 1px dashed grey;border-right: 1px dashed grey;font-weight:bold;font-size:12px;text-align:left;width:45px;" onclick = "searchThisCashAdvance(this)" >' . $tn . '</td>
						   <td class = "tdDataBalance" style ="text-align:left;">' . $claim . '</td>
						   <td class = "tdDataBalance" style ="text-align:center;">' . $dueCtr . '</td>
						   
						   <td class = "tdDataBalance" style ="text-align:left;">' . $claimant . '</td>
						   <td class = "tdDataBalance" style ="text-align:left;">' . $month . '</td>
						   
						   <td class = "tdDataBalance" style ="text-align:center;">' . $this->zeroToNothing($adv) . '</td>
						   <td class = "tdDataBalance" style ="text-align:center;">' . $this->zeroToNothing($obrNo) . '</td>
						 	<td class = "tdDataBalance" style ="text-align:left;">' . $status . '</td>
						   <td class = "tdDataBalance" style ="color:rgb(109, 39, 39);text-align:right;">' . $this->toNumberFormat($net) . '</td>
						    <td class = "tdDataBalance"><span style = "letter-spacing:1px;">' . $check . '</span></td>
						   <td class = "tdDataBalance" style ="">' . $checkDate . '</td> 
						   
						   <td class = "tdDataBalance" style ="text-align:center;">' . $due . '</td>	
						    <td class = "tdDataBalance" style ="text-align:right;border-right:0;padding-right:0px;width:20px;font-weight:bold;">' . $d . '</td>
						    <td class = "tdDataBalance" style ="text-align:left;border-left:0;width:20px;">' . $ds . '</td>
						    
						    <td class = "tdDataBalance" style ="text-align:left;font-weight:bold;text-align:center;" onclick = "searchThisCashAdvance(this)">' . $trackingPartner . '</td>
						    <td class = "tdDataBalance" style ="text-align:left;">' . $lqStatus . '</td>
						    ';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			
			return $sheet;
		}

		function CreateLiquidatedWBrkDwn($record, $office){

			if($office == ""){
				$sql1 = "SELECT 
						 count(distinct a.TrackingNumber) as actRows
						 FROM vouchercurrent a
						 WHERE 
						 a.Status != 'Cancelled'
						 AND
						 (
						 a.DocumentType = 'CASH ADVANCE - PETTY CASH' OR 
						 a.DocumentType = 'CASH ADVANCE - TRAVEL (FOREIGN)' OR
						 a.DocumentType = 'CASH ADVANCE - TRAVEL (LOCAL)' OR
						 a.DocumentType = 'CASH ADVANCE - SPECIAL'
						 )
						 ORDER BY a.DateModified DESC";
			}else{
				$sql1 = "SELECT 
						 count(distinct a.TrackingNumber) as actRows
						 FROM vouchercurrent a
						 WHERE 
						 a.Office = '".$office."'
						 AND 
						 (
						 a.DocumentType = 'CASH ADVANCE - PETTY CASH' OR 
						 a.DocumentType = 'CASH ADVANCE - TRAVEL (FOREIGN)' OR
						 a.DocumentType = 'CASH ADVANCE - TRAVEL (LOCAL)' OR
						 a.DocumentType = 'CASH ADVANCE - SPECIAL'
						 )
						 AND a.Status != 'Cancelled'
						 ORDER BY a.DateModified DESC";
			}
			$record1 = $this->query($sql1);
			$data = $this->fetch_array($record1); 
			$numRows = $data['actRows']; 
	
			$curCaProg = "";
			$curTN = "";
			$ind = 0;
			$prgList = "";
			$accList = "";
			$curTotalCa = 0;
			$curTotallq = 0;
			$bgclr = "";

			$sheet = "<table border='0' cellspacing='0' cellpadding='0' id='tableLiqBrkDwn'>
						<thead>
							<tr>
								<th style='background-color:white;'></th>
								<th colspan='9' style='text-align:left; font-family:mainFont; font-size:16px;'>
									<span class = 'hoverPrint'  style = 'position:absolute;margin-top:-12px;' onclick = ''>&#8471;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<span  id = 'p3' style = 'color:green;margin-left:3px;'>Cash Advance & Liquidation</span>
								</th>
							</tr>
							<tr style='background-color:rgb(186, 196, 194);'>
								<th style='background-color:white;'></th>
								<th style='background-color:rgb(160, 165, 164); width:10px;'>Cash&nbsp;Advance</th>
								<th style=''>Type</th>
								<th style=''>Claimant</th>
								<th style='width:10px;'>Month</th>
								<th style=''>Program</th>
								<th style=''>Account Code</th>
								<th style='text-align:right;'>Amount</th>
								<th style='background-color:rgb(135, 154, 163); width:10px;'>Liquidation</th>
								<th style='text-align:right; background-color:rgb(135, 154, 163);'>Amount</th>
							</tr>
						</thead>
						";


			while($data = $this->fetch_array($record)){
				$displayRow = 1;
				$prgCode = $data['PR_ProgramCode'];
				$accCode = $data['PR_AccountCode'];
				
				$docType = $data['DocumentType'];
				$claimant = $data['Claimant'];
				$month = $data['PeriodMonth'];

				$cashAdvance = $data['caTN'];
				$liquidation = $data['lqTN'];

				if($docType != 'Liquidation') {
					// $liquidation = $data['TrackingPartner'];
					// $cashAdvance = $data['TrackingNumber'];
					$amount = floatval($data['caAmount']);
					$lqAmount = floatval($data['realLqAmount']);
				}else {
					// $cashAdvance = $data['TrackingPartner'];
					// $liquidation = $data['TrackingNumber'];
					$amount = 0.00;
					$lqAmount = floatval($data['lqAmount']);
				}
				


				$idComposed = "";

				$prgSpan = "<span style='display:inline-block; font-weight:bold; min-width:40px;'>".$prgCode."</span>";
				$accSpan = "<span style='display:inline-block; font-weight:bold; min-width:55px;'>".$accCode."</span>";

				if($liquidation != ""){
					$idComposed = $liquidation."!*!".$accCode;
				}

				if(!strpos($prgList, '"'.$prgCode.'"')){
					$prgList .= ',"'.$prgCode.'"';
				}

				if(!strpos($accList, '"'.$accCode.'"')){
					$accList .= ',"'.$accCode.'"';
				}else {
					if($docType == 'Liquidation') { 
						$displayRow = 0;
					}
				}

				if($cashAdvance != $curTN){
					if($curCaProg != ""){
						// $sheet .= "	<tr style='background-color:rgb(135, 154, 163, .2);'>
						// 				<td style='background-color:white;'></td>
						// 				<td style='border-left:1px solid silver;'></td>
						// 				<td style=''></td>
						// 				<td style=''></td>
						// 				<td style=''></td>
						// 				<td style=''></td>
						// 				<td style='text-align:right; font-weight:bold; padding-right:0px; letter-spacing:1px; color:gray;'>Total</td>
						// 				<td style='text-align:right; font-weight:bold; letter-spacing:1px;'>".number_format($curTotalCa, 2)."</td>
						// 				<td style=''></td>
						// 				<td style='text-align:right; font-weight:bold; letter-spacing:1px; border-right:1px solid silver;'>".number_format($curTotallq, 2)."</td>
						// 			</tr>";

						$sheet .= "	<tr style=''>
										<td style='background-color:white;'></td>
										<td style='border-left:1px solid silver;'></td>
										<td style=''></td>
										<td style=''></td>
										<td style=''></td>
										<td style=''></td>
										<td style='text-align:right; font-weight:bold; padding-right:0px; letter-spacing:1px; color:gray;'>Total</td>
										<td style='text-align:right; font-weight:bold; letter-spacing:1px;'>".number_format($curTotalCa, 2)."</td>
										<td style=''></td>
										<td style='text-align:right; font-weight:bold; letter-spacing:1px; border-right:1px solid silver;'>".number_format($curTotallq, 2)."</td>
									</tr>";
					}
					$curCaProg = $prgCode;
					$curTN = $cashAdvance;
					$row = $numRows--;
					$curTotalCa = 0;
					$curTotallq = 0;
					$bgclr = "background-color:rgb(135, 154, 163, .2);";
				}else{
					$cashAdvance = "";
					$liquidation = "";
					$row = "";
					$docType = "";
					$claimant = "";
					$month = "";

					$prgSpan = "";
					$bgclr = "";
				}

				if($displayRow == 1) {
					$sheet .= "	<tr style='".$bgclr."'>
									<td style='background-color:white;'>".$row."</td>
									<td style='color:rgb(35, 116, 157); font-weight:bold; border-left:1px solid silver;'>".$cashAdvance."</td>
									<td style='background-color:rgba(207, 212, 213, .2);'>".$docType."</td>
									<td>".$claimant."</td>
									<td style='background-color:rgba(207, 212, 213, .2);'>".$month."</td>
									<td style='padding-left:10px;'>".$prgSpan."</td>
									<td>".$accSpan."</td>
									<td style='text-align:right;'>".$this->zeroToEmpty( number_format($amount, 2) )."</td>
									<td style='color:rgb(35, 116, 157); font-weight:bold; background-color:rgba(207, 212, 213, .3);'>".$liquidation."</td>
									<td id='amount".$idComposed."' style='text-align:right; border-right:1px solid silver; background-color:rgba(207, 212, 213, .3);'>".$this->zeroToEmpty( number_format($lqAmount, 2) )."</td>
								</tr>";
					
					$curTotalCa += $amount;
					$curTotallq += $lqAmount;
				}

			}



			if($curCaProg != ""){
				// $sheet .= "	<tr style='background-color:rgb(135, 154, 163, .2);'>
				// 				<td style='background-color:white;'></td>
				// 				<td style='border-left:1px solid silver;'></td>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style='text-align:right; font-weight:bold; padding-right:0px; letter-spacing:1px; color:gray;'>Total</td>
				// 				<td style='text-align:right; font-weight:bold; letter-spacing:1px;'>".number_format($curTotalCa, 2)."</td>
				// 				<td style=''></td>
				// 				<td style='text-align:right; font-weight:bold; letter-spacing:1px; border-right:1px solid silver;'>".number_format($curTotallq, 2)."</td>
				// 			</tr>";
				$sheet .= "	<tr style=''>
								<td style='background-color:white;'></td>
								<td style='border-left:1px solid silver;'></td>
								<td style=''></td>
								<td style=''></td>
								<td style=''></td>
								<td style=''></td>
								<td style='text-align:right; font-weight:bold; padding-right:0px; letter-spacing:1px; color:gray;'>Total</td>
								<td style='text-align:right; font-weight:bold; letter-spacing:1px;'>".number_format($curTotalCa, 2)."</td>
								<td style=''></td>
								<td style='text-align:right; font-weight:bold; letter-spacing:1px; border-right:1px solid silver;'>".number_format($curTotallq, 2)."</td>
							</tr>";
			}
			$sheet .= "</table>";

			$prgDetails = "";
			$sql2 = "SELECT Code, Name FROM programcode WHERE Code IN (".substr($prgList, 1).")";
			$record2 = $this->query($sql2);
			while($data = $this->fetch_array($record2)){
				$code = $data['Code'];
				$title = $data['Name'];

				$prgDetails .= $code.":".$title."~";
			}

			$accDetails = "";
			$sql3 = "SELECT Code, Title FROM fundtitles WHERE Code IN (".substr($accList, 1).")";
			$record3 = $this->query($sql3);
			while($data = $this->fetch_array($record3)){
				$code = $data['Code'];
				$title = $data['Title'];

				$accDetails .= $code.":".$title."~";
			}

			echo $sheet."!j!".$prgDetails."!j!".$accDetails;
			
		}

		function CreateCandL($record){
			$count = $this->num_rows($record);
			$sheetA = '<table style = "font-size:14px;border-spacing:0;width:100%;font-family:Oswald;" border= "0">';
			$sheet = '<tr style = "font-size:14px;font-weight:bold;"><td></td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;width:20px;padding-right:10px;">Cash&nbsp;Advance</td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;">Period</td>
						
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;">Claimant</td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;width:20px;padding-right:10px;">Amount</td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;width:20px;padding-right:10px;">Check</td>
						<td style = "border-top:2px solid grey;border-bottom:1px solid grey;width:20px;padding-right:10px;">CheckDate</td>
						
						
						<td style ="text-align:left;border-top:2px solid grey;border-bottom:1px solid grey;width:80px;border-right:1px dashed grey;">Status</td>
						<td style = "text-align:left;border-top:2px solid grey;border-bottom:1px solid grey;width:70px;padding-left:10px;">Liquidation</td>
						<td style ="text-align:left;border-top:2px solid grey;border-bottom:1px solid grey;width:60px;">Status</td>
						
						';
			$sheet .= '</tr>';
			$i = 1;	
			
			$total = 0;
			$totalGross = 0;
			$p =1;
			$c =1;
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$type = $data['TrackingType'];
				$tn = $data['TrackingNumber'];
				$claim = $data['DocumentType'];
				$claimant = $data['Claimant'];
				
				$obr = $data['Amount'];
				$net = $data['NetAmount'];
				$poAmount = $data['PO_Amount'];
				
				$multiple = $data['TotalAmountMultiple'];
				$charge = $data['ChargeType'];
				$check = $data['checknumber'];
				$checkDate = $data['checkdate'];
				$trackingPartner = $data['TrackingPartner'];
				$lqStatus = $data['LQstatus'];
			
				$adv = $data['ADV1'];
				$obrNo = $data['OBR_Number'];
				$month = $data['PeriodMonth'];
				$lq = $data['LQstatus'];
				$trackingPartner = $data['TrackingPartner'];
				
				
				
				
				if($charge > 1){
					
						$obr = $multiple;
						
				}else{
					if($type == "PO"){
						$codeAmount = $poAmount;
					}else{
						$codeAmount = $obr;
					}
				}
				
				$status = $data['Status'];
			
				$modified = substr($data['DateModified'],0,10);
				$sheet .= '<tr  >';
				$sheet .= '<td style = "border:0;text-align:center;background-color:white;">' . $i++ . '</td>
						   <td  style ="text-align:left;border-bottom:1px solid silver;padding-left:5px;">' . $tn . '</td>
						   <td  style ="text-align:left;border-bottom:1px solid silver;">' . $month . '</td>
						   <td style = "text-align:left;border-bottom:1px solid silver;text-overflow:nowrap;white-space: nowrap;" onclick = "searchThisBalance(this)" >' . $claimant . '</td>
						   <td  style ="text-align:right;border-bottom:1px solid silver;padding-right:10px;letter-spacing:1px;">' . number_format($obr,2) . '</td>
						   <td  style ="text-align:right;border-bottom:1px solid silver;padding-right:10px;font-size:12px;">' . $check . '</td>
						   <td  style ="text-align:right;border-bottom:1px solid silver;padding-right:10px;font-size:12px;">' . $checkDate . '</td>
						   
						   <td  style ="text-align:left;border-bottom:1px solid silver;text-overflow:nowrap;white-space: nowrap;border-right:1px dashed grey;">' . $status . '</td>
						   <td  style ="text-align:left;border-bottom:1px solid silver;padding-left:10px;">' . $trackingPartner . '</td>
						  
						   <td  style ="text-align:left;border-bottom:1px solid silver;text-overflow:nowrap;white-space: nowrap;padding-right:5px;">' . $lq . '</td>
						  
						   
						  
						   ';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr><td></td><td colspan = "10" style = "border-top:1px solid grey;"><span>www.davaocityportal.com</span><span style = "float:right;padding-right:15px;">' . date('D d, M Y h:m a') . '</span></td></tr>';
			$sheet .= '</table>';
			$sheetB = '<tr>
							<td></td>	
							<td colspan="3" style = "border-top:1px solid silver;"><span style = "font-size:20px;font-weight:bold;">Cash advance and Liquidation </span></td>
							<td colspan="8" style = "border-top:1px solid silver;text-align:right;padding-right:16px;"><span>&nbsp;&nbsp;&nbsp;Rows</span>
								<span style = "font-size:14px;font-weight:bold;">' .$count . '</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
								
							
							</td>	
					   </tr>';
			return $sheetA . $sheetB .  $sheet;
		}
		function CreateLockItems($record){
			$i = 1;
			$sheet1 ='';
			$sheet2 ='';
			
			$count  = $this->num_rows($record);
		
			while($data = $this->fetch_array($record)){
				$name  = $data['Name'];
				$value  = $data['PPMP'];
				$code = $data['Code'];
				if($value == 1){
					$c = "checked";
					$color = "rgb(252, 249, 172)";
				}else{
					$c = '';
					$color = "";
				}
				if($i <= 48){
					$sheet1 .= '<tr style = "background-color:' . $color . '" ><td style = "padding:2px;color:black;font-size:12px;text-shadow:0px 0px 1px white;">' . $i++ . '</td>';
					$sheet1 .= '<td>' . $name . '</td>';
					$sheet1 .= '<td><input type = "checkbox" ' . $c . ' onclick = "lockThis(this)" id = "' . $code . '"></td>';
					$sheet1 .= '</tr>';
				}else{
					
					$sheet2 .= '<tr style = "background-color:' . $color . '" >';
					$sheet2 .= '<td>' . $i++ . '</td>';
					$sheet2 .= '<td>' . $name . '</td>';
					$sheet2 .= '<td ><input type = "checkbox" ' . $c . ' onclick = "lockThis(this)" id = "' . $code . '"></td>';
					$sheet2 .= '</tr>';
				}
			}
			$sheet = "<table style = 'margin:10px auto;font-family:Oswald;'>
							<tr>
								<td colspan = '2'><div style = 'font-weight:bold;font-size:18px;letter-spacing:1px;padding-left:10px;'>List of Offices</div></td>
							</tr>
							<tr>
							<td>
								<table style ='background-color:rgb(246, 245, 236);padding:5px;font-size:14px;' >
									<tr style = 'background-color:rgb(208, 205, 183);font-weight:bold;'><td></td><td>Office Name</td><td>Lock</td></tr>
									" . $sheet1 . "
								</table>
							</td>";
							if($count > 49){
								$sheet .= "<td style ='vertical-align:top;padding-left:20px;'>
													<table style ='background-color:rgb(246, 245, 236);padding:5px;font-size:14px;'>
														<tr style = 'background-color:rgb(208, 205, 183);font-weight:bold;'><td></td><td>Office Name</td><td>Lock</td></tr>" . $sheet2 . "
													</table>
											</td>";
							}
			$sheet .= "</tr></table>";
			return $sheet;
		}
		function CreateLockFunds($record){
			$i = 1;
			$sheet1 ='';
			
			$count  = $this->num_rows($record);
			if($count == 0){
				$sheet1 = '<tr id = "noData" ><td colspan = "4" style = "padding:20px;color:black;font-size:22px;text-shadow:0px 0px 1px white;text-align:center;">No record found.</td></tr>';
			}
			while($data = $this->fetch_array($record)){
				$name  = $data['Name'];
				$value  = $data['Locker'];
				$code = $data['Code'];
				if($value == 1){
					$c = "checked";
					$color = "rgb(252, 249, 172)";
				}else{
					$c = '';
					$color = "";
				}
				
					$sheet1 .= '<tr class = "hoverTRlock" style = "background-color:' . $color . '" ><td style = "padding-left:8px;color:black;font-size:12px;text-shadow:0px 0px 1px white;color:brown;">' . $i++ . '</td>';
					$sheet1 .= '<td style = "border-bottom:1px solid silver;">' . $code . '</td>';
					$sheet1 .= '<td style = "border-bottom:1px solid silver;">' . $name . '</td>';
					$sheet1 .= '<td style = "border-bottom:1px solid silver;"><input type = "checkbox" ' . $c . ' onclick = "lockThisFund(this)" id = "' . $code . '"></td>';
					$sheet1 .= '</tr>';
				
			}
			
			$sheet = "<table style = 'margin:10px auto;font-family:Oswald;'>
							<tr>
								<td colspan = '2'><div style = 'font-weight:bold;font-size:18px;letter-spacing:1px;padding-left:10px;'>List of Funds</div></td>
							</tr>
							<tr>
							<td style = 'vertical-align:top;'>
								<table style ='background-color:rgb(246, 245, 236);padding:2px;min-width:800px;border-spacing:0;font-size:14px;' >
									<tr style = 'background-color:rgb(208, 205, 183);font-weight:bold;'><td></td><td>Code</td><td>Fund Title</td><td>Lock</td></tr>
									" . $sheet1 . "
								</table>
							</td>";
						
			$sheet .= "</tr></table>";
			return $sheet;
		}
		function CreateAttachment($record){
			$accountType = $_SESSION['accountType'];
			$officeCode = $_SESSION['cbo'];
			$lim = 10;
			$sheet = '<table style = "width:100%;border-spacing:0;font-family:Oswald;padding-top:15px;border:5px solid rgb(235, 233, 224);border-top:3px dotted  rgb(235, 233, 224);" border = "0">';
			$count = $this->num_rows($record);
			$i = $count;
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$title = $data['Title'];
				$remark = $data['Remarks'];
				if($remark == ''){
					$remark = "&nbsp;";
				}
				$sender = $data['Sender'];
				$senderName = ucwords(strtolower($data['Name']));
				$receiver = ucwords(strtolower($data['Receiver']));
				$receiverName = ucwords(strtolower($data['ReceiverName']));
				$filename = $data['Filename'];
				$posted = $data['DatePosted'];
				$posted = $this->ezDate1($posted);
				$subtitle = $remark . $posted; 
				
			
					$sheet .= '<tr>';
					$sheet .= '<td style = "text-align:right;vertical-align:top;padding:0;padding-bottom:10px;padding-left:2px;width:10px;padding-top:4px;">
								<span style = "border:1px solid rgb(241, 250, 232);padding:4px 6px;background-color:rgba(111, 120, 102,.8);color:white;">' . $id . '</span></td>
							    <td style = "padding:0;padding-bottom:10px;padding-right:2px;">
							    <div style = "text-shadow:0px 0px 2px black; font-size:15px; background-color:rgb(152, 169, 156); color:white;letter-spacing:1px;padding-left:10px;padding-top:8px;padding-bottom:2px;font-weight:bold;">
							    ' . $senderName ; 
					
					if($receiver != 'All'){
						$sheet .= '<span style = "color:white;padding-left:10px;padding-right:10px;"> &#9654;</span> <span style = "color:rgb(252, 238, 174);text-shadow:0px 0px 2px black;">' . $receiverName  . '</span>';
					}		    
					$sheet .= '</div>
							    <div style = "background-color:rgb(231, 235, 220); background-color:rgb(246, 253, 224);background-color:rgb(242, 245, 228); padding:10px;">
								    <div style = "font-size:22px;">' . $title;
					if($sender == $officeCode || $accountType == 7){
						$sheet .= '			    	<span class = "hover" id  = "' . $id . '~!~' . $filename . '" style = "float:right;font-size:18px;cursor:pointer;padding-left:10px;color:rgb(216, 52, 90);" onclick = "detach(this)">Remove</span>';
					}			    
					
								    	
					$sheet .= '<span class = "hover" id= "' . $filename . '" style = "float:right;font-size:18px;cursor:pointer;" onclick = "show(this)">View</span>
								    </div>
								    <div style = "padding-left:5px;border-top:1px solid rgb(226, 225, 197);font-size:14px;">' . $remark  .  '<span style = "font-size:12px;margin-left:10px;color:rgb(84, 107, 16);float:right;">' . $posted . '</span></div>
							   	</div>
							   </td>
							   ';
					$sheet .= '<tr>';
			}
			if($count == $lim){
				$sheet .= '<tr><td id = "' . $id . '" onclick = "loadMoreAttach(this)"  colspan = "4" style = "cursor:pointer;text-align:center;padding-bottom:8px;font-weight:bold;letter-spacing:1px;">Load more <span style = "color:silver;">&#x25BC;</span></td></tr>';
			}
			
			if($count == 0){
				$sheet = '<div style = "font-family:Oswald;font-size:20px;padding-top:25px;font-weight:bold;letter-spacing:1px;">No files uploaded.</div>';
			}
			
			$sheet .= '</table>';
			return $sheet;
		}
		function CreateAdviserInfo($record){

			$sheet = '<table style = "margin:0 auto;font-family:Oswald;font-size:18px;width:100%;">';
			$sheet .= '<tr style = "font-weight:bold;color:white;background-color:rgba(57, 122, 162,.5)">';
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Year</td>';	
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Tracking No</td>';	
				
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">ADV No</td>';	
				$sheet .= '<td style = "padding:3px 15px;">Advice No</td>';	
				$sheet .= '<td style = "padding:3px 15px;">Fund</td>';	
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Account No</td>';	
				
				$sheet .= '<td style = "padding:3px 15px;">Claimant</td>';	
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Check Number</td>';	
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Check Date</td>';	
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Amount</td>';	
				$sheet .= '<td style = "padding:3px 15px;text-align:center;">Updated</td>';
				$sheet .= '</tr>';
			while($data = $this->fetch_array($record)){
				
				$tn = $data['TrackingNumber'];
				$fund = $data['Fund'];
				$account = $data['AccountNo'];
				$adviceId = $data['AdviceId'];
				$adv =  $data['Adv1'];
				if($data['Adv2'] > 0){
					$adv = $data['Adv2'];
				}
				$checknumber = $data['CheckNumber'];
				$checkdate = $data['CheckDate'];
				$claimant = $data['Claimant'];
				$net = number_format($data['NetAmount'],2);
				$net = '****';
				$year = $data['Year'];
				$date = $data['DateAdvice'];
				
				$sheet .= '<tr style = "font-size:14px;font-weight:bold;" onmouseover ="highlight(this)" onmouseout = "highlight(this)" >';
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;text-align:center;">' . $year . '</td>';
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;text-align:center;">' . $tn . '</td>';
				
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;font-weight:bold;text-align:center;">' . $adv . '</td>';	
				$sheet .= '<td style = "background-color:rgb(239, 244, 197);padding:2px 15px;font-weight:bold;letter-spacing:1px;cursor:pointer;" onclick = "showBatchAdvice(this)">' . $adviceId . '</td>';	
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;">' . $fund . '</td>';	
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;text-align:center;">' . $account . '</td>';	
				
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;">' . $claimant . '</td>';	
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;text-align:center;letter-spacing:1px;">' . $checknumber . '</td>';	
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;text-align:center;">' . $checkdate . '</td>';	
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;text-align:right;">' . $net . '</td>';	
				$sheet .= '<td style = "background-color:rgba(247, 248, 248,.6);padding:2px 15px;font-size:12px;letter-spacing:1px;text-align:center;">' . $date . '</td>';	
				$sheet .= '</tr>';
			}
			$sheet .= '<tr><td colspan = "10" style = "color:silver;font-size:14px;text-align:right;letter-spacing:1px;padding-right:20px;">Note : From  2017 transactions only</td></tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		function CreatePPMPItemSelect($record,$catName,$catDes,$dbYear){
			$sheet = "<div class='editorContainer' style ='padding:0;border:1px solid white;' id='editorContainer'>";
			$sheet .= "<table border='0' style='margin: 0px auto; border-spacing: 5px; font-family: arial;width:800px;'>";
			$sheet	 .= "<tr style = 'background-image: linear-gradient(to  left, rgb(90, 105, 23) , rgba(157, 183, 12,.8));'>";
			$sheet	 .= "<td style=' color:white;font-weight:bold;padding:5px 10px;font-family:roboto;background-color:rgb(158, 172, 144); '>";
			$sheet	 .= "	&#9777; Item Select </span>
					<span id = 'ppmpItemCat' style = 'font-family:Oswald;color:black;font-weight:bold;letter-spacing:2px;font-size:12px;padding-left:10px;'>" . $catName  . "</span>	
					<span id='editorX'  onclick='closeAbsolute(this)'style = 'float:right;cursor:pointer;'>&#10006;</span><span style = 'float:right;margin-right:15px;font-size:14px;'><span>Search Keyword</span>
					<input style = 'width:120px;border-radius:2px;text-align:center;padding:3px 4px;margin-left:5px;border:0;border-top:1px solid silver;border-left:1px solid silver;margin-top:2px;' value = '' onkeydown ='keypressAndWhat1(this,event,searchKeywordPPMP,1)'/></span>";
			$sheet	 .= "</td>";
			$sheet	 .= "</tr><tr><td>
						<div style = 'border-bottom:1px solid silver;padding-left:40px;padding-bottom:2px;font-weight:bold;letter-spacing:1px;font-size:12px;'>Item#
						<span style = 'margin-left:5px;'>Description</span> <span style = 'float: right;margin-right:32px;'>Est. Price</span></div>
						<div style =  'height:700px;overflow:auto;'><table id = 'pppmpItemSelectTable' style = 'font-size:12px;width:100%;'>";
			$i = 1;
			while($data = $this->fetch_array($record)){
				$id =   $data['Id'];
				$desc =   $data['Description'];
				$unit = $data['PurchasedUnit'];
				$cat = $data['CategoryCode'];
				$price = $this->toNumberFormat($data['EstimatedPrice']);
				$sheet	 .= "<tr id = '" . $cat . "' onclick = 'selectThisItem(this)'>";
				$sheet	 .= "	<td  style = 'text-align:center;background-color:white;color:grey;'>" . $i++ .  "<input type = 'hidden' value = '" . $unit .  "'/></td>";
				$sheet	 .= "	<td  style = 'vertical-align:middle;text-align:center;padding:0px 10px;width:10px;'>" . $id . "</td>";
				$sheet	 .= "	<td  style = 'padding:7px 5px;'>" . $desc . "</td>";
				$sheet	 .= "	<td  style = 'text-align:right; padding:0px 5px;padding-right:15px;letter-spacing:1px;width:75px;'>" . $price  . "</td>";
				$sheet	 .= "</tr>";
			}
			$sheet	 .= "<tr style = 'background-color:rgb(158, 172, 144);'>";
			$sheet	 .= "	<td colspan = '4' style = 'text-align:center;font-weight:bold;padding:10px;color:white;'>Nothings follows.</td>
						</tr>";	
			// $sheet	 .= "</table></div><div style = 'border-top:1px solid rgb(158, 172, 144);  '>&nbsp;</div></td></tr>";
			$sheet	 .= "</table></div>";
			$sheet	 .= "<div style = 'border-top:1px solid rgb(158, 172, 144); font-weight:bold; font-size:12px; padding:10px; text-align:right;'>
							<span onclick='goToPrintCATItems(\"".$cat."\", \"".$catDes."\", \"".$dbYear."\")' style='cursor:pointer;'>&#8471;&nbsp;PRINT LIST</span>
						</div>";
			$sheet	 .= "</td></tr>";
			$sheet	 .= "</table>";
			$sheet	 .= "</div>";
			return $sheet;
		}
		
		function CreatePPMPItemSelect1($record){
		
			$i = 1;
			$sheet = '';
			while($data = $this->fetch_array($record)){
				$id =   $data['Id'];
				$desc =   $data['Description'];
				$unit = $data['PurchasedUnit'];
				$price = $this->toNumberFormat($data['EstimatedPrice']);
				$cat = $data['CategoryCode'];
				$sheet	 .= "<tr id = '" . $cat . "' onclick = 'selectThisItem(this)'>";
				$sheet	 .= "	<td  style = 'text-align:center;background-color:white;color:grey;'>" . $i++ .  "<input type = 'hidden' value = '" . $unit .  "'/></td>";
				$sheet	 .= "	<td  style = 'vertical-align:middle;text-align:center;padding:0px 10px;width:10px;'>" . $id . "</td>";
				$sheet	 .= "	<td  style = 'padding:7px 5px;'>" . $desc . "</td>";
				$sheet	 .= "	<td  style = 'text-align:right; padding:0px 5px;padding-right:15px;letter-spacing:1px;width:75px;'>" . $price  . "</td>";
				$sheet	 .= "</tr>";
			}
			$sheet	 .= "<tr style = 'background-color:rgb(158, 172, 144);'>";
			$sheet	 .= "	<td colspan = '4' style = 'text-align:center;font-weight:bold;padding:10px;color:white;'>Nothings follows.</td>
						</tr>";	
			
			return $sheet;
		}

		function displayCounter($record,$year,$qtrLabel){
			$i = 1;
			
			
			$sheetCAO = '<table class = "tableOffice" ><tr><th colspan ="4">City Accountant\'s Office</th></tr>';
			$sheetAdmin = '<table class = "tableOffice"><tr><th colspan ="4">City Administrator\'s Office</th></tr>';
			
			$sheetGSO = '<table class = "tableOffice"><tr><th colspan ="4">General Service Office</th></tr>';
			$sheetCBO = '<table class = "tableOffice"><tr><th colspan ="4">City Budget Office</th></tr>';
			
			$sheetCTO = '<table class = "tableOffice"><tr><th colspan ="4">City Treasurer\' Office</th></tr>';
			$sheetAdmin = '<table class = "tableOffice"  ><tr><th colspan ="4">City Admin Office</th></tr>';
			$sheetBAC = '<table class = "tableOffice"><tr><th colspan ="4">Bid of Awards Committee</th></tr>';
			
			
			$caoArr = ["CAO Received", "Forwarding Transmittal","CAO - SLP","CAO - SLP 1","CAO Released","Pending at CAO", "Pending Released - CAO", "Check Advised","Cancelled"];
			$cboArr = ["CBO Received", "CBO Released","Pending at CBO", "Pending Released - CBO", "Fund Control","Waiting for Delivery"];
			$gsoArr = ["GSO Received", "GSO Released","Pending at GSO", "Pending Released - GSO","For Inspection","Inspected", "Inventory", "Pending at GSO - Inspection","Pending Released - Ispection","Pending at GSO - Inventory","Pending Released - Inventory","Served to Supplier","Supplier Conformed"];
			$ctoArr = ["CTO Received", "Pending at CTO", "Pending Released - CTO","Check Preparation - CTO","Forwarded to Admin - Administration","Forwarded to Admin - Operation","Forwarded to SP - Admin","Forwarded to SP Admin - PR"];
			$adminArr = ["Admin Received", "Pending at Admin", "Pending Released - Admin"];
			$bacArr = ["BAC Received", "Pending at BAC", "Pending Released - BAC","For P.O"];
			
			
			$caoTotal = 0;
			$cboTotal = 0;
			$gsoTotal = 0;
			$ctoTotal = 0;
			$adminTotal = 0;
			$bacTotal = 0;
			
			while($data = $this->fetch_array($record)){
				$status =   $data['status'];
				$count =   $data['Count'];
				$seq = $data['seq'];
				
				if(in_array($status ,$caoArr)){
					$sheetCAO	 .= "<tr>";
					$sheetCAO	 .= "	<td style = ''>" . $status . "</td>";
					$sheetCAO	 .= "	<td style = 'text-align:right;width:0px;'>" . $count  . "</td>";
					$sheetCAO	 .= "</tr>";
					$caoTotal += $count;
				}else if(in_array($status ,$cboArr)){
					$sheetCBO	 .= "<tr>";
					$sheetCBO	 .= "	<td style = ''>" . $status . "</td>";
					$sheetCBO	 .= "	<td style = 'text-align:right;width:0px;'>" . $count  . "</td>";
					$sheetCBO	 .= "</tr>";
					$cboTotal += $count;
				}else if(in_array($status ,$gsoArr)){
					$sheetGSO	 .= "<tr>";
					$sheetGSO	 .= "	<td style = ''>" . $status . "</td>";
					$sheetGSO	 .= "	<td style = 'text-align:right;width:0px;'>" . $count  . "</td>";
					$sheetGSO	 .= "</tr>";
					$gsoTotal += $count;
				}else if(in_array($status ,$ctoArr)){
					$sheetCTO	 .= "<tr>";
					$sheetCTO	 .= "	<td style = ''>" . $status . "</td>";
					$sheetCTO	 .= "	<td style = 'text-align:right;width:0px;'>" . $count  . "</td>";
					$sheetCTO	 .= "</tr>";
					$ctoTotal += $count;
				}else if(in_array($status ,$adminArr)){
					$sheetAdmin	 .= "<tr>";
					$sheetAdmin	 .= "	<td style = ''>" . $status . "</td>";
					$sheetAdmin	 .= "	<td style = 'text-align:right;width:0px;'>" . $count  . "</td>";
					$sheetAdmin	 .= "</tr>";
					$adminTotal += $count;
				}else if(in_array($status ,$bacArr)){
					$sheetBAC	 .= "<tr>";
					$sheetBAC	 .= "	<td style = ''>" . $status . "</td>";
					$sheetBAC	 .= "	<td style = 'text-align:right;width:0px;'>" . $count  . "</td>";
					$sheetBAC	 .= "</tr>";
					$bacTotal += $count;
				}
			}
			$sheetCAO	 .= "<tr><td class = 'officeTotal' colspan = '2'>" . $caoTotal . "</td></tr></table>";
			$sheetAdmin	 .= "<tr><td class = 'officeTotal' colspan = '2'>" . $adminTotal . "</td></tr></table>";
			$sheetGSO	 .= "<tr><td class = 'officeTotal' colspan = '2'>" . $gsoTotal . "</td></tr></table>";
			$sheetCBO	 .= "<tr><td class = 'officeTotal' colspan = '2'>" . $cboTotal . "</td></tr></table>";
			$sheetCTO	 .= "<tr><td class = 'officeTotal' colspan = '2'>" . $ctoTotal . "</td></tr></table>";
			$sheetBAC	 .= "<tr><td class = 'officeTotal' colspan = '2'>" . $bacTotal . "</td></tr></table>";
			
			
			
			if(trim($qtrLabel) == "Year Plus"){
				$rem = "Summary of <span style ='font-weight:bold;font-family:roboto;'> </span>processed transactions updated in the years of <span style ='font-weight:bold;font-family:roboto;'>" .  ($year+1) . "</span> <span id = 'qtrSummary' style = 'font-family:Robot;font-size:28px;color:rgb(8, 117, 153);'> and above</span>";
			}else if($qtrLabel == "Year Before"){
				$rem = "Summary of <span style ='font-weight:bold;font-family:roboto;'>$year </span> transactions processed in advance in the last quarter of <span id = 'qtrSummary' style = 'font-family:Robot;font-size:28px;color:rgb(8, 117, 153);'>"  .  ($year-1) ."</span> ";
			}else if($qtrLabel == "All"){
				$rem = "<span id = 'qtrSummary' style = 'font-family:Robot;font-size:28px;color:rgb(8, 117, 153);'>Summary</span> of <span style ='font-weight:bold;font-family:roboto;'>$year</span> processed transactions";
			}else{
				$rem = " Summary of processed transactions updated in the <span id = 'qtrSummary' style = 'font-family:Robot;font-size:28px;color:rgb(8, 117, 153);'>" . $qtrLabel ."</span> of <span style ='font-weight:bold;font-family:roboto;'>$year</span>";
				
			}
			
			$sheet = '<table style = "margin:0 auto;border-spacing:10px;;" >';
			
			$sheet .= "<tr><td colspan ='3' style = 'text-align:center;font-size:14px;padding:10px;padding-bottom:5px;vertical-align:bottom;font-family:Arial;'>$rem
					   </td></tr>";
			
			$sheet	 .= "<tr>";
			$sheet	 .= "<td style = 'vertical-align:top;'>";
			$sheet   .= $sheetCAO;
			$sheet	 .= "</td>";
			$sheet	 .= "<td style = 'vertical-align:top;'>";
			$sheet   .= $sheetCBO;
			$sheet	 .= "</td>";
			
			$sheet	 .= "<td style = 'vertical-align:top;'>";
			$sheet   .= $sheetGSO;
			$sheet	 .= "</td>";
			$sheet	 .= "</tr>";
			
			
			$sheet	 .= "<tr>";
			$sheet	 .= "<td style = 'vertical-align:top;padding-top:10px;'>";
			$sheet   .= $sheetCTO;
			$sheet	 .= "</td>";
			
			$sheet	 .= "<td style = 'vertical-align:top;padding-top:10px;'>";
			$sheet   .= $sheetAdmin;
			$sheet	 .= "</td>";
			
			$sheet	 .= "<td style = 'vertical-align:top;padding-top:10px;'>";
			$sheet   .= $sheetBAC;
			$sheet	 .= "</td></tr>";
			
			$sheet	 .= "<tr><td style = 'vertical-align:top;padding-top:10px;text-align:right;font-size:10px;border-top:1px solid rgb(238, 241, 242);background-color:rgb(245, 249, 249);' colspan = '3'>";
			$sheet   .= "Source : " . $year . " transactions from Doctrack" . $year . " , Doctrack".  ($year-1). ", Doctrack" . ($year-2) . " and Doctrack" . ($year-3) . ".";
			$sheet	 .= "</td></tr>";
			
			$sheet .= '</table>';
			
			
			return $sheet;
		}
		
		function displayOfficeCounter($record,$year){
			$i = 0;
			
			$sheet = '<table  class = "tableOfficeCounter">';
			$sheet .= "<tr><td colspan ='20' style = 'text-align:center;font-size:14px;padding:10px;padding-bottom:5px;vertical-align:bottom;font-family:Arial;'>
				<span id = 'qtrSummary' style = 'font-family:Robot;font-size:28px;color:rgb(8, 117, 153);'>Summary</span> of processed transactions updated in the year <span style ='font-weight:bold;font-family:roboto;'>$year</span></td></tr>
			
						<tr style = 'background-color:rgb(12, 71, 123);color:white;'>
							<th></th>
							<th>Status</th>
							<th>Jan</th>
							<th>Feb</th>
							<th>Mar</th>
							<th style ='background-color:rgb(157, 157, 136);'>Q1</th>
							
							<th>Apr</th>
							<th>May</th>
							<th>Jun</th>
							<th style ='background-color:rgb(157, 157, 136);'>Q2</th>
							<th>Jul</th>
							<th>Aug</th>
							<th>Sep</th>
							<th style ='background-color:rgb(157, 157, 136);'>Q3</th>
							<th>Oct</th>
							<th>Nov</th>
							<th>Dec</th>
							<th style ='background-color:rgb(157, 157, 136);'>Q4</th>
						</tr>";
			
			
			while($data = $this->fetch_array($record)){
				$status =   $data['Status'];
				$jan =   $data['Jan'];
				$feb =   $data['Feb'];
				$mar =   $data['Mar'];
				$apr =   $data['Apr'];
				$may =   $data['May'];
				$jun =   $data['Jun'];
				$jul =   $data['Jul'];
				$aug =   $data['Aug'];
				$sep =   $data['Sep'];
				$oct =   $data['Oct'];
				$nov =   $data['Nov'];
				$dex =   $data['Dex'];
				$seq = $data['seq'];
				$i++;
				
				if($status == "Check Released"){
					$sheet	 .= "<tr style = 'background-color:rgba(137, 188, 225,.3);font-weight:bold;'>";
					$col = "black";
				}else{
					$col = "rgb(11, 133, 178)";
					$sheet	 .= "<tr>";
				}
			
				$sheet	 .= "	<td style = 'background-color:white;'>" . $i . "</td>";
				$sheet	 .= "	<td style = 'text-align:left;padding-left:5px;'>" . $status . "</td>";
				$sheet	 .= "	<td >" . $jan  . "</td>";
				$sheet	 .= "	<td >" . $feb  . "</td>";
				$sheet	 .= "	<td >" . $mar  . "</td>";
				
				$sheet	 .= "	<td style = 'border-right:1px solid rgba(229, 232, 227);border-left:1px solid rgba(229, 232, 227);font-weight:bold;color:$col;'>" . $this->zeroToNothing(($jan + $feb + $mar))  . "</td>";
				
				
				$sheet	 .= "	<td >" . $apr  . "</td>";
				$sheet	 .= "	<td >" . $may  . "</td>";
				$sheet	 .= "	<td >" . $jun  . "</td>";
				$sheet	 .= "	<td style = 'border-right:1px solid rgba(229, 232, 227);border-left:1px solid rgba(229, 232, 227);font-weight:bold;color:$col;'>" . $this->zeroToNothing(($apr + $may + $jun))  . "</td>";
				
				
				$sheet	 .= "	<td >" . $jul  . "</td>";
				$sheet	 .= "	<td >" . $aug  . "</td>";
				$sheet	 .= "	<td >" . $sep  . "</td>";
				$sheet	 .= "	<td style = 'border-right:1px solid rgba(229, 232, 227);border-left:1px solid rgba(229, 232, 227);font-weight:bold;color:$col;'>" . $this->zeroToNothing(($jul + $aug + $sep))  . "</td>";
				
				$sheet	 .= "	<td >" . $oct  . "</td>";
				$sheet	 .= "	<td >" . $nov  . "</td>";
				$sheet	 .= "	<td >" . $dex  . "</td>";
				$sheet	 .= "	<td style = 'border-right:1px solid rgba(229, 232, 227);border-left:1px solid rgba(229, 232, 227);font-weight:bold;color:$col;'>" . $this->zeroToNothing(($oct + $nov + $dex))  . "</td>";
				$sheet	 .= "</tr>";	
			}
			$sheet	 .= "<tr><td style = 'vertical-align:top;padding-top:10px;text-align:right;font-size:10px;border-top:1px solid rgb(238, 241, 242);background-color:rgb(245, 249, 249);padding-right:10px;' colspan = '20'>";
			$sheet   .= "Source : Transactions from Doctrack" . $year . " system.";
			$sheet	 .= "</td></tr>";
			$sheet .= '</table>';
			return $sheet;
		}
		
		function createTableCalendarTracking($record){
			$sheet = '<table id ="tableTrackingCalendar" style = "width:100%;font-size:11px;border-spacing:0;font-family:Roboto;border:1px solid silver; padding:5px;" >';
			$sheet .= '<tr style = "background-color:rgb(71, 87, 97);color:white;">
						<td></td>	
						<td style = "padding-top:5px; padding-bottom:5px;">Office</td>	
						<td>Type</td>	
						<td style = "width:90px;">Tracking Number</td>
						<td>Document</td>
					  	<td>Claimant</td>
					  	<td style = "text-align:right;">Amount</td>
						<td style ="text-align:center;width:120px;">Date Updated</td>
						<td style ="text-align:center;width:120px;">Classification</td>
					  </tr>	
					 ';
			$i = 1;
			$cmpx = 0;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$office = $data['Name'];
				$trackingType = $data['TrackingType'];
				$docType = $data['DocumentType'];
				$status = $data['Status'];
				$amount = $data['Amount'];
				$poAmount = $data['PO_Amount'];
				$mul = $data['TotalAmountMultiple'];
				$complex = $data['Complex'];
				$classification ='';
				// if($complex > 0){
				// 	$classification = "Complex";
				// 	$cmpx++;
				// }

				if($complex == 2) {
					$classification = "Complex";
					$cmpx++;
				}
				
				
				if($trackingType == "PO"){
					$docType = "P.O / Payment";
					if($mul > 0){
						$amount = $mul;
					}else{
						$amount = $poAmount;
					}
				}else{
					if($mul > 0){
						$amount = $mul;
					}
				}
				$amount = number_format($amount,2);
				
				if($trackingType == "PR"){
					$docType = "Purchase Request";
				}
				$dateModified = $data['DateModified'];
				
				
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(230, 232, 234);border-bottom:1px solid white;">' . $i++ . '</td>';
				$sheet .= '<td>' . $office . '</td>';
				$sheet .= '<td>' . $trackingType . '</td>';
				$sheet .= '<td onclick="clickToSearchCalendar(this)" style="cursor:pointer;">' . $tn . '</td>';
				$sheet .= '<td>' . $docType . '</td>';
				$sheet .= '<td>' . $claimant . '</td>';
				$sheet .= '<td style = "text-align:right;">' . $amount . '</td>';
				$sheet .= '<td style ="text-align:center;">' . $dateModified . '</td>';
				$sheet .= '<td style ="text-align:center;">' . $classification . '</td>';
				
				$sheet .= '</tr>';
			}
			$sheet .= '<tr>';
			$sheet .= '<td style = "text-align:center;background-color:rgb(239, 241, 245);font-size:9px;padding-top:1px;border-top:1px solid rgb(228, 231, 232);" colspan = "32">-  -  -</td>';
			$sheet .= '<tr>';
			
			$sheet .= '</table>';
			
			
			$sheet1 = "<div style = 'margin:20px auto; margin-bottom:0px;'><div style = 'font-size:13px;font-family:Roboto;padding-left:10px;'>Status : <span style = 'font-weight:bold;color:rgb(10, 104, 159);' >" . $status . "</span></div>" . $sheet . "</div>";
			
			
			return $sheet1;
		}

		function createTableCalendarTrackingComplex($record){
			$sheet = '<table id ="tableTrackingCalendar" style = "width:100%;font-size:11px;border-spacing:0;font-family:Roboto;border:1px solid silver; padding:5px;" >';
			$sheet .= '<tr style = "background-color:rgb(71, 87, 97);color:white;">
						<td></td>	
						<td style = "padding-top:5px; padding-bottom:5px;">Office</td>	
						<td>Type</td>	
						<td style = "width:90px;">Tracking Number</td>
						<td>Document</td>
					  	<td>Claimant</td>
					  	<td style = "text-align:right;">Amount</td>
						<td style ="text-align:center;width:120px;">Date Updated</td>
						<td style ="text-align:center;width:120px;">Classification</td>
					  </tr>	
					 ';
			$i = 1;
			$cmpx = 0;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$office = $data['Name'];
				$trackingType = $data['TrackingType'];
				$docType = $data['DocumentType'];
				$status = $data['Status'];
				$amount = $data['Amount'];
				$poAmount = $data['PO_Amount'];
				$mul = $data['TotalAmountMultiple'];
				$complex = $data['Complex'];
				$classification ='';
				if($complex > 0){
					$classification = "Complex";
					$cmpx++;
				}
				
				
				if($trackingType == "PO"){
					$docType = "P.O / Payment";
					if($mul > 0){
						$amount = $mul;
					}else{
						$amount = $poAmount;
					}
				}else{
					if($mul > 0){
						$amount = $mul;
					}
				}
				$amount = number_format($amount,2);
				
				if($trackingType == "PR"){
					$docType = "Purchase Request";
				}
				$dateModified = $data['DateModified'];
				
				
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(230, 232, 234);border-bottom:1px solid white;">' . $i++ . '</td>';
				$sheet .= '<td>' . $office . '</td>';
				$sheet .= '<td>' . $trackingType . '</td>';
				$sheet .= '<td onclick="clickToSearchCalendar(this)" style="cursor:pointer;">' . $tn . '</td>';
				$sheet .= '<td>' . $docType . '</td>';
				$sheet .= '<td>' . $claimant . '</td>';
				$sheet .= '<td style = "text-align:right;">' . $amount . '</td>';
				$sheet .= '<td style ="text-align:center;">' . $dateModified . '</td>';
				$sheet .= '<td style ="text-align:center;">' . $classification . '</td>';
				
				$sheet .= '</tr>';
			}
			$sheet .= '<tr>';
			$sheet .= '<td style = "text-align:center;background-color:rgb(239, 241, 245);font-size:9px;padding-top:1px;border-top:1px solid rgb(228, 231, 232);" colspan = "32">-  -  -</td>';
			$sheet .= '<tr>';
			
			$sheet .= '</table>';
			
			$sheet1 = "<div style = 'margin:20px auto; margin-bottom:0px;'><div style = 'font-size:13px;font-family:Roboto;padding-left:10px;'><span style = 'font-weight:bold;color:rgb(10, 104, 159);' >List of Complex Transactions</span></div>" . $sheet . "</div>";
			
			
			return $sheet1;
		}
		
		function createForReleasedChecks($record){
			$d= 'display:none;';
			if($_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == '7'){
				$d = 'display:table-cell;';
			}
			
			$sheet = '<table id = "tableForReleaseChecks" style = "font-size:10px;width:100%;">';
			$sheet .='<tr style = "background-color:rgb(12, 71, 123);color:white;letter-spacing:1px;">
							<td style = "background-color:rgb(12, 71, 123);"></td>
							<td style = "text-align:left;background-color:rgb(43, 50, 56);">Office</td>
							<td style = "text-align:left;">TN</td>
							<td style = "text-align:left;">Claimant</td>
							<td style = "text-align:left;">Transaction Type</td>
							<td style = "text-align:right; background-color:rgb(116, 149, 154);border:1px solid black;">Amount</td>
							<td style = "background-color:rgb(195, 195, 161);border:1px solid black;border-left:0;">CheckNumber</td>
							<td style = "background-color:rgb(116, 149, 154);border:1px solid black;border-left:0;">CheckDate</td>
							<td style = "border:1px solid black;border-left:0;">Days</td>
							<td style = "width:120px;">Date&nbsp;Advised</td>
							<td  style = "background-color:rgb(43, 50, 56);text-align:right;padding-right:0px;' . $d . '">Claim</td>
							<td  style = "background-color:rgb(43, 50, 56);' . $d . '">Close</td>
							<td  style = "background-color:rgb(43, 50, 56);' . $d . '">Print</td>
							
					  </tr>';
					  
			$i = 1;		  
			while($data =  $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				
				$claimant = $data['Claimant'];
				$amount = number_format($data['NetAmount'],2);
				$checknumber = $data['CheckNumber'];
				$checkdate = $data['CheckDate'];
				$dateModified = $data['DateModified'];
				$office  = $data['Name'];
				$docType  = $data['DocumentType'];
				
				
				$ctr = $this->dayCounter($checkdate);
				if($ctr >= 45){
					$counter = "<span style = 'color:red;'>" . $ctr . "</span>";
				}else{
					$counter = $ctr;
				}
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:left;background-color: rgba(42, 72, 83,.1);color:black;border-bottom:1px solid white;">'. $i++ . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $office . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white; font-weight:bold;cursor:pointer;" onclick = "searchThisCancel(this)">'. $tn . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $claimant . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $docType . '</td>';
				
				$sheet .= '<td style = "text-align:right;border:1px solid white;border-right:0;border-top:0;border-left:1px solid rgb(224, 229, 233);">'. $amount . '</td>';
				$sheet .= '<td style = "text-align:center;border:1px solid white;border-top:0;">'. $checknumber . '</td>';
				$sheet .= '<td style = "border-right:1px solid black;border:1px solid white;border-left:0;border-top:0;">'. $checkdate . '</td>';
				$sheet .= '<td style = "background-color:rgba(176, 205, 218,.6);border:1px solid white;border-top:0;font-family:arial;font-size:12px;">'.  $counter . '</td>';
				
				$sheet .= '<td style = "border:1px solid rgb(224, 229, 233); ">'. $dateModified . '</td>';
				
				$sheet .= '<td style = "border-bottom:1px solid rgb(224, 229, 233);padding-right:2px;' . $d . '"><span id = "' . $tn . '" class = "buttonAction" onclick="ctoClaimLate(this)" style= "font-size:10px;float:right;margin-right:0px;" >&#10004;</span></td>';
				
				$sheet .= '<td style = "border-bottom:1px solid rgb(224, 229, 233);' . $d . '">';
				if($ctr >= 45){
					$sheet .= '<span class = "buttonAction"  id = "' . $tn . '"  onclick="ctoUnClaimLate(this)" style = "font-size:10px;margin-left:-2px;">&#9932;</span>';
				}
				$sheet .= '</td>';
				$sheet .= '<td style = "border-bottom:1px solid rgb(224, 229, 233);' . $d . '">';
				if($ctr >= 45){
					$sheet .= '<span class = "buttonAction"  id = "' . $tn . '" onclick="printLetter(this)">&#9993;</span>';
				}
				
				$sheet .= '</td>';
				
				
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			$sheet .= '<div style = "text-align:center;font-weight:bold;letter-spacing:1px;font-size:12px;margin-top:10px;"> -  Nothing follows - </div>';
			$sheet .= '<div style = "text-align:right;font-size:10px;margin-top:10px;font-family:arial;padding-right:10px;" ><span onclick = "printDueChecks()" style = "cursor:pointer;">&#9777; Print 45 days due checks </span></div>';
			return $sheet;
		}
		function createUnclaimedChecks($record){
			$d= 'display:none;';
			if($_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == '7'){
				$d = 'display:table-cell;';
			}
			$sheet = '<table id = "tableForReleaseChecks" style = "font-size:10px;width:100%;">';
			$sheet .='<tr style = "background-color:rgb(12, 71, 123);color:white;letter-spacing:1px;">
							<td style = "background-color:rgb(12, 71, 123);"></td>
							<td style = "text-align:left;background-color:rgb(43, 50, 56);">Office</td>
							<td style = "text-align:left;">TN</td>
							<td style = "text-align:left;">Claimant</td>
							<td style = "text-align:left;">Transaction Type</td>
							<td style = "text-align:right; background-color:rgb(116, 149, 154);border:1px solid black;">Amount</td>
							<td style = "background-color:rgb(195, 195, 161);border:1px solid black;border-left:0;">CheckNumber</td>
							<td style = "background-color:rgb(116, 149, 154);border:1px solid black;border-left:0;">CheckDate</td>
							<td style = "border:1px solid black;border-left:0;">Days</td>
							<td style = "width:120px;">Date&nbsp;Updated</td>
							<td  style = "background-color:rgb(43, 50, 56);text-align:right;padding-right:0px;padding-left:5px;padding-right:5px;' . $d . '">Undo</td>
						
					  </tr>';
					  
			$i = 1;		  
			while($data =  $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$amount = number_format($data['NetAmount'],2);
				$checknumber = $data['CheckNumber'];
				$checkdate = $data['CheckDate'];
				$dateModified = $data['DateModified'];
				$office  = $data['Name'];
				$docType  = $data['DocumentType'];
				$ctr = $this->dayCounter($checkdate);
				if($ctr >= 45){
					$counter = "<span style = 'color:red;'>" . $ctr . "</span>";
				}else{
					$counter = $ctr;
				}
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:left;background-color: rgba(42, 72, 83,.1);color:black;border-bottom:1px solid white;">'. $i++ . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $office . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white; font-weight:bold;cursor:pointer;" onclick = "searchThisCancel(this)">'. $tn . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $claimant . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $docType . '</td>';
				$sheet .= '<td style = "text-align:right;border:1px solid white;border-right:0;border-top:0;border-left:1px solid rgb(224, 229, 233);">'. $amount . '</td>';
				$sheet .= '<td style = "text-align:center;border:1px solid white;border-top:0;">'. $checknumber . '</td>';
				$sheet .= '<td style = "border-right:1px solid black;border:1px solid white;border-left:0;border-top:0;">'. $checkdate . '</td>';
				$sheet .= '<td style = "background-color:rgba(176, 205, 218,.6);border:1px solid white;border-top:0;font-family:arial;font-size:12px;">'.  $counter . '</td>';
				$sheet .= '<td style = "border:1px solid rgb(224, 229, 233); ">'. $dateModified . '</td>';
				$sheet .= '<td style = "border-bottom:1px solid rgb(224, 229, 233);' . $d . '"><span id = "' . $tn . '" class = "buttonAction" onclick="ctoBackToAdvise(this)"  > &#8617;</span></td>';
				$sheet .= '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			$sheet .= '<div style = "text-align:center;font-weight:bold;letter-spacing:1px;font-size:12px;margin-top:10px;"> -  Nothing follows - </div>';
			$sheet .= '<div style = "text-align:right;font-size:10px;margin-top:10px;font-family:arial;padding-right:10px;" ><span onclick = "printUnclaimed()" style = "cursor:pointer;">&#9777; Print unclaimed list </span></div>';
			
			
			return $sheet;
		}
		function createClaimedChecks($record){
			$d= 'display:none;';
			if($_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == '7'){
				$d = 'display:table-cell;';
			}	
			$sheet = '<table id = "tableForReleaseChecks" style = "font-size:10px;width:100%;">';
			$sheet .='<tr style = "background-color:rgb(12, 71, 123);color:white;letter-spacing:1px;">
							<td style = "background-color:rgb(12, 71, 123);"></td>
							<td style = "text-align:left;background-color:rgb(43, 50, 56);">Office</td>
							<td style = "text-align:left;">TN</td>
							<td style = "text-align:left;">Claimant</td>
							<td style = "text-align:left;">Transaction Type</td>
							<td style = "text-align:right; background-color:rgb(116, 149, 154);border:1px solid black;">Amount</td>
							<td style = "background-color:rgb(195, 195, 161);border:1px solid black;border-left:0;">CheckNumber</td>
							<td style = "background-color:rgb(116, 149, 154);border:1px solid black;border-left:0;">CheckDate</td>
							<td style = "width:120px;">Date&nbsp;Released</td>
							<td  style = "background-color:rgb(43, 50, 56);text-align:right;' . $d . '">Undo</td>
							
					  </tr>';
					  
			$i = 1;		  
			while($data =  $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$amount = number_format($data['NetAmount'],2);
				$checknumber = $data['CheckNumber'];
				$checkdate = $data['CheckDate'];
				$dateModified = $data['DateModified'];
				$office  = $data['Name'];
				$docType  = $data['DocumentType'];
				$ctr = $this->dayCounter($checkdate);
				if($ctr >= 45){
					$counter = "<span style = 'color:red;'>" . $ctr . "</span>";
				}else{
					$counter = $ctr;
				}
				$sheet .= '<tr>';
				$sheet .= '<td style = "text-align:left;background-color: rgba(42, 72, 83,.1);color:black;border-bottom:1px solid white;">'. $i++ . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $office . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white; font-weight:bold;cursor:pointer;" onclick = "searchThisCancel(this)">'. $tn . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $claimant . '</td>';
				$sheet .= '<td style = "text-align:left;border:1px solid white;">'. $docType . '</td>';
				$sheet .= '<td style = "text-align:right;border:1px solid white;border-right:0;border-top:0;border-left:1px solid rgb(224, 229, 233);">'. $amount . '</td>';
				$sheet .= '<td style = "text-align:center;border:1px solid white;border-top:0;">'. $checknumber . '</td>';
				$sheet .= '<td style = "border-right:1px solid black;border:1px solid white;border-left:0;border-top:0;">'. $checkdate . '</td>';
				$sheet .= '<td style = "border:1px solid rgb(224, 229, 233); ">'. $dateModified . '</td>';
				$sheet .= '<td style = "border-bottom:1px solid rgb(224, 229, 233);' . $d . '"><span id = "' . $tn . '" class = "buttonAction" onclick="ctoBackToAdvise(this)" > &#8617;</span></td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			$sheet .= '<div style = "text-align:center;font-weight:bold;letter-spacing:1px;font-size:12px;margin-top:10px;"> -  Last 50 released entries - </div>';
			return $sheet;
		}
		function createCancelledChecks($record){
			$count = $this->num_rows($record);
			$sheet ='';
			if($count > 0){
				$sheet = '<table id = "tableForReleaseChecks" style = "font-size:10px;width:100%;">';
				$sheet .='<tr style = "background-color:rgb(12, 71, 123);color:white;letter-spacing:1px;">
								<td style = "background-color:rgb(12, 71, 123);"></td>
								<td style = "text-align:left;background-color:rgb(43, 50, 56);padding:2px 5px;">Office</td>
								<td style = "text-align:left;padding:2px 5px;">TN</td>
								<td style = "text-align:left;padding:2px 5px;">Claimant</td>
								<td style = "text-align:left;padding:2px 5px;">Transaction Type</td>
								<td style = "text-align:right; background-color:rgb(116, 149, 154);border:1px solid black;padding:2px 5px;">Amount</td>
								<td style = "background-color:rgb(195, 195, 161);border:1px solid black;border-left:0;padding:2px 5px;">CheckNumber</td>
								<td style = "background-color:rgb(116, 149, 154);border:1px solid black;border-left:0;padding:2px 5px;">CheckDate</td>
								<td style = "width:120px;">Date&nbsp;Modified</td>
								<td style = "text-align:left;padding:2px 5px;">Remarks</td>		
						  </tr>';
						  
				$i = 1;		  
				while($data =  $this->fetch_array($record)){
					$tn = $data['TrackingNumber'];
				
					$checknumber = $data['CheckNumber'];
					$checkdate = $data['CheckDate'];
					$dateModified = $data['DateModified'];
					$modifiedBy  = $data['ModifiedBy'];
					$remarks  = $data['Remarks'];
					$reiisue  = $data['Reissue'];
					
					$office  = $data['Office'];
					$claimant  = $data['Claimant'];
					
					$docType  = $data['DocumentType'];
					$net  = $data['NetAmount'];
						
					
					$sheet .= '<tr>';
					$sheet .= '<td style = "text-align:left;background-color: rgba(42, 72, 83,.1);color:black;border-bottom:1px solid white;padding:2px 5px;">'. $i++ . '</td>';
					$sheet .= '<td style = "text-align:left;border:1px solid white;padding:2px 5px;">'. $office . '</td>';
					$sheet .= '<td style = "text-align:left;border:1px solid white; font-weight:bold;padding:2px 5px;cursor:pointer; " onclick ="searchThisCancel(this)">'. $tn . '</td>';
					$sheet .= '<td style = "text-align:left;border:1px solid white;padding:2px 5px;">'. $claimant . '</td>';
					$sheet .= '<td style = "text-align:left;border:1px solid white;padding:2px 5px;">'. $docType . '</td>';
					$sheet .= '<td style = "text-align:right;border:1px solid white;border-right:0;border-top:0;border-left:1px solid rgb(224, 229, 233);padding-right:5px;">' . $net . '</td>';
					$sheet .= '<td style = "text-align:center;border:1px solid white;border-top:0;">'. $checknumber . '</td>';
					$sheet .= '<td style = "border-right:1px solid black;border:1px solid white;border-left:0;border-top:0;">'. $checkdate . '</td>';
					$sheet .= '<td style = "border:1px solid rgb(224, 229, 233); ">'. $dateModified . '</td>';
					$sheet .= '<td style = "border:1px solid rgb(224, 229, 233); text-align:left;padding:2px 5px;">'. $remarks . '</td>';
					$sheet .= '</tr>';
				}
				$sheet .= '</table>';
				$sheet .= '<div style = "text-align:center;font-weight:bold;letter-spacing:1px;font-size:12px;margin-top:10px;"> -  Last 50 cancelled checks - </div>';
				$sheet .= '<div style = "text-align:right;font-size:10px;margin-top:10px;font-family:arial;padding-right:10px;" ><span onclick = "printCancelledChecks()" style = "cursor:pointer;">&#9777; Print list </span></div>';
			}else{
				$sheet .= '<tr><td style = "padding:20px 50px;font-size:22px;font-family:oswald;" colspan = "100%" ><div style = "text-align:center;margin-top:40px;color:red;font-weight:bold;">No record found.</div></td></tr>';
			}
			
			return $sheet;
		}
		
		function createAllChecksFilters($record){
			$sheet = '<table id = "" style = "font-size:10px;width:100%;border:1px solid silver;">';
			$sheet .='<tr style = "">
						<th colspan ="100%" style ="background-color:white;padding:5px;">
							<table id= "tableChkFilter" style ="background-color:white;font-size:11px;border-spacing:0px;" border = "0">
								<tr>
									<td style ="background-color:white;text-align:right;">YEAR</td>
									<td >
										<select id ="chkYear" style = "width:70px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">';
											$year = date('Y');
											for($i = 0 ; $i < 7; $i++){
												$sheet .= '<option>' . ($year - $i) .'</option>';	
											}
												
							$sheet .='	</select>
									</td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="background-color:white;">FUND</td>
									<td >
										<select id ="chkFund" style = "width:70px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">
											<option>All</option>
											<option>GF</option>
											<option>SF</option>
											<option>TF</option>
										</select>
									</td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="background-color:white;">COLUMN NAME</td>
									<td>
										<select id ="chkColumn" style = "width:100px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">
											<option>CheckNumber</option>
											<option>CheckDate</option>
											<option>DateModified</option>
										</select>
									</td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="background-color:white;">DISPLAY LIMIT</td>
									<td>
										<select id ="chkLimit" style = "width:60px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">
											<option>50</option>
											<option>100</option>
											<option>200</option>
											<option>500</option>
											<option>All</option>
										</select>
									</td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="background-color:white;">SHOW RESPO</td>
									<td>
										<select id ="chkGroup" style = "width:60px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">
											<option>No</option>
											<option>Yes</option>
										</select>
									</td>
								</tr>
								<tr>
									<td style ="background-color:white;">MONTH</td>
									<td >
										<select id ="chkMonth" style = "width:70px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">
											<option>Jan</option>
											<option>Feb</option>
											<option>Mar</option>
											<option>Apr</option>
											<option>May</option>
											<option>Jun</option>
											<option>Jul</option>
											<option>Aug</option>
											<option>Sep</option>
											<option>Oct</option>
											<option>Nov</option>
											<option>Dec</option>
											<option>All</option>
										</select>
									</td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="background-color:white;text-align:right;">ORDER</td>
									<td>
										<select id ="chkOrder" style = "width:100px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">
											<option>Asc</option>
											<option>Desc</option>
										</select>
									</td>
									<td style ="padding:0px 10px;background-color:white;"></td>
									<td style ="background-color:white;text-align:right;">DATABASE</td>
									<td>
										<select id ="chkDbase" style = "width:60px;font-size:11px;border:0;border-bottom:1px solid silver;text-align:center;" onchange = "fetchAllChecks()">';
										$year = date('Y');
										for($i = 0 ; $i < 7; $i++){
											$sheet .= '<option>' . ($year - $i) .'</option>';	
										}
											
							$sheet .= '</select>
									</td>
								</tr>
							</table>
						</th>
					 </tr>
					 <tr><td colspan ="100%" style= "text-align:right;" id  = "chkTitle"></td></tr>
				</table>';
			echo $sheet;
		}
		function createAllChecks($record,$respo){
			$count = $this->num_rows($record);
			$sheet ='';
			if($count > 0){
				
				$sheet .= '<div id ="chkFilterContainer">
							<table id = "tableAllChecks" style = "font-size:10px;width:100%;">';
				$sheet .='  <tr style = "background-color:rgb(12, 71, 123);color:white;letter-spacing:1px;">
								<th style = "background-color:rgb(12, 71, 123);"></th>
								<th style = "text-align:left;background-color:rgb(43, 50, 56);padding:2px 5px;">Office</th>
								<th style = "text-align:left;padding:2px 5px;">TN</th>
								<th style = "text-align:left;padding:2px 5px;">Adv</th>
								<th style = "text-align:left;padding:2px 5px;">OBR</th>';
					if($respo == "Yes"){
						 $sheet .='<th style = "text-align:left;padding:2px 5px;">Respo</th>
								<th style = "text-align:left;padding:2px 5px;">Exp</th>';
					}				
				$sheet .='  	<th style = "text-align:left;padding:2px 5px;">Claimant</th>
								<th style = "text-align:left;padding:2px 5px;">Transaction Type</th>
								<th style = "text-align:left;padding:2px 5px;text-align:center;">Bank A/C</th>
								<th style = "text-align:right; background-color:rgb(116, 149, 154);border:1px solid black;padding:2px 5px;">Amount</th>
								<th style = "background-color:rgb(195, 195, 161);border:1px solid black;border-left:0;padding:2px 5px;">CheckNumber</th>
								<th style = "background-color:rgb(116, 149, 154);border:1px solid black;border-left:0;padding:2px 5px;">CheckDate</th>
								<th style = "width:120px;">Status</th>
								<th style = "width:120px;">Date&nbsp;Modified</th>
								
						  </tr>';
						  
				$i = 1;
				$temp = '';		  
				$bg1 = 'white';
				$bg2 = 'rgb(229, 231, 230)';
				$lastColor = $bg1;
				
				while($data =  $this->fetch_array($record)){
					$tn = $data['TrackingNumber'];
				
					$checknumber = $data['checknumber'];
					$checkdate = $data['checkdate'];
					$dateModified = $data['DateModified'];
					
					$adv  = $data['ADV1'];
					$obr  = $data['OBR_Number'];
					$office  = $data['Office'];
					$claimant  = $data['Claimant'];
					
					$docType  = $data['DocumentType'];
					$net  = $data['NetAmount'];
					
					$program =  $data['PR_ProgramCode'];
					$exp =  $data['PR_AccountCode'];
					
					$status =  $data['Status'];
					$accountNo =  $data['AccountNo'];
					if($temp == $tn){
						$sheet .= '<tr style = "background-color:' . $lastColor . '">';
						
					}else{
						if($lastColor == $bg1){
							$lastColor = $bg2;
						}else{
							$lastColor = $bg1;
						}
						$sheet .= '<tr style = "background-color:' . $lastColor . '">';
					}
					if($status != "Check Released"){
						$color = "Red";
					}else{
						$color = "Black";
					}
					
					$temp = $tn;
					$sheet .= '<td style = "text-align:left;background-color: rgba(42, 72, 83,.1);color:black;border-bottom:1px solid white;padding:2px 5px;">'. $i++ . '</td>';
					$sheet .= '<td style = "text-align:left;padding:2px 5px;">'. $office . '</td>';
					$sheet .= '<td style = "text-align:left;font-weight:bold;padding:2px 5px;cursor:pointer; " onclick ="searchThisCancel(this)">'. $tn . '</td>';
					$sheet .= '<td style = "text-align:left;font-weight:bold;padding:2px 5px;cursor:pointer; ">'. $adv . '</td>';
					$sheet .= '<td style = "text-align:left;font-weight:bold;padding:2px 5px;cursor:pointer; ">'. $obr . '</td>';
					if($respo == "Yes"){
						$sheet .= '<td style = "text-align:left;font-weight:bold;padding:2px 5px;cursor:pointer; ">'. $program . '</td>';
						$sheet .= '<td style = "text-align:left;font-weight:bold;padding:2px 5px;cursor:pointer; ">'. $exp . '</td>';
					}
					$sheet .= '<td style = "text-align:left;;padding:2px 5px;">'. $claimant . '</td>';
					$sheet .= '<td style = "text-align:left;padding:2px 5px;">'. $docType . '</td>';
					$sheet .= '<td style = "text-align:left;padding:2px 5px;">'. $accountNo . '</td>';
					
					$sheet .= '<td style = "text-align:right;border-right:0;border-top:0;border-left:1px solid rgb(224, 229, 233);padding-right:5px;">' . $net . '</td>';
					$sheet .= '<td style = "text-align:center;border-top:0;">'. $checknumber . '</td>';
					$sheet .= '<td style = "border-right:1px solid silver;border-left:0;border-top:0;">'. $checkdate . '</td>';
					$sheet .= '<td style = "text-align:center;color:' . $color . '">'. $status . '</td>';
					$sheet .= '<td style = "text-align:center;">'. $dateModified . '</td>';
					$sheet .= '</tr>';
				}
				$sheet .= '<tr>
								<td colspan ="100%">
									<div style = "text-align:center;font-weight:bold;letter-spacing:1px;font-size:12px;margin-top:10px;"> -  -  - </div>
								</td>
						   </tr>';
				
				$sheet .= '</table>
					
					<div style = "text-align:right;font-size:10px;margin-top:10px;font-family:arial;padding-right:10px;" ><span onclick = "printView()" style = "cursor:pointer;"> Print list &#9777;</span></div>
					<div style = "text-align:right;font-size:10px;margin-top:10px;font-family:arial;padding-right:10px;" ><span onclick = "toChkExcel()" style = "cursor:pointer;"> Save to Excel &#9777;</span></div>
				</div>';
			}else{
				$sheet .= '<tr><td style = "padding:20px 50px;font-size:22px;font-family:oswald;" colspan = "100%" ><div style = "text-align:center;margin-top:40px;color:red;font-weight:bold;">No record found.</div></td></tr>';
			}
			
			return $sheet;
		}
		
		function CreateOBRAmountEditWGS($record, $record1, $trackingNumber, $year, $office, $docTypeN){
		
			$empRows = $this->num_rows($record1); 

			$sheet0 = '';
			$sheet1 = '';
			$totalGross = 0;
			$totalNet = 0;
			$totalGSIS = 0;
			$totalGSISV = 0;
			$totalPera = 0;
			$totalPagibig = 0;
			$totalPhilHealth = 0;
			$totalPhilHealthV = 0;
			$totalState = 0;
			
			$total1 = 0;
			$total2 = 0;
			$total3 = 0;
			$total4 = 0;
			$x = 1;

			$sheet0 .= "<table border='0' id='tableDoctrackDBFList' style='margin:0px auto; padding:5px 3px 5px 5px;'>
						<thead>
							<tr style='background-color:rgb(12, 71, 123); color:white;'>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); padding:3px 5px 3px 10px; text-align:left;'></th>
								<th style='background-color:rgb(43, 50, 56); border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 8px; text-align:left;'>Employee</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>GSIS</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>PhilHealth</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Pagibig</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Pera</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>ECIP</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>W1</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>W2</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>W3</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>W4</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Salary</th>
								<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Net</th>
								<th style='background-color:white;'></th>
							</tr>
						</thead>";

			$unregistered = 0;
			while ($data = $this->fetch_array($record1)) {
				$empnum = $data['EmployeeNumber'];
				$gross = floatval($data['Salary']);
				$gsisv = floatval($data['GSIS']);
				$philhealthv = floatval($data['PhilHealth']);
				$pera  = floatval($data['Pera']);
				$pagibig  = floatval($data['PagIbig']);
				$state = floatval($data['ECIP']);
				$net = floatval($data['NetAmount']);
				$w1 = floatval($data['W1']);
				$w2 = floatval($data['W2']);
				$w3 = floatval($data['W3']);
				$w4 = floatval($data['W4']);

				$added = $data['Added'];
				$removeBtn = "";
				if($added == 1){
					$removeBtn = "<div><span style='color:red; font-size:12px; font-weight:bold; cursor:pointer; padding-left:8px; position:absolute; margin-top:-8px;' onclick='wgsRemoveAndUpdateFromTable(\"".$trackingNumber."\",\"".$empnum."\", 2, ".$docTypeN.")'>&#x2716;</span></div>";
				}
			
				$fullname = $data['LastName'].", ".$data['FirstName'];

				if($totalGross == 0){
					if($empRows > 1){
						$claimant = $fullname." ET AL ";
					}else{
						$claimant = $fullname;
					}
				}

				$sheet0 .= "<tr>";
				$sheet0 .= "<td style='padding:0px 5px; text-align:left; font-style:italic; font-weight:bold; font-size:9px; border-left:1px solid rgb(211,212,212);'>".($x++)."</td>";
				$sheet0 .= "<td style='padding:5px 5px 5px 5px; text-align:left;'><span style='display:none;'>".$empnum."</span><span>".utf8_encode($fullname)."</span></td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($gsisv, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($philhealthv, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($pagibig, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($pera, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($state, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($w1, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($w2, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($w3, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($w4, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($gross, 2)."</td>
							<td style='padding:5px 5px 5px 10px; letter-spacing:1px; border-right:1px solid rgb(211,212,212);'>".number_format($net, 2)."</td>
							<td style='background-color:white; padding:0px;'> <input value='".$added."' style='display:none;' disabled />".$removeBtn."</td>
							";
				$sheet0 .= "</tr>";

				$totalGross += $gross;
				$totalGSISV += $gsisv;
				$totalPhilHealthV += $philhealthv;

				$totalPera  += $pera;
				$totalPagibig  += $pagibig;
				$totalState += $state;


				$totalNet += $net;

				$total1 += $w1;
				$total2 += $w2;
				$total3 += $w3;
				$total4 += $w4;
				
			}

			$totalAmountMultipleNew = $totalGross + $totalPera + $totalGSISV + $totalPagibig + $totalPhilHealthV + $totalState;

			//Add `person` for consolidated payroll - START
			$sheet0 .= "<tr>
							<td colspan='13' style='padding:0px 10px; text-align:right; font-weight:bold; font-size:13px; background-color:white; border-top:1px solid rgb(211,212,212);'>
								<span style='color:rgb(64, 161, 202); cursor:pointer;' onclick='wgsAddPerson(\"".$trackingNumber."\", 2, \"".$docTypeN."\")'>+ Insert Employee</span>
							</td>
						</tr>";
			//Add `person` for consolidated payroll - END
			
			$sheet0 .= "</table>";
			
		
			// $totalAmountMultiple = $totalGross + $totalPera + $totalGSISV + $totalPagibig + $totalPhilHealthV + $totalState;

			$progList = $this->LoadProgramFundsByOffice($year,$_SESSION['officeCode']);
			$dpd = "<select class='wgsDPDPlain' name='wgsPrgCode'>";
			$dpd .= '<option value = ""></option>';
			while($data = $this->fetch_array($progList)){
				$dpd .= '<option value = "'  . $data['Code'] . '">';
				$dpd .= $data['Code'] . " " . $data['Name'];
				$dpd .= '</option>';
			}
			$dpd .= "</select>";
			

			if($_SESSION['perm'] == 31){
				$sql = "SELECT a.OfficeCode,a.ProgramCode,a0.AccountCode,b.Name FROM funds a left join programcode b on a.ProgramCode = b.Code 
						group by a.ProgramCode ";
			}else{
				$sql = "SELECT a.OfficeCode,a.ProgramCode,a.AccountCode,b.Name FROM funds a left join programcode b on a.ProgramCode = b.Code 
						where a.OfficeCode = '" . $office . "' or a.OfficeCode = 'LUMP' group by a.ProgramCode ";
			}
			$forProg = $this->FetchThis($sql);
			
			$sql = "SELECT a.AccountCode,b.Title FROM funds a left join fundtitles b on a.AccountCode = b.Code where a.OfficeCode = '" . $office . "' or   a.OfficeCode = 'LUMP'  group by a.AccountCode order by b.Title ";
			$forAcct = $this->FetchThis($sql);

			$fundSelect = "<select class='data2' style='width:300px;' name='wgsPrgCode' onchange='onChangeWGSCodesPYEdit(this)'>";
			while($prog = $this->fetch_array($forProg)){
				$fundSelect .= '<option value = "' . $prog['ProgramCode'] . '">' . $prog['ProgramCode'] . '  ' . $prog['Name'] . '</option>';
			}
			$fundSelect .= "</select>";

			$accountSelect = "<select class='data2' style='width:300px;' name='wgsAccCode'>";
			while($acct = $this->fetch_array($forAcct)){
				$accountSelect .= '<option value = "' . $acct['AccountCode'] . '">' . $acct['AccountCode'] . '  ' . $acct['Title'] . '</option>';
			}
			$accountSelect .= "</select>";

			$totalAmountMultiple = 0;
			$obrDetails = "" ;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$period = $data['PeriodMonth'];
				$claimant = $data['Claimant'];
				$tnPartner = $data['TrackingPartner'];
				$docType = $data['DocumentType'];

				$fund = $data['PR_ProgramCode'];
				$name = $data['Name'];
				$code = $data['PR_AccountCode'];
				$title = $data['Title'];
				$amount = floatval($data['Amount']);
				$subCode = $data['SubCode'];

				$totalAmountMultiple += $amount;

				$fundSelect = str_replace("selected", "", $fundSelect);
				$accountSelect = str_replace("selected", "", $accountSelect);

				$fundSelect = str_replace(">".$fund, "selected>".$fund, $fundSelect);
				$accountSelect = str_replace(">".$code, "selected>".$code, $accountSelect);

				$obrDetails .= "<tr>
								<td style='padding:5px 8px;'>
									".$fundSelect."
								</td>
								<td style='padding:5px 8px;'>
									".$accountSelect."
								</td>
								<td style='padding:5px 8px;'>
								<input type='text' class='wgsValuePlain' name='wgsValues' style='padding-right:5px;' onkeydown='return isAmount(this,event);' onkeyup='wgsUpdateEditTotal();' value='".number_format($amount,2)."'></td>
								</tr>";
			}

			if($totalAmountMultipleNew != $totalAmountMultiple){
				$totalAmountMultiple = $totalAmountMultipleNew;
			}

			$obrDetails .= "<tr>
							<td></td>
							<td style='text-align:right; color:red; font-weight:bold; padding:10px 8px 5px 8px; font-size:18px;'>
								Total
							</td>
							<td style='padding:10px 8px 5px 8px;'>
								<input type='text' class='wgsValuePlain' id='wgsTotalAmountMultiple' style='padding-right:5px;' disabled value='".number_format($totalAmountMultiple,2)."'></td>
							</tr>";


			$sheet1  = "<table border='0' style='margin:0px auto; border-spacing:0px; margin-top:18px;'>
						<tr>
						<td style='text-align:right; padding-bottom:8px;'>
							<table border='0' style='width:100%; border-spacing:0px; font-family:Oswald;'>
								<tr>
									<td style='font-size:16px;'>
										<label for='claimantWGS' style='margin-right:5px; color:gray;'>Claimant</label>	
										<input id='claimantWGS' type='text' style='border:0px; color:black; background-color:white; font-family:Oswald; font-size:16px; width:350px; font-weight:bold; border-bottom:1px dashed black; padding:0px 5px;' value='".$claimant."' disabled/>
									</td>
									<td style='text-align:right; vertical-align:bottom; padding-right:8px;'>
										<span style='color:gray; margin-right:5px;'>Source of Fund</span>
										<input type='radio' name='selectWgsMode' style='cursor:pointer;' id='wgsManl'  class='' onclick = 'wgsMode(this)'/>
										<label  for='wgsManl' style='cursor:pointer;'>Manual</label>
										<input type='radio' name='selectWgsMode' style='cursor:pointer;' id='wgsAuto'  class='' onclick = 'wgsMode(this)' checked/>
										<label  for='wgsAuto' style='cursor:pointer;'>Auto</label>
									</td>
								</tr>
							</table>
						</td></tr>
						<tr><td>
							<table border='0' id='wgsChargesTblM' style='border-spacing:0px; margin:0px auto; border:1px solid rgb(215, 216, 217); display:none;'>
								<thead>
									<tr style='font-family:Oswald;'>
										<th style='padding:5px 8px; text-align:left;'>Program <span id='wgsFundSourceM'></span></th>
										<th style='padding:5px 8px; text-align:left;'><span style='display:block; text-align:left;'>Code</span> <span id='wgsAcctSourceM'><select class = 'data2' style = 'width:300px; display:block'></select></span></th>
										<th colspan='2' style='padding:5px 8px; text-align:left;'>
											<span style='display:block; text-align:left;'>Amount&nbsp;&nbsp;<span style='color:red;' id='wgsTotalAmountMultiple'>".number_format($totalAmountMultiple,2)."</span></span> 
											<input type='text' class='data2' id='wgsValueM' style='width:160px; margin-right:10px; padding: 4px 6px; text-align:center;' onkeydown='return isAmount(this,event)'>
											<span class='button2' onclick='wgsAddMultipleSource(this)'>Add</span>
										</th>
									</tr>
									<tr><th colspan='4' style='padding:3px 0px;'></th></tr>
									<tr style='background-color:rgb(121, 137, 141); color:white; font-size:18px; font-family:Oswald;'>
										<th style='padding:5px 8px; text-align:left;'>Program</th>
										<th style='padding:5px 8px; text-align:left;'>Code</th>
										<th style='padding:5px 8px; text-align:center;'>Amount</th>
										<th style='padding:5px 8px; text-align:center;'></th>
									</tr>
								</thead>
								<tbody>
								</tbody>
							</table>
							</td></tr>
						<tr><td>
						<table border='0' id='wgsChargesTbl' style='border-spacing:0px; margin:0px auto; border:1px solid rgb(215, 216, 217);'>
							<thead>
								<tr style='background-color:rgb(121, 137, 141); color:white; font-size:18px; font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program</th>
									<th style='padding:5px 8px; text-align:left;'>Code</th>
									<th style='padding:5px 8px; text-align:center;'>Amount</th>
								</tr>
							</thead>
							<tbody>
								".$obrDetails."
							</tbody>
						</table>
						<input style='display:none' id='wgsEditSubPrgCode' value='".$subCode."'>
						<input style='display:none' id='wgsEditDocType' value='".$docType."'>
						</td>
						</tr>
						</table>";
			

			$sheet = "";
			$sheet .= "<table id = 'tableDoctrackWGS' border='0'  style='width:100%;border-spacing:0px;'>";
			$sheet .= "	<tr>
							<td>
								<span class ='numberField'>Enter&nbsp;Sequence</span>
							</td>
							<td style='padding-bottom:2px; padding-left:0px;'>
								<input style = 'text-align: left;padding-left:10px;font-weight: bold;text-transform:uppercase; width:512px;'  id  = 'sequenceWGSEdit' onclick='clickInput(this)' type ='text' class = 'data2 checkPY' />
							</td>
						</tr>
						<tr>
							<td>
								<span class ='numberField'>New&nbsp;Upload</span>
							</td>
							<td style='padding-bottom:0px; padding-left:0px;'>
								<div class='data2' style='display:inline-block; padding:3px 0px 3px 10px; text-align:left;'>
									<label for='uploadWGS1' id='uploadWGSlabel1' style='cursor:pointer; color:gray; display:block; width:400px;'>Select file</label>
									<input type='file' id='uploadWGS1' style='display:none;' onchange='updateUploadWGSlabel1(\"".$tn."\",\"".$period."\",\"".$docType."\",\"".$docTypeN."\")'>
								</div>
							</td>
						</tr>
						<tr>
							<td id='dbfTable1' style='padding-top:20px;' colspan='3'>".$sheet0.$sheet1."</td>
						</tr>
						<tr>
							<td style = 'padding:10px 0px;' colspan='3'>
								<div style = 'margin-top:20px; width:70px;' class = 'button1' onclick = 'updateWagesTracking(\"".$tn."\")'>Update</div><br/>
							</td>
						</tr>
						";
			$sheet .= "</table>";


			return   $sheet.'*v*' ;
		}

		function CreateOBRAmountRefresh($record, $empRows, $type, $ptrs, $docType, $defaultYear, $trackingNumber, $trigType){
			$totalGross = 0;
			$totalNet = 0;
			$totalGSIS = 0;
			$totalPera = 0;
			$totalPagIbig = 0;
			$totalPhilHealth = 0;
			$totalState = 0;

			$claimant = "";
			$row = 0;
			$sheet0 = "	<table border='0' id='tableDoctrackDBFList' style='margin:0px auto;'>
							<thead>
								<tr style='background-color:rgb(12, 71, 123); color:white;'>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); padding:3px 5px 3px 10px; text-align:left;'></th>
									<th style='background-color:rgb(43, 50, 56); border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 8px; text-align:left;'>Employee</th>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>GSIS</th>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>PhilHealth</th>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Pagibig</th>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Pera</th>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>ECIP</th>
									<th style='border-bottom:1px solid rgba(0,0,0,.2); letter-spacing:1px; padding:3px 5px 3px 10px; text-align:right;'>Salary</th>
								</tr>
							</thead>
							<tbody>
						";

			while($data = $this->fetch_array($record)){
				if($type == "RP" || $type == "VP"){
					$rate = $data['rate']; // for plantilla
					$compen = $data['compen']; // for other payroll 
					$lwop = $data['lwop']; // absences

					$gsis = $data['gvgsis'];
					$pera = $data['pera'];
					$pagibig = $data['gvpagibig'];
					$philhealth = $data['gvphilhealth'];
					$state = $data['state'];
				}else{
					$amt1 = $data['amt1'];
					$tax1 = $data['tax1'];
					$amt2 = $data['amt2'];
					$tax2 = $data['tax2'];

					$rate = floatval($amt1) + floatval($amt2); // for special payroll
					$compen = 0.00;
					$lwop = 0.00;

					$gsis = 0.00;
					$pera = 0.00;
					$pagibig = 0.00;
					$philhealth = 0.00;
					$state = 0.00;
				}
				
				$lname = trim($data['lastname']);
				$fname = trim($data['firstname']);
				$mname = trim($data['middlename']);
				$exten = trim($data['extension']);

				$fullname = $lname.", ".$fname." ".$mname[0]." ".$exten;

				if($totalGross == 0){
					if($empRows > 1){
						$claimant = $fullname." ET AL";
					}else{
						$claimant = $fullname;
					}
				}

				if($type == "RP" || $type == "VP"){
					if($docType == "WAGES - SALARY PLANTILLA"){
						$salary = $rate;
					}else{
						$salary = floatval($compen) - floatval($lwop); 
					}
				}else{
					$salary = $rate;
				}
				

				$totalGSIS += $gsis;
				$totalPera += $pera;
				$totalPagIbig += $pagibig;
				$totalPhilHealth += $philhealth;
				$totalState += $state;
				$totalGross += $salary;

				$sheet0 .= "	<tr>
								<td style='padding:0px 5px; text-align:left; font-style:italic; font-weight:bold; font-size:9px; border-left:1px solid rgb(211,212,212);'>
									".++$row."
								</td>
								<td style='padding:5px 10px 5px 10px; text-align:left;'>".$fullname."</td>
								<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($gsis, 2)."</td>
								<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($philhealth, 2)."</td>
								<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($pagibig, 2)."</td>
								<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($pera, 2)."</td>
								<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($state, 2)."</td>
								<td style='padding:5px 5px 5px 10px; letter-spacing:1px;'>".number_format($salary, 2)."</td>
							</tr>";

			}

			$sheet0 .= "	</tbody>
						</table>";

			$totalAmountMultiple = $totalGross + $totalPera + $totalGSIS + $totalPagIbig + $totalPhilHealth + $totalState;

			$record = $this->LoadProgramFundsByOffice($defaultYear,$_SESSION['cbo']);
			$dpd = "<select class='wgsDPDPlain' name='wgsPrgCode' onchange='showHideWGSSubPrgCode(this);'>";
			$dpd .= '<option value = ""></option>';
			while($data = $this->fetch_array($record)){
				$dpd .= '<option value = "'  . $data['Code'] . '">';
				$dpd .= $data['Code'] . " " . $data['Name'];
				$dpd .= '</option>';
			}
			$dpd .= "</select>";
			$dpd .= "<div id='wgsSubPrgCodeCnt' style='padding-top:15px; display:none;'>
					 <div style='padding-left:5px; font-weight:bold; color:rgb(64, 161, 202);'>Sub-Program Code</div>
					 <select class='wgsDPDPlain' id='wgsSubPrgCode'>";
			$dpd .=	"	<option value='0' selected></option>
						<option value='1'>Crime Prevention and Law Enforcement</option>
						<option value='2'>Counter Terrorism</option>
						<option value='3'>Counter Insurgency</option>
						<option value='4'>Public Safety</option>
						<option value='5'>Emergency Crisis Management</option>
						<option value='6'>Illegal Drugs / Illegal Gambling and Other Illegal Activities</option>
						<option value='7'>Compound </option>";
			$dpd .= "</select>
					 </div>";
			

			$prgCodeDp = "<td rowspan='7' style='vertical-align:top; padding:0px 5px; padding-top:5px;'>".$dpd."</td>";
			$sheet1  = "<table border='0' style='margin:0px auto; border-spacing:0px; margin-top:18px;'>
						<tr>
						<td style='text-align:right; padding-bottom:8px;'>
							<table border='0' style='width:100%; border-spacing:0px; font-family:Oswald;'>
								<tr>
									<td style='font-size:16px;'>
										<label for='claimantWGS' style='margin-right:5px; color:gray;'>Claimant</label>	
										<input  id='claimantWGS' type='text' style='border:0px; color:black; background-color:white; font-family:Oswald; font-size:16px; width:350px; font-weight:bold; border-bottom:1px dashed black; padding:0px 5px;' value='".$claimant."' disabled/>
									</td>
									<td style='text-align:right; vertical-align:bottom; padding-right:8px;'>
										<span style='color:gray; margin-right:5px;'>Source of Fund</span>
										<input type='radio' name='selectWgsMode' style='cursor:pointer;' id='wgsManl'  class='' onclick = 'wgsMode(this)'/>
										<label  for='wgsManl' style='cursor:pointer;'>Manual</label>
										<input type='radio' name='selectWgsMode' style='cursor:pointer;' id='wgsAuto'  class='' onclick = 'wgsMode(this)' checked/>
										<label  for='wgsAuto' style='cursor:pointer;'>Auto</label>
									</td>
								</tr>
							</table>
						</td>
						</tr>
						<tr><td>
						<table border='0' id='wgsChargesTblM' style='border-spacing:0px; margin:0px auto; border:1px solid rgb(215, 216, 217); display:none;'>
							<thead>
								<tr style='font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program <span id='wgsFundSourceM'></span></th>
									<th style='padding:5px 8px; text-align:left;'><span style='display:block; text-align:left;'>Code</span> <span id='wgsAcctSourceM'><select class = 'data2' style = 'width:300px; display:block'></select></span></th>
									<th colspan='2' style='padding:5px 8px; text-align:left;'>";

			$blk = "<span style='display:block; text-align:left;'>Amount&nbsp;&nbsp;<span style='color:red;' id='wgsTotalAmountMultiple'>".number_format($totalAmountMultiple,2)."</span></span> ";
			if($docType == "WAGES - SALARY J.O (1st half)"){
				$blk = "<span style='display:block; text-align:left;'>Amount&nbsp;&nbsp;
				<input style='color:red; border:0px; font-weight:bold; font-family:Oswald; font-size:16px;' id='wgsTotalAmountMultiple' value='".number_format($totalAmountMultiple,2)."' /></span>";			
			}

			$sheet1 .=				$blk."<input type='text' class='data2' id='wgsValueM' style='width:160px; margin-right:10px; padding: 4px 6px; text-align:center;' onkeydown='return isAmount(this,event)'>
										<span class='button2' onclick='wgsAddMultipleSource(this)'>Add</span>
									</th>
								</tr>
								<tr><th colspan='4' style='padding:3px 0px;'></th></tr>
								<tr style='background-color:rgb(121, 137, 141); color:white; font-size:18px; font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program</th>
									<th style='padding:5px 8px; text-align:left;'>Code</th>
									<th style='padding:5px 8px; text-align:center;'>Amount</th>
									<th style='padding:5px 8px; text-align:center;'></th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
						</td></tr>
						<tr><td>
						<table border='0' id='wgsChargesTbl' style='border-spacing:0px; margin:0px auto; border:1px solid rgb(215, 216, 217);'>
							<thead>
								<tr style='background-color:rgb(121, 137, 141); color:white; font-size:18px; font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program</th>
									<th style='padding:5px 8px; text-align:left;'>Code</th>
									<th style='padding:5px 8px; text-align:center;'>Amount</th>
								</tr>
							</thead>
							<tbody>
						";

			if($totalGSIS > 0){
				$sheet1 .= "<tr>
							".$prgCodeDp."
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50103010'>
								Retirement and Life Insurance Premiums
							</td>
							<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalGSIS' disabled value='".number_format($totalGSIS,2)."'></td>
							</tr>";
				$prgCodeDp = "";			
			}
			if($totalPhilHealth > 0){
				$sheet1 .= "<tr>
							".$prgCodeDp."
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50103030'>
								PhilHealth Contributions
							</td>
							<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalPhilHealth' disabled value='".number_format($totalPhilHealth,2)."'></td>
							</tr>";
				$prgCodeDp = "";			
			}
			if($totalPagIbig > 0){
				$sheet1 .= "<tr>
							".$prgCodeDp."
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50103020'>
								Pag-IBIG Contributions
							</td>
							<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalPagibig' disabled value='".number_format($totalPagIbig,2)."'></td>
							</tr>";
				$prgCodeDp = "";			
			}
			if($totalPera > 0){
				$sheet1 .= "<tr>
							".$prgCodeDp."
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50102010'>
								Personal Economic Relief Allowance (PERA)
							</td>
							<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalPera' disabled value='".number_format($totalPera,2)."'></td>
							</tr>";
				$prgCodeDp = "";			
			}
			if($totalState > 0){
				$sheet1 .= "<tr>
							".$prgCodeDp."
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50103040'>
								Employees Compensation Insurance Premiums
							</td>
							<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalState' disabled value='".number_format($totalState,2)."'></td>
							</tr>";
				$prgCodeDp = "";			
			}
			if($totalGross > 0){
				$search = "J.O";
				if(preg_match("/{$search}/i", $docType) == 1){
					$sheet1 .= "<tr>
								".$prgCodeDp."
								<td style='padding:5px 8px;'>
									<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50212990'>
									Other General Services
								</td>
								<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalGross' disabled value='".number_format($totalGross,2)."'></td>
								</tr>";
					$prgCodeDp = "";
				}else{
					$sheet1 .= "<tr>
								".$prgCodeDp."
								<td style='padding:5px 8px;'>
									<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='50101010'>
									Salaries and Wages - Regular
								</td>
								<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='wgsTotalGross' disabled value='".number_format($totalGross,2)."'></td>
								</tr>";
					$prgCodeDp = "";
				}
					

				$sheet1 .= "<tr style='display:none;'>
							<td style='padding:5px 8px; color:red; font-weight:bold;'>
								<input type='text' style='display:none;' name='wgsAccCode' disabled value='netamount'>
								Net Amount
							</td>
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsValuePlain' id='wgsTotalNet' name='wgsValues' disabled value='".number_format($totalNet,2)."'>
							</td>
							</tr>";
				$sheet1 .= "<tr>
							<td style='padding:5px 8px; color:red; font-weight:bold; text-align:right;'>
								<input type='text' style='display:none;' name='' disabled value=''>
								Total
							</td>
							<td style='padding:5px 8px;'>
								<input type='text' class='wgsValuePlain' name='wgsTotalAll' id='wgsTotalAll' disabled value='".number_format($totalAmountMultiple,2)."'>
							</td>
							</tr>";
			}
			$sheet1 .= "</tbody></table>
						</td></tr></table>";
			$sheet1 .= "<input id='wgsPTRS' style='display:none;' value='".$ptrs."' disabled>";


			if($trigType == 1){
				echo $sheet0.$sheet1."*j*".$claimant;
			}else{
				$comp = "	<table border='0' style='border-spacing:0px; margin:0px auto; margin-bottom:20px;'>
								<tr>
									<td><span class='numberField'>PTRS No.</span></td>
									<td style='padding-bottom:0px; padding-left:7px;'>
										<input style='text-align: left;padding-left:10px;font-weight: bold;text-transform:uppercase;' id='sequenceNumWGS1' onchange='resetDbfTable()' onclick='clickInput(this)' onkeydown='keypressAndWhatClear(this,event,searchPTRS,1)' class='data2 checkPY' type='text' placeholder=''>
									</td>
								</tr>
								<tr>
									<td colspan='2' style='padding-top:20px;' id='dbfTable1'>".$sheet0.$sheet1."</td>
								</tr>
								<tr>
									<td colspan='2'><div style='margin-top:20px;' class='button1' onclick='updateTrackingWGS()'>Save</div></td>
								</tr>
							</table>";
				$comp .= "<input id='selectDocTypeWGS1' style='display:none;' value='".$docType."' disabled>";
				$comp .= "<input id='wgsTracking' style='display:none;' value='".$trackingNumber."' disabled>";

				echo $comp."*v*";
			}
		}

		//------------------------------------------------- Multiple Liquidation - START
		function CreateSelectLiquidationMLQ($record, $type){
			if($type == 1){
				$sheet = '<select class = "data2" id="selectCashAdvanceMLQList" style = "letter-spacing:2px;" >';
			}else{
				$sheet = '<select class = "data2" id="selectCashAdvanceMLQList1" style = "letter-spacing:2px;" >';
			}


			$sheet .= '<option></option>'; 
			$i = 0;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$period = strtoupper(substr($data['PeriodMonth'],0,3));
				$amount = $data['Gross'];
				$v = $tn ."@" . $amount . "@" . $claimant . "@" . $data['PeriodMonth'];
				if($i % 2 == 0){
					$sheet .= '<option value = "' . $v . '" style = "background-color:rgb(223, 226, 228);">' .  $period . '  - ' .$claimant  . '</option>';
				}else{
					$sheet .= '<option value = "' . $v . '">' .  $period . '  - ' .$claimant  . '</option>';
				}
				$i++;
				
			}
			$sheet .= '</select>';
			if($type == 1){
				$sheet .= "<span style='color:rgb(24, 167, 219); font-weight:bold; margin-left:10px; font-size:20px; font-family:mainFont; cursor:pointer;' onclick='selectCashAdvanceMLQ()'>+ Add</span>";	
			} else {
				$sheet .= "<span style='color:rgb(24, 167, 219); font-weight:bold; margin-left:10px; font-size:20px; font-family:mainFont; cursor:pointer;' onclick='selectCashAdvanceMLQ1()'>+ Add</span>";	
			}
			
			return $sheet;
		}
		//------------------------------------------------- Multiple Liquidation - END

		//------------------------------------------------- INFRA Payment - START
		function CreateSelectInfraFinal($record){
			$sheet = "";
			$sheet .= '<option></option>'; 
			$i = 0;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$amount = $data['NetAmount'];
				$office = $data['Office'];
				
				$sheet .= "<option value='".$tn."'>".$tn." - ".$claimant." - ".number_format($amount,2)."</option>";
				
			}
			return $sheet;
		}
		//------------------------------------------------- INFRA Payment - END

		//------------------------------------------------- New Liquidation - START
		function CreateSelectLiquidationNLIQ($record, $type){
			$sheet = '<select class = "data2" id="selectCashAdvanceNLIQList" style = "letter-spacing:2px;" onchange="getCashAdvanceforNLIQ(this)">';

			$sheet .= '<option></option>'; 
			$i = 0;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$obrNumber = $data['OBR_Number'];
				$adv1 = $data['ADV1'];
				$period = strtoupper(substr($data['PeriodMonth'],0,3));
				$amount = $data['Gross'];
				$v = $tn ."@" . $amount . "@" . $claimant . "@" . $data['PeriodMonth']. "@" . $obrNumber. "@" . $adv1;
				if($i % 2 == 0){
					$sheet .= '<option value = "' . $v . '" style = "background-color:rgb(223, 226, 228);">' . $tn . " " . $period . '  - ' .$claimant  . '</option>';
				}else{
					$sheet .= '<option value = "' . $v . '">' . $tn . " " . $period . '  - ' .$claimant  . '</option>';
				}
				$i++;
				
			}
			$sheet .= '</select>';
			
			return $sheet;
		}

		// function CreateViewGroupDetailsNLIQ($grp, $trackingPartner){
		// 	$splitDataA = explode('*',$grp);	
		// 	$obrGRP = '';
		// 	$amountX = 0;
		// 	$programS = '';
		// 	$codeS = '';


		// 	$sql = "SELECT PR_ProgramCode, PR_AccountCode, Amount FROM vouchercurrent WHERE TrackingNumber = '".$trackingPartner."'";
		// 	$record = $this->query($sql);

		// 	$caCharges = [];
		// 	$caTotal = 0;
		// 	while($data = $this->fetch_array($record)){
		// 		$amount = floatval($data['Amount']);
		// 		$caCharges[$data['PR_ProgramCode']][$data['PR_AccountCode']] = $amount;
		// 		$caTotal += $amount;				
		// 	}

		// 	for($i = 0; $i < sizeof($splitDataA)-1 ; $i++ ){
		// 		$splitDataB = explode('~',$splitDataA[$i]);	
		// 		$programCode = $splitDataB[0];
		// 		$code = $splitDataB[1];
		// 		$amount = $splitDataB[2];
		// 		$total = $splitDataB[3];
		// 		if($total == 0){
		// 			$total = $amount;
		// 		}
		// 		$programName =$splitDataB[4];
		// 		$title = $splitDataB[5];
		// 		if($programS != $programCode){
		// 			$programS = $programCode;
		// 			$amountX = $amount;
		// 			$codeS = $code;
		// 			$obrGRP .= $programS . '~' . $codeS . '~' . $amountX . '~' . $total  . '~'  . $programName . '~'  . $title  .  '*';
		// 		}else{
		// 			if($codeS != $code){
		// 				$amountX = $amount;
		// 				$codeS = $code;
		// 				$obrGRP .= $programS . '~' . $codeS . '~' . $amountX . '~' . $total  . '~'  . $programName . '~'  . $title  .  '*';
		// 			}else{
		// 				$amountX = $amountX + $amount;
		// 			}
		// 		}	
		// 	}
	   
		// 	$sheet3 = '';
		// 	$sheet0 = '<table id = "nliqOBRBreakdown" style = "border-spacing:0;margin:0 auto;width:100%;border:1px solid rgb(215, 216, 217); font-family:Oswald;"  border= "0">';
		// 	$sheet2 = ' <tr style = "background-color:rgb(121, 137, 141);">
		// 					<td class = "dataHeader1" style="padding:5px 10px;">Program <span class = "countTotal">(' . $i . ')</span></td>
		// 					<td class = "dataHeader1" style="padding:5px 10px;text-align:">Code</td>
		// 					<td class = "dataHeader1" style="padding:5px 10px;text-align:center;">Cash&nbsp;Advance</td>
		// 					<td class = "dataHeader1" style="padding:5px 10px;text-align:center;">Spent</td>
		// 				</tr>';
		// 			 $splitDataA = explode('*',$obrGRP);
		// 			 $programO = '';			   
		// 			  for($i = 0; $i < sizeof($splitDataA)-1 ; $i++ ){
		// 			  	$splitDataB = explode('~',$splitDataA[$i]);	
		// 				$programCode = $splitDataB[0];
		// 				$code = $splitDataB[1];
		// 				$amount = $splitDataB[2];
		// 				$total = $splitDataB[3];

		// 				if(isset($caCharges[$programCode][$code])) {
		// 					$caAmount = $caCharges[$programCode][$code];
		// 				}else {
		// 					$caAmount = 0;
		// 				}

		// 				if($total == 0){
		// 					$total = $amount;
		// 				}
		// 				$programName =$splitDataB[4];
		// 				$title = $splitDataB[5];
		// 				if($programO != $programCode){
		// 					$programO = $programCode;
		// 				}else{
		// 					$programCode = '';
		// 					$programName = '';
		// 				}
		// 				if($i % 2 == 1){
		// 					$color = "rgb(228, 240, 246)";
		// 				}else{
		// 					$color = "";
		// 				}


		// 			 	 $sheet3 .= '<tr style= "background-color:' . $color . ';">	
		// 									<td class = "data1" style="padding:10px;">
		// 										<div style = "font-weight:bold;">' . $programCode .  '</div>
		// 										<span>' . $programName  . '</span>
		// 									</td>
		// 									<td class = "data1" style="padding:10px;">
		// 										<div style = "font-weight:bold;">' . $code .  '</div>
		// 										<span >' . $title  . '</span>
		// 									</td>
		// 									<td class = "data1" style="padding:10px; padding-right:13px; text-align:right;font-weight:bold;"><span >' . $this->zeroToNothing(number_format($caAmount,2)) . '</span></td>
		// 									<td class = "data1" style="padding:10px; padding-right:13px; text-align:right;font-weight:bold;"><span >' . $this->zeroToNothing(number_format($amount,2)) . '</span></td>
		// 						     </tr>';
		// 			 }		   

		// 	$sheet4 = '<tr>
		// 			 		<td></td>
		// 			 		<td style="padding:10px;text-align:right;">Total</td>
		// 			 		<td style="letter-spacing:1px; color:red; font-weight:bold; text-align:right; padding-right:13px; font-size:20px;">'.number_format($caTotal,2).'</td>
		// 			 		<td style="letter-spacing:1px; color:red; font-weight:bold; text-align:right; padding-right:13px; font-size:20px;">'.number_format($total,2).'</td>
		// 			   </tr>
		// 			  </table>';


		// 	unset($caCharges);

		// 	return $sheet0 . $sheet2 .  $sheet3 . $sheet4 ;
		// 	//return $obrGRP;
		// }

		function CreateViewGroupDetailsNLIQ($trackingNumber, $trackingPartner){

			// $sql = "SELECT c.*, d.Amount as realLqAmount FROM 
			// 		(
			// 			(
			// 				SELECT TrackingNumber as caTN, TrackingPartner as lqTN, TrackingNumber, TrackingPartner, PR_ProgramCode, PR_AccountCode, Amount as caAmount, null as lqAmount, DocumentType
			// 				FROM vouchercurrent
			// 				WHERE TrackingNumber = '".$trackingPartner."'
			// 			)
			// 			UNION
			// 			(
			// 				SELECT TrackingPartner as caTN, TrackingNumber as lqTN, TrackingNumber, TrackingPartner, PR_ProgramCode, PR_AccountCode, null as caAmount, Amount as lqAmount, DocumentType
			// 				FROM vouchercurrent
			// 				WHERE TrackingNumber = '".$trackingNumber."'
			// 			)
			// 		) c LEFT JOIN
			// 			vouchercurrent d 
			// 			on concat(c.lqTN,c.PR_AccountCode) = concat(d.TrackingNumber,d.PR_AccountCode) GROUP BY caTN, lqTN, PR_AccountCode ORDER BY caTN ASC, DocumentType ASC;";

			$sql = "SELECT c.*, d.Amount as realLqAmount FROM 
					(
						(
							SELECT TrackingNumber as caTN, TrackingPartner as lqTN, TrackingNumber, TrackingPartner, PR_ProgramCode, PR_AccountCode, Amount as caAmount, null as lqAmount, DocumentType
							FROM vouchercurrent
							WHERE TrackingNumber = '".$trackingPartner."'
						)
						UNION
						(
							SELECT TrackingPartner as caTN, TrackingNumber as lqTN, TrackingNumber, TrackingPartner, PR_ProgramCode, PR_AccountCode, null as caAmount, Amount as lqAmount, DocumentType
							FROM vouchercurrent
							WHERE TrackingNumber = '".$trackingNumber."'
						)
					) c LEFT JOIN
						vouchercurrent d 
						on concat(c.lqTN,c.PR_ProgramCode,c.PR_AccountCode) = concat(d.TrackingNumber,d.PR_ProgramCode,d.PR_AccountCode) GROUP BY caTN, lqTN, PR_ProgramCode, PR_AccountCode ORDER BY caTN ASC, PR_ProgramCode ASC, DocumentType ASC;";
			$record = $this->query($sql);

			$newRecord = [];
			$acctList = "";
			$progList = "";
			$progNames = [];
			$acctNames = [];
			$countCodes = 0;
			while ($data = $this->fetch_array($record)) {
				$progCode = $data['PR_ProgramCode'];
				$acctCode = $data['PR_AccountCode'];
				$caAmount = $data['caAmount'];
				$lqAmount = $data['realLqAmount'];

				if(!isset($newRecord[$progCode])) {
					$newRecord[$progCode] = [];
				}

				array_push($newRecord[$progCode], $progCode.'~'.$acctCode.'~'.$caAmount.'~'.$lqAmount);

				if(!strpos($progList, '"'.$progCode.'"')){
					$progList .= ',"'.$progCode.'"';
				}

				if(!strpos($acctList, '"'.$acctCode.'"')){
					$acctList .= ',"'.$acctCode.'"';
				}

				$countCodes++;
			}

			$sql = "SELECT Code, Name FROM programcode WHERE Code IN (".substr($progList, 1).")";
			$record = $this->query($sql);

			while ($data = $this->fetch_array($record)) {
				$code = $data['Code'];
				$title = $data['Name'];

				$progNames[$code] = $title;
			}

			$sql = "SELECT Code, Title FROM fundtitles WHERE Code IN (".substr($acctList, 1).")";
			$record = $this->query($sql);

			while ($data = $this->fetch_array($record)) {
				$code = $data['Code'];
				$title = $data['Title'];

				$acctNames[$code] = $title;
			}

			
			$rowNum = 0;
			$caTotal = 0;
			$lqTotal = 0;
			$sheet = "<table id='nliqOBRBreakdown' border='0' cellpadding='0' cellspacing='0' style='margin:0px auto; width:100%; border:1px solid rgb(215, 216, 217); font-family:Oswald;'>
						<tr style = 'background-color:rgb(121, 137, 141);'>
		 					<td class = 'dataHeader1' style='padding:5px 10px;'>Program <span class = 'countTotal'>(".$countCodes.")</span></td>
		 					<td class = 'dataHeader1' style='padding:5px 10px;text-align:'>Code</td>
		 					<td class = 'dataHeader1' style='padding:5px 10px;text-align:center;'>Cash&nbsp;Advance</td>
		 					<td class = 'dataHeader1' style='padding:5px 10px; padding-right:13px; text-align:right;'>Utilized</td>
		 				</tr>";
			foreach($newRecord as $progCode => $charges) {

				$curProg = "";
				$display = 1;
				for ($i=0; $i < sizeof($charges); $i++) { 
					$temp = explode('~', $charges[$i]);
					$pCode = $temp[0];
					$aCode = $temp[1];

					$caAmount = $temp[2];
					$lqAmount = $temp[3];
					if($caAmount == '') {
						$caAmount = 0;
					}
					if($lqAmount == '') {
						$lqAmount = 0;
					}

					$pName = $progNames[$pCode];
					$aName = $acctNames[$aCode];

					if($i > 0) {
						$pCode = '';
						$pName = '';
					}

					if($rowNum % 2 == 1){
						$color = "rgb(228, 240, 246)";
					}else{
						$color = "";
					}

					$sheet .= "	<tr style='background-color:".$color."'>	
					 				<td class = 'data1' style='padding:10px;'>
					 					<div style = 'font-weight:bold;'>".$pCode."</div>
					 					<span>".$pName."</span>
					 				</td>
					 				<td class = 'data1' style='padding:10px;'>
					 					<div style = 'font-weight:bold;'>".$aCode."</div>
					 					<span >".$aName."</span>
					 				</td>
					 				<td class = 'data1' style='padding:10px; padding-right:13px; text-align:right;font-weight:bold;'><span >".$this->zeroToNothing(number_format($caAmount,2))."</span></td>
					 				<td class = 'data1' style='padding:10px; padding-right:13px; text-align:right;font-weight:bold;'><span >".$this->zeroToNothing(number_format($lqAmount,2))."</span></td>
					 		  	</tr>";
					
					$caTotal += $caAmount;
					$lqTotal += $lqAmount;
					
					$rowNum++;
				}

			}

			$sheet .= "		<tr>
								<td></td>
								<td style='padding:10px; text-align:right;'>Total</td>
								<td style='letter-spacing:1px; color:red; font-weight:bold; text-align:right; padding-right:13px; font-size:20px;'>".number_format($caTotal,2)."</td>
								<td style='letter-spacing:1px; color:red; font-weight:bold; text-align:right; padding-right:13px; font-size:20px;'>".number_format($lqTotal,2)."</td>
							</tr>
						</table>";

			return $sheet;

		}


		//------------------------------------------------- New Liquidation - END

		function createWAGESView($sheet0,$ptrs,$claimant,$upType,$docType,$defaultYear,$office,$totalGross,$totalPera,$totalGSIS,$totalPagIbig,$totalPhilHealth,$totalState,$totalNet,$totalAmountMultiple){
			$autoOBR = "";
			// if($docType == 'WAGES - BACK PAY' || $docType == 'WAGES - OVERTIME PAY (Plantilla)' || $docType == 'WAGES - SALARY PLANTILLA' ||	$docType == 'WAGES - SALARY DIFFERENTIAL'){
				// $record = $this->LoadProgramFundsByOffice($defaultYear,$office);

				if($_SESSION['accountType'] === "1"){
					$record = $this->LoadProgramFundsByOffice($defaultYear,$office);
				}else{
					$record = $this->LoadProgramFundsWGS();
				}

				$showHide = "showHidePEORCodeWGS(this)";
				// if($upType == 1){
				// 	$showHide = "showHidePEORCodeWGS1(this)";
				// }

				$dpd = "<select class='wgsDPDPlain' name='wgsPrgCode' onchange='".$showHide."'>";
				$dpd .= '<option value = ""></option>';
				while($data = $this->fetch_array($record)){
					$dpd .= '<option value = "'  . $data['Code'] . '">';
					$dpd .= $data['Code'] . " " . $data['Name'];
					$dpd .= '</option>';
				}
				$dpd .= "</select>";
				$prgCodeDp = "<td rowspan='7' style='vertical-align:top; padding:0px 5px; padding-top:5px;'>".$dpd."</td>";


				$defOBR = [
							["50103010", "Retirement and Life Insurance Premiums", "wgsTotalGSIS", $totalGSIS],
							["50103030", "PhilHealth Contributions", "wgsTotalPhilHealth", $totalPhilHealth],
							["50103020", "Pag-IBIG Contributions", "wgsTotalPagibig", $totalPagIbig],
							["50102010", "Personal Economic Relief Allowance (PERA)", "wgsTotalPera", $totalPera],
							["50103040", "Employees Compensation Insurance Premiums", "wgsTotalState", $totalState],
							["50101010", "Salaries and Wages - Regular", "wgsTotalGross", $totalGross],
						];

				for($i = 0; $i < sizeof($defOBR); $i++){
					$code = $defOBR[$i][0];
					$title = $defOBR[$i][1];
					$elemId = $defOBR[$i][2];
					$amount = floatval($defOBR[$i][3]);

					if($amount > 0){
						$autoOBR .= "<tr>
									".$prgCodeDp."
									<td style='padding:5px 8px;'>
										<input type='text' class='wgsPlainInput' name='wgsAccCode' disabled value='".$code."'>
										".$title."
									</td>
									<td style='padding:5px 8px;'><input type='text' class='wgsValuePlain' name='wgsValues' id='".$elemId."' disabled value='".number_format($amount,2)."'></td>
									</tr>";
						$prgCodeDp = "";

					}

				}

				// $autoOBR .= "<tr style='display:none;'>
				// 				<td style='padding:5px 8px; color:red; font-weight:bold;'>
				// 					<input type='text' style='display:none;' name='wgsAccCode' disabled value='netamount'>
				// 					Net Amount
				// 				</td>
				// 				<td style='padding:5px 8px;'>
				// 					<input type='text' class='wgsValuePlain' id='wgsTotalNet' name='wgsValues' disabled value='".number_format($totalNet,2)."'>
				// 				</td>
				// 			</tr>";
				$autoOBR .= "<tr>
								<td style='padding:5px 8px; color:red; font-weight:bold; text-align:right;'>
									<input type='text' style='display:none;' name='' disabled value=''>
									Total
								</td>
								<td style='padding:5px 8px;'>
									<input type='text' class='wgsValuePlain' name='wgsTotalAll' id='wgsTotalAll' disabled value='".number_format($totalAmountMultiple,2)."'>
								</td>
							</tr>";
			// }

			$sheet1  = "<table border='0' style='margin:0px auto; border-spacing:0px; margin-top:18px;'>
						<tr>
						<td style='text-align:right; padding-bottom:8px;'>
							<table border='0' style='width:100%; border-spacing:0px; font-family:Oswald;'>
								<tr>
									<td style='font-size:16px;'>
										<label for='claimantWGS' style='margin-right:5px; color:gray;'>Claimant</label>	
										<input  id='claimantWGS' type='text' style='border:0px; color:black; background-color:white; font-family:Oswald; font-size:16px; width:350px; font-weight:bold; border-bottom:1px dashed black; padding:0px 5px;' value='".$claimant."' disabled/>
									</td>
									<td style='text-align:right; vertical-align:bottom; padding-right:8px;'>
										<span style='color:gray; margin-right:5px;'>Source of Fund</span>
										<input type='radio' name='selectWgsMode' style='cursor:pointer;' id='wgsManl'  class='' onclick = 'wgsMode(this)'/>
										<label  for='wgsManl' style='cursor:pointer;'>Manual</label>
										<input type='radio' name='selectWgsMode' style='cursor:pointer;' id='wgsAuto'  class='' onclick = 'wgsMode(this)' checked/>
										<label  for='wgsAuto' style='cursor:pointer;'>Auto</label>
									</td>
								</tr>
							</table>
						</td>
						</tr>
						<tr><td>
						<table border='0' id='wgsChargesTblM' style='border-spacing:0px; margin:0px auto; border:1px solid rgb(215, 216, 217); display:none;'>
							<thead>
								<tr style='font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program <span id='wgsFundSourceM'></span></th>
									<th style='padding:5px 8px; text-align:left;'><span style='display:block; text-align:left;'>Code</span> <span id='wgsAcctSourceM'><select class = 'data2' style = 'width:300px; display:block'></select></span></th>
									<th colspan='2' style='padding:5px 8px; text-align:left;'>";

			$blk = "<span style='display:block; text-align:left;'>Amount&nbsp;&nbsp;<span style='color:red;' id='wgsTotalAmountMultiple'>".number_format($totalAmountMultiple,2)."</span></span> ";
			if($docType == "WAGES - SALARY J.O (1st half)"){
				$blk = "<span style='display:block; text-align:left;'>Amount&nbsp;&nbsp;
				<input style='color:red; border:0px; font-weight:bold; font-family:Oswald; font-size:16px;' id='wgsTotalAmountMultiple' value='".number_format($totalAmountMultiple,2)."' /></span>";			
			}

			$sheet1 .=				$blk."<input type='text' class='data2' id='wgsValueM' style='width:160px; margin-right:10px; padding: 4px 6px; text-align:center;' onkeydown='return isAmount(this,event)'>
										<span class='button2' onclick='wgsAddMultipleSource(this)'>Add</span>
									</th>
								</tr>
								<tr><th colspan='4' style='padding:3px 0px;'></th></tr>
								<tr style='background-color:rgb(121, 137, 141); color:white; font-size:18px; font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program</th>
									<th style='padding:5px 8px; text-align:left;'>Code</th>
									<th style='padding:5px 8px; text-align:center;'>Amount</th>
									<th style='padding:5px 8px; text-align:center;'></th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
						</td></tr>
						<tr><td>
						<table border='0' id='wgsChargesTbl' style='border-spacing:0px; margin:0px auto; border:1px solid rgb(215, 216, 217);'>
							<thead>
								<tr style='background-color:rgb(121, 137, 141); color:white; font-size:18px; font-family:Oswald;'>
									<th style='padding:5px 8px; text-align:left;'>Program</th>
									<th style='padding:5px 8px; text-align:left;'>Code</th>
									<th style='padding:5px 8px; text-align:center;'>Amount</th>
								</tr>
							</thead>
							<tbody>
							".$autoOBR."
							</tbody>
						</table>
					</td></tr></table>";

			$sheet1 .= "<input id='wgsPTRS' style='display:none;' value='".$ptrs."' disabled>";


			if($upType == 0){
				$sheet1 .= "<table id='peorCodeRow' border='0' cellpadding='0' cellspacing='0' style='width:100%; display:none; padding:20px 0px;'>
								<tr>
									<td style='width:130px;'><span class = 'numb' style='display:inline-block;'>7</span><span class ='numberField'>Select&nbsp;Sub&nbsp;Code</span></td>
									<td>
										<input id='peorSubCodeWGS' type ='hidden' value='0'/>
				 						<input id='peorOfcIdWGS' type ='hidden' value='0'/>
				 						<div class = 'data2 checkPY' style = 'text-align: left;padding-left:10px;font-weight: bold;text-transform:uppercase; cursor:pointer; height:26px; width:95%; border:0px; border-bottom:1px solid black;'  id  = 'peorCodesWGS'  onclick='showSubCodeSelectionWGS()'></div>
									</td>
								</tr>
							</table>";

				$sheet1 .= "<div style = 'text-align:center;padding:20px 0px;'><div style = 'margin:0 auto;' class = 'button1' onclick = 'saveTracking()'>Save</div><br/></div>";
			}else{
				$sheet1 .= "<table id='peorCodeRow' border='0' cellpadding='0' cellspacing='0' style='width:100%; display:none; padding:20px 0px;'>
								<tr>
									<td style='width:130px;'><span class = 'numb' style='display:inline-block;'>7</span><span class ='numberField'>Select&nbsp;Sub&nbsp;Code</span></td>
									<td>
										<input id='peorSubCodeWGS' type ='hidden' value='0'/>
										<input id='peorOfcIdWGS' type ='hidden' value='0'/>
										<div class = 'data2 checkPY' style = 'text-align: left;padding-left:10px;font-weight: bold;text-transform:uppercase; cursor:pointer; height:26px; width:95%; border:0px; border-bottom:1px solid black;'  id  = 'peorCodesWGS'  onclick='showSubCodeSelectionWGS1()'></div>
									</td>
								</tr>
							</table>";

				$sheet1 .= "<div style = 'text-align:center;padding:20px 0px;'>
								<div style = 'margin-top:20px; width:70px;' class = 'button1' onclick = 'checkChargesForSubWGS1()'>Update</div>
								<input id='selectDocTypeWGS1' style='display:none;' value='".$docType."' disabled>
							</div>";
			}
			
			echo $sheet0.$sheet1;
		}
		function createExpenseByCodeBalance1($type,$record){
			
			$sheet = '<div style ="border:1px solid silver;padding:5px;margin-bottom:10px;"><table class ="balancesTableOBRpeace" style ="border-spacing:0; width:600px;line-height:13px;margin-bottom:5px;width:100%;" border = "0">';
			$sheet .= '<tr><th colspan ="100%" style ="font-size:22px;padding:5px;padding-top:10px;text-align:left;color:white;font-weight:bold;background-image: linear-gradient(to  left, black ,rgb(32, 128, 201));">' . $type . '</th></tr>';
			$sheet .= '
						<tr style ="background-color:rgb(224, 226, 217);">
						<th style ="width:10px;background-color:rgb(24, 52, 71);">TNs</th>
						<th style = "">Program / Account Charges</th>
						<th style = ""></th>
						<th style ="text-align:right;padding-right:6px;width:100px;">Total</th>
					  </tr>';
			$i = 0;	
			$gTotal = 0;	  
			$subLabel ='';
			$subLabelExpense ='';
			$subLabelExpense1 ='';
			
			$subtotal = 0;
			$subtotalExpense = 0;
			$arrrSub = array('','Crime Prevention and Law Enforcement',
									'Counter Terrorism',
									'Counter Insurgency',
									'Public Safety',
									'Emergency Crisis Management',
									'Illegal Drugs / Illegal Gambling and Other Illegal Activities',
									'Compound');
									
			$sName = '';
			while($data = $this->fetch_array($record)){
				$code = $data['PR_AccountCode'];
				
				$total = $data['Total'];
				$gTotal += $total;
				$count = $data['Count'];
				$fund = $data['Fund'];
				$pId = $data['PeaceOfficeId'];
				$subcode = $data['SubCode'];
				$pName = $data['Name'];
				$title1 = $data['Title'];
				if($subcode > 0){
					$sName = $arrrSub[$subcode];
				}
				
				
				if($subLabelExpense != $code){
					if($i > 0){
						$sheet .= '<tr style ="">
										<th colspan = "100%" style = "background-color:white;text-align:right;color:green;font-weight:bold;padding:5px;border-top:1px solid rgb(155, 178, 157);">' .  number_format($subtotalExpense,2) . '</th>
									</tr>';
						$subtotalExpense = 0;
					}
					
					$subLabelExpense = $code;
				}
				
				$title = $data['Title'];
				if($subLabel != $fund){
					if($i > 0){
						$sheet .= '<tr style ="background1-color:rgb(234, 233, 220);">
									<th colspan ="100%" style = "text-align:right;color:red;background-color:white;">' . number_format($subtotal,2) . '</th>
								</tr>';
						$subtotal = 0;
					}
					$sheet .= '<tr style ="background1-color:rgb(234, 233, 220);" >
									<th colspan = "100%" style ="padding-top:10px;font-weight:bold;color:rgb(16, 149, 232);background-color:white;text-align:left;">' . $fund . '</th>
								</tr>';
					$subLabel = $fund;
					
				}
				
				if($subLabelExpense1 != $title1){
					$sheet .= '<tr >
									<td colspan = "100%" style ="font-weight:bold;background-color:white;border-bottom:1px solid rgb(155, 178, 157);">' . $title1 . '</td>
								</tr>';
					
				}
				$subLabelExpense1 = $title1;	
				$sheet .= '<tr id = "' .$type . '"onclick = "selectTransactionsInBalances(this)">
							
							<td style = "vertical-align:top;text-align:center;" id = "' . $code . '*' .$pId . '">' . $count . '</td>
							<td style = "vertical-align:top;white-space: nowrap;">' . $sName . '</td>
							<td style = "vertical-align:top;white-space: nowrap;">' . $pName . '</td>
							<td style = "vertical-align:top;text-align:right;">' . number_format($total,2) . '</td>
							
						  </tr>';
				$subtotal += $total;
				$subtotalExpense += $total;
				$i = 1;
			}
			$sheet .= '<tr style ="">
						<th colspan = "100%" style = "background-color:white;text-align:right;color:green;font-weight:bold;padding:5px;border-top:1px solid green;">' .  number_format($subtotalExpense,2) . '</th>
					</tr>';
			$sheet .= '<tr style ="background1-color:rgb(234, 233, 220);">
									<th colspan ="100%" style = "text-align:right;color:red;background-color:white;">' . number_format($subtotal,2) . '</th>
								</tr>';
			$sheet .= '<tr style ="background-color:red;">
							<th colspan ="100%" style="font-size:18px; color:black;background-color:white;text-align:right;"><div style = "display:inline-block;border-top:1px solid black;padding-top:5px;">' . number_format($gTotal,2) . '</div></th>
						</tr>';
			$sheet .= '</table></div>';
			return $sheet;
		}
		function createExpenseByCodeBalance($type,$record){
			$sheet = '<div style ="border:1px solid silver;padding:5px;margin-bottom:10px;"><table class ="balancesTableOBR" style ="border-collapse:collapse;width:600px;line-height:13px;margin-bottom:5px;" border = "0">';
			$sheet .= '<tr><th colspan ="100%" style ="font-size:22px;padding:5px;padding-top:10px;color:white;text-align:left;font-weight:bold;background-image: linear-gradient(to  left, black ,rgb(32, 128, 201));">' . $type . '</th></tr>';
			$sheet .= '
						<tr style ="background-color:rgb(224, 226, 217);">
						
						<th style ="width:10px;background-color:rgb(24, 52, 71);">TNs</th>
						<th style = "width:20px;">Code</th>
						<th style ="text-align:left;padding-left:5px;">Title</th>
						<th style ="text-align:right;padding-right:6px;">Total</th>
					  </tr>';
			$i = 0;	
			$gTotal = 0;	  
			$subLabel ='';
			
			$subtotal = 0;
			while($data = $this->fetch_array($record)){
				$code = $data['PR_AccountCode'];
				$title = $data['Title'];
				$total = $data['Total'];
				$gTotal += $total;
				$count = $data['Count'];
				$fund = $data['Fund'];
				
				if($subLabel != $fund){
					if($i > 0){
						$sheet .= '<tr style ="background1-color:rgb(234, 233, 220);">
									<td colspan ="100%" style = "text-align:right;color:red;font-weight:bold;">' . number_format($subtotal,2) . '</td>
								</tr>';
						$subtotal = 0;
					}
					$sheet .= '<tr style ="" >
									<th colspan = "100%" style ="padding-top:10px;font-weight:bold;color:rgb(16, 149, 232);background-color:white;text-align:left;">' . $fund . '</th>
								</tr>';
					$subLabel = $fund;
				}
				$sheet .= '<tr id = "' .$type . '"onclick = "selectTransactionsInBalances(this)">
							
							<td style = "vertical-align:top;text-align:center;">' . $count . '</td>
							<td style = "vertical-align:top;text-align:center;">' . $code . '</td>
							<td style = "vertical-align:top;">' . $title . '</td>
							<td style = "vertical-align:top;text-align:right;">' . number_format($total,2) . '</td>
							
						  </tr>';
				$subtotal += $total;
				$i = 2;
			}
			$sheet .= '<tr style ="background1-color:rgb(234, 233, 220);">
							<td colspan ="100%" style = "text-align:right;color:red;font-weight:bold;">' . number_format($subtotal,2) . '</td>
						</tr>';
			$sheet .= '<tr style ="background-color:red;">
							<th colspan ="100%" style="font-size:18px; color:black;background-color:white;text-align:right;"><div style = "display:inline-block;border-top:1px solid black;padding-top:5px;">' . number_format($gTotal,2) . '</div></th>
						</tr>';
			$sheet .= '</table></div>';
			return $sheet;
		}
		function createTransactionByCodeBalance($record){
			$sheet3 ='';
			$sheet4 ='';
			$sheet2 ='';
			$sheet1 ='';
			$sheet0 = '<table id = "tableOBRtransactions" class ="balancesTableOBR1" style ="border-collapse:collapse;width:700px;line-height:12px;font-family: NOR;margin-top:11px;" border = "0">';
			
			$i = 1;
			$totalOBR = 0;	
			$program ='';	
			$trackingType = '';  
			$colspan = 4;
			while($data = $this->fetch_array($record)){
				$accountCode = $data['PR_AccountCode'];
				$program = $data['PR_ProgramCode'];
				
				$tn = $data['TrackingNumber'];
				$docType = $data['DocumentType'];
				$total = $data['Total'];
				$title = $data['Title'];
				$totalAmount = $data['TotalAmountMultiple'];
				$status = $data['Status'];
				$office = $data['Name'];
				$obr = $data['OBR_Number'];
				$subcode = $data['SubCode'];
				$claimant = $data['Claimant'];
				$trackingType = $data['TrackingType'];
				
				
				 $arrrSub = array('','Crime Prevention and Law Enforcement',
									'Counter Terrorism',
									'Counter Insurgency',
									'Public Safety',
									'Emergency Crisis Management',
									'Illegal Drugs / Illegal Gambling and Other Illegal Activities',
									'Compound');
				$dataModified = $data['DateModified'];
				$totalOBR += $total;
				$sheet2 = '<tr><td colspan ="100%" style ="padding:4px;background-image: linear-gradient(to  left, white ,rgb(224, 226, 217));text-align:left;padding:5px;font-size:13px;font-weight:bold;letter-spacing:1px;"><span span style ="color:rgb(6, 111, 187);"><span style ="color:black;">' . $program . '</span> - ' . $accountCode . '</span> <span style ="">' . strtoupper($title) . '</span></td></tr>';
				$sheet3 .= '<tr >
							<td>' . $i++ . '</td>
							
							<td onclick ="clickThisBalance(this)" class = "hover" style = "white-space: nowrap">' . $tn . '</td>';
				if($trackingType != "PR"){
					$sheet3 .= '<td style = "white-space: nowrap;">' . $claimant . '</td>';
				}				
				$sheet3 .= '<td style = "vertical-align:top; white-space: nowrap;">' . $office . '</td>
							<td>' . $obr . '</td>';
				if($trackingType == "PY"){			
					$sheet3 .= '<td style = "white-space: nowrap;">' . $docType . '</td>';
				}
				if($program == '1011-1'){					
					$sheet3 .= '<td style = "white-space: nowrap;" onclick = "changeSubcode(this)">';
					if($subcode){
						$sheet3 .=  $arrrSub[$subcode] ;
					}
					$sheet3 .= '</td>';
				}			
				$sheet3 .= '<td style = "text-align:right;">' . number_format($total,2) . '</td>
							<td style = "vertical-align:top;white-space: nowrap;font-size:13px;">' . $status . '</td>
							<td style = "white-space: nowrap;font-size:13px;">' . $dataModified . '</td>
						  </tr>';
			}
			$sheet1 .= '<tr>
						<th></th>
						<th style = "background-color:rgb(187, 60, 164);">TN</th>';
			if($trackingType != "PR"){
				$sheet1 .= '<th >Claimant</th>';
				$colspan++;
			}			
			$sheet1 .= '<th style ="background-color:rgb(36, 42, 52)">Office</th><th>OBR&nbsp;No.</th>';
			if($trackingType == "PY"){			
				$sheet1 .= '<th>Document</th>';
				$colspan++;
			}
			if($program == '1011-1'){		
				$sheet1 .= '<th>SubCode</th>';
				$colspan++;
			}			
			$sheet1 .= '
						<th style = "text-align:right;">Amount</th>
						<th>Status</th>
						<th>DateModified</th>
					  </tr>';
			$sheet4 .= '</table>
						<div onclick = "toExcel1(this)" class = "hover" style = "text-align:right;font-size:10px;letter-spacing:1px;color:GREY;cursor:pointer;padding-right:10px;">SAVE TO EXCEL</div>
						<div onclick = "printView()" class = "hover" style = "text-align:right;font-size:10px;letter-spacing:1px;color:GREY;cursor:pointer;padding-right:10px;padding-top:5px;">PRINT DISPLAY</div>
						';
			
			$sheet5 = '<tr><th colspan ="' . $colspan . '" style = "background-color:white;"></th><th style = "background-color:white;color:black;"><div style = "border-top:1px solid black;padding-top:5px;">' . number_format($totalOBR,2) . '</div></th></tr>';
			return $sheet0  . $sheet2 . $sheet1 . $sheet3 . $sheet5 .  $sheet4 ;
		}
		function createPeaceOffice($record,$tn){
			$sheet = '<div style = "height:505px;overflow-y:auto;overflow-x:hidden;">
					
					<table id = "tablePeaceAndOrder" style = "font-size:12px;border-collapse:collapse;width:650px;font-family:NOR;" border ="1">';
			$i =1;			
			$sheet .= '<tr style = "">
						<th style ="width:10px;">
							<div style ="position:fixed;height:18px;width:35px;margin-left:-1px;text-align:left;margin-top:-12px;background-color:rgb(15, 19, 22);color:white;padding:2px 5px;">&nbsp;</div>
						</th>
						<th style ="width:280px;height:20px;">
							<div style ="position:fixed;height:18px;width:287px;margin-left:-1px;text-align:left;margin-top:-12px;background-color:rgb(70, 89, 106);color:white;padding:2px 5px;">Office</div>
						</th>
						<th style ="height:20px;">
							<div style ="position:fixed;height:18px;width:317px;margin-left:-1px;text-align:left;margin-top:-12px;background-color:rgb(70, 89, 106);color:white;padding:2px 5px;">Fund</div>
						</th></tr>';
			while($data = $this->fetch_array($record)){
				$officeId = $data['OfficeId'];
				$name = $data['Name'];
				$fund = $data['Fund'];
				$code = $data['Code'];
				$sheet .= '<tr id ="' . $officeId . '*' . $code . '*' . $tn . '" style ="cursor: pointer;" onclick ="selectSubProgramPeace(this)">';
				$sheet .= '<td style ="text-align:center;">' . $i++ . '</td><td style ="">' . $name  . '</td><td style ="">' .  $fund . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '	</table></div>
						<div style = "font-family:NOR;font-size:12px;letter-spacing:1px;padding-top:10px;"> CHANGE SUBCODE FOR TN : <span style ="color:red;font-weight:bold;">' . $tn . '</span></div>';
			return $sheet;
		}
		function createPeaceOfficeWGS($record, $upType){
			$row = 0;
			$sheet = " <div id='tablePeaceAndOrderWGSCont' style='height:505px;'>";
			$sheet .= "	<table id='tablePeaceAndOrderWGS' border='0' cellpadding='0' cellspacing='0' style='font-size:14px; width:650px; font-family:NOR;'>
							<thead>
								<tr>
									<th style='background-color:rgb(15, 19, 22);'></th>
									<th>Office</th>
									<th>Fund</th>
								</tr>
							</thead>
							<tbody style=''>";
			while($data = $this->fetch_array($record)){
				$officeId = $data['OfficeId'];
				$name = $data['Name'];
				$fund = $data['Fund'];
				$code = $data['Code'];

				if($upType == 0){
					$func = "setWGSPEORDetails(this)";
				}else{
					$func = "setWGSPEORDetails1(this)";
				}

				$sheet .= '<tr id ="' . $officeId . '*' . $code . '" style ="cursor: pointer;" onclick="'.$func.'">';
				$sheet .= '<td style ="text-align:center;">' . ++$row . '</td><td style ="">' . $name  . '</td><td style ="">' .  $fund . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= "		</tbody>
						</table>";
			$sheet .= "</div>";
			
			return $sheet;
		}
		function createPeaceOfficeEDIT($record, $key){
			$row = 0;
			$sheet = " <div id='tablePeaceAndOrderWGSCont' style='height:505px;'>";
			$sheet .= "	<table id='tablePeaceAndOrderWGS' border='0' cellpadding='0' cellspacing='0' style='font-size:14px; width:650px; font-family:NOR;'>
							<thead>
								<tr>
									<th style='background-color:rgb(15, 19, 22);'></th>
									<th>Office</th>
									<th>Fund</th>
								</tr>
							</thead>
							<tbody style=''>";
			while($data = $this->fetch_array($record)){
				$officeId = $data['OfficeId'];
				$name = $data['Name'];
				$fund = $data['Fund'];
				$code = $data['Code'];

				$sheet .= '<tr id ="' . $officeId . '*' . $code . '*' . $key . '" style ="cursor: pointer;" onclick="setEDITPEORDetails(this)">';
				$sheet .= '<td style ="text-align:center;">' . ++$row . '</td><td style ="">' . $name  . '</td><td style ="">' .  $fund . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= "		</tbody>
						</table>";
			$sheet .= "</div>";
			
			return $sheet;
		}
		function createPeaceOfficeEDITDirect($record, $tn){
			$row = 0;
			$sheet = " <div id='tablePeaceAndOrderWGSCont' style='height:505px;'>";
			$sheet .= "	<table id='tablePeaceAndOrderWGS' border='0' cellpadding='0' cellspacing='0' style='font-size:14px; width:650px; font-family:NOR;'>
							<thead>
								<tr>
									<th style='background-color:rgb(15, 19, 22);'></th>
									<th>Office</th>
									<th>Fund</th>
								</tr>
							</thead>
							<tbody style=''>";
			while($data = $this->fetch_array($record)){
				$officeId = $data['OfficeId'];
				$name = $data['Name'];
				$fund = $data['Fund'];
				$code = $data['Code'];

				$sheet .= '<tr id ="' . $officeId . '*' . $code . '*' . $tn . '" style ="cursor: pointer;" onclick="updateEDITPEORDirect(this)">';
				$sheet .= '<td style ="text-align:center;">' . ++$row . '</td><td style ="">' . $name  . '</td><td style ="">' .  $fund . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= "		</tbody>
						</table>";
			$sheet .= "</div>";
			
			return $sheet;
		}
		function CreatePaymasterList($record){
			$sheet = '<div style ="border:1px solid silver;padding:5px;margin-bottom:10px;"><table class ="windowTable" style ="border-collapse:collapse;line-height:13px;margin-bottom:5px;font-family:NOR;" border = "0">';
			$sheet .= '<tr><th colspan ="100%" style ="font-size:22px;padding:5px;padding-top:10px;color:white;text-align:left;font-weight:bold;background-image: linear-gradient(to  left, black ,rgb(32, 128, 201));">Paymaster List</th></tr>';
			$sheet .= '
						<tr style ="background-color:rgb(224, 226, 217);">
						<th ></th>
						<th style ="background-color:rgb(24, 52, 71);text-align:left;">TNs</th>
						<th style = "text-align:center;">Fund</th>
						<th style = "text-align:center;">Window</th>
						<th style = "text-align:left;">Disbursement&nbsp;Officer</th>
						<th style = "text-align:left;">People</th>
						
						<th style = "text-align:right;">Amount</th>
						<th style = "text-align:left;">Status</th>
						
						<th style ="text-align:left;padding-left:5px;">Date Modified</th>
						
					  </tr>';
			$i = 1;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$dateModified = $data['DateModified'];
				$status = $data['Status'];
				$amount = $data['Amount'];
				$window = $data['Window'];
				$fund = $data['Fund'];
				$person = $data['NumOfEmps'];
				$sheet .= '<tr >
							<td style = "text-align:center;">' . $i++ . '</td>
							<td  id = "' . $tn . '" onclick ="getPaymasterTracking(this)">' . $tn . '</td>
							<td style = "text-align:center;">' . $fund . '</td>
							<td style = "text-align:center;">' . $window . '</td>
							<td style = "">' . $claimant . '</td>
							<td style = "text-align:center;">' . $person . '</td>
							<td style = "text-align:right;">' . number_format($amount,2) . '</td>
							<td style = "">' . $status . '</td>
							<td style = "font-size:12px;">' . $dateModified . '</td>
						  </tr>';
			}
			
			$sheet .= '<tr style ="background-color:red;">
							<th colspan ="100%" style="background-color:white;padding:0;"><div style = "border-top:1px solid silver;background-color:rgb(242, 244, 246);">&nbsp;</div></th>
						</tr>';
			$sheet .= '</table></div>';
			return $sheet;
		}
		// function CreatePaymasterBreakdown($record){
		// 	$sheet = '<div style ="border:1px solid silver;padding:5px;margin-bottom:10px;">
		// 				<table class ="windowTable1" id="paymasterTableBreakdown" style ="border-collapse:collapse;line-height:13px;margin-bottom:5px;font-family:NOR;" border = "0">';
		// 	$sheet .= '	<tr><th colspan ="100%" style ="font-size:22px;padding:5px;padding-top:10px;color:white;text-align:left;font-weight:bold;background-color:rgb(32, 128, 201); background-image: linear-gradient(to  left, black ,rgb(32, 128, 201));">Breakdown</th></tr>';
		// 	$sheet .= '
		// 				<tr style ="background-color:rgb(224, 226, 217);">
		// 				<th ></th>
		// 				<th style ="background-color:rgb(24, 52, 71);text-align:left;">TNs</th>
		// 				<th style = "text-align:left;">ADV</th>
		// 				<th style = "text-align:left;">OBR</th>
		// 				<th style = "text-align:left;">Payroll</th>
		// 				<th style = "text-align:right;">Amount</th>
		// 				<th style = "text-align:right;">Net&nbsp;Amount</th>
		// 				<th colspan="2" style = "text-align:left;">Fund</th>
		// 				<th colspan="2" style = "text-align:left;">Expense Account</th>
		// 			  </tr>';
		// 	$i = 1;
		// 	while($data = $this->fetch_array($record)){
		// 		$tn = $data['TrackingNumber'];
		// 		$claimant = $data['Claimant'];
		// 		$dateModified = $data['DateModified'];
		// 		$status = $data['Status'];
		// 		$amount = $data['Amount'];
		// 		$program = $data['PR_ProgramCode'];
		// 		$accountCode = $data['PR_AccountCode'];
		// 		$name = $data['Name'];
		// 		$title = $data['Title'];
		// 		$adv = $data['ADV1'];
		// 		$obr = $data['OBR_Number'];
		// 		$netAmount = $data['NetAmount'];

				
		// 		$sheet .= '<tr >
		// 					<td style = "text-align:center;">' . $i++ . '</td>
		// 					<td  id = "' . $tn . '" onclick ="">' . $tn . '</td>
		// 					<td style = "">' . $adv . '</td>
		// 					<td style = "">' . $obr . '</td>
		// 					<td style = "white-space:nowrap;">' . ($claimant) . '</td>
		// 					<td style = "text-align:right;">' . number_format($amount,2) . '</td>
		// 					<td style = "text-align:right;">' . number_format($netAmount,2) . '</td>
		// 					<td style = "font-size:12px;"><span style = "color:rgb(27, 107, 169);font-weight:bold;">' . $program . '</span></td>
		// 					<td style = "font-size:12px;">' . $name . '</td>
		// 					<td style = "font-size:12px;"><span style = "color:rgb(215, 72, 115);font-weight:bold;">' . $accountCode .'</span></td>
		// 					<td style = "font-size:12px;">' . $title . '</td>
		// 				  </tr>';
		// 	}
			
		// 	$sheet .= '<tr style ="background-color:red;">
		// 					<th colspan ="100%" style="background-color:white;padding:0;"><div style = "border-top:1px solid silver;background-color:rgb(242, 244, 246);">&nbsp;</div></th>
		// 				</tr>';
		// 	$sheet .= '</table></div>';
		// 	$sheet .= "<div style='text-align:right;'><span class='hover' style='font-size:10px;letter-spacing:1px;color:GREY;cursor:pointer;padding-right:10px;' onclick='paymasterSaveToExcel()'>Save to Excel</span></div>";

		// 	return $sheet;
		// }

		function CreatePaymasterBreakdown($record){
			$sheet = '<table class ="windowTable1" id="" style ="border-collapse:collapse;line-height:13px;margin-bottom:5px;font-family:NOR;" border = "0">';
			// $sheet .= '	<tr><th colspan ="100%" style ="font-size:22px;padding:5px;padding-top:10px;color:white;text-align:left;font-weight:bold;background-color:rgb(32, 128, 201); background-image: linear-gradient(to  left, black ,rgb(32, 128, 201));">Breakdown</th></tr>';
			$sheet .= '
						<tr style ="background-color:rgb(224, 226, 217);">
						<th ></th>
						<th style ="background-color:rgb(24, 52, 71);text-align:left;">TNs</th>
						<th style = "text-align:left;">ADV</th>
						<th style = "text-align:left;">OBR</th>
						<th style = "text-align:left;">Payroll</th>
						<th style = "text-align:right;">Amount</th>
						<th style = "text-align:right;">Net&nbsp;Amount</th>
						<th colspan="2" style = "text-align:left;">Fund</th>
						<th colspan="2" style = "text-align:left;">Expense Account</th>
					  </tr>';
			$i = 1;
			while($data = $this->fetch_array($record)){
				$tn = $data['TrackingNumber'];
				$claimant = $data['Claimant'];
				$dateModified = $data['DateModified'];
				$status = $data['Status'];
				$amount = $data['Amount'];
				$program = $data['PR_ProgramCode'];
				$accountCode = $data['PR_AccountCode'];
				$name = $data['Name'];
				$title = $data['Title'];
				$adv = $data['ADV1'];
				$obr = $data['OBR_Number'];
				$netAmount = $data['NetAmount'];

				
				$sheet .= '<tr >
							<td style = "text-align:center;">' . $i++ . '</td>
							<td  id = "' . $tn . '" onclick ="">' . $tn . '</td>
							<td style = "">' . $adv . '</td>
							<td style = "">' . $obr . '</td>
							<td style = "white-space:nowrap;">' . ($claimant) . '</td>
							<td style = "text-align:right;">' . number_format($amount,2) . '</td>
							<td style = "text-align:right;">' . number_format($netAmount,2) . '</td>
							<td style = "font-size:12px;"><span style = "color:rgb(27, 107, 169);font-weight:bold;">' . $program . '</span></td>
							<td style = "font-size:12px;">' . $name . '</td>
							<td style = "font-size:12px;"><span style = "color:rgb(215, 72, 115);font-weight:bold;">' . $accountCode .'</span></td>
							<td style = "font-size:12px;">' . $title . '</td>
						  </tr>';
			}
			
			$sheet .= '<tr style ="background-color:red;">
							<th colspan ="100%" style="background-color:white;padding:0;"><div style = "border-top:1px solid silver;background-color:rgb(242, 244, 246);">&nbsp;</div></th>
						</tr>';
			$sheet .= '</table></div>';
			$sheet .= "<div style='text-align:right;'><span class='hover' style='font-size:10px;letter-spacing:1px;color:GREY;cursor:pointer;padding-right:10px;' onclick='paymasterSaveToExcel()'>Save to Excel</span></div>";
			return $sheet;
		}
		function createRevisionDisplay($trackingNumber){
			$sql = "select Claimant,Amount,NetAmount,PR_AccountCode,TrackingType from vouchercurrent where trackingnumber = '" . $trackingNumber . "' limit 1";
			$record = $this->query($sql);
			$count = $this->num_rows($record);
			if($count > 0){
				$data = $this->fetch_array($record);
				$amount = $data['Amount'];
				$net = $data['NetAmount'];
				$claimant = $data['Claimant'];
				$accountCode = $data['PR_AccountCode'];
				$trackingType = $data['TrackingType'];
				if($trackingType =="NF"){
					$sql = "select Name,Code,FundYear from programcode where TrackingNumberInfra = '" . $trackingNumber . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					
					$fundYear = $data['FundYear'];
					$name = $data['Name'];
					$code = $data['Code'];
					
					$sql = "select Title from fundtitles where Code = '" . $accountCode . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					$title = $data['Title'];
					
					$sql = "select Variation,Unperformed from infra where TrackingNumber = '" . $trackingNumber . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					$variation = $data['Variation'];
					$unperformed = $data['Unperformed'];
					
					$revisedContract = '';
					$type = '';
					$amountAdjustment = 0;
					if($variation > 0){
						$type = "Variation";
						$amountAdjustment = $variation;
						$revisedContract =  number_format($net + $amountAdjustment,2);
					}
					if($unperformed > 0){
						$type = "Unperformed";
						$amountAdjustment = $unperformed;
						$revisedContract =   number_format($net - $amountAdjustment,2);
					}
					$sheet  ='<table border ="0" style ="border-collapse:collapse;">';
					$sheet  .='<tr><td style ="width:150px;color:rgb(12, 113, 172)"><span style = "color:grey;" class = "labelProjectNumber">1</span>TN</td><td id = "infraRevisionTN">' . $trackingNumber .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">2</span>Contractor</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $claimant .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">3</span>Project Name</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $name .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">4</span>Fund Year</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $fundYear .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">5</span>Project Code</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $code .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">6</span>Expense&nbsp;Account</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $accountCode .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">7</span>Expense Title</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $title .'</td></tr>';
					$sheet  .='<tr><td colspan ="2">
								<table style ="float:right;border-collapse:collapse;text-align:right;margin-top:10px;" cellpadding="0" cellspacing="0" >
									<tr><td style = "padding-right:5px;">Budget Amount </td><td style ="padding-left:20px;font-weight:bold;padding-right:5px;">' . number_format($amount,2) .'</td></tr>
									<tr><td style = "padding-right:5px;">Actual Cost </td><td id = "infraRevisionActual" style ="padding-right:5px;">' . number_format($net,2) .'</td></tr>
									<tr><td style = "padding-right:5px;">Adjustment Type </td><td style ="padding-right:5px;" id ="infraRevisionType">' .  $type . '</td></tr>
									<tr><td style = "padding-right:5px;">Amount </td><td style ="padding-right:5px;" id ="infraRevisionAmount">' .  $this->zeroToNothing(number_format($amountAdjustment,2)) . '</td></tr>
									<tr><td style = "padding-right:5px;">Revised Amount </td><td style ="color:red;background-color:rgb(235, 239, 237);padding-right:5px;" id ="infraRevisionAdjusted">' . $revisedContract . '</td></tr>
								</table>
							  </tr>';
					$sheet  .='</table>';
				}else{
					$sheet = '<div style = "">Non-infrastructure transaction.</div>';
				}
				
			}else{
				
				$sheet = '<div style = "">No record found.</div>';
			}
			
			return $sheet;
		}
		function createInfraUploadDisplay($trackingNumber){
			$sql = "select Claimant,Amount,NetAmount,PR_AccountCode,TrackingType from vouchercurrent where trackingnumber = '" . $trackingNumber . "' limit 1";
			$record = $this->query($sql);
			$count = $this->num_rows($record);
			if($count > 0){
				$data = $this->fetch_array($record);
				$amount = $data['Amount'];
				$net = $data['NetAmount'];
				$claimant = $data['Claimant'];
				$accountCode = $data['PR_AccountCode'];
				$trackingType = $data['TrackingType'];
				if($trackingType =="NF"){
					$sql = "select Name,Code,FundYear from programcode where TrackingNumberInfra = '" . $trackingNumber . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					
					$fundYear = $data['FundYear'];
					$name = $data['Name'];
					$code = $data['Code'];
					
					$sql = "select Title from fundtitles where Code = '" . $accountCode . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					$title = $data['Title'];
					
					$sql = "select Variation,Unperformed,Progress,Duration from infra where TrackingNumber = '" . $trackingNumber . "' limit 1";
					$record = $this->query($sql);
					$data = $this->fetch_array($record);
					$variation = $data['Variation'];
					$unperformed = $data['Unperformed'];
					$progress = $data['Progress'];
					$duration = $data['Duration'];
					
					$revisedContract = '';
					$type = '';
					$amountAdjustment = 0;
					if($variation > 0){
						$type = "Variation";
						$amountAdjustment = $variation;
						$revisedContract =  number_format($net + $amountAdjustment,2);
					}
					if($unperformed > 0){
						$type = "Unperformed";
						$amountAdjustment = $unperformed;
						$revisedContract =   number_format($net - $amountAdjustment,2);
					}
					$sheet  ='<table border ="0" style ="border-collapse:collapse;">';
					$sheet  .='<tr><td style ="width:175px;color:rgb(12, 113, 172)"><span style = "color:grey;" class = "labelProjectNumber">1</span>TN</td>
								<td  id="infraUpSelectTN" style = "font-size:20px; color:orange;font-weight:bold;border-bottom:1px solid rgb(216, 219, 221);">' . $trackingNumber .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">2</span>Construction&nbsp;Progress</td><td id="infraUpCurProgress" style ="letter-spacing:1px;font-weight:bold;border-bottom:1px solid rgb(216, 219, 221);">' . $progress .'%</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">3</span>Contractor</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $claimant .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">4</span>Project Name</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $name .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">5</span>Fund Year</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $fundYear .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">6</span>Project Code</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $code .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">7</span>Expense&nbsp;Account</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $accountCode .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">8</span>Expense Title</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $title .'</td></tr>';
					$sheet  .='<tr><td style ="color:rgb(41, 111, 152);"><span style = "color:grey;"class = "labelProjectNumber">9</span>Project Duration</td><td style ="border-bottom:1px solid rgb(216, 219, 221);">' . $duration .'</td></tr>';
					$sheet  .='<tr><td colspan ="2">
								<table style ="float:right;border-collapse:collapse;text-align:right;margin-top:10px;" cellpadding="0" cellspacing="0" >
									<tr><td style = "padding-right:5px;">Budget Amount </td><td style ="padding-left:20px;font-weight:bold;padding-right:5px;">' . number_format($amount,2) .'</td></tr>
									<tr><td style = "padding-right:5px;">Actual Cost </td><td id = "infraRevisionActual" style ="padding-right:5px;">' . number_format($net,2) .'</td></tr>
									<tr><td style = "padding-right:5px;">Adjustment Type </td><td style ="padding-right:5px;" id ="infraRevisionType">' .  $type . '</td></tr>
									<tr><td style = "padding-right:5px;">Amount </td><td style ="padding-right:5px;" id ="infraRevisionAmount">' . $this->zeroToEmpty(number_format($amountAdjustment,2)) . '</td></tr>
									<tr><td style = "padding-right:5px;">Revised Amount </td><td style ="color:red;background-color:rgb(235, 239, 237);padding-right:5px;" id ="infraRevisionAdjusted">' . $revisedContract . '</td></tr>
								</table>
							  </tr>';
					
					
					$sql = "select * from infraconstruction where trackingnumber = '" . $trackingNumber . "' order  by id desc";
					$record = $this->query($sql);
					
					$count = $this->num_rows($record);
					if($count > 0){
						
						$sheet  .='<tr><td colspan ="2" style ="padding:15px 0px;"><div style = "border-top:1px dashed rgb(131, 142, 147);"></div><td></tr>';
						$sheet  .='<tr><td style ="color:rgb(41, 111, 152);vertical-align:top;"><span style = "color:grey;" class = "labelProjectNumber">10</span>Progress History</td><td>';
							$sheet .= '<table id = "progressHistory"  style ="line-height:15px;width:100%;font-size:14px;" >';
							$sheet .= '<tr><th></th><th style ="text-align:left;">Progress</th><th style ="text-align:left;">Notes</th>
								<th style ="text-align:left; width:0px; white-space:nowrap;">Images</th>
								<th style ="text-align:left; width:0px; white-space:nowrap;">Video</th>
								
								<th style ="text-align:left;width:1px; ">Date Updated</th></tr>';
							$i = 1;
							while($data = $this->fetch_array($record)){
								$progress = $data['Progress'];
								$description = $data['ProgressDescription'];
								$encoded = $data['DateEncoded'];
								$files = $data['Files'];
								$video = $data['Video'];
								if(strlen($video) > 0){
									$video = 1;
								}
								$filesLen = 0;
								if($files != "") {
									$filesLen = sizeof(explode('-', $files));
								}
								 
								$sheet .= '<tr onclick="getProgressDetails(this)" style="cursor:pointer;">';
								$sheet .= '<td style ="padding:0px 5px;vertical-align:top;text-align:center;color:rgb(19, 60, 78);font-size:12px;background-color1:rgb(242, 239, 230);">' . $i++ . '</td>
											<td style ="vertical-align:top;">' . $progress . '</td><td>' . $description . '</td>
											<td style="text-align:center;">' . $this->zeroToNothing($filesLen) . '</td>
											<td style="text-align:center;">' . $video . '</td>
											
											<td style ="text-align:left;white-space:nowrap;">' . $encoded . '</td>';
								$sheet .= '</tr>';
							}
							$sheet .= '</table>';								
						$sheet  .='</tr>';
					}
					$sheet  .='</table>';
					
				}else{
					$sheet = '<div style = "">Non-infrastructure transaction.</div>';
				}
				
			}else{
				
				$sheet = '<div style = "">No record found.</div>';
			}
			
			return $sheet;
		}

	//---------------------------------------------------------------------------------------------------INFRA PAYMENT TYPE B - START
		function createIpbInfraTNList($record, $batchNumbers) {
			$sheet = "<option></option>";
			while($data = $this->fetch_array($record)) {
				$trackingNumber = $data['TrackingNumberInfra'];
				$project = $data['Name'];

				$sheet .= "<option value='".$batchNumbers[$trackingNumber]."'><span>".$trackingNumber."</span>&nbsp;&nbsp;".$project."</option>";
			}
			unset($data);
			unset($batchNumbers);
			echo $sheet;
		}

		
	//---------------------------------------------------------------------------------------------------INFRA PAYMENT TYPE B - END

	//---------------------------------------------------------------------------------------------------INFRA VIEWER - START
		
		function createInfraViewerMultipleView($project) {
			// Construction of Type "A"
			$row = 0;
			$sheet = "<table id='infraViewerResults' border='0' cellpadding='0' cellspacing='0' style=''>
						<thead>
							<th></th>
							<th>TN</th>
							<th>Fund</th>
							<th>Year</th>
							<th>Code</th>
							<th>Type</th>
							<th>Project</th>
							<th>Location</th>
							<th>Contractor</th>
							<th>Progress</th>
							<th>Inspector</th>
							<th>Programmer</th>
						</thead>
						<tbody>";

			foreach ($project as $tn => $val) {
				$fundYear = $val['FundYear'];
				$fund = $val['Fund'];
				$code = $val['Code'];
				$title = $val['Title'];
				$location = $val['Location'];
				$contractor = $val['Contractor'];
				$progress = $val['Progress'];
				$inspector = $val['Inspector'];
				$programmer = $val['Programmer'];
				$expCode = $val['ExpCode'];
				$expTitle = $val['ExpTitle'];

				$displayTN = $tn;
				if(substr($tn, 0, 7) == 'infraTN') {
					$displayTN = '';
				}

				$sheet .= "	<tr>
								<td style=''>".++$row."</td>
								<td style='font-weight:bold; white-space:nowrap; vertical-align:top;'>".$displayTN."</td>
								<td>".$fund."</td>
								<td>".$fundYear."</td>
								<td>".$code."</td>
								<td>".$expTitle."</td>
								<td>".$title."</td>
								<td>".$location."</td>
								<td>".$contractor."</td>
								<td style='font-weight:bold; text-align:center;'>".$progress."</td>
								<td>".$inspector."</td>
								<td>".$programmer."</td>
							</tr>";
			}	

			$sheet .="	</tbody>
					  </table>";

			echo $sheet;

		}

		// function createInfraViewerDetailedView($record, $record1, $progTitle, $fundYear) {
		// 	$data = $this->fetch_array($record);
		// 	$tn = $data['TrackingNumber'];
		// 	$claimant = $data['Claimant'];
		// 	$pCost = $data['Amount'];
		// 	$aCost = $data['NetAmount'];
		// 	$fund = $data['Fund'];
		// 	$progCode = $data['PR_ProgramCode'];
		// 	$acctCode = $data['PR_AccountCode'];
		// 	unset($data);

		// 	$data = $this->fetch_array($record1);
		// 	$currentProgress = $data['Progress'];
		// 	$variation = $data['Variation'];
		// 	$unperformed = $data['Unperformed'];
		// 	unset($data);

		// 	$sheet = "<table border='0' cellpadding='0' cellspacing='0' style=''>";

		// 	$sheet .="	
		// 				<tr>
		// 					<td style='width:175px; color:rgb(12, 113, 172)'><span style='color:grey;' class='labelProjectNumber'>1</span>TN</td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>2</span>Const</td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>3</span></td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>4</span></td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>5</span></td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>6</span></td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>7</span></td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>8</span></td>
		// 					<td></td>
		// 				</tr>
		// 				<tr>
		// 					<td style='color:rgb(41, 111, 152);'><span style='color:grey;' class='labelProjectNumber'>9</span></td>
		// 					<td></td>
		// 				</tr>
		// 			";

		// 	$sheet .="</table>";
		// }

	//---------------------------------------------------------------------------------------------------INFRA VIEWER - END

	//---------------------------------------------------------------------------------------------------MOBILE PUBLIC SEARCH - START
	
	function CreatePublicTableMultipleMobileVouchers($record, $cnt) {
		$sheet = "";
		$rows = 0;
		foreach ($record as $tn => $data) {
			$id = $data['Id'];
			$trackingNumber = $data['TrackingNumber'];
			$claimant = $data['Claimant'];
			$status = $data['Status'];
			$period = $data['Period'];
			$docType = $data['DocumentType'];
			$dateEncoded = $data['DateEncoded'];
			$dateModified = $data['DateModified'];
			$officeName = $data['OfficeName'];
			$remarks = $data['Remarks'];
			$year = $data['Year'];

			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' class='resultsItems' style='border:1px solid rgba(70,70,70,1); padding:2px;'>
							<tr style='background-color:rgba(34,79,131,1);'>
								<td style='width:20px; background-color:rgb(74, 133, 203); padding:4px 5px 2px 5px; color:white; text-align:center; font-size:16px;'>
									".++$cnt."
								</td>
								<td style='padding-left:10px;'>
									TN : <span style='font-weight:bold; color:rgba(80,163,223,1); letter-spacing:1px;'>".$trackingNumber."</span>
								</td>
								<td style='width:10px; background-color:rgba(24,57,94,1); padding:3px 5px 1px 5px; text-transform:uppercase; font-size:12px;'>
									".$period."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-top:1px solid black; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px; color:orange; text-transform:uppercase; font-weight:bold;'>
									".$status."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$claimant."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$docType."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$officeName."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px;padding-top:5px;'>
									<div onclick='getGenDetailsVouchers(\"".$trackingNumber."\", this)' style='text-align:left; font-size:8px; line-height:12px; color:rgb(79,221,90,1); letter-spacing:1px;  padding-bottom:3px; padding-left:5px;'>&#x2b;&nbsp;SHOW MORE</div>
									<div class='showMoreContainer'></div>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='padding:3px 5px; border-top:1px solid rgba(122,122,122, .5);'>
									<table border='0' cellpadding='0' cellspacing='0' style='font-family:NOR; font-size:11px; color:white; margin:0px 0px 0px auto;'>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Date Encoded :</td>
											<td style='padding-left:5px;'>".$dateEncoded."</td>
										</tr>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Last Updated :</td>
											<td style='padding-left:5px;'>".$dateModified."</td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='text-align:center; font-family:NOR; text-align:right; padding:.5rem 0px; border-top:1px solid rgba(122,122,122,.1);'>
									<div onclick='mobileRegisterToThisTracking(\"".$trackingNumber."\", \"".$year."\", this)' style='padding:3px 3px 3px 5px; font-size:12px; display:inline-block; letter-spacing:1px; cursor:pointer; color:#cdc56d;'>Keep me updated on this transaction &#x1F514;</div>
								</td>
							</tr>
						</table>
						";
			++$rows;
		}

		if(($cnt - 10) > -1) {
			if($rows == 10) {
				$sheet .= "<span onclick='getLoadMoreVouchers(this)' style='display:inline-block; font-size:12px; color:white; user-select:none; line-height:12px;'>LOAD MORE<br/>&#9660</span>";
			}else {
				$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
			}
		}else {
			$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
		}

		$sheet .= "<span id='lastIdVouchers' style='display:none;'>".$id."</span>";
		$sheet .= "<span id='lastIdCount' style='display:none;'>".$cnt."</span>";

		return $sheet;
	}

	function CreatePublicTableMultipleMobileGoods($record, $cnt) {
		$sheet = "";
		$rows = 0;
		foreach ($record as $tn => $data) {
			$id = $data['Id'];
			$trackingNumber = $data['TrackingNumber'];
			$claimant = $data['Claimant'];
			$status = $data['Status'];
			$period = $data['Period'];
			$docType = $data['DocumentType'];
			$dateEncoded = $data['DateEncoded'];
			$dateModified = $data['DateModified'];
			$officeName = $data['OfficeName'];
			$remarks = $data['Remarks'];
			$year = $data['Year'];


			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' class='resultsItems' style='border:1px solid rgba(70,70,70,1); padding:2px;'>
							<tr style='background-color:rgba(34,79,131,1);'>
								<td style='width:20px; background-color:rgb(74, 133, 203); padding:4px 5px 2px 5px; color:white; text-align:center; font-size:16px;'>
									".++$cnt."
								</td>
								<td style='padding-left:10px;'>
									TN : <span style='font-weight:bold; color:rgba(80,163,223,1); letter-spacing:1px;'>".$trackingNumber."</span>
								</td>
								<td style='width:10px; background-color:rgba(24,57,94,1); padding:3px 5px 1px 5px; text-transform:uppercase; font-size:12px;'>
									".$period."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-top:1px solid black; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px; color:orange; text-transform:uppercase; font-weight:bold;'>
									".$status."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$claimant."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$docType."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$officeName."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px;padding-top:5px;'>
									<div onclick='getGenDetailsGoods(\"".$trackingNumber."\", this)' style='text-align:left; font-size:8px; line-height:12px; color:rgb(79,221,90,1); letter-spacing:1px;  padding-bottom:3px; padding-left:5px;'>&#x2b;&nbsp;SHOW MORE</div>
									<div class='showMoreContainer'></div>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='padding:3px 5px; border-top:1px solid rgba(122,122,122, .5);'>
									<table border='0' cellpadding='0' cellspacing='0' style='font-family:NOR; font-size:11px; color:white; margin:0px 0px 0px auto;'>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Date Encoded :</td>
											<td style='padding-left:5px;'>".$dateEncoded."</td>
										</tr>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Last Updated :</td>
											<td style='padding-left:5px;'>".$dateModified."</td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='text-align:center; font-family:NOR; text-align:right; padding:.5rem 0px; border-top:1px solid rgba(122,122,122,.1);'>
									<div onclick='mobileRegisterToThisTracking(\"".$trackingNumber."\", \"".$year."\", this)' style='padding:3px 3px 3px 5px; font-size:12px; display:inline-block; letter-spacing:1px; cursor:pointer; color:#cdc56d;'>Keep me updated on this transaction &#x1F514;</div>
								</td>
							</tr>
						</table>
						";
			++$rows;
		}

		if(($cnt - 10) > -1) {
			if($rows == 10) {
				$sheet .= "<span onclick='getLoadMoreVouchers(this)' style='display:inline-block; font-size:12px; color:white; user-select:none; line-height:12px;'>LOAD MORE<br/>&#9660</span>";
			}else {
				$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
			}
		}else {
			$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
		}

		$sheet .= "<span id='lastIdVouchers' style='display:none;'>".$id."</span>";
		$sheet .= "<span id='lastIdCount' style='display:none;'>".$cnt."</span>";

		return $sheet;
	}

	function CreatePublicTableMultipleMobileInfra($record, $cnt) {
		$sheet = "";
		$rows = 0;
		foreach ($record as $tn => $data) {
			$id = $data['Id'];
			$trackingNumber = $data['TrackingNumber'];
			$claimant = $data['Claimant'];
			$status = $data['Status'];
			$period = $data['Period'];
			$docType = $data['DocumentType'];
			$dateEncoded = $data['DateEncoded'];
			$dateModified = $data['DateModified'];
			$officeName = $data['OfficeName'];
			$prMonth = $data['PR_Month'];
			$month = $this->numberToMonth($prMonth);
			$remarks = $data['Remarks'];
			$year = $data['Year'];


			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' class='resultsItems' style='border:1px solid rgba(70,70,70,1); padding:2px; padding-bottom:5px;'>
							<tr style='background-color:rgba(34,79,131,1);'>
								<td style='width:20px; background-color:rgb(74, 133, 203); padding:4px 5px 2px 5px; color:white; text-align:center; font-size:16px;'>
									".++$cnt."
								</td>
								<td style='padding-left:10px;'>
									TN : <span style='font-weight:bold; color:rgba(80,163,223,1); letter-spacing:1px;'>".$trackingNumber."</span>
								</td>
								<td style='width:10px; background-color:rgba(24,57,94,1); padding:3px 5px 1px 5px; text-transform:uppercase; font-size:12px;'>
									".$month."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-top:1px solid black; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px; color:orange; text-transform:uppercase; font-weight:bold;'>
									".$status."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$claimant."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$docType."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$officeName."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px;padding-top:5px;'>
									<div onclick='getGenDetailsInfra(\"".$trackingNumber."\", this)' style='text-align:left; font-size:8px; line-height:12px; color:rgb(79,221,90,1); letter-spacing:1px;  padding-bottom:3px; padding-left:5px;'>&#x2b;&nbsp;SHOW MORE</div>
									<div class='showMoreContainer'></div>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='padding:3px 5px; border-top:1px solid rgba(122,122,122, .5);'>
									<table border='0' cellpadding='0' cellspacing='0' style='font-family:NOR; font-size:11px; color:white; margin:0px 0px 0px auto;'>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Date Encoded :</td>
											<td style='padding-left:5px;'>".$dateEncoded."</td>
										</tr>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Last Updated :</td>
											<td style='padding-left:5px;'>".$dateModified."</td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='text-align:center; font-family:NOR; text-align:right; padding:.5rem 0px; border-top:1px solid rgba(122,122,122,.1);'>
									<div onclick='mobileRegisterToThisTracking(\"".$trackingNumber."\", \"".$year."\", this)' style='padding:3px 3px 3px 5px; font-size:12px; display:inline-block; letter-spacing:1px; cursor:pointer; color:#cdc56d;'>Keep me updated on this transaction &#x1F514;</div>
								</td>
							</tr>
						</table>
						";
			++$rows;
		}



		if(($cnt - 10) > -1) {
			if($rows == 10) {
				$sheet .= "<span onclick='getLoadMoreInfra(this)' style='display:inline-block; font-size:12px; color:white; user-select:none; line-height:12px;'>LOAD MORE<br/>&#9660</span>";
			}else {
				$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
			}
		}else {
			$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
		}

		$sheet .= "<span id='lastIdInfra' style='display:none;'>".$id."</span>";
		$sheet .= "<span id='lastIdCount' style='display:none;'>".$cnt."</span>";

		return $sheet;
	}

	function CreatePublicTableMultipleMobilePayroll($record, $cnt, $tnList) {
		$sheet = "";
		$rows = 0;
		foreach ($record as $tn => $data) {
			$id = $data['Id'];
			$trackingNumber = $data['TrackingNumber'];
			$claimant = $data['Claimant'];
			$status = $data['Status'];
			$period = $data['Period'];
			$docType = $data['DocumentType'];
			$dateEncoded = $data['DateEncoded'];
			$dateModified = $data['DateModified'];
			$officeName = $data['OfficeName'];
			$remarks = $data['Remarks'];
			$year = $data['Year'];

			$tnList = str_replace(",'".$trackingNumber."'", "", $tnList);

			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' class='resultsItems' style='border:1px solid rgba(70,70,70,1); padding:2px; padding-bottom:5px;'>
							<tr style='background-color:rgba(34,79,131,1);'>
								<td style='width:20px; background-color:rgb(74, 133, 203); padding:4px 5px 2px 5px; color:white; text-align:center; font-size:16px;'>
									".++$cnt."
								</td>
								<td style='padding-left:10px;'>
									TN : <span style='font-weight:bold; color:rgba(80,163,223,1); letter-spacing:1px;'>".$trackingNumber."</span>
								</td>
								<td style='width:10px; background-color:rgba(24,57,94,1); padding:3px 5px 1px 5px; text-transform:uppercase; font-size:12px;'>
									".$period."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-top:1px solid black; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px; color:orange; text-transform:uppercase; font-weight:bold;'>
									".$status."
								</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$claimant."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$docType."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px; border-bottom:1px solid rgba(122,122,122, .5); padding:3px 5px;'>".$officeName."</td>
							</tr>
							<tr>
								<td colspan='3' style='font-family:NOR; font-size:13px;padding-top:5px;'>
									<div onclick='getGenDetailsPayroll(\"".$trackingNumber."\", this)' style='text-align:left; font-size:8px; line-height:12px; color:rgb(79,221,90,1); letter-spacing:1px;  padding-bottom:3px; padding-left:5px;'>&#x2b;&nbsp;SHOW MORE</div>
									<div class='showMoreContainer'></div>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='padding:3px 5px; border-top:1px solid rgba(122,122,122, .5);'>
									<table border='0' cellpadding='0' cellspacing='0' style='font-family:NOR; font-size:11px; color:white; margin:0px 0px 0px auto;'>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Date Encoded :</td>
											<td style='padding-left:5px;'>".$dateEncoded."</td>
										</tr>
										<tr>
											<td style='color:#8f8888; text-align:right;'>Last Updated :</td>
											<td style='padding-left:5px;'>".$dateModified."</td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td colspan='3' style='text-align:center; font-family:NOR; text-align:right; padding:.5rem 0px; border-top:1px solid rgba(122,122,122,.1);'>
									<div onclick='mobileRegisterToThisTrackingPayroll(\"".$trackingNumber."\", \"".$year."\", this)' style='padding:3px 3px 3px 5px; font-size:12px; display:inline-block; letter-spacing:1px; cursor:pointer; color:#cdc56d;'>Keep me updated on this transaction &#x1F514;</div>
								</td>
							</tr>
						</table>
						";
			++$rows;
		}

		if(($cnt - 10) > -1) {
			if($rows == 10) {
				$sheet .= "<span onclick='getLoadMorePayroll(this)' style='display:inline-block; font-size:12px; color:white; user-select:none; line-height:12px;'>LOAD MORE<br/>&#9660</span>";
			}else {
				$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
			}
		}else {
			$sheet .= "<span style='font-size:12px; line-height:10px; color:rgba(104,104,104,1); user-select:none;'>NOTHING FOLLOWS<br/ >&#8943;</span>";
		}

		$sheet .= "<span id='lastIdPayroll' style='display:none;'>".$id."</span>";
		$sheet .= "<span id='lastIdCount' style='display:none;'>".$cnt."</span>";
		$sheet .= "<span id='lastTNList' style='display:none;'>".$tnList."</span>";

		return $sheet;
	}

	function createPublicMobileGenDetails($record) {
		$sheet = "";
		$adv = $record['ADV1'];
		$obr = $record['OBR_Number'];
		$fund = $record['Fund'];
		$fundYear = $record['FundYear'];
		$rows = "";

		if($adv != "" && $adv != 0) {
			$rows .= "	<tr>
							<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver;'>ADV</td>
							<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5);'>".$adv."</td>
						</tr>";
		}

		if($obr != "") {
			$rows .= "	<tr>
							<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver;'>OBR</td>
							<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5);'>".$obr."</td>
						</tr>";
		}

		if($fund != "") {
			$rows .= "	<tr>
							<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver;'>Fund</td>
							<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5);'>".$fund."</td>
						</tr>";
		}

		if($fundYear != "") {
			$rows .= "	<tr>
							<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver; white-space:nowrap;'>Budget Year</td>
							<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5);'>".$fundYear."</td>
						</tr>";
		}

		if($rows != "") {
			$sheet .= "	<div style='margin:10px 0px 0px 0px; background:linear-gradient(to right, rgba(0,0,0,.5), transparent); padding:3px 5px;'>DETAILS</div>";
			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' style='color:white; margin:0px auto; width:100%; font-size:12px;'>
							".$rows."
						</table>";
		}else {
			$sheet .= "<div style = 'color:white; font-size:26px; display:block; margin:1rem 0; text-align:center; text-shadow:0px 2px 2px black;'>Not Available.</div>";
		}

		return $sheet;
	}

	function createPublicMobileCheckDetails($record) {
		$sheet = "";
		$checkNm = $record['checknumber'];
		$checkDt = $record['checkdate'];
		$netAmount = $record['NetAmount'];
		$rows = "";

		if($checkNm != "" && $checkDt != "" && $netAmount != "") {
			$sheet .= "	<div style='margin:10px 0px 0px 0px; background:linear-gradient(to right, rgba(0,0,0,.5), transparent); padding:3px 5px;'>CHECK DETAILS</div>";
			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' style='color:white; margin:0px auto; width:100%; font-size:12px;'>
							<tr>
								<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver; white-space:nowrap;'>Check Date</td>
								<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5);'>".$checkDt."</td>
							</tr>
							<tr>
								<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver; white-space:nowrap;'>Check No.</td>
								<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5);'>".$checkNm."</td>
							</tr>
							<tr>
								<td style='width:10px; padding:3px 5px; padding-left:8px; color:silver;'>Amount</td>
								<td style='padding:2px 5px; border-bottom:1px dashed rgba(122,122,122, .5); /*color:rgb(98,169,231);*/ color:rgb(255,189,89);'>".$this->zeroToEmpty(number_format($netAmount,2))."</td>
							</tr>
						</table>";
		}

		return $sheet;

	}

	function createPublicMobilePendingNote($record) {
		$sheet = "";
		$remarks = $record['Remarks'];
		$rows = "";

		if($remarks != "") {
			$sheet .= "	<div style='margin:10px 0px 0px 0px; background:linear-gradient(to right, rgba(0,0,0,.5), transparent); padding:3px 5px;'>ALL NOTES</div>";
			$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' style='color:white; margin:0px auto; width:100%; font-size:12px;'>
							<tr>
								<td style='font-family:NOR; font-size:12px; padding:3px 5px; color:#8f8888; border:1px solid rgba(34,79,131,.2); border-top:0px;'>
									".nl2br(strip_tags(preg_replace('/<br\s?\/?>/i', "\r\n", $remarks)))."
								</td>
							</tr>
						</table>";
		}

		return $sheet;
	}

	function createPublicMobileOBR($record) {
		$sheet = "";
		$total = 0;
		$sheet .= "	<div style='margin:10px 0px 0px 0px; background:linear-gradient(to right, rgba(0,0,0,.5), transparent); padding:3px 5px;'>BUDGET DETAILS</div>";
		$sheet .= "	<table border='0' cellpadding='0' cellspacing='0' style='margin:0px auto; color:white; width:100%; font-size:11px; border:1px solid rgba(34,79,131,.2); padding:1px 0px;'>
						<tbody>";
		foreach ($record as $prog => $value1) {
			if($prog != "Total") {
				$row = 0;
				$sheet .= "	<tr>
								<td colspan='3' style='padding:1px 0px; padding-left:8px; border-bottom:1px solid rgba(122,122,122,.5); background-color:rgba(34,79,131,.2); font-size:11px;'>
									".$prog." - ".$value1['Title']."
								</td>
							</tr>";
				foreach ($value1 as $acct => $value2) {

					$bcg = "";
					if($row%2 != 1) {
						$bcg = "background-color:rgba(255,255,255,.1);";
					}

					if($acct != "Title") {
						$sheet .= "	<tr style='".$bcg."'>
										<td style=''></td>
										<td style='padding:2px 5px; vertical-align:top; text-align:right; color:silver;'>".$value2['Title']."</td>
										<td style='padding:2px 5px; vertical-align:top; width:0px; text-align:right; border-left:1px solid rgba(0,0,0,.2);'>
											".$this->zeroToEmpty(number_format($value2['Amount'],2))."
										</td>
									</tr>";
					}

					$row++;
				}
			}else {
				$total = $record['Total'];
			}
		}

		$sheet .= "	<tr style=''>
						<td style='border-top:1px solid gray; width:10px;'></td>
						<td style='border-top:1px solid gray; padding:2px 5px; vertical-align:top; text-align:right;'></td>
						<td style='border-top:1px solid gray; padding:2px 5px; vertical-align:top; text-align:right; color:rgb(255,189,89); border-left:1px solid rgba(0,0,0,.2);'>
							".$this->zeroToEmpty(number_format($total,2))."
						</td>
					</tr>";

		$sheet .= "		</tbody>
					</table>";

		return $sheet;
	}

	function createPublicMobileHistory($record) {
		$sheet = "";
		$sheet .= "<div style='margin:10px 0px 0px 0px; background:linear-gradient(to right, rgba(0,0,0,.5), transparent); padding:3px 5px;'>TRANSACTION HISTORY</div>";
		$sheet .= "<table border='0' style='margin:0px auto; color:white; width:100%; font-size:11px; border-spacing:1px 0px; border:1px solid rgba(34,79,131,.2); padding:1px 0px;'>
					<thead style='background-color:rgba(34,79,131,.2); color:silver; font-size:12px;'>
						<th style='border-bottom:1px solid rgba(122,122,122,.5);'></th>
						<th style='padding:1px 5px; text-align:left; border-bottom:1px solid rgba(122,122,122,.5); font-weight:normal;'>Status</th>
						<th style='padding:1px 5px; text-align:left; border-bottom:1px solid rgba(122,122,122,.5); font-weight:normal;'>Date</th>
					</thead>
					<tbody>";
		$row = 0;
		while ($data = $this->fetch_array($record)) {
			$dateModified = $data['DateModified'];
			$status = $data['Status'];
			$completion = $data['Completion'];
			
			$bcg = "";
			if($row%2 != 0) {
				$bcg = "background-color:rgba(255,255,255,.1);";
			}

			$sheet .= "	<tr style='".$bcg."'>
							<td style='padding:2px 5px; padding-left:8px; vertical-align:top; width:0px; background-color:rgba(24,57,94,.5);'>".++$row."</td>
							<td style='padding:2px 5px; vertical-align:top;'>".$status."</td>
							<td style='padding:2px 5px; vertical-align:top; width:0px; white-space:nowrap;'>".$dateModified."</td>
						</tr>";
		}
		$sheet .= "	</tbody>
				   </table>";

		return $sheet;
	}

	function createPublicMobileProgress($record) {
		$trackingType = $record['TrackingType'];
		$status = $record['Status'];
		$claimType = $record['ClaimType'];
		$mode = $record['ModeOfProcurement'];
		$fund = $record['Fund'];
		$docType = $record['DocumentType'];
		$fontSize = "";

		$sheet = "";
		$sheet .= "<div style='margin:10px 0px 0px 0px; background:linear-gradient(to right, rgba(0,0,0,.5), transparent); padding:3px 5px;'>PROGRESS</div>";

		if($trackingType == "PO"){
			$array = array(

						"1*Tracking - Office" => 'Encoded', 
						"2*Received - GSO" => 'GSO Received', 
						"x*GSO Pending" => 'Pending at GSO',
						"x*Pending Released - GSO" => 'Pending Released - GSO',
						
						"3*For Signature - CMO" => 'Forwarded to CMO', 
						"4*Approved - CMO" => 'CMO Approved',
						"5*PO Served - GSO" => 'Served to Supplier',
						"6*Supplier Conformed - GSO" => 'Supplier Conformed',
													
						"7*Appropriation Recording - CBO" => 'Fund Control',
						"x*Pending at CBO" => 'Pending at CBO', 
						"x*Pending Released - CBO" => 'Pending Released - CBO', 

						"8*Payment Preparation - Office" => 'Waiting for Delivery',
						
						"9*For Inspection - GSO" => 'For Inspection',
						
						"10*Inspection - GSO" => 'Inspected',
						"x*Pending Inspection - GSO" => 'Pending at GSO - Inspection',
						"x*Pending Released - Inspection" => 'Pending Released - Inspection',
						
						"11*Inventory - GSO" => 'Inventory',
						"x*Pending Inventory - GSO" => 'Pending at GSO - Inventory',
						"x*Pending Released - Inventory" => 'Pending Released - Inventory',
						
						"12*Received - CAO" => 'CAO Received',
						
						"x*Accounting Pending" => 'Pending at CAO',
						"x*Pending Released - CAO" => 'Pending Released - CAO',
						
						
						"13*Released - CAO" => 'Forwarding Transmittal',
						"14*Check Preparation - CTO" => 'Check Preparation - CTO'
						
				);
				if($status == "Forwarded to Admin - Operation"){ 
					
					$array["15*Check for Signature"] = 'Forwarded to Admin - Operation';
					$array["16*Check Advised"] = 'Check Advised';
					
				}else if($status == "Forwarded to Admin - Administration"){
					$array["15*Check for Signature"] = 'Forwarded to Admin - Administration';
					$array["16*Check Advised"] = 'Check Advised';
				}else if($status == "Forwarded to SP - Admin"){
					$array["15*Check for Signature"] = 'Forwarded to SP - Admin';
					$array["16*Check Advised"] = 'Check Advised';
				}else{
					$array["15*Check for Signature"] = '';
					$array["16*Check Advised"] = 'Check Advised';
				}
				$array["17*Check Released"] = 'Check Released';
		}

		if($trackingType == "PY"){
			if(strtoupper($claimType) == "CHECK"){
				if($docType != 'BOND - RETENTION MONEY') {
					$array = array(
						"1*Encoded" => 'Encoded', 
						"2*CBO Received" => 'CBO Received', 
						"x*Pending at CBO" => 'Pending at CBO', 
						"x*Pending Released - CBO" => 'Pending Released - CBO', 
						"3*CBO Released" => 'CBO Released', 
						"4*Accounting Received" => 'CAO Received',
						"x*Pending at CAO" => 'Pending at CAO', 
						"x*Pending Released - CAO" => 'Pending Released - CAO', 
						"5*Released - CAO" => 'Forwarding Transmittal',
						
						"6*Check Preparation" => 'Check Preparation - CTO'
						
					);
					
					if($status == "Forwarded to Admin - Operation"){
						
						$array["7*Check for Signature"] = 'Forwarded to Admin - Operation';
						$array["8*Check Advised"] = 'Check Advised';
						
					}else if($status == "Forwarded to Admin - Administration"){
						$array["7*Check for Signature"] = 'Forwarded to Admin - Administration';
						$array["8*Check Advised"] = 'Check Advised';
					}else if($status == "Forwarded to SP - Admin"){
						$array["7*Check for Signature"] = 'Forwarded to SP - Admin';
						$array["8*Check Advised"] = 'Check Advised';
					}else{
						$array["7*Check for Signature"] = '';
						$array["8*Check Advised"] = 'Check Advised';
					}
					$array["9*Check Released"] = 'Check Released';
				}else {
					$array = array(
							"1*Encoded" => 'Encoded', 
							"2*Accounting Received" => 'CAO Received',
							"x*Pending at CAO" => 'Pending at CAO', 
							"x*Pending Released - CAO" => 'Pending Released - CAO', 
							"3*CAO Released" => 'CAO Released');
				}
				
				
			}else if(strtoupper($claimType) == "WINDOW"){
				$array = array(
						"1*Encoded" => 'Encoded', 
						"2*CBO Received" => 'CBO Received', 
						"x*Pending at CBO" => 'Pending at CBO', 
						"x*Pending Released - CBO" => 'Pending Released - CBO', 
						"3*CBO Released" => 'CBO Released', 
						"4*Accounting Received" => 'CAO Received',
						"x*Pending at CAO" => 'Pending at CAO', 
						"x*Pending Released - CAO" => 'Pending Released - CAO', 
						"5*Forwarded to CTO" => 'Forwarded to CTO');
			}else{
				$array = array(
						"1*Encoded" => 'Encoded', 
						"2*Accounting Received" => 'CAO Received',
						"x*Pending at CAO" => 'Pending at CAO', 
						"x*Pending Released - CAO" => 'Pending Released - CAO', 
						"3*CAO Released" => 'CAO Released');
			}
		}

		if($trackingType == "PR"){
			
			$stat = $status;
			if($status  == "Admin Received"){
				$label = "Admin Received";
			}else if($status  == "Forwarded to SP Admin - PR"){
				$label = "Forwarded to SP Admin";
			}else{
				$label = "Admin Received";
				$stat = "Admin Received";
			}
			$array = array(
					"1*Encoded" => 'Encoded',
					"2*CBO Received" => 'CBO Received', 
					"x*Pending at CBO" => 'Pending at CBO', 
					"x*Pending Released - CBO" => 'Pending Released - CBO', 
					"3*GSO Received" => 'GSO Received', 
					"x*Pending at GSO" => 'Pending at GSO', 
					"x*Pending Released - GSO" => 'Pending Released - GSO', 

					"4*GSO Released" => 'GSO Released',
					
					"5*CTO Received" => 'CTO Received', 
					"x*Pending at CTO" => 'Pending at CTO', 
					"x*Pending Released - CTO" => 'Pending Released - CTO',
					
					"6*" . $label .   "" => '' . $stat . '', 
					
					
					"x*Pending at Admin" => 'Pending at Admin', 
					"x*Pending Released - Admin" => 'Pending Released - Admin',  
					
					"6*Forwarding to BAC" => 'Forwarding to BAC', 
					"7*BAC Received" => 'BAC Received', 
					"x*Pending at BAC" => 'Pending at BAC', 
					"x*Pending Released - BAC" => 'Pending Released - BAC',
					
					"8*BAC Deliberation" => 'BAC Deliberation', 
					"x*Pending at Deliberation" => 'Pending at Deliberation', 
					"x*Pending Released - Deliberation" => 'Pending Released - Deliberation'
					
			);
			if($mode == 1){ //bidding
				$array["9*BAC Bidding Process"] = 'BAC Bidding Process';
				$array["x*Failed Bid"] = 'Failed Bid';
				$array["x*Failed Bid Released"] = 'Failed Bid Released';
				$array["10*BAC Canvas Signed"] = 'BAC Canvas Signed';
				$array["11*BAC for P.O"] = 'PR for P.O';
			}
			if($mode >= 2 and $mode < 15){
				$array["9*BAC Canvassing"] = 'BAC Canvassing';
				$array["10*BAC Canvas Complete"] = 'BAC Canvas Complete';
				$array["11*Office Review Canvas"] = 'Office Review Canvas';
				$array["12*BAC Received Abstract"] = 'BAC Received Abstract';
				$array["x*Pending Abstract"] = 'Pending Abstract';
				$array["x*Pending Released Draft"] = 'Pending Released Draft';
				$array["13*BAC Awarding"] = 'BAC Awarding';
				$array["14*BAC For Final Abstract"] = 'BAC For Final Abstract';
				$array["15*Office Final Abstract"] = 'Office Final Abstract';
				$array["16*BAC Received Final Abstract"] = 'BAC Received Final Abstract';
				$array["x*Pending Final Abstract"] = 'Pending Abstract';
				$array["x*Pending Released Final Abstract"] = 'Pending Released Final Abstract';
				
				$array["17*BAC Signed"] = 'BAC Signed';
				$array["18*For P.O"] = 'For P.O';
			}	
			if($mode >= 15){
				$array["9*For P.O"] = 'For P.O';
			}		
		}

		if($trackingType == "NF"){
			$array = array(
					"1*Project Encoded" => "Project Encoded",
					"2*Requesting for Fund Certification" => "Requesting for Fund Certification",
					"3*Acknowledge Certification Request" => "Acknowledge Certification Request",
					"4*Fund Certification Signed" => "Fund Certification Signed",
					"5*Schedule for Inspection - CEO" => "Schedule for Inspection",
					"6*For Inspection - CEO" => "For Inspection",
					"x*Inspected - Not Feasible - CEO" => "Inspected - Not Feasible",
					"7*Preparation of Plans, PoW, and Detailed Estimates - CEO" => "Preparation of Plans, PoW, and Detailed Estimates",
					"8*Plans, PoW, and Detailed Estimates for Approval - Admin" => "Plans, PoW, and Detailed Estimates for Approval",
					"9*Plans, PoW, and Detailed Estimates Signed - Admin" => "Plans, PoW, and Detailed Estimates Signed",
					"10*For BAC Procedures - CEO" => "For BAC Procedures",
					"11*Drafting Invitation to Bid - BAC Secretariat" => "Drafting Invitation to Bid",
					"12*Checking Invitation to Bid - CEO" => "Checking Invitation to Bid",
					"13*Invitation to Bid for Adjustment - CEO" => "Invitation to Bid for Adjustment",
					"14*Invitation to Bid for Pick-up - CEO" => "Invitation to Bid for Pick-up",
					"15*Invitation to Bid for Transmit - BAC Secretariat" => "Invitation to Bid for Transmit",
					"16*Invitation to Bid for Signature - BAC Chairman" => "Invitation to Bid for Signature",
					"17*Invitation to Bid Signed - BAC Chairman" => "Invitation to Bid Signed",
					"18*Posting - BAC Secretariat" => "Posting",
					"19*Bidding Schedule - BAC Secretariat" => "Bidding Schedule",
					"20*Post Qualification - BAC Secretariat" => "Post Qualification",
					"21*Letters for Signature - BAC Chairman" => "Letters for Signature",
					"22*Letters Signed - BAC Chairman" => "Letters Signed",
					"23*Notice of Award for Transmit - BAC Secretariat" => "Notice of Award for Transmit",
					"24*Notice of Award for Admin Signature - Admin" => "Notice of Award for Admin Signature",
					"25*Notice of Award Admin Signed - Admin" => "Notice of Award Admin Signed",
					"26*NoA and Contract for Contractor's Signature - BAC Secretariat" => "NoA and Contract for Contractor's Signature",
					"27*NoA and Contract Released to Contractor" => "NoA and Contract Released to Contractor",
					"28*NoA and Contract Contractor Signed - BAC Secretariat" => "NoA and Contract Contractor Signed",
					"29*Obligation Request Preparation - CEO" => "Obligation Request Preparation",
					"30*OBR for Implementing Office Signature - CEO" => "OBR for Implementing Office Signature",
					"31*OBR for Implementing Office Signed - CEO" => "OBR for Implementing Office Signed",
					"32*CBO Received - CBO" => "CBO Received",
					"x*Pending at CBO" => "Pending at CBO",
					"x*Pending Released - CBO" => "Pending Released - CBO", 
					"33*Obligation request for Pick-up" => "Obligation request for Pick-up",
					"34*Obligation Request Signed - BAC Secretariat" => "Obligation Request Signed",
					"35*Contract and NTP for City Engineer's Signature - CEO" => "Contract and NTP for City Engineer's Signature",
					"36*Contract and NTP Signed - CEO" => "Contract and NTP Signed",
					"37*Document Filing - BAC Secretariat" => "Document Filing",
					"38*CAO Received" => "CAO Received",
					"x*Pending at CAO" => "Pending at CAO",
					"x*Pending Released - CAO" => "Pending Released - CAO", 
					"39*Document for Pick-up - CAO" => "Document for Pick-up - CAO",
					"40*Contract and NTP Transmit to Admin - BAC Secretariat" => "Contract and NTP Transmit to Admin",
					"41*Contract and NTP for Admin Signature - Admin" => "Contract and NTP for Admin Signature",
					"x*Pending at Admin" => "Pending at Admin",
					"x*Pending Released - Admin" => "Pending Released - Admin", 
					"42*Document for Pick-up - Admin" => "Document for Pick-up - Admin",
					"43*Contract for Notarization - BAC Secretariat" => "Contract for Notarization",
					"44*Released to Contractor for Notarization" => "Released to Contractor for Notarization",
					"45*Contract Notarized - BAC Secretariat" => "Contract Notarized",
					"46*Prepare Letter for Pick-up NTP - CEO" => "Prepare Letter for Pick-up NTP",
					"47*Forwarded Letter for Pick-up NTP - CEO" => "Forwarded Letter for Pick-up NTP",
					"48*NTP Released to Contractor" => "NTP Released to Contractor",
					"49*NTP Received from Contractor - CEO" => "NTP Received from Contractor",
					"50*NTP Forwarded to Construction Division - CEO" => "NTP Forwarded to Construction Division"
					);

			$fontSize = "font-size:8px;";
		}

		if($trackingType == "IP"){
			$array = array(
						"1*Encoded" => 'Encoded', 
						"2*Accounting Received" => 'CAO Received',
						"x*Pending at CAO" => 'Pending at CAO', 
						"x*Pending Released - CAO" => 'Pending Released - CAO', 
						"3*Released - CAO" => 'Forwarding Transmittal',
						"4*Check Preparation" => 'Check Preparation - CTO'
						);

			if($status == "Forwarded to Admin - Operation"){
				$array["5*Check for Signature"] = 'Forwarded to Admin - Operation';
				$array["6*Check Advised"] = 'Check Advised';
			}else if($status == "Forwarded to Admin - Administration"){
				$array["5*Check for Signature"] = 'Forwarded to Admin - Administration';
				$array["6*Check Advised"] = 'Check Advised';
			}else if($status == "Forwarded to SP - Admin"){
				$array["5*Check for Signature"] = 'Forwarded to SP - Admin';
				$array["6*Check Advised"] = 'Check Advised';
			}else{
				$array["5*Check for Signature"] = '';
				$array["6*Check Advised"] = 'Check Advised';
			}
			$array["7*Check Released"] = 'Check Released';
		}
		
		
		$sheet .= '<div style="padding:10px 8px 0px 8px; border:1px solid rgba(34,79,131,.2);">';
		$i =1;
		$mark = 0;
		foreach($array as $x => $x_value) {
			$arr = explode("*",$x);
			
			if($status == $x_value){
				if($arr[0] == 'x'){
					if($mark == 0){
						$sheet .= "<div class = 'sliderSelectedPending' style = '".$fontSize."'><div class = 'numberSlider'>" .  $i++ . "</div>&nbsp;&nbsp;" .  $arr[1] .  " </div>";
						$mark = 1;
					}
				}else{
					$sheet .= "<div class = 'sliderSelected' style = '".$fontSize."'><div class = 'numberSlider'>" .  $i++ . "</div>&nbsp;&nbsp;" .  $arr[1] .  " </div>";
				}	
			}else{
				if($arr[0] != 'x'){
					$sheet .= "<div class = 'slider' style = '".$fontSize."'><div class = 'numberSliderNone'>" .  $i++ . "</div>&nbsp;&nbsp;" .  $arr[1] .  " </div>";
				}
			}
		}

		$sheet .= '</div>';
		return $sheet;
	}
	
	//---------------------------------------------------------------------------------------------------MOBILE PUBLIC SEARCH - END

	//---------------------------------------------------------------------------------------------------INVENTORY VIEWER - START

	function generateInvViewerGenOnly($record, $header) {
		$sheet = "";
		$item = 0;

		$sheet .= "<table border='0' cellspacing='0' cellpadding='0' style='font-size: 12px; font-family:NOR; width:100%;'>";
		$sheet .= "	<tr style=''>
						<td style='border:1px solid silver; border-left:0px; border-right:0px; font-size: 14px; width:0px;'></td>
						<td style='border:1px solid silver; border-left:0px; border-right:0px; font-size: 14px; width:0px; padding:8px 0px; font-weight:bold;'>Details</td>
						<td style='border:1px solid silver; border-left:0px; border-right:0px; font-size: 14px; font-weight:bold;'>Description</td>
						";
		$sheet .= "</tr>";

		foreach ($record as $id => $details) {
			$rclr = "white";
			if ($item%2 != 0) {
				// $rclr = "rgb(234, 234, 220)";
				$rclr = "rgba(100,100,100,.1)";
			}

			$tn = $details['TrackingNumber'];
			
			$id = $details['Id'];
			$year = $details['Year'];
			$brand = $details['Brand'];
			$serial = $details['SerialNumber'];
			$propertyNumber = $details['PropertyNumber'];
			$sticker = $details['StickerNumber'];
			$currentUser = ucwords(strtolower($details['CurrentUser']));
			$assignedTo = ucwords(strtolower($details['NameAssignedTo']));
			$employeeNumber = $details['EmployeeNumber'];
			$status = $details['Status'];
			$remarks = $details['Remarks'];
			$dateAcquired = $details['DateAcquired'];

			if ($tn == 1) {
				$tn = "";
				$claimant = "";
				$poNumber = "";
				$poDate = "";
				$invoiceNumber = "";
				$invoiceDate = "";
				$status = "";
				$remarks = "";
			}

			// $sheet .= "	<tr style='background-color: ".$rclr.";' class='rowOnHover' onclick='invGetSingleItem(". $id .", ". $year .", \"".$tn."\", event, this)'>
			// 				<td style='vertical-align:top; font-size: 12px; width: 0px; text-align: center; padding: 8px 5px;'>".++$item."</td>
			// 				<td style='vertical-align:top; width:0px; padding: 8px 3px; font-size: 12px; border:2px solid white; border-top:0px; border-bottom:0px;'>
			// 					<table border='0' cellpadding='0' cellspacing='0' style='font-size:12px; width:100%;'>
			// 						<tr>
			// 							<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); text-align:right; width:0px; white-space:nowrap;'>Date Acquired :</td>
			// 							<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); font-weight:bold; white-space:nowrap;'>".$dateAcquired."</td>
			// 						</tr>
			// 						<tr>
			// 							<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); text-align:right; width:0px; white-space:nowrap;'>ARE To :</td>
			// 							<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); font-weight:bold; white-space:nowrap;'>".$assignedTo."</td>
			// 						</tr>
			// 					</table>
			// 				</td>
			// 				<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; word-wrap: break-word; vertical-align: top;'>
			// 					".nl2br($details['Description'])."
			// 				</td>
			// 			</tr>
			// 			";

			$sheet .= "	<tr style='background-color: ".$rclr.";'>
							<td style='vertical-align:top; font-size: 12px; width: 0px; text-align: center; padding: 8px 5px;'>".++$item."</td>
							<td style='vertical-align:top; width:0px; padding: 8px 3px; font-size: 12px; border:2px solid white; border-top:0px; border-bottom:0px;'>
								<table border='0' cellpadding='0' cellspacing='0' style='font-size:12px; width:100%;'>
									<tr>
										<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); text-align:right; width:0px; white-space:nowrap;'>Date Acquired :</td>
										<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); font-weight:bold; white-space:nowrap;'>".$dateAcquired."</td>
									</tr>
									<tr>
										<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); text-align:right; width:0px; white-space:nowrap;'>ARE To :</td>
										<td style='padding:0px 3px; border-bottom:1px solid rgba(200,200,200,.3); font-weight:bold; white-space:nowrap;'>".$assignedTo."</td>
									</tr>
									<tr>
										<td colspan='2' style='padding:0px; text-align:center;'>
											<span style='cursor:pointer; color:orange;' onMouseOver='this.style.fontWeight=\"bold\";' onMouseOut='this.style.fontWeight=\"normal\";' onClick='invGetSingleItemNew(". $id .", ". $year .", \"".$tn."\")'>
												More details
											</span>
										</td>
									</tr>
								</table>
							</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; word-wrap: break-word; vertical-align: top;'>
								".nl2br($details['Description'])."
							</td>
						</tr>
						";
		}

		$sheet .= "</table>";

		echo $header.$sheet;
	}

	function generateInvViewerView($record){
		$sheet = "";
		$item = 0;

		$sheet .= "<table border='0' cellspacing='0' cellpadding='0' style='font-size: 12px; font-family:NOR; width:100%;'>";
		$sheet .= "	<tr style=''>
						<td style='border-bottom:1px solid black; font-size: 14px;'></td>
						<td style='border-bottom:1px solid black; font-size: 14px; padding:8px 0px;'>Year</td>
						<td style='border-bottom:1px solid black; font-size: 14px;'>TN</td>
						<td style='border-bottom:1px solid black; font-size: 14px;'>Brand</td>
						<td style='border-bottom:1px solid black; font-size: 14px;'>Description</td>
						<td style='border-bottom:1px solid black; font-size: 14px;'>Serial</td>
						<td style='border-bottom:1px solid black; width: 120px; font-size: 14px;'>Property</td>
						<td style='border-bottom:1px solid black; width: 120px; font-size: 14px;'>Sticker</td>
						<td style='border-bottom:1px solid black; font-size: 14px;'>Details</td>
						<td style='border-bottom:1px solid black; font-size: 14px; white-space:nowrap;'>Assigned To</td>
						<td style='border-bottom:1px solid black; font-size: 14px; white-space:nowrap;'>Current User</td>
						<td style='border-bottom:1px solid black; font-size: 14px;'>Status</td>
						";
		$sheet .= "</tr>";

		foreach ($record as $id => $details) {
			$rclr = "white";
			if ($item%2 != 0) {
				$rclr = "rgb(234, 234, 220)";
			}

			$tn = $details['TrackingNumber'];
			
			$id = $details['Id'];
			$year = $details['Year'];
			$brand = $details['Brand'];
			$serial = $details['SerialNumber'];
			$propertyNumber = $details['PropertyNumber'];
			$sticker = $details['StickerNumber'];
			$currentUser = ucwords(strtolower($details['CurrentUser']));
			$assignedTo = ucwords(strtolower($details['NameAssignedTo']));
			$employeeNumber = $details['EmployeeNumber'];
			$status = $details['Status'];
			$remarks = $details['Remarks'];

			if ($tn == 1) {
				$tn = "";
				$claimant = "";
				$poNumber = "";
				$poDate = "";
				$invoiceNumber = "";
				$invoiceDate = "";
				$status = "";
				$remarks = "";
			}else {
				// $claimant = $tndetails[$year][$tn]['Claimant'];
				// $poNumber = $tndetails[$year][$tn]['PO_Number'];
				// $poDate = $tndetails[$year][$tn]['PoDate'];
				// $invoiceNumber = $tndetails[$year][$tn]['InvoiceNumber'];
				// $invoiceDate = $tndetails[$year][$tn]['InvoiceDate'];

				$claimant = "";
				$poNumber = "";
				$poDate = "";
				$invoiceNumber = "";
				$invoiceDate = "";
			}

			$poDetails = "";
			if($claimant != "") {
				$poDetails .= "	<table id = 'dataGridManage' border = '0' style='border-spacing:0;padding:0px; font-size: 12px; font-family: NOR; white-space:nowrap; width:100%;'>
								<tr><td colspan = '4' style = 'border-bottom:1px solid rgb(236, 239, 229);'>" . $claimant . "</td></tr><tr>
									<td style = 'text-align:right;color:grey;border-bottom:1px solid rgb(236, 239, 229);'>PO :</td><td style ='border-bottom:1px solid rgb(236, 239, 229);'>" . $poNumber . "</td><td style = 'border-bottom:1px solid rgb(236, 239, 229);text-align:right;color:grey;'>Date :</td><td style ='border-bottom:1px solid rgb(236, 239, 229);'>" . $poDate . "</td>
								</tr>
								<tr>
									<td style = 'text-align:right;color:grey;border-bottom:1px solid rgb(236, 239, 229);'>Invoice :</td><td style ='border-bottom:1px solid rgb(236, 239, 229);'>" . $invoiceNumber . "</td><td style = 'border-bottom:1px solid rgb(236, 239, 229);text-align:right;color:grey;'>Date :</td><td style ='border-bottom:1px solid rgb(236, 239, 229);'>" . $invoiceDate . "</td>
								</tr>
							</table>";
			}
			
			
			$sheet .= "	<tr style='background-color: ".$rclr.";' class='rowOnHover' onclick='invGetSingleItem(". $id .", ". $year .", \"".$tn."\", event, this)'>
							<td style='vertical-align:top; font-size: 12px; width: 10px; text-align: center; padding: 8px 5px;'>".++$item."</td>
							<td style='vertical-align:top; padding: 8px 0px; font-size: 12px;'>". $year ."</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; font-weight: bold; white-space:nowrap;'>".$tn."</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px;'>". $brand ."</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; word-wrap: break-word; vertical-align: top; width: 500px;'>
								".nl2br($details['Description'])."
							</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; color: rgb(45, 90, 126); letter-spacing: 1px; font-weight:bold;'>". $serial ."</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px;'>". $propertyNumber . "</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px;'>". $sticker ."</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; border-left:1px solid rgb(249, 250, 211); border-right:1px solid rgb(249, 250, 211);' valign='top'>". $poDetails  . "</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; width: 120px; font-weight:bold;'><div id = '" . $employeeNumber . "' onclick = 'previewMyAre(this,event)'>" . $assignedTo . "</div></td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px; font-weight:bold;'>". $currentUser ."</td>
							<td style='vertical-align:top; padding: 8px 5px; font-size: 12px;'><div>" . $status . '</div><div style = "color:orange;">' .$remarks ."</div></td>
						";
			$sheet .= "</tr>";
		}

		$sheet .= "</table>";

		return $sheet;
	}

	function generateSummaryOfItemsInv($record){
		$sheet = "";
		$sheet = "<div class='sumCont'>";
		$rowCnt = 0;
		$log = $_SESSION['fullName'];
		while ($data = $this->fetch_array($record)) {
			$year = $data['Year'];
			$brand = $data['Brand'];
			$description = $data['Description'];
			$sticker = $data['StickerNumber'];
			$dateReceived = $data['DateReceived'];
			$employeeNumber = $data['EmployeeNumber'];
			$nameAssigned = strtoupper($data['NameAssignedTo']);
			$position = strtoupper($data['Position']);
			$office = strtoupper($data['OfficeName']);
			
			if ($rowCnt == 0) {
				$sheet .= "<div class='sumHeader' style='padding-bottom: 20px; '>	
							<table style='width: 100%; margin: 0px auto; border-spacing: 0px;' border='0'>		
								<tbody>

									<tr>			
										<td style='text-align: right; padding: 0px 5px 0px 5px;'>				
											<img src='../images/davaologo.png' style='width: 100px;'>			
										</td>			
										<td style='width: 20%; text-align: center; padding: 8px 0px;'>				
											<div style='font-size: 22px; font-weight: bold; margin-bottom: -3px;'>SUMMARY OF ITEMS</div>				
											<div style='font-size: 14px;'>City Government of Davao</div>				
											<div style='font-size: 17px;'>" . $office . "</div>			
										</td>			
										<td style='vertical-align: bottom; text-align: right; padding-right: 10px; width: 38%;'></td>		
									</tr>	
								</tbody>
							</table>	
							<table style='width: 100%; margin: 0px auto; border-spacing: 0px; padding-top: 20px;' border='0'>		
								<tbody>
									<tr>			
										<td style='font-size: 12px; text-align: right; width: 10px;'>Name&nbsp;:&nbsp;</td>			
										<td style='width: 68%; vertical-align: bottom;'>
											<span style='border-bottom: 1px solid black; font-size: 14px; display: inline-block; padding-left: 3px; width: 320px; vertical-align: bottom;'>" . $nameAssigned . "</span>
										</td>			
										<td style='font-size: 12px; text-align: right; width: 80px;'>Prepared by&nbsp;:&nbsp;</td>			
										<td style='width: 250px; text-align: right; vertical-align: bottom;'>
											<input class='preparedBy' onkeyup='fillUpPreparedBy(this)' value = '" . $log . "' style='width: 250px; border: 0px; border-bottom: 1px solid black; font-size: 14px; display: inline-block; padding-left: 3px; vertical-align: bottom; font-family: times; text-align: center;' type='text'>
										</td>		
									</tr>
									<tr>			
										<td style='font-size: 12px; text-align: right; width: 10px; padding-left: 10px;'>Position&nbsp;:&nbsp;</td>			
										<td style='width: 140px; vertical-align: bottom;'>
											<span style='border-bottom: 1px solid black; width: 320px; font-size: 14px; display: inline-block; padding-left: 3px; vertical-align: bottom;'>" . $position . "</span>
										</td>			
										<td style='font-size: 12px; text-align: right; width: 10px; padding-left: 10px;'>Date&nbsp;:&nbsp;</td>			
										<td style='width: 250px; text-align: right; vertical-align: bottom;'>
											<span style='text-align: center; border-bottom: 1px solid black; width: 247px; font-size: 14px; display: inline-block; padding-left: 3px; vertical-align: bottom;'>" . date("F d, Y") . "</span>
										</td>		
									</tr>	
								</tbody>
							</table>
						</div>";
				// $sheet .= "<div style='overflow: auto; height: 600px;'>		
				// 			<table class='borderBottom' style='margin: 0px auto; width: 100%; font-size: 13px; text-align: center; border-spacing: 0px; border-bottom: 1px solid black;' border='0'>";
				$sheet .= "<div style=''>		
							<table class='borderBottom' style='margin: 0px auto; width: 100%; font-size: 13px; text-align: center; border-spacing: 0px; border-bottom: 1px solid black;' border='0'>";
				$sheet .= "	<tr>				
								<td class='sumHeaderLabel' style='width: 10px; border-right: 1px solid black; border-left: 1px solid black;'></td>				
								<td class='sumHeaderLabel' style='width: 70px;'>Brand</td>				
								<td class='sumHeaderLabel'>Description</td>				
								<td class='sumHeaderLabel' style='width: 70px;'>Sticker&nbsp;No.</td>				
								<td class='sumHeaderLabel' style='width: 130px; text-align: left; padding: 0px 8px;'>Date&nbsp;Received</td>			
							</tr>";
			}

			//$sNumber = $data['StickerNumber'] ? $data['StickerNumber'] : "";
			//$dReceived = $data['DateReceived'] ? $data['DateReceived'] : "";

			$sheet .= "	<tr>	
							<td class='sumItem' style='text-align: center; border-right: 1px solid black; border-left: 1px solid black;'>".++$rowCnt."</td>	
							<td class='sumItem' style='border-right: 1px solid black;'>".$brand."</td>	
							<td class='sumItem' style='border-right: 1px solid black;'>".$description."</td>	
							<td class='sumItem' style='border-right: 1px solid black;'>".$sticker."</td>	
							<td class='sumItem' style='border-right: 1px solid black;'>".$dateReceived."</td>
						</tr>";
		}
		$sheet .= "		</table>	
					</div>";
		$sheet .= "</div>";

		echo $sheet;
	}

	function generateInventorySummaryByCat($record) {
		
		$sheet = "";
		$sheet .= "<table border='0' cellspacing='0' cellpadding='0' class='summaryListInv' style='padding:5px; width:100%;'>
					<thead>
						<th style='white-space:nowrap; padding:2px 5px; font-size:14px; border-bottom:1px solid silver; text-align:left;'>Category</th>
						<th style='white-space:nowrap; padding:2px 5px; font-size:14px; border-bottom:1px solid silver; text-align:right;'>No. of Items</th>
					</thead>
					<tbody>";

		foreach ($record as $cat => $details) {
			$category = $details['Code'];
			$title = $details['Title'];
			$cnt = $details['Count'];

			$sheet .= "	<tr class='summaryRow' onclick='getThisInvCatItems(\"".$category."\", this)'>
							<td style='padding:2px 5px;'>
								<div style='font-size:11px; font-weight:bold;'>".$category."</div>
								<div style='font-size:10px;'>".$title."</div>
							</td>
							<td style='padding:2px 5px;text-align:right; font-size:14px; font-weight:bold;'>".$cnt."</td>
						</tr>";
		}

		$sheet .= "	</tbody>
				</table>";
		

		return $sheet;
	}
	//---------------------------------------------------------------------------------------------------INVENTORY VIEWER - END

	//---------------------------------------------------------------------------------------------------INFRA RETENTION - START

	function createInfraRetentionDetails($record) {

		$trackingNumber = $record['TrackingNumber'];
		$contractor = $record['Claimant'];
		$fundYear = $record['FundYear'];
		$program = $record['PR_ProgramCode'];
		$account = $record['PR_AccountCode'];
		$project = $record['ProjectName'];
		$accountTitle = $record['AccountTitle'];
		$progress = $record['Progress'];
		$duration = $record['Duration'];
		$retention = $record['Retention'];
		$fund = $record['Fund'];

		$sheet = "	<table border='0' cellpadding='0' style='font-size:16px; font-family:NOR; margin:0px auto; width:620px; min-width:620px; max-width:620px; border-spacing:0px;'>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top; padding-top:4px;'><span style='color:grey;' class='labelProjectNumber'>1</span>TN</td>
							<td id='retinINTN' style='letter-spacing:1px; font-weight:bold; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px; font-size:20px; color:orange;'>".$trackingNumber."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>2</span>Construction Progress</td>
							<td style='letter-spacing:1px; font-weight:bold; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$progress."%</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>3</span>Contractor</td>
							<td id='retinContractor' style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$contractor."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>4</span>Project Name</td>
							<td style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$project."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>5</span>Fund Year</td>
							<td style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$fundYear."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>6</span>Project Code</td>
							<td id='retinProgram' style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$program."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>7</span>Expense Account</td>
							<td style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$account."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>8</span>Expense Title</td>
							<td style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$accountTitle."</td>
						</tr>
						<tr>
							<td style='color:rgb(41, 111, 152); white-space:nowrap; width:0px; padding-right:8px; vertical-align:top;'><span style='color:grey;' class='labelProjectNumber'>9</span>Project Duration</td>
							<td style='letter-spacing:1px; border-bottom:1px solid rgb(216, 219, 221); padding:0px 8px;'>".$duration."</td>
						</tr>
						<tr>
							<td colspan='2' style='padding-top:20px;'>
								<table border='0' cellpadding='0' style='margin:0px 0px 0px auto; border-spacing:0px;'>
									<tr>
										<td style='padding:0px 8px;'>Retention</td>
										<td id='retinRetention' style='padding:0px 8px; border-bottom:1px dashed black; font-weight:bold; font-size:20px; color:red;'>".number_format($retention, 2)."</td>
									</tr>
								</table>
								<span id='retinFund' style='display:none;'>".$fund."</span>
							</td>
						</tr>
					</table>";


		return $sheet;

	}

	//---------------------------------------------------------------------------------------------------INFRA RETENTION - END

	//---------------------------------------------------------------------------------------------------GOODS AND SERVICES PO - START

	function goodsPRGenDetailsForPO($record) {

		$trackingNumber = $record['TrackingNumber'];
		$prNumber = $record['PR_Number'];
		$obrNumber = $record['OBR_Number'];
		$fund = $record['Fund'];
		$chargeType = $record['ChargeType'];
		$prMonth = $record['PR_Month'];
		$catCode = $record['PR_CategoryCode'];
		$catName = $record['PR_CategoryName'];

		$disaDisplay = "";
		$disaId = $record['DisaId'];
		$disaName = $record['DisaName'];

		if(strlen(trim($disaName)) == 0) {
			$disaDisplay = "display:none;";
		}

		if(strlen(trim($disaId)) == 0) {
			$disaId = 0;
		}

		$qtrDisp = "";

		if ($prMonth >= 1 AND $prMonth <= 3) {
			$qtrDisp = "1st Quarter";
		}elseif ($prMonth >= 4 AND $prMonth <= 6) {
			$qtrDisp = "2nd Quarter";
		}elseif ($prMonth >= 7 AND $prMonth <= 9) {
			$qtrDisp = "3rd Quarter";
		}elseif ($prMonth >= 10 AND $prMonth <= 12) {
			$qtrDisp = "4th Quarter";
		}

		$sheet = "	<table border='0' style='border-spacing:0px 3px; font-size:14px; margin:0px auto; padding-left:40px; font-family:NOR; width:100%;'>
						<tr>
							<td colspan='2' style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding:0px 0px; padding-left:5px; border-bottom:1px solid black;'>PR Tracking Details</td>
						</tr>
						<tr>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom; width:0px;'><span class='goodsSubField' style='font-size:12px;'>TN&nbsp;#</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;' id='prTrackingNumberGoods'>".$trackingNumber."</td>
						</tr>
						<tr>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom;'><span class='goodsSubField' style='font-size:12px;'>PR&nbsp;#</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;' id='prNumberGoods'>".$prNumber."</td>
						</tr>
						<tr>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom;'><span class='goodsSubField' style='font-size:12px;'>OBR&nbsp;#</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;' id='obrNumberGoods'>".$obrNumber."</td>
						</tr>
						<tr>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom;'><span class='goodsSubField' style='font-size:12px;'>FUND</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;' id='fundTypeGoods'>".$fund ."</td>
						</tr>
						<tr>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom;'><span class='goodsSubField' style='font-size:12px;'>QUARTER</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;' id='prMonthGoods'>".$qtrDisp."</td>
						</tr>
						<tr>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom;'><span class='goodsSubField' style='font-size:12px;'>CATEGORY</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;'><span id='prCategoryNewGoods'>".$catCode."</span>&nbsp;-&nbsp;".$catName."</td>
						</tr>
						<tr style='".$disaDisplay."'>
							<td style='padding:0px; padding-right:5px; text-align:right; vertical-align:bottom; white-space:nowrap;'><span class='goodsSubField' style='font-size:12px;'>DISASTER PROJECT</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; font-size:14px;'><span style='display:none;' id='poNewGoodsDisaProject'>".$disaId."</span>".$disaName."</td>
						</tr>
					</table>";

		return $sheet;
	}

	function goodsListOfPOsThisPR($record) {
		
		$row = 0;
		$dispTotal = 0;
		$sheet = "";
		if($this->num_rows($record) > 0) {

			$dispHeader = "PO Tracking Created";
			// if($this->num_rows($record) > 1) {
			// 	$dispHeader = "PO Tracking Numbers";
			// }
			
			// $sheet  = "	<div style='text-align:left; margin-bottom:5px;'><span class='goodsNum'>5</span><span class='goodsField'>Review Details</span></div>";
			$sheet .= "	<table border='0' style='border-spacing:0px; font-size:14px; width:100%; font-family:NOR;'>
							<thead>
								<tr>
									<th colspan='7' style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding:0px 0px; padding-left:5px;'>".$dispHeader."</th>
								</tr>
								<tr style='background-color:rgba(121,137,141,1); color:white;'>
									<th style='border-bottom:1px solid black; border-top:1px solid silver; border-left:1px solid silver;'></th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>TN</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Supplier</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Status</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Encoded</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Last Updated</th>
									<th style='text-align:right; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver; border-right:1px solid silver;'>Amount</th>
								</tr>
								<tr>
									<th colspan='7' style='padding:1px 0px; border-bottom:1px solid silver;'></th>
								</tr>
							</thead>
							<tbody>
							";
			while ($data = $this->fetch_array($record)) {
				$trackingNumber = $data['TrackingNumber'];
				$supplier = $data['Claimant'];

				$amount = $data['PO_Amount'];
				$total = $data['TotalAmountMultiple'];
				$dispAmount = $amount;
				if($total > 0) {
					$dispAmount = $total;
				}

				$dateEncoded = $data['DateEncoded'];
				$dateModified = $data['DateModified'];
				$status = $data['Status'];

				$sheet .= "	<tr>
								<td style='padding:0px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; font-size:11px; text-align:center;'>".++$row."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px; font-weight:bold; cursor:pointer;' onclick='clickToSearchTNNew(this)'>".$trackingNumber."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; border-left:0px;' class='goodsPOSupplier'>".$supplier."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$status."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$dateEncoded."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$dateModified."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px; text-align:right;'>".number_format($dispAmount, 2)."</td>
							</tr>";

				$dispTotal += $dispAmount;
			}

			$sheet .= "	<tr>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style='padding:2px 6px; text-align:right; font-weight:bold; color:red; font-size:16px; font-weight:bold;' id='totalAmountPOsTracked'>".number_format($dispTotal, 2)."</td>
						</tr>";

			$sheet .= "		</tbody>
						</table>";
		}

		return $sheet;

		
	}

	function goodsSelectApprovedPOforPX($record) {

		$sheet = "<select id='selectTrackingPO' class='goodsData2' onchange='getDetailsByPORelease(this)'>
					<option>&nbsp;</option>";
		$row = 0;
		while($data = $this->fetch_array($record)){
			
			$trackingNumber = $data['TrackingNumber'];
			$supplier = utf8_encode($data['Claimant']);
			$amount = $data['PO_Amount'];
			if($data['TotalAmountMultiple'] > 0) {
				$amount =  $data['TotalAmountMultiple'];
			}

			if($row % 2 > 0){
				$sheet .= "<option value='".$trackingNumber."' style='background-color:rgb(223, 226, 228);'>".$trackingNumber."&nbsp;".$supplier."&nbsp;".number_format($amount, 2)."</option>";
			}else {
				$sheet .= "<option value='".$trackingNumber."'>".$trackingNumber."&nbsp;".$supplier."&nbsp;".number_format($amount, 2)."</option>";
			}
		
			$row++;
		}
		$sheet .= "</select>";

		return $sheet;	
	}

	function goodsPOGenDetailsForPX($record) {

		$trackingNumber = $record['TrackingNumber'];
		$supplier = utf8_encode($record['Claimant']);
		$prTN = $record['PR_TrackingNumber'];
		$poNumber = $record['PO_Number'];
		$prNumber = $record['PR_Number'];
		$obrNumber = $record['OBR_Number'];
		$fund = $record['Fund'];
		$chargeType = $record['ChargeType'];
		$prMonth = $record['PR_Month'];
		$catCode = $record['PR_CategoryCode'];
		$catName = $record['PR_CategoryName'];
		$nature = $record['NatureOfPayment'];
		$modOfProc = $record['ModeOfProcurement'];
		$pyTerm = $record['PaymentTerm'];

		$disaId = $record['DisaId'];
		$disaName = $record['DisaName'];

		$hideDisaster = "display:none;";
		if(intval($disaId) > 0) {
			$hideDisaster = "";
		}

		$withRetention = $record['WithRetention'];
		$allowRetention = "<input type='hidden' id='pxWithRetention' value='".$withRetention."'>";

		$specifics = $record['Specifics'];
		if($specifics == 'Combi') {
			$specifics = 'Agricultural products & other Goods/Items';
		}
		
		$suppClassif = $record['SuppClassification'];

		$suppType = $record['SuppType'];
		$suppDispType = "VAT";
		if($suppType == 'NV') {
			$suppDispType = "NON-VAT";
		}

		$suppTIN = $record['SuppTIN'];
		$suppCode = $record['SuppCode'];

		$qtrDisp = "";
		if ($prMonth >= 1 AND $prMonth <= 3) {
			$qtrDisp = "1st Quarter";
		}elseif ($prMonth >= 4 AND $prMonth <= 6) {
			$qtrDisp = "2nd Quarter";
		}elseif ($prMonth >= 7 AND $prMonth <= 9) {
			$qtrDisp = "3rd Quarter";
		}elseif ($prMonth >= 10 AND $prMonth <= 12) {
			$qtrDisp = "4th Quarter";
		}

		$sheet1 = "	<table border='0' cellpadding='0' style='border-spacing:0px 3px; font-size:14px; font-family:NOR;'>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>PO TN #</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poTrackingNumber'>".$trackingNumber."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>PO #</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poNumber'>".$poNumber."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>OBR #</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='obrNumber'>".$obrNumber."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>PR TN #</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poPrTrackingNumber'>".$prTN."</td>
						</tr>
					</table>";

		$exp = "";
		if(isset($record['Expanded'])) {
			$temp1 = explode('~', $record['Expanded']);
			$expPer = $temp1[0];
			$taxCode = $temp1[1];
			$atc = $temp1[2];

			$exp = "<input type='hidden' name='pxTaxes' id='pxTaxEXP' value='".$expPer."'>
					<input type='hidden' name='' id='pxEXPCode' value='".$taxCode."'>
					<input type='hidden' name='' id='pxEXPATC' value='".$atc."'>";

			unset($temp1);
		}

		$gmp = "";
		if(isset($record['GMP'])) {
			$temp1 = explode('~', $record['GMP']);
			$gmpPer = $temp1[0];
			$taxCode = $temp1[1];
			$atc = $temp1[2];

			$gmp = "<input type='hidden' name='pxTaxes' id='pxTaxGMP' value='".$gmpPer."'>
					<input type='hidden' name='' id='pxGMPCode' value='".$taxCode."'>
					<input type='hidden' name='' id='pxGMPATC' value='".$atc."'>";
			
			unset($temp1);
		}

		$notax = "";
		if(isset($record['NoTax'])) {

			$notax = "	<input type='hidden' name='pxTaxes' id='pxTaxNTX' value='0'>
						<input type='hidden' name='' id='pxNTXCode' value='0'>
						<input type='hidden' name='' id='pxNTXATC' value='0'>";

			$exp = "";
			$gmp = "";
		}

		$hideAcctNum = "display:none;";
		$gasList = "<option></option>";
		if($catCode == 'CAT 80' && $_SESSION['cbo'] == 'ONE1' && $specifics == 'Gasoline') {
			$hideAcctNum = "";
			$gasList = $this->getGasAccountsList();

		}


		$sheet2 = "	<table border='0' cellpadding='0' style='border-spacing:0px 3px; font-size:14px; font-family:NOR;'>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right; width:0px;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>SUPPLIER</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poSupplier'>".$supplier."</td>
						</tr>
						<tr style='display:none;'>
							<td>
								<input type='hidden' id='pxTIN' value='".$suppTIN."'>
								".$exp.$gmp.$notax.$allowRetention."
							</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>FUND</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='fundType'>".$fund ."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>QUARTER</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poMonth'>".$qtrDisp."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>CATEGORY</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;'><span id='poCategoryNew'>".$catCode."</span>&nbsp;-&nbsp;".$catName."</td>
						</tr>
					</table>";


		$sheet3 = "	<table border='0' cellpadding='0' style='border-spacing:0px 3px; font-size:14px; font-family:NOR;'>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>NATURE OF PAYMENT</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poNature'>".$nature ."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>SPECIFICS</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poSpecifics'>".$specifics ."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>RECEIPT TYPE</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poSupplierRecType'>".$suppDispType ."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>BUSINESS TYPE</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poSupplierBusType'>".$suppClassif ."</td>
						</tr>
					</table>";

		$sheet4 = "	<table border='0' cellpadding='0' style='border-spacing:0px 3px; font-size:14px; font-family:NOR;'>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>MODE OF PROCUREMENT</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poModeProc'>".$modOfProc ."</td>
						</tr>
						<tr>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>PAYMENT TERM</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;' id='poPYTerm'>".$pyTerm ."</td>
						</tr>
						<tr style='".$hideDisaster."'>
							<td style='padding:0px 5px 1px 0px; text-align:right; vertical-align:top;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>DISASTER PROJECT</span></td>
							<td style='padding:0px 8px; font-weight:bold; border-bottom:1px solid silver; min-width:200px;'><span id='poDisasterProject' style='display:none;'>".$disaId."</span>".$disaName."</td>
						</tr>
						<tr style='".$hideAcctNum."'>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>GAS FOR</span></td>
							<td style='font-weight:bold; min-width:200px;'>
								<select id='pxGasAcctNum' style='width:230px; border:0px; padding:2px 8px 2px 8px; font-family:NOR; font-weight:bold; background-color:rgba(225,225,225,.5);'>".$gasList."</select>
							</td>
						</tr>
						<tr style='".$hideAcctNum."'>
							<td style='padding:0px 5px 1px 0px; text-align:right;'><span class='goodsSubField' style='font-size:14px; white-space:nowrap;'>PERIOD OF</span></td>
							<td style='font-weight:bold; min-width:200px;'>
								<select id='pxGasPeriod' style='width:230px; border:0px; padding:2px 8px 2px 8px; font-family:NOR; font-weight:bold; background-color:rgba(225,225,225,.5);'>
									<option></option>
									<option>January</option>
									<option>February</option>
									<option>March</option>
									<option>April</option>
									<option>May</option>
									<option>June</option>
									<option>July</option>
									<option>August</option>
									<option>September</option>
									<option>October</option>
									<option>November</option>
									<option>December</option>
								</select>
							</td>
						</tr>
					</table>";

		$sheet = "	<table border='0' cellpadding='0' style='border-spacing:0px; margin:10px 0px 0px 0px; width:100%;'>
						<tr>
							<td colspan='7' style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding:0px 5px;'>
								Review Details
							</td>
						</tr>
						<tr>
							<td colspan='7' style='background-color:rgba(121,137,141,1); color:white; font-family:NOR; font-weight:bold; font-size:14px; padding:2px 5px; border:1px solid silver; border-bottom:1px solid black;'>PO Details</td>
						</tr>
						<tr>
							<td colspan='7' style='padding:1px 0px;'></td>
						</tr>
						<tr>
							<td style='border:1px solid silver; vertical-align:top; padding:5px 10px 10px 10px;'>".$sheet1."</td>
							<td style='border:1px solid silver; border-left:0px; vertical-align:top; padding:5px 10px 10px 10px;'>".$sheet2."</td>
							<td style='border:1px solid silver; border-left:0px; vertical-align:top; padding:5px 10px 10px 10px;'>".$sheet3."</td>
							<td style='border:1px solid silver; border-left:0px; vertical-align:top; padding:5px 10px 10px 10px;'>".$sheet4."</td>
						</tr>
					</table>";


		return $sheet;
	}

	function getGasAccountsList() {

		$sql = "SELECT * FROM gasaccounts ORDER BY Office ASC";
		$record = $this->query($sql);

		$sheet = "<option></option>";

		while ($data = $this->fetch_array($record)) {

			$acctNum = $data['AccountNumber'];
			$acctNem = $data['Office'];

			$sheet .= "<option value='".$acctNum."'>".$acctNem."</option>";
			
		}

		return $sheet;

	}

	function CreatePXItems($record, $specifics, $mode){
		$row = 0;
		$totalAmount = 0;
		$sheet = "";
		$count = $this->num_rows($record);

		$hidden = "";
		if ($specifics != 'Combi') {
			$hidden = 'display:none;';
		}

		$agriChecked = '';
		if ($specifics == 'Agricultural Products') {
			$agriChecked = 'checked';
		}

		if ($specifics == 'Agricultural Products Without Retention') {
			// $hidden = "";
			$agriChecked = 'checked';
		}

		$disabled = "";
		if ($mode == 'Agency to Agency' || $mode == 'Postal Office' || $mode == 'Agency to Agency (DBM)') {
			$disabled = 'disabled';
		}

		$sheet .= "<div style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding-left:5px; margin-top:10px;'>List of Items</div>";
		$sheet .= "<table id='pxItemsTable' border='0' cellpadding='0' style='border-spacing:0px; width:100%;'>
						<tr class='goodsDataHeader1'>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'></td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'>Code</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'>Description&nbsp;<span style='color:orange;'>(".$count.")</span></td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; white-space:nowrap; text-align:right;'>PO Amount</td>
							<td style='font-weight:normal; padding:2px 10px 2px 10px; font-weight:bold; background-color:rgb(119, 122, 122); border:1px solid silver; border-top:0px; border-bottom:0px;'><input type='checkbox' onclick='selectAllPX(this)' checked></td>
							<td style='font-weight:normal; padding:2px 10px 2px 10px; font-weight:bold; background-color:rgb(119, 122, 122); border:1px solid silver; border-top:0px; border-bottom:0px; ".$hidden."'>Agri</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;' colspan='4'>Qty&nbsp;<span style='font-size:12px;'>&#10006;</span>&nbsp;Price</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:right;'>Total Cost</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:center;'>Days Delayed</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:right;'>LD</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:right;'>Total</td>
						</tr>";

		while ($data = $this->fetch_array($record)) {
			$amount =  $data['Amount'];
			$qty =  intval($data['Qty']);
			$price =  $data['Amount'];
			$amountX =  $data['Total'];
			$itemDes =  $data['Item'];
			$description = $data['Description'];
			$category  =  $data['Category'];
			$program = $data['ProgramCode'];
			$accountCode = $data['Code'];
			$unit = $data['Unit'];

			$totalAmount += $amountX;

			$sheet .= "	<tr style='background-color:rgb(206, 215, 218);'>
							<td style='width:0px; padding:8px 8px; border-bottom:2px solid white; vertical-align:top;'>
								<span class='goodsItemNum'>".++$row."</span><input type='hidden' value='".$itemDes."'><input type='hidden' value='".$qty."'><input type='hidden' value='".$price."'>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver;' value='".$program."'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px;' value='".$accountCode."'>
							</td>
							<td style='padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<textarea style='font-size:14px; resize:vertical; color:black; font-family:NOR; width:450px; max-width:450px; min-height:60px; overflow:hidden; padding:2px 5px; background-color:white; color:black;' onclick='this.style.backgroundColor=\"white\";' disabled>".$description."</textarea>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountX,2)."' style='color:rgb(45, 90, 118); text-align:right; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR;' disabled>
							</td>
							<td style='width:0px; padding:12px 10px; border-bottom:2px solid white; vertical-align:top; background-color:rgb(222, 228, 231);'>
								<input type='checkbox' onclick='selectCalculateAddPX(this)' checked>
							</td>
							<td style='width:0px; padding:12px 10px; border-bottom:2px solid white; vertical-align:top; background-color:rgb(222, 228, 231); ".$hidden."'>
								<input type='checkbox' name='agriCheckedItems' onclick='calculateAddPX(this)' ".$agriChecked.">
							</td>
							<td style='width:0px; padding:5px 5px; padding-top:8px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPX(this)' value='".$qty."' maxlength='8' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver; color:rgb(45, 90, 118);'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px;' value='".$unit."'>
							</td>
							<td style='width:0px; padding:8px 5px; border-bottom:2px solid white; vertical-align:top; font-size:12px;'>
								&#10006;
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPX(this)' value='".number_format($price,2)."' style='background-color:rgb(220, 228, 232);  width:97px; text-align:right; color:black; border:0; font-size:14px; font-weight:bold; padding:2px 5px; font-family:NOR;' >
							</td>
							<td style='width:0px; padding:6px 3px; border-bottom:2px solid white; vertical-align:top; font-weight:bold;'>=</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountX,2)."' style='color:rgb(45, 90, 118); text-align:left; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR; text-align:right;' disabled>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPX(this)' value='' style='background-color:rgb(220, 228, 232);  width:97px; text-align:center; color:black; border:0; font-size:14px; font-weight:bold; padding:2px 5px; font-family:NOR;' ".$disabled.">
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='0.00' style='color:rgb(45, 90, 118); text-align:right; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR;' name='pxLD' disabled>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountX,2)."' style='color:rgb(45, 90, 118); text-align:right; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR;' disabled>
							</td>
						</tr>";
		}
		$sheet .= "	<tr>
						<td colspan='2' style='border-top:1px solid silver;'></td>
						<td colspan='2' style='border-top:1px solid silver; padding:0px 10px; padding-right:8px;'>
							<input class='data1' id='totalAmountItemsPXPO' value='".number_format($totalAmount,2)."' style='font-size:18px; color:black; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; font-family:NOR;' disabled>
						</td>
						<td colspan='4' style='border-top:1px solid silver;'></td>
						<td colspan='2' style='border-top:1px solid silver; padding:0px 10px; padding-right:5px;'>
							<input class='data1' id='totalAmountItemsPX' value='".number_format($totalAmount,2)."' style='font-size:18px; color:black; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; font-family:NOR;' disabled>
						</td>
						<td colspan='3' style='border-top:1px solid silver; padding:0px 10px; padding-right:5px;'>
							<input class='data1' id='totalAmountItemsPXLD' value='".number_format($totalAmount,2)."' style='font-size:18px; color:black; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; font-family:NOR;' disabled>
						</td>
					</tr>";

		$sheet .= "</table>";

		return $sheet;
	}

	function goodsListOfPXsThisPO($record) {
		
		$row = 0;
		$dispTotal = 0;
		$sheet = "";

		if($this->num_rows($record) > 0) {

			$sheet  = "";
			// $sheet  = "	<div style='text-align:left; margin-bottom:5px;'><span class='goodsNum'>5</span><span class='goodsField'>Review Details</span></div>";
			$sheet .= "	<table border='0' style='border-spacing:0px; font-size:14px; font-family:NOR; margin:0px auto; margin-top:20px; width:100%;'>
							<thead>
								<tr>
									<th colspan='8' style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding:0px 0px; padding-left:5px;'>Payment History</th>
								</tr>
								<tr style='background-color:rgba(121,137,141,1); color:white;'>
									<th style='border-bottom:1px solid black; border-top:1px solid silver; border-left:1px solid silver; width:0px;'></th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>TN</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Status</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Encoded</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Last Updated</th>
									<th style='text-align:right; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Amount</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver; white-space:nowrap;'>Check No.</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver; white-space:nowrap; border-right:1px solid silver;'>Check Date</th>
								</tr>
								<tr>
									<th colspan='8' style='padding:1px 0px; border-bottom:1px solid silver;'></th>
								</tr>
							</thead>
							<tbody>
							";
			while ($data = $this->fetch_array($record)) {
				$trackingNumber = $data['TrackingNumber'];
				// $supplier = $data['Claimant'];

				$amount = $data['Amount'];
				// $amount = $data['PO_Amount'];
				$total = $data['TotalAmountMultiple'];
				$dispAmount = $amount;
				if($total > 0) {
					$dispAmount = $total;
				}

				$dateEncoded = $data['DateEncoded'];
				$dateModified = $data['DateModified'];
				$status = $data['Status'];
				$checknumber = $data['checknumber'];
				$checkdate = $data['checkdate'];

				$sheet .= "	<tr>
								<td style='padding:0px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; font-size:11px; text-align:center;'>".++$row."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px; font-weight:bold; cursor:pointer;' onclick='clickToSearchTNNew(this)'>".$trackingNumber."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px;' class='pxStatuses'>".$status."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px;'>".$dateEncoded."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px;'>".$dateModified."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px; text-align:right;' class='pxAmounts'>".number_format($dispAmount, 2)."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px;'>".$checknumber."</td>
								<td style='padding:2px 5px; border:1px solid silver; border-top:0px; white-space:nowrap; border-left:0px;'>".$checkdate."</td>
							</tr>";

				$dispTotal += $dispAmount;
			}

			$sheet .= "	<tr>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style=''></td>
							<td style='padding:2px 6px; text-align:right; font-weight:bold; color:red; font-size:16px; font-weight:bold;' id='totalAmountPXsTracked'>".number_format($dispTotal, 2)."</td>
						</tr>";

			$sheet .= "		</tbody>
						</table>";

		}

		return $sheet;
		
	}

	function CreatePXItemsEdit($record, $newRecord, $itemList){
		$row = 0;
		$totalAmount = 0;
		$totalAmountLD = 0;
		$totalAmountPO = $newRecord['Amount'];
		$specifics = $newRecord['Specifics'];
		$trackingNumber = $newRecord['TrackingNumber'];
		$trackingNumberPO = $newRecord['PO_TrackingNumber'];
		$poModeOfProc = $newRecord['ModeOfProcurement'];
		$sheet = "";
		$count = $this->num_rows($record);

		$hidden = "";
		if ($specifics != 'Combi') {
			$hidden = 'display:none;';
		}

		$agriChkDefault = '';
		if ($specifics == 'Agricultural Products') {
			$agriChkDefault = 'checked';
		}

		if ($specifics == 'Agricultural Products Without Retention') {
			// $hidden = "";
			$agriChkDefault = 'checked';
		}

		$sheet .= "<table id='pxItemsTableED' border='0' cellpadding='0' style='border-spacing:0px; width:100%; margin-top:20px;'>
						<tr>
							<td colspan='13' style='text-align:right; border-bottom:6px solid white;'>
								<span style='white-space:nowrap; font-family:NOR; background-color:rgb(108, 111, 113); padding:4px 8px 5px 8px; color:white; font-weight:bold; cursor:pointer; font-size:14px;' onclick='pxAddItemFromPO(\"".$trackingNumberPO."\")'>Add Item</span>
							</td>
						</tr>
						<tr class='goodsDataHeader1'>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'></td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'>Code</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'>Description&nbsp;<span style='color:orange;'>(".$count.")</span></td>
							<td style='font-weight:normal; padding:2px 10px 2px 10px; font-weight:bold; background-color:rgb(119, 122, 122); border:1px solid silver; border-top:0px; border-bottom:0px;'><input type='checkbox' id='pxChkAll' style='' onclick='selectAllPXInEdit(this)' checked></td>
							<td style='font-weight:normal; padding:2px 10px 2px 10px; font-weight:bold; background-color:rgb(119, 122, 122); border:1px solid silver; border-top:0px; border-bottom:0px; ".$hidden."'>Agri</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;' colspan='4'>Qty&nbsp;<span style='font-size:12px;'>&#10006;</span>&nbsp;Price</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:right;'>Total Cost</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:center;'>Days&nbsp;Delayed</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:right;'>LD</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; text-align:right;'>Total</td>
						</tr>";

		while ($data = $this->fetch_array($record)) {
			$id =  $data['Id'];
			$amount =  $data['Amount'];
			$qty =  intval($data['Qty']);
			$price =  $data['Amount'];
			$amountX =  $data['Total'];
			$itemDes =  $data['Item'];
			$description = $data['Description'];
			$category  =  $data['Category'];
			$program = $data['ProgramCode'];
			$accountCode = $data['Code'];
			$unit = $data['Unit'];
			$ld = $data['LiquidatedDamages'];
			$amountLD =  $data['TotalLD'];
			// $agriChecked =  $data['AgriChecked'];

			// $totalAmountLD += $amountLD;

			$agriChecked = "";
			if($data['AgriChecked'] == 1) {
				$agriChecked = "checked";
			}

			$checked = "";
			$bgColor = "";
			if(in_array($itemDes, $itemList)) {
				$checked = "checked";
				$bgColor = "background-color:rgb(206, 215, 218);";
				$totalAmount += $amountX;
			}


			$days = $data['Days'];
			$int = floor($days);
			$decimal = $days - $int;
			if($decimal == 0){
				$days = intval($data['Days']);
			}

			$sheet .= "	<tr style='".$bgColor."'>
							<td style='width:0px; padding:8px 8px; border-bottom:2px solid white; vertical-align:top;'>
								<span class='goodsItemNum'>".++$row."</span><input type='hidden' value='".$itemDes."'><input type='hidden' value='".$qty."'><input type='hidden' value='".$price."'>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver;' value='".$program."'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px;' value='".$accountCode."'>
							</td>
							<td style='padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<textarea id='item".$id."' style='font-size:14px; resize:vertical; color:black; font-family:NOR; width:450px; max-width:450px; min-height:60px; overflow:hidden; padding:2px 5px; background-color:white;' onclick='this.style.backgroundColor=\"white\";'>".stripcslashes($description)."</textarea>
							</td>
							<td style='width:0px; padding:12px 10px; border-bottom:2px solid white; vertical-align:top; background-color:rgb(222, 228, 231);'>
								<input type='checkbox' onclick='selectCalculateAddPXInEdit(this)' style='' ".$checked." >
							</td>
							<td style='width:0px; padding:12px 10px; border-bottom:2px solid white; vertical-align:top; background-color:rgb(222, 228, 231); ".$hidden."'>
								<input type='checkbox' name='agriCheckedItemsED' onclick='calculateAddPXInEdit(this)' ".$agriChecked.">
							</td>
							<td style='width:0px; padding:5px 5px; padding-top:8px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPXInEdit(this)' value='".$qty."' maxlength='8' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver; color:rgb(45, 90, 118);'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px;' value='".$unit."'>
							</td>
							<td style='width:0px; padding:8px 5px; border-bottom:2px solid white; vertical-align:top; font-size:12px;'>
								&#10006;
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPXInEdit(this)' value='".number_format($price,2)."' style='background-color:rgb(220, 228, 232);  width:97px; text-align:right; color:black; border:0; font-size:14px; font-weight:bold; padding:2px 5px; font-family:NOR;' >
							</td>
							<td style='width:0px; padding:6px 3px; border-bottom:2px solid white; vertical-align:top; font-weight:bold;'>=</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountX,2)."' style='color:rgb(45, 90, 118); font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px 2px 5px; font-family:NOR; text-align:right;' disabled>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPXInEdit(this)' value='".$days."' style='background-color:rgb(220, 228, 232);  width:97px; text-align:center; color:black; border:0; font-size:14px; font-weight:bold; padding:2px 5px; font-family:NOR;' >
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($ld,2)."' style='color:rgb(45, 90, 118); text-align:right; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR;' name='pxLD' disabled>
							</td>
							<td colspan='2' style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountLD,2)."' style='color:rgb(45, 90, 118); text-align:right; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR;' disabled>
							</td>
						</tr>";
		}
		$sheet .= "	<tr>
						<td colspan='4' style='border-top:1px solid silver;'>
							<input class='data1' id='totalAmountItemsPXPO' value='".number_format($totalAmountPO,2)."' style='display:none;' disabled>
						</td>
						<td colspan='3' style='border-top:1px solid silver;'></td>
						<td colspan='2' style='border-top:1px solid silver; padding:0px 10px; padding-right:6px;'>
							<input class='data1' id='totalAmountItemsPX' value='".number_format($totalAmount,2)."' style='font-size:18px; color:black; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; font-family:NOR;' disabled>
						</td>
						<td colspan='3' style='border-top:1px solid silver; padding:0px 10px; padding-right:6px;'>
							<input class='data1' id='totalAmountItemsPXLD' value='".number_format($totalAmount,2)."' style='font-size:18px; color:black; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; font-family:NOR;' disabled>
						</td>
					</tr>";

		$sheet .= "</table>";
		$sheet .= "<input type='hidden' id='pxCategoryED' value='".$category."'>";
		$sheet .= "<input type='hidden' id='pxPOModeED' value='".$poModeOfProc."'>";

		return $sheet;
	}

	function CreatePXTaxAndDeductionsDetails($record) {

		$sheet = "";
		$tnYear = $record['Year'];
		$fund = $record['Fund'];
		$supplier = $record['Supplier'];
		$nature = $record['NatureOfPayment'];
		$specifics = $record['Specifics'];
		$category = $record['PR_CategoryCode'];
		$withRetention = $record['WithRetention'];
		
		if($specifics == 'Combi') {
			$specifics = 'Agricultural products & other Goods/Items';
		}

		$classification = $record['SuppClassification'];
		$receiptType = $record['SuppType'];
		$tin = $record['SuppTIN'];
		$supplierCode = $record['SuppCode'];

		// $fields = "	<input type='hidden' id='pxTNYear' value='".$tnYear."'>
		// 			<input type='hidden' id='pxFund' value='".$fund."'>
		// 			<input type='hidden' id='pxSupplier' value='".$supplier."'>
		// 			<input type='hidden' id='pxTIN' value='".$tin."'>
		// 			<input type='hidden' id='pxSuppCode' value='".$supplierCode."'>
		// 			<input type='hidden' id='pxCatCode' value='".$category."'>
		// 			<input type='hidden' id='pxWithRetention' value='".$withRetention."'>
		// 		";

		$fields = '	<input type="hidden" id="pxTNYear" value="'.$tnYear.'">
					<input type="hidden" id="pxFund" value="'.$fund.'">
					<input type="hidden" id="pxSupplier" value="'.$supplier.'">
					<input type="hidden" id="pxTIN" value="'.$tin.'">
					<input type="hidden" id="pxSuppCode" value="'.$supplierCode.'">
					<input type="hidden" id="pxCatCode" value="'.$category.'">
					<input type="hidden" id="pxWithRetention" value="'.$withRetention.'">
				';

		$exp = "";
		if(isset($record['Expanded'])) {
			$temp1 = explode('~', $record['Expanded']);
			$expPer = $temp1[0];
			$taxCode = $temp1[1];
			$atc = $temp1[2];

			$exp = "<input type='hidden' name='pxTaxesED' id='pxTaxEXP' value='".$expPer."'>
					<input type='hidden' name='' id='pxEXPCode' value='".$taxCode."'>
					<input type='hidden' name='' id='pxEXPATC' value='".$atc."'>";

			unset($temp1);
		}

		$gmp = "";
		if(isset($record['GMP'])) {
			$temp1 = explode('~', $record['GMP']);
			$gmpPer = $temp1[0];
			$taxCode = $temp1[1];
			$atc = $temp1[2];

			$gmp = "<input type='hidden' name='pxTaxesED' id='pxTaxGMP' value='".$gmpPer."'>
					<input type='hidden' name='' id='pxGMPCode' value='".$taxCode."'>
					<input type='hidden' name='' id='pxGMPATC' value='".$atc."'>";
			
			unset($temp1);
		}

		$notax = "";
		if(isset($record['NoTax'])) {

			$notax = "	<input type='hidden' name='pxTaxes' id='pxTaxNTX' value='0'>
						<input type='hidden' name='' id='pxNTXCode' value='0'>
						<input type='hidden' name='' id='pxNTXATC' value='0'>";

			$exp = "";
			$gmp = "";
		}

		$adjType = $record['AdjustmentType'];
		$adjLabel = $record['AdjustmentLabel'];
		$adjAmount = $record['AdjustmentAmount'];

		$adjChecked = '';
		$adjShow = 'display:none;';
		if(strlen(trim($adjType)) > 0) {
			$adjChecked = 'checked';
			$adjShow = '';
		}

		$adjSelected = "<option></option>
						<option>Add</option>
						<option>Deduct</option>";

		if($adjType == 'Add') {
			$adjSelected = "<option></option>
							<option selected>Add</option>
							<option>Deduct</option>";

		}elseif($adjType == 'Deduct') {
			$adjSelected = "<option></option>
							<option>Add</option>
							<option selected>Deduct</option>";

		}

		$sheet .= "<table border='0' cellpadding='0' style='border-spacing:0px; margin:0px 0px 0px auto;'>
					<tr>
						<td style='vertical-align:top; padding-right:100px;'>";

		$sheet .= " 		<div style='font-weight:bold; font-size:16px; color:rgb(64, 161, 202); background-color:white; padding:2px 8px; font-family:NOR; margin:20px 0px 0px auto;'>Computation Variables</div>
							<table border='0' cellpadding='0' style='border-spacing:0px; font-family:NOR; font-size:14px; background-color:rgba(248, 249, 248, 1); padding:3px 8px 8px 0px;'>
								<tr>
									<td colspan='3'>".$fields.$exp.$gmp.$notax."</td>
								</tr>
								<tr>
									<td style='padding:0px 8px; text-align:right; vertical-align:bottom; white-space:nowrap;'><span class='goodsSubField' style='font-size:12px;'>NATURE OF PAYMENT</span></td>
									<td style='font-family:NOR; font-weight:bold; font-size:16px; min-width:100px; border-bottom:1px dashed silver; padding:0px 5px;' id='pxNature'>
										".$nature."
									</td>
								</tr>
								<tr>
									<td style='padding:0px 8px; text-align:right; vertical-align:bottom; white-space:nowrap;'><span class='goodsSubField' style='font-size:12px;'>SPECIFICS</span></td>
									<td style='font-family:NOR; font-weight:bold; font-size:16px; min-width:100px; border-bottom:1px dashed silver; padding:0px 5px;' id='pxSpecifics'>
										".$specifics."
									</td>
								</tr>
								<tr>
									<td style='padding:0px 8px; text-align:right; vertical-align:bottom; white-space:nowrap;'><span class='goodsSubField' style='font-size:12px;'>RECEIPT TYPE</span></td>
									<td style='font-family:NOR; font-weight:bold; font-size:16px; min-width:100px; border-bottom:1px dashed silver; padding:0px 5px;' id='pxRecType'>
										".$receiptType."
									</td>
								</tr>
								<tr>
									<td style='padding:0px 8px; text-align:right; vertical-align:bottom; white-space:nowrap;'><span class='goodsSubField' style='font-size:12px;'>BUSINESS TYPE</span></td>
									<td style='font-family:NOR; font-weight:bold; font-size:16px; min-width:100px; border-bottom:1px dashed silver; padding:0px 5px;' id='pxClassification'>
										".$classification."
									</td>
								</tr>
							</table>";

		$sheet .= "		</td>
						<td style='vertical-align:top;'>";

		$sheet .= "		<div style='font-family:NOR; margin:20px 0px 0px auto; font-weight:bold; font-size:16px; color:rgb(64, 161, 202); background-color:white; padding:2px 8px;'>Computation Breakdown</div>

							<table border='0' cellpadding='0' style='border-spacing:0px; font-family:NOR; font-size:14px; border:1px dashed black; background-color:rgba(248, 249, 248, 1);'>
								<tr>
									<td colspan='3' style='padding:5px 0px;'></td>
								</tr>
								<tr>
									<td></td>
									<td style='text-align:right; padding:3px 5px;'>Gross</td>
									<td style='width:0px; padding-right:20px;'>
										<input style='font-family:NOR; font-size:18px; font-weight:bold; color:black; background-color:transparent; width:145px; border:0px; text-align:right;' id='totalAmountItemsPXDispOnlyED' value='0.00' disabled>
									</td>
								</tr>
								<tr>
									<td style='font-weight:bold; color:orange; padding:0px 40px 0px 20px;'>LESS</td>
									<td colspan='2'></td>
								</tr>
								<tr>
									<td></td>
									<td style='text-align:right; padding:3px 5px;'>Liquidated Damages</td>
									<td>	
										<input style='font-family:NOR; font-size:18px; font-weight:bold; background-color:transparent; width:145px; border:0px; text-align:right; color:red;' id='pxTotalLDED' value='0.00' disabled>
									</td>
								</tr>
								<tr>
									<td></td>
									<td style='text-align:right; padding:3px 5px;'>Total</td>
									<td>
									<input style='font-family:NOR; font-size:18px; font-weight:bold; color:black; background-color:transparent; width:145px; border:0px; border-top:1px dashed black; text-align:right;' id='totalAmountItemsPXLDDispOnlyED' value='0.00' disabled>
									</td>
								</tr>
								<tr>
									<td style='font-weight:bold; color:orange; padding:0px 40px 0px 20px;'>LESS</td>
									<td colspan='2'></td>
								</tr>
								<tr>
									<td></td>
									<td colspan='2' style='text-align:right; padding:0px 80px 0px 10px;'>
										<table border='0' cellpadding='0' id='pxTaxesContED' style='border-spacing:0px; font-family:NOR;'></table>
									</td>
								</tr>
								<tr>
									<td></td>
									<td style='text-align:right; padding:3px 5px;'>Total Tax</td>
									<td>
										<input style='font-family:NOR; font-size:18px; font-weight:bold; background-color:transparent; width:145px; border:0px; border-top:1px dashed black; text-align:right; color:red;' id='pxTotalTaxED' value='0.00' disabled>
									</td>
								</tr>
								<tr>
									<td colspan='3' style='padding:5px 0px;'></td>
								</tr>
								<tr>
									<td></td>
									<td style='text-align:right; padding:3px 5px;'><span style='font-size:12px; color:gray;' id='retentionLabelInEdit'>(Total &#10006; 1%)</span> Retention</td>
									<td>
										<input style='font-family:NOR; font-size:18px; font-weight:bold; background-color:transparent; width:145px; border:0px; text-align:right; color:red;' id='pxRetentionED' value='0.00' disabled>
									</td>
								</tr>
								<tr>
									<td colspan='3' style='padding:5px 0px;'></td>
								</tr>
							</table>

							<table border='0' cellspacing='0' style='margin:0px 0px 0px auto; font-family:NOR;'>
								<tr style='background-color:white;'>
									<td colspan='3' style='padding:10px 0px;'></td>
								</tr>
								<tr style='background-color:white;'>
									<td style=''></td>
									<td style='padding:3px 5px 3px 0px; min-width:265px;' colspan='2' id='adjustmentLabelED'>
										<label>
											<input type='checkbox' id='showHideAdj' style='cursor:pointer; vertical-align:middle; position:relative; bottom: .08em;' onclick='showHideAdjTableInEdit(this)' ".$adjChecked.">
											Adjustment <span style='color:gray; font-size:11px;'>(for special computation only)</span>
										</label>
									</td>
								</tr>
								<tr style='background-color:white;'>
									<td></td>
									<td colspan='2' style='padding:0px 0px 20px 0px;'>
										<table border='0' cellpadding='0' id='pxAdjustmentTableED' style='border-spacing:0px; margin:0px 0px 0px auto; font-size:14px; font-family:NOR; ".$adjShow."'>
											<tr>
												<td style='text-align:right; padding:3px 5px; vertical-align:bottom;'>Adjustment Type</td>
												<td>
													<select id='pxAdjustmentTypeED' style='font-family:NOR; font-size:18px; font-weight:bold; background-color:transparent; width:145px; border:0px; border-bottom:1px dashed silver; text-align:center;' onchange='updatePXAmountDetailsInEdit()'>
														".$adjSelected."
													</select>
												</td>
											</tr>
											<tr>
												<td style='text-align:right; padding:3px 5px; vertical-align:bottom;'>Description</td>
												<td>
													<input style='font-family:NOR; font-size:18px; font-weight:bold; text-align:center; color:black; background-color:transparent; width:145px; border:0px; border-bottom:1px solid black; padding-right:20px;' id='pxAdjustmentDescED' value='".$adjLabel."'>
												</td>
											</tr>
											<tr>
												<td style='text-align:right; padding:3px 5px; vertical-align:bottom;'>Amount</td>
												<td>
													<input style='font-family:NOR; font-size:18px; font-weight:bold; color:black; background-color:transparent; width:145px; border:0px; border-bottom:1px solid black; text-align:center; padding-right:20px;' id='pxAdjustmentAmountED' value='".number_format($adjAmount, 2)."' onkeydown='return isAmount(this,event)' onkeyup='updatePXAmountDetailsInEdit()'>
												</td>
											</tr>
										</table>
									</td>
								</tr>
								<tr style='background-color:white;'>
									<td style=''></td>
									<td colspan='2' style='text-align:right; padding:10px 20px 10px 0px; border-top:1px solid black; line-height:16px;'>
										<span style='padding:0px 5px; vertical-align:bottom; font-size:16px; color:gray;'>Net Amount</span>
										<span style='font-family:NOR; font-size:20px; font-weight:bold; color:black; background-color:transparent; padding-right:2px; text-align:right;' id='pxNetAmountED'>0.00</span>
									</td>
								</tr>
							</table>";

		$sheet .= "		</td>
					</tr>
				</table>";

		return $sheet;

	}

	function goodsListOfPXsThisPOInEdit($record, $currentPXTN) {
		
		$row = 0;
		$dispTotal = 0;
		$sheet = "";

		if($this->num_rows($record) > 0) {

			$sheet  = "";
			// $sheet  = "	<div style='text-align:left; margin-bottom:5px;'><span class='goodsNum'>5</span><span class='goodsField'>Review Details</span></div>";
			$sheet .= "	<table border='0' style='border-spacing:0px; font-size:14px; font-family:NOR; margin:20px auto;'>
							<thead>
								<tr>
									<th colspan='8' style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding:0px 0px; padding-left:5px;'>Payment History</th>
								</tr>
								<tr style='background-color:rgba(121,137,141,1); color:white;'>
									<th style='border-bottom:1px solid black; border-top:1px solid silver; border-left:1px solid silver;'></th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>TN</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Status</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Encoded</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Last Updated</th>
									<th style='text-align:right; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver;'>Amount</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver; white-space:nowrap;'>Check No.</th>
									<th style='text-align:left; padding:0px 5px; border-bottom:1px solid black; border-top:1px solid silver; white-space:nowrap; border-right:1px solid silver;'>Check Date</th>
								</tr>
								<tr>
									<th colspan='8' style='padding:1px 0px; border-bottom:1px solid silver;'></th>
								</tr>
							</thead>
							<tbody>
							";
			while ($data = $this->fetch_array($record)) {

				$trackingNumber = $data['TrackingNumber'];

				if($trackingNumber != $currentPXTN) {

					// $amount = $data['Amount'];
					$amount = $data['PO_Amount'];
					$total = $data['TotalAmountMultiple'];
					$dispAmount = $amount;
					if($total > 0) {
						$dispAmount = $total;
					}

					$dateEncoded = $data['DateEncoded'];
					$dateModified = $data['DateModified'];
					$status = $data['Status'];
					$checknumber = $data['checknumber'];
					$checkdate = $data['checkdate'];

					$sheet .= "	<tr>
									<td style='padding:0px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; font-size:11px; text-align:center;'>".++$row."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$trackingNumber."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$status."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$dateEncoded."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$dateModified."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px; text-align:right;'>".number_format($dispAmount, 2)."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$checknumber."</td>
									<td style='padding:2px 5px; border:1px solid silver; border-top:0px; width:0px; white-space:nowrap; border-left:0px;'>".$checkdate."</td>
								</tr>";

					$dispTotal += $dispAmount;

				}
			}

			if($dispTotal == 0) {
				// $sheet .= "	<tr>
				// 				<td colspan='8' style='text-align:center; border:1px solid silver; border-top:0px;'>No previous payments.</td>
				// 			</tr>
				// 			<tr style='display:none;'>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style=''></td>
				// 				<td style='padding:2px 6px; text-align:right; font-weight:bold; color:red; font-size:16px; font-weight:bold;' id='totalAmountPXsTracked'>".number_format($dispTotal, 2)."</td>
				// 			</tr>";

				$sheet = "<input type='hidden' id='totalAmountPXsTracked' value='".number_format($dispTotal, 2)."'>";

			}else {
				$sheet .= "	<tr>
								<td style=''></td>
								<td style=''></td>
								<td style=''></td>
								<td style=''></td>
								<td style=''></td>
								<td style='padding:2px 6px; text-align:right; font-weight:bold; color:red; font-size:16px; font-weight:bold;' id='totalAmountPXsTracked'>".number_format($dispTotal, 2)."</td>
							</tr>";

				$sheet .= "		</tbody>
							</table>";
			}

		}

		return $sheet;
		
	}

	function CreateCategoryListNewPr($record){
		$count = $this->num_rows($record);
		$sheet = '<div id="containerHeaderNewPR" style="width:800px; margin:0 auto; overflow-y:hidden; background-color:rgb(121, 137, 141);"></div>';
		$sheet .= '<div style="width:800px; height:200px; margin:0 auto; overflow-y:auto; border:1px solid rgb(219, 229, 235);">
						<table id="tableSelectCategory" style="border-spacing:0; width:100%; font-family:NOR;" border="0">';
		$sheet .= '<tr id="trCategoryListHeaderNewPR">';
		$sheet .= '		<td class="dataHeader1" style="padding:5px 10px; font-family:NOR; font-weight:normal; width:10px; background-color:grey"></td>
						<td class="dataHeader1" style="padding:5px 10px; font-family:NOR; font-weight:normal; width:125px; background-color:rgb(121, 137, 141);">Category<span style = "padding-left:2px;font-size:16px;font-weight:normal;color:orange;">(' . $count . ')</span></td>
						<td class="dataHeader1" style="padding:5px 10px; font-family:NOR; font-weight:normal; background-color:rgb(121, 137, 141);">Description</td>
						<td class="dataHeader1" style="padding:5px 10px; font-family:NOR; font-weight:normal; background-color:rgb(121, 137, 141); text-align:center;">Items</td>';
		$sheet .= '</tr>';
		if($count == 0){
				$sheet .= '	<tr>
								<td style = "padding:20px 50px;font-size:22px;font-family:oswald;" colspan = "5" >No record found.</td>
							</tr>';
		}
		while($data = $this->fetch_array($record)){
			$count = $data['Count'];
			$category = $data['Category'];
			$description = $data['Description'];
			$sheet .= '<tr onclick="getCategoryItemsUsingDesc(this, event)" style="cursor:pointer;">';
			$sheet .= '	<td style="width:10px; padding:10px; border-bottom:1px solid rgb(225, 229, 231);"><input type = "checkbox" style="position:relative; z-index:99999;"  onclick = "getCategoryItemsNewPR(this)"/></td>';
			$sheet .= '	<td style="padding:0 10px; border-bottom:1px solid rgb(225, 229, 231);"><span class="data1" style="font-family:NOR;">' . $category . '</span></td>';
			$sheet .= '	<td style="padding:0 10px; border-bottom:1px solid rgb(225, 229, 231);"><span class="data1" style="font-family:NOR;">' . $description . '</span></td>';
			$sheet .= '	<td style = "width:100px;padding:0 10px;border-bottom:1px solid rgb(225, 229, 231);text-align:center;"><span class="data1" style="font-family:NOR;">' . $count . '</span></td>';
			$sheet .= '</tr>';
		}
		$sheet .= '</table></div>';			
		return  $sheet;	
	}

	function CreateCategoryItemsNew($record){		
		$count = $this->num_rows($record);
		$sheet = '<table id = "prItemsTableGoods" style = "border-spacing:0;border:1px solid rgb(219, 229, 235);width:800px;margin:0 auto; font-family:NOR;" border ="0">';
		$sheet .= '<tr class = "dataHeader1" style="font-family:NOR; font-weight:normal;">';
		$sheet .= '	<td style = "padding:5px 10px;font-size:18px; background-color:grey;">&nbsp;</td>
					<td style = "padding:5px 10px;font-size:18px; background-color:rgb(121, 137, 141);">Code</td>
					<td style = "padding:5px 10px;font-size:18px; background-color:rgb(121, 137, 141);">Description<span style = "padding-left:2px;font-size:16px;font-weight:normal;color:orange;">(' . $count . ')</span></td>
					<td style = "padding:5px 10px;font-size:18px; background-color:rgb(119, 122, 122);border:1px solid silver;"><input onclick ="selectAllGoods(this)" type = "checkbox" checked/></td>
					<td colspan = "5"  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Qty x Price</td>';
		$sheet .= '</tr>';
		
		
			
		$i = 1;
		$totalAmount = 0;
		$fund = '';
		while($data = $this->fetch_array($record)){
			
			$fund =  $data['Fund'];
			$amount =  $data['Amount'];
			$item = $data['Item'];
			$itemNo = $data['ItemNo'];
			
			$fund = $data['Fund'];
			
			$qtyX =  $data['Qty'];
			
			$qty =  $data['Qty'];
			$desc = $data['Description'];
			
			$category = $data['Category'];
			$unit = $data['Unit'];
			
			$accountCode = $data['AccountCode'];
			$programCode =  $data['ProgramCode'];
			
			//$price = $amount / $qtyX;
			$price = $data['Cost'];
			$price = round($price,2);
			
			$amountX =  $qty * $price;
			$totalAmount += $amountX;
			$sheet .= '<tr style = "background-color:rgb(206, 215, 218);">';
			$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
						<span class = "number" 
							style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">' . $i++ . '</span><input type = "hidden"  value = "' . $itemNo . '"></td>';
			
			$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
						<input onclick = "clickInput(this)" style = "font-family:NOR; font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;" value ="' . $programCode . '" class = "data1"/>
						<input onclick = "clickInput(this)" style = "font-family:NOR; font-size:14px;width:80px;border:0;background-color:transparent;color:black;" value = "' . $accountCode . '" class = "data1"/></td>';
			
			$sheet .= '<td style = "width:450px;padding:10px 2px;border-bottom:2px solid white;">
						<textarea onclick="this.style.backgroundColor=\'white\';"  style = "width:100%;font-size:16px; resize:vertical;color:rgb(45, 90, 118);padding-bottom:5px;padding-left:5px;color:black; font-family:NOR; " class = "data1">' .  $desc . '</textarea>' . '</td>';
			$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
						<input onclick ="selectCalculateAddPRGoods(this)" type = "checkbox" checked/>
						</td>';
			$sheet .= '<td style = "border-bottom:2px solid white;width:10px;">
							<input onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPRNew(this)" class = "data1" value = "' . $qty . '" maxlength = "8" 
									style = "font-family:NOR; color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:16px;border-bottom:1px solid silver;background-color:transparent;padding:2px;"/>
								<br/>
							<input onclick = "clickInput(this)" value = "' . $unit . '" style = "font-family:NOR; color:grey; font-size:15px;border:0;background-color:transparent; text-align:center;width:85px;color:black;"class = "data1"/>
						</td>';
			$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white; font-weight:bold;">
							&times;
						</td>';
			$sheet .= '<td style = "padding:0 2px;border-bottom:2px solid white;">
						<input onclick = "" onkeydown="return isAmount(this,event)" class = "data1" onkeyup ="calculateAddPRNew(this)" value  = ' . number_format($price,2) . '  
						style = "background-color:rgb(220, 228, 232);  width:100px;text-align:left;color:black;border:0;font-size:14px;;padding:5px; 2px;font-weight:bold; font-family:NOR; text-align:right;"/></td>';
			$sheet .= '<td style = "width:20px;border-bottom:2px solid white;text-align:center;">=</td>';
			$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
						<input value = ' . number_format($amountX,2) . ' disabled 
							style = "color:rgb(45, 90, 118);font-weight:bold;width:90px;border:0;font-size:16px; background-color:transparent;padding:2px;border-bottom:1px dashed silver; text-align:right; font-family:NOR;" class = "data1"/></td>';
			$sheet .= '</tr>';	
		}
		$sheet .= '<tr>';
		$sheet .= '<td colspan ="9"  style = "padding:0px  2px;">
					
					<input id ="totalAmountItemsGoods" value = ' . number_format($totalAmount,2) . ' disabled  class = "data1"  style = "width:170px;font-size:21px;border:0;background-color:transparent;text-align:right;font-weight:bold;letter-spacing:1px;color:red;padding-right:10px;float:right; font-family:NOR;" />	
					<span id  = "angFundGoods" style = "float:right;font-family:NOR;font-size:22px;color:rgb(64, 161, 202);">'  . $fund .  '</span>
					</td>';
		$sheet .= '</tr>';
		
		$sheet .= '</table>';
		$sheet0 = '<div style = " ">';
		$sheet2 = '</div>';
		return   $sheet0  . $sheet .$sheet2 ;	
	}

	// NOTE: naa ni diri daan kay in the future naa mn mga default terms and conditions per type sa transaction so para dli na mag transfer2 diri nlng daan gbutang - 2023-06-21
	function CreateTermsNConditionsSheet($mode, $terms) {

		$id = "";
		if($mode == 'newPR') {
			$id = "goodsPRnewTerms";
		}elseif($mode == 'newPO') {
			$id = "goodsPOnewTerms";
		}elseif($mode == 'editPR') {
			$id = "goodsPReditTerms";
		}elseif($mode == 'editPO') {
			$id = "goodsPOeditTerms";
		}

		$sheet = "	<table border='0' cellpadding='0' style='border-spacing:0px; width:100%;'>
						<tr>
							<td style='padding:5px 10px; font-size:18px; background-color:rgb(121, 137, 141); color:white;'>Terms and Conditions</td>
						</tr>
						<tr>
							<td style='padding:10px 10px; background-color:rgb(206, 215, 218);'>
								<textarea id='".$id."' onclick='this.style.backgroundColor=\"white\";' style='width:100%; font-size:16px; resize:vertical; color:rgb(45, 90, 118); padding-bottom:5px; padding-left:5px; color:black; font-family:NOR; min-height:160px;' class='data1'>".$terms."</textarea>
							</td>
						</tr>
					</table>";

		return $sheet;

	}

	function CreateHeaderNewSheet($mode, $terms) {

			$id = "";
			if($mode == 'newPR') {
				$id = "goodsPRnewHeader";
			}elseif($mode == 'newPO') {
				$id = "goodsPOnewHeader";
			}elseif($mode == 'editPR') {
				$id = "goodsPReditHeader";
			}elseif($mode == 'editPO') {
				$id = "goodsPOeditHeader";
			}
	
			$sheet = "	<table border='0' cellpadding='0' style='border-spacing:0px; width:100%;'>
							<tr>
								<td style='padding:5px 10px; font-size:18px; background-color:rgb(121, 137, 141); color:white;'>Header</td>
							</tr>
							<tr>
								<td style='padding:10px 10px; background-color:rgb(206, 215, 218);'>
									<textarea id='".$id."' onclick='this.style.backgroundColor=\"white\";' style='width:100%; font-size:16px; resize:vertical; color:rgb(45, 90, 118); padding-bottom:5px; padding-left:5px; color:black; font-family:NOR; min-height:100px;' class='data1'>".$terms."</textarea>
								</td>
							</tr>
						</table>";
	
			return $sheet;
	
		}

	function CreateSelectApprovePRNew($record){
		$sheet = '<select id = "selectTrackingPRNew" class = "goodsData2" onchange = "SelectItemsByPRReleaseNew(this)">';	
		$sheet .= '<option value = "">&nbsp;</option>';
		$i = 1;
		while($data = $this->fetch_array($record)){
			
			$chargeType = $data['ChargeType'];
			if($chargeType > 1){
				$amount =  $data['TotalAmountMultiple'];
			}else{
				$amount = $data['Amount'];
			}
			if($i % 2 == 0){
				$sheet .= '<option style = "background-color:rgb(223, 226, 228);" value = "' .  $data['TrackingNumber'] .  '">';
			}else{
				$sheet .= '<option value = "' .  $data['TrackingNumber'] .  '">';
			}
			
			$sheet .= $data['TrackingNumber'] . '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' . number_format($amount,2)  ;
			$sheet .= '</option>';
			$i++;
		}
		$sheet .= '</select>';
		return $sheet;	
	}

	function CreatePOItemsNew($record){
		$row = 0;
		$totalAmount = 0;
		$sheet = "";
		$count = $this->num_rows($record);

		$sheet .= "<div style='text-align:left; font-family:NOR; font-weight:bold; font-size:16px; padding-left:5px;'>List of Items</div>";
		$sheet .= "<table id='poItemsTableGoods' border='0' style='border-spacing:0px; width:100%;'>
						<tr class='goodsDataHeader1'>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'></td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'>Code</td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;'>Description&nbsp;<span style='color:orange;'>(".$count.")</span></td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold; white-space:nowrap; text-align:right;'>PR Amount</td>
							<td style='font-weight:normal; padding:2px 10px 2px 10px; font-weight:bold; background-color:rgb(119, 122, 122); border:1px solid silver; border-top:0px; border-bottom:0px;'><input type='checkbox' onclick='selectAllPO(this)' checked></td>
							<td style='font-weight:normal; padding:0px 10px 2px 10px; font-weight:bold;' colspan='6'>Qty&nbsp;<span style='font-size:12px;'>&#10006;</span>&nbsp;Price</td>
						</tr>";

		while ($data = $this->fetch_array($record)) {
			$amount =  $data['Amount'];
			$qty =  intval($data['Qty']);
			$price =  $data['Amount'];
			$amountX =  $data['Total'];
			$itemDes =  $data['Item'];
			$description = $data['Description'];
			$category  =  $data['Category'];
			$program = $data['ProgramCode'];
			$accountCode = $data['Code'];
			$unit = $data['Unit'];

			$totalAmount += $amountX;

			$sheet .= "	<tr style='background-color:rgb(206, 215, 218);'>
							<td style='width:0px; padding:8px 8px; border-bottom:2px solid white; vertical-align:top;'>
								<span class='goodsItemNum'>".++$row."</span><input type='hidden' value='".$itemDes."'><input type='hidden' value='".$qty."'><input type='hidden' value='".$price."'>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver;' value='".$program."'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px;' value='".$accountCode."'>
							</td>
							<td style='padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<textarea style='font-size:14px; resize:vertical; color:black; font-family:NOR; width:450px; max-width:450px; min-height:60px; overflow:hidden; padding:2px 5px;' onclick='this.style.backgroundColor=\"white\";'>".$description."</textarea>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountX,2)."' style='color:rgb(45, 90, 118); text-align:right; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR;' disabled>
							</td>
							<td style='width:0px; padding:12px 10px; border-bottom:2px solid white; vertical-align:top; background-color:rgb(222, 228, 231);'>
								<input type='checkbox' onclick='selectCalculateAddPO(this)' checked>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPO(this)' value='".$qty."' maxlength='8' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver; color:rgb(45, 90, 118);' value='".$program."'>
								<input class='data1 goodsItemPlainInp' onclick='clickInput(this)' style='font-size:14px;' value='".$unit."'>
							</td>
							<td style='width:0px; padding:8px 5px; border-bottom:2px solid white; vertical-align:top; font-size:12px;'>
								&#10006;
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' onkeydown='return isAmount(this,event)' onkeyup='calculateAddPO(this)' value='".number_format($price,2)."' style='background-color:rgb(220, 228, 232);  width:97px; color:black; border:0; font-size:14px; font-weight:bold; padding:2px 5px; font-family:NOR; text-align:right;' >
							</td>
							<td style='width:0px; padding:6px 3px; border-bottom:2px solid white; vertical-align:top; font-weight:bold;'>=</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($amountX,2)."' style='color:rgb(45, 90, 118); text-align:left; font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px; font-family:NOR; text-align:right;' disabled>
							</td>
						</tr>";
		}
		$sheet .= "	<tr>
						<td colspan='2'></td>
						<td colspan='2' style='padding:0px 10px; padding-right:8px;'>
							<input class='data1' id='totalAmountItemsPR' value='".number_format($totalAmount,2)."' style='font-size:16px; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; color:red; font-family:NOR;' disabled>
						</td>
						<td colspan='3'></td>
						<td colspan='3' style='padding:0px 10px; padding-right:5px;'>
							<input class='data1' id='totalAmountItemsPO' value='".number_format($totalAmount,2)."' style='font-size:16px; border:0; background-color:transparent; width:100%; text-align:right; font-weight:bold; letter-spacing:1px; color:red; font-family:NOR;' disabled>
						</td>
					</tr>";

		$sheet .= "</table>";

		return $sheet;
	}

	function CreateViewListPX($record){
		$count = $this->num_rows($record);	
		$sheet3 = ''; 
		$sheet0 = '<table id = "selectedPRPOtable" style = "border-spacing:0;margin:0 auto;width:100%;border:1px solid rgb(215, 216, 217);"  border= "0">';
		$sheet2 = '<tr style = "background-color:rgb(207, 208, 209);">
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; border-bottom:0px solid grey;">Program</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; border-bottom:0px solid grey;">&nbsp;</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:left;border-bottom:0px solid grey;">Desciption<span class = "countTotal"> (' . $count . ')</span></td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey;">Qty</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey;">&nbsp;</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey;">Cost</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey;">&nbsp;</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey;">Total Cost</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey; white-space:nowrap;">Days Delayed</td>
					<td class = "dataHeader1" style="font-size:14px; padding:5px 10px; text-align:center;border-bottom:0px solid grey;">
						Total
					</td>
				 </tr>';
				 
				 $c1 = '';
				 $c2 = '';
				 
				  $gTotal = 0;	
				  $programO = '';
				  $codeO = '';
				  $categoryO = '';
				  $categoryTotal = 0;
				  $programTotal = 0;
				  $LDTotal = 0;
				  $curLDTotal = 0;
				  $i = 1;
				   while($data = $this->fetch_array($record)){
						   $prAccountCode = $data['Code'];
						$prTrackingNumber = $data['TrackingNumber'];
						
						$amount = $data['Amount'];
						$category = $data['Category'];
						$code = $data['Code'];
						$programCode = $data['ProgramCode'];
						$qty = $data['Qty'];
						$unit = $data['Unit'];
						$description = $data['Description'];
						$cost = $data['Amount'];
						$totalCost = $data['Total'];

						$days = $data['Days'];
						$ld = $data['LiquidatedDamages'];
						$totalLD = $data['TotalLD'];

						
						
						if($programO != $programCode){
							
							if($i > 1){
								  $sheet3 .= '<tr>
												<td colspan="8" style="padding:10px;text-align:right;padding-right:15px;">
													<span  class = "data1" style = "color:orange;font-weight:bold;">' . $programO . '</span>
													<span id = "selectedPOTotal" class = "data1" style = "letter-spacing:1px; padding-left:10px;font-size:24px;color:black;font-weight:bold;">' . number_format($programTotal,2) . '</span>
												</td>
												<td colspan="2" style="padding:10px;text-align:right;padding-right:15px;">
													<span id = "" class = "data1" style = "letter-spacing:1px; padding-left:10px;font-size:24px;color:black;font-weight:bold;">' . number_format($curLDTotal,2) . '</span>
												</td>
											</tr>';	
								$programTotal = $totalCost;
								$curLDTotal = $totalLD;
							}else{
								$programTotal = $totalCost;
								$curLDTotal = $totalLD;
							}
							$c1 = $code;
							$programO = $programCode;
						}else{
							
							if($c1 != $code){
								$c1 = $code;
							}else{
								$c1 = "";
							}
							
							$programTotal = $programTotal + $totalCost;
							$programCode = '';
							$programName = '';

							$curLDTotal += $totalLD;
						}
						
						$LDTotal += $totalLD;
					
						if($programCode != ''){
							$sheet3 .= '<tr>	
										<td style = "background-color:rgb(222, 226, 228);padding:5px ;border-bottom:1px solid silver;border-top:1px solid silver;padding-left:10px;"><div class = "data1"style = "font-weight:bold;color:rgb(26, 142, 196);font-size:19px;">' . $programO .  '
										<span style = "font-size:13px;color:black;text-shadow:0px 0px 2px white;font-weight:normal;padding-left:3px;" class = "data1"></span></div></td>	
										<td style = "background-color:rgb(222, 226, 228);padding:5px ;border-bottom:1px solid silver;border-top:1px solid silver;"></td>
										<td colspan ="9" style = "color:black;font-size:12px;background-color:rgb(222, 226, 228);padding:5px 12px;border-bottom:1px solid silver;border-top:1px solid silver;"><div  class = "data1" style = "font-size:15px;">' . $category .  '</div></td>
									</tr>'; 
						}
						
						if($i % 2 == 0){
							$sheet3 .= '<tr style= "background-color:rgb(221, 236, 243);">';
						}else{
							$sheet3 .= '<tr  >';
						}
						   
						   $sheet3 .= 	'
									<td class = "tableDataRows3" style= "vertical-align:top; padding:12px 10px;">
										<span class = "data1" style= "font-size:13px;padding-left:10px;">' . $c1 . '</span>
									</td>
									<td class = "tableDataRows3" style="padding:13px 2px;text-align:right;"><span style = "padding: 2px;font-style:italic;color:black;font-weight:bold;">' . $i++ . '</span></td>	
									<td class = "tableDataRows3" style="padding:10px;">
										<div class = "data1" style = "font-size:14px;white-space: pre-line; word-wrap: break-word;background-color1:white;padding:0px 5px;">' . nl2br($description) . '</div>
									</td>
									<td class = "tableDataRows3" style="padding:10px;text-align:center;">
										<div style = "border-bottom:1px solid silver;color:rgb(45, 90, 126);font-weight:bold;" class = "data1">' . intVal($qty) . '</div>
										<span class = "data1">' . $unit . '</span>
									</td>	
									<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span >x</span></td>
									<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span class = "data1" style = "color:rgb(45, 90, 126);font-weight:bold;">' . number_format($cost,2) . '</span></td>
									<td class = "tableDataRows3" style="padding:10px;text-align:right;"><span >=</span></td>
									<td class = "tableDataRows3" style="padding:10px;text-align:right;">
										<span style = "font-weight:bold;padding:5px;" class = "data1">' . number_format($totalCost,2) . '</span>
									</td>
									<td class = "tableDataRows3" style="padding:10px;text-align:center;">
										<span style = "font-weight:bold;padding:5px; color:rgb(45, 90, 126);" class = "data1">' . intval($days) . '</span>
									</td>
									<td class = "tableDataRows3" style="padding:10px;text-align:right;">
										<span style = "font-weight:bold;padding:5px;" class = "data1">' . number_format($totalLD,2) . '</span>
									</td>
								</tr>';
						
						$gTotal = $gTotal + $totalCost;
				   }
		$sheet3 .= '<tr>
					<td colspan="8" style="padding:10px;text-align:right;padding-right:10px;">
						<span class = "data1" style = "color:orange;font-weight:bold;">' . $programO . '</span>
						<span  class = "data1" id = "selectedPOTotal" class = "data1" style = "letter-spacing:1px; color:red;padding-left:10px;font-size:24px;color:black;font-weight:bold;">' . number_format($programTotal,2) . '</span>
					</td>
					<td colspan="2" style="padding:10px;text-align:right;padding-right:10px;">
						<span  class = "data1" id = "" class = "data1" style = "letter-spacing:1px; color:red;padding-left:10px;font-size:24px;color:black;font-weight:bold;">' . number_format($curLDTotal,2) . '</span>
					</td>
					</tr>';
		$sheet4 = '	<tr>
						<td class = "data1" colspan="8" style="padding:10px;text-align:right;padding-right:10px;">Total
							<span class = "data1" id = "selectedPOTotal" style = "letter-spacing:1px; padding-left:26px; font-size:26px;font-weight:bold;">' . number_format($gTotal,2) . '</span>
						</td>
						<td colspan="2" style="padding:10px;text-align:right;padding-right:10px;">
							<span class = "data1" id = "selectedPXTotal" style = "letter-spacing:1px; color:red;padding-left:26px; font-size:26px;font-weight:bold;">' . number_format($LDTotal,2) . '</span>
						</td>
					  </tr>
				  </table>';
		return  $sheet0 . $sheet2 .  $sheet3 .$sheet4 ;
	}

	function CreatePOItemsListForPXEdit($record) {
		$sheet = "";
		$row = 0;

		$sheet .= "<div class='editorContainer' border='0' cellpadding='0' style=''>
						<table border='0' cellpadding='0' class='editorTable' style='background-color:rgb(206, 215, 218); border-collapse:collapse;'>
							<tr>
								<td class = 'editorHeader' colspan = '2' style = 'text-align:left; border-bottom:2px solid white;' >PO Item Selection<div onclick ='closeAbsolute(this)' id='pxEditorClose' class = 'closeEditor'></div></td>
							</tr>
							<tr>
								<td>
									<table border='0' cellpadding='0' style='border-spacing:0px;'>";

		while ($data = $this->fetch_array($record)) {

			$trackingNumber = $data['TrackingNumber'];
			$category = $data['Category'];
			$programCode = $data['ProgramCode'];
			$accountCode = $data['Code'];
			$unit = $data['Unit'];
			$itemCode = $data['Item'];
			$description = $data['Description'];
			$qty = $data['Qty'];
			$amount = $data['Amount'];	
			$total = $data['Total'];
	
			$sheet .= "	<tr class='pxItemSelect' style=''>
							<td style='width:0px; padding:8px 8px; border-bottom:2px solid white; vertical-align:top;'>
								<span class='goodsItemNum'>".++$row."</span><input type='hidden' value='".$itemCode."'>
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' disabled style='font-size:14px; color:black; font-weight:bold; border-bottom:1px solid silver;' value='".$programCode."'>
								<input class='data1 goodsItemPlainInp' disabled style='font-size:14px; color:black;' value='".$accountCode."'>
							</td>
							<td style='padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<textarea style='font-size:14px; resize:vertical; color:black; font-family:NOR; width:450px; max-width:450px; min-height:60px; overflow:hidden; padding:2px 5px; background-color:transparent; border:0px; border-bottom:1px solid silver;' onclick='this.style.backgroundColor=\"white\";' disabled>".$description."</textarea>
							</td>
							<td style='width:0px; padding:5px 5px; padding-top:8px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1 goodsItemPlainInp' disabled maxlength='8' style='font-size:14px; font-weight:bold; border-bottom:1px solid silver; color:rgb(45, 90, 118);' value='".$qty."'>
								<input class='data1 goodsItemPlainInp' disabled style='font-size:14px; color:black;' value='".$unit."'>
							</td>
							<td style='width:0px; padding:8px 5px; border-bottom:2px solid white; vertical-align:top; font-size:12px;'>
								&#10006;
							</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' disabled value='".number_format($amount,2)."' style='background-color:rgb(220, 228, 232);  width:97px; text-align:right; color:black; border:0; font-size:14px; font-weight:bold; padding:2px 5px; font-family:NOR;' >
							</td>
							<td style='width:0px; padding:6px 3px; border-bottom:2px solid white; vertical-align:top; font-weight:bold;'>=</td>
							<td style='width:0px; padding:5px 5px; border-bottom:2px solid white; vertical-align:top;'>
								<input class='data1' value='".number_format($total,2)."' style='color:rgb(45, 90, 118); font-weight:bold; width:97px; border:0; font-size:14px; background-color:transparent; padding:2px 5px 2px 5px; font-family:NOR; text-align:right;' disabled>
							</td>
							<td style='width:0px; padding:10px 8px 0px 8px; border-bottom:2px solid white; background-color:rgb(222, 228, 231); vertical-align:top;'>
								<input type='checkbox' onclick='pxAddThisItemToCurrentEdit(this)' style='cursor:pointer;'>
							</td>
						</tr>";

		}

		$sheet .= "		</table>";
		$sheet .= "		</td>
					</tr>";
		$sheet .= "</table>";
		$sheet .= "</div>";

		return $sheet;
	}

	//---------------------------------------------------------------------------------------------------GOODS AND SERVICES PO - END


	//---------------------------------------------------------------------------------------------------NEW PO PX SEARCHING SHEETS - START

	function CreateGenDetailsRow($rowNum, $label, $value, $trackingNumber, $className, $type) {

		$sheet = "";

		$id = "";
		if($label == 'Delivery Date') {
			$id = "id='poDeliveryDate'";
		}elseif($label == 'Inspection Date') {
			$id = "id='poInspectionDate'";
		}elseif($label == 'Mode') {
			$id = "id='poPOMode'";
		}

		if($type == 1) {

			$sheet .= "	<tr>
							<td style='width:0px; white-space:nowrap; padding:0px 10px 0px 10px; font-size:18px;'>
								<span style='display:inline-block; width:20px; text-align:right; font-size:20px; color:rgb(41, 111, 152); font-family:NOR; padding-right:8px;'>".$rowNum."</span>
								<span class='genDtlLabel'>".$label."</span>
							</td>
							<td style='border-bottom:1px solid silver; padding:0px 10px 0px 10px; font-weight:bold; font-size:22px; white-space:nowrap; min-width:100px;'>
								<span ".$id." style='color:red; cursor:pointer;' onclick='searchThisPartner(this)' >".$value."</span>
							</td>
							<td>
								<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editThis(this)'>EDIT</span>
							</td>
						</tr>";

		}elseif($type == 2){

			$sheet = "	<tr>
							<td style='width:0px; white-space:nowrap; padding:0px 10px 0px 10px; font-size:18px;'>
								<span style='display:inline-block; width:20px; text-align:right; font-size:20px; color:rgb(41, 111, 152); font-family:NOR; padding-right:8px;'>".$rowNum."</span>
								<span class='genDtlLabel'>".$label."</span>
							</td>
							<td style='border-bottom:1px solid silver; padding:0px 10px 0px 10px; font-weight:bold; font-size:22px; white-space:nowrap; min-width:100px;'>
								<span ".$id." class='data1' style='font-weight:bold; font-size:22px; color:rgb(22, 178, 217);'>".$value."</span>
							</td>
							<td>
								<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editThis(this)'>EDIT</span>
							</td>
						</tr>";

		}elseif($type == 3){

			$sheet = "	<tr>
							<td style='width:0px; white-space:nowrap; padding:0px 10px 0px 10px; font-size:18px;'>
								<span style='display:inline-block; width:20px; text-align:right; font-size:20px; color:rgb(41, 111, 152); font-family:NOR; padding-right:8px;'>".$rowNum."</span>
								<span class='genDtlLabel'>".$label."</span>
							</td>
							<td style='padding:0px 10px 0px 10px; font-weight:bold; font-size:22px; white-space:nowrap; min-width:100px;'>
								<span ".$id." class='data1' style='font-weight:bold; font-size:22px; color:red;'>".$value."</span>
							</td>
							<td>
								<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editThis(this)'>EDIT</span>
							</td>
						</tr>";

		}else{
			$sheet = "	<tr>
							<td style='width:0px; white-space:nowrap; padding:0px 10px 0px 10px; font-size:18px;'>
								<span style='display:inline-block; width:20px; text-align:right; font-size:20px; color:rgb(41, 111, 152); font-family:NOR; padding-right:8px;'>".$rowNum."</span>
								<span class='genDtlLabel'>".$label."</span>
							</td>
							<td ".$id." style='border-bottom:1px solid silver; padding:0px 10px 0px 10px; font-weight:bold; font-size:22px; white-space:nowrap; min-width:100px;'>".$value."</td>
							<td>
								<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editThis(this)'>EDIT</span>
							</td>
						</tr>";

		}


		return $sheet;

	}

	function NewCreateDoctrackInfoPO($record) {
		$sheet = "";
		$genDetails1 = "";
		$genDetails2 = "";


		$grp = '';
		$sheet = '';
		$logOffice = $_SESSION['gso'];
		$acct = $_SESSION['accountType'];
		if($_SESSION['accountType'] >= 2){
			$className = 'label19';
		}else{
			$className = 'hide';	
		}	

		$trackingType = $record['TrackingType'];
		$status = $record['Status'];
		$office = $record['Office'];
		$row = 0;

		// ------------------------------------------------------------------------------------------------- COLUMN 1 - GEN DETAILS - START
		$genDetails1 .= "<table border='0' cellpadding='0' style='border-spacing:0px; font-family:Oswald;'>";

		$trackingNumber = $record['TrackingNumber'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'TN', $trackingNumber, $trackingNumber, 'hide', 0);

		$claimant =  strtoupper(utf8_encode($record['Claimant']));
		$className =  $this->permissionClassByField($trackingType,$status,$office,"Supplier");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Supplier', $claimant, $trackingNumber, $className, 0);

		$complex = $record['Complex'];
		if($complex == 1 ){
			$complexity = "Simple Transaction";
		}else if($complex == 2 ){
			$complexity = "Complex Transaction";
		}else{
			$complexity = "Simple Transaction";
		}

		$className =  $this->permissionClassByField($trackingType, $status, $office,"Complex");	
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Transaction Classification', $complexity, $trackingNumber, $className, 2);

		$poNumber = $record['PO_Number'];
		$className =  $this->permissionClassByField($trackingType,$status,$office,"PONumber");	
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'PO Number', $poNumber, $trackingNumber, $className, 0);

		$poDate = $record['PoDate'];
		$className =  $this->permissionClassByField($trackingType,$status,$office,"PODate");	
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'PO Date', $poDate, $trackingNumber, $className, 0);

		$obrNumber = $record['OBR_Number'];
		$className =  $this->permissionClassByField($trackingType,$status,$office,"OBRNumber");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'OBR Number', $obrNumber, $trackingNumber, $className, 0);

		$prMonth =  $record['PR_Month'];
		$className =  $this->permissionClassByField($trackingType,$status,$office,"PRMonth");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'PR Sched', $this->numberToQuarter($prMonth), $trackingNumber, $className, 0);

		$prTrackingNumber = $record['PR_TrackingNumber'];
		$className =  $this->permissionClassByField($trackingType,$status,$office,"PRTrackingNumber");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'PR Tracking Number', $prTrackingNumber, $trackingNumber, $className, 1);

		$genDetails1 .= "</table>";

		// ------------------------------------------------------------------------------------------------- COLUMN 1 - GEN DETAILS - END


		// ------------------------------------------------------------------------------------------------- COLUMN 2 - GEN DETAILS - START

		$genDetails2 .= "<table border='0' cellpadding='0' style='border-spacing:0px; font-family:Oswald;'>";



		$fund = $record['Fund'];
		$className =  $this->permissionClassByField($trackingType,$status,$office,"Fund");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Fund', $fund, $trackingNumber, $className, 0);

		$nature = $record['NatureOfPayment'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"NatureOfPayment");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Nature of Payment', $nature, $trackingNumber, $className, 0);

		$specifics = $record['Specifics'];
		if($specifics == 'Combi') {
			$specifics = 'Agricultural products & other Goods/Items';
		}
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Specifics', $specifics, $trackingNumber, 'hide', 0);

		$mode = $record['ModeOfProcurement'];
		$modOfProcList = [	'','Competitive Bidding','Shopping','Shopping 52.1.b','Alternative','Agency to Agency','Negotiated','Negotiated Procurement 53.9(SVP)',
							'Negotiated Procurement 53.1(TFB)','Negotiated Procurement 53.6(MS)','Negotiated Procurement 53.7','Negotiated Procurement 53.2(E.C.)',
							'Postal Office','Direct Contracting','Repeat Order','Two Failed Biddings(TFB)','Extension of Contract Appx. 21 Sec. 3.31',
							'Renewal of Contract Based on Appendix 21 3.3.1.3','Agency to Agency (DBM)','Lease of Real Property Sec 5.10'];

		if($mode != "") {
			$mode = $modOfProcList[$mode];
		}

		$className = $this->permissionClassByField($trackingType,$status,$office,"POMode");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Mode', $mode, $trackingNumber, $className, 0);

		$pyTerm = $record['PaymentTerm'];
		if($pyTerm == 1) {
			$pyTerm = 'After full delivery';
		}elseif($pyTerm == 2) {
			$pyTerm = 'Per Statement';
		}elseif($pyTerm == 3) {
			$pyTerm = 'Cash on Delivery';
		}elseif($pyTerm == 4) {
			$pyTerm = 'Complete Delivery';
		}

		$className = $this->permissionClassByField($trackingType,$status,$office,"PaymentTerm");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Payment Term', $pyTerm, $trackingNumber, $className, 0);

		$invoiceNumber = $record['InvoiceNumber'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"InvoiceNumber");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Invoice Number', $invoiceNumber, $trackingNumber, $className, 0);

		$invoiceDate = $record['InvoiceDate'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"InvoiceDate");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Invoice Date', $invoiceDate, $trackingNumber, $className, 0);

		$retentionTN = $record['RetentionTN'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"RetentionTN");
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Retention TN', $retentionTN, $trackingNumber, $className, 1);

		$genDetails2 .= "</table>";

		// ------------------------------------------------------------------------------------------------- COLUMN 2 - GEN DETAILS - END


		$supplierClass = $record['SuppClassification'];
		$supplierType = $record['SuppType'];
		$supplierTIN = $record['SuppTIN'];
		$supplierCode = $record['SuppCode'];


		$trackingPartner = $record['TrackingPartner'];
		$year = $record['Year'];
		$officeName = $record['OfficeName'];
		$prNumber = $record['PR_Number'];
		$controlNo = $record['ControlNo'];
		$periodType  = $record['PeriodType'];
		$payeeNumber = $record['PayeeNumber']; 
		$total = $record['TotalAmountMultiple'];
		$amount = $record['PO_Amount'];
		$poAmount = $amount;
		$pendingNote = $record['Remarks'];
		$remarksNote = $record['Remarks1'];
		$claimType  = $record['ClaimType'];
		$docType  = $record['DocumentType'];
		$subCode = $record['SubCode'];
		$peorOfc = $record['PeaceOfficeId'];
		$periodType = $record['PeriodType'];
		$periodValue = $record['PeriodMonth'];
		$document  = $record['DocumentType'];
		$category =  $record['PR_CategoryCode'];
		$categoryName =  $record['CategoryName'];
		$chargeType = $record['ChargeType'];
		$prData = $record['PR_Data'];	
		
		$encodedBy = utf8_encode($record['EncodedBy']);
		$dateEncoded = $record['DateEncoded'];
		$dateUpdated = $record['DateModified'];
		$completion = $record['Completion'];
		$batchTracking = $record['BatchTracking']; 
		$grp = $record['GRP'];
		$programCode = $record['PR_ProgramCode'];
		$conformDate = $record['ConformDate'];

		$poRecords =  $this->SearchPOrecord($trackingNumber);
		$inputParms = ['PO_Number' => $poNumber,'ConformDate' => $conformDate,'OBR_Number' => $obrNumber];

		$classNamePOEdit =  $this->permissionClassByField($trackingType,$status,$office,"PRdetails"); 

		// <div style='line-height:28px;'>
		// 	<span class='data1 lnk'  style='margin-left:10px; font-size:18px; letter-spacing:1px; color:black;' onclick='alertAIRForm()'>4. Acceptance Form</span>
		// </div>

		$classNameRemarks = $this->permissionClassByField($trackingType,$status,$office,"Remarks1");

		$sheet .= "	<table border='0' cellpadding='0' style=''>
						<tr>
							<td colspan='2' style='background-color:rgb(23, 207, 253); padding:15px 0px;'>
								
								<span class='label7' style='color:white;padding-left:20px;'>Status</span>
								<span id='trackType' style='text-shadow:0px 0px 10px black; color:rgb(42, 122, 172); font-weight:bold; color:white; font-size:34px;' class='data1'>".$trackingType." - </span>
								<span id='labelStatus' style='text-shadow:0px 0px 10px black;color:rgb(42, 122, 172); font-weight:bold;color:white;font-size:34px;letter-spacing:1px;font-weight:bolder;' class='data1'>".$status."</span>
								
								<div style='color:black;padding-left:5px;width:110px;display:inline-block;display:none;'>".$this->ezDate1($dateUpdated)."</div>
								<div style='padding:5px;padding-left:75px;color:white;text-shadow:0px 0px 1px white;letter-spacing:1px;' class='data1'>".$officeName."</div>
							
							</td>
						</tr>
						<tr>
							<td style='vertical-align:top; padding:40px 10px 20px 20px; width:0px;'>".$genDetails1."</td>
							<td style='vertical-align:top; padding:40px 20px 20px 10px;'>".$genDetails2."</td>
						</tr>
						<tr>
							<td colspan='2'>
								<div style='padding-top:20px;'>
									<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Payment History</span>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:0px 10px;'>".$this->POPaymentHistory($trackingNumber)."</td>
						</tr>
						<tr>
							<td colspan='2'>
								<div style='margin-top:20px;padding-top:20px;'>
									<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Printables</span>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan='2' style=''>
								<div style='line-height:28px;'>
									<a href='../interface/formOBR.php?trackingNumber=".$trackingNumber."&payee=".urlencode($claimant)."&officeName=". $officeName ."' target='_blank' style='text-decoration:none;'>
										<span class='data1 lnk' style='margin-left:10px; font-size:18px; letter-spacing:1px; color:black;'>1. OBR Form</span>
									</a>
								</div>
								<div style='line-height:28px;'>
									<a href='../interface/formPRnew.php?tn=".$prTrackingNumber."' target='_blank' style = 'text-decoration:none;'>
										<span class='data1 lnk'  style='margin-left:10px; font-size:18px; letter-spacing:1px; color:black;'>2. PR Form</span>
									</a>
								</div>
								<div style='line-height:28px;'>
									<a href='../interface/formPO.php?tn=".$trackingNumber."' target='_blank' style = 'text-decoration:none;'>
										<span class='data1 lnk'  style='margin-left:10px; font-size:18px; letter-spacing:1px; color:black;'>3. PO Form</span>
									</a>
								</div>
								<div style='line-height:28px;'>
									<a href='../interface/formAR.php?tn=".$trackingNumber."' target='_blank' style = 'text-decoration:none;'>
										<span class='data1 lnk'  style='margin-left:10px; font-size:18px; letter-spacing:1px; color:black;'>4. Acceptance Form</span>
									</a>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan='2'></td>
						</tr>
						<tr>
							<td colspan='2'>
								<div style='margin-top:20px; padding-top:20px;'>
									<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>OBR Information</span>
								</div>
							</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:0px 10px;'>".$this->CreateViewGroupDetails($grp)."</td>
						</tr>
						<tr>
							<td colspan='2'></td>
						</tr>
						<tr>
							<td>
								<div style='margin-top:20px; padding-top:20px;'>
									<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>PO Details</span>
								</div>
							</td>
							<td style='padding:20px 10px 0px 0px; vertical-align:bottom;'>
								<span id='prEdit".$trackingNumber."' class='button1 ".$classNamePOEdit."' style='width:75px; text-shadow:0px 0px 1px GREY;  padding:5px 10px; font-weight:bold; color:white; letter-spacing:1px; font-size:14px; background-color:rgb(18, 184, 240);' onclick='editPR(this)'>Edit&nbsp;items</span></a>
								<span id='prSeq".$trackingNumber."' class='button1 ".$classNamePOEdit."' style='width:95px; text-shadow:0px 0px 1px GREY;  padding:5px 10px; font-weight:bold; color:white; letter-spacing:1px; font-size:14px; background-color:rgb(18, 184, 240); margin-right:8px;' onclick='itemSequence(this)'>Sequence&nbsp;items</span></a>
							</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:0px 10px;'>".$this->CreateViewListPRPO($poRecords)."</td>
						</tr>
						<tr>
							<td colspan='2'></td>
						</tr>
						<tr>
							<td colspan='2' style='padding:20px 0px 10px 0px;''>".$this->remarksNote($remarksNote,$trackingNumber,$classNameRemarks)."</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:20px 0px 10px 0px;'>".$this->pendingNote($pendingNote)."</td>
						</tr>
						<tr>
							<td colspan='2'></td>
						</tr>
						<tr>
							<td colspan='2'>".$this->logs($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber)."</td>
						</tr>
						<tr>
							<td colspan='2'></td>
						</tr>
						<tr>
							<td colspan='2' style='padding:20px 0px 10px 0px; text-align:center;'>".$this->CreateActionsUpdateNew($trackingType, $status, $trackingNumber, $inputParms)."</td>
						</tr>
					</table>";


		$statusGuide = $this->CreateSlider($trackingType,$status,$claimType,$mode,$fund,$docType);

		unset($inputParms);

		return $statusGuide.'*v*'.$sheet;
	}

	function POPaymentHistory($trackingNumber) {
		$sheet = "";
		$sql = "SELECT TrackingNumber, Status FROM vouchercurrent WHERE TrackingPartner = '".$trackingNumber."' AND TrackingType = 'PX' GROUP BY TrackingNumber ORDER BY DateEncoded ASC";
		$recordPX = $this->query($sql);
		$numRows = $this->num_rows($recordPX);

		if($numRows > 0) {

			$pxTNList = "";
			$pxVCDetails = [];
			while ($data = $this->fetch_array($recordPX)) {
				$pxTN = $data['TrackingNumber'];
				$status = $data['Status'];

				$pxTNList .= ",'".$pxTN."'";
				$pxVCDetails[$pxTN] = $status;
			}

			// $sql = "SELECT * FROM pxvouchertax WHERE TrackingNumber IN (".substr($pxTNList, 1).")";
			$sql = "SELECT *, SUM(PercentageAmount) as TotalTax FROM pxvouchertax where TrackingNumber IN (".substr($pxTNList, 1).") GROUP BY TrackingNumber";
			$recordPX = $this->query($sql);

			$sheet .= "		<table border='0' cellpadding='0' style='border-spacing:0px; width:100%; border-collapse:collapse; font-family:Oswald;'>
								<tr style='border:1px solid silver; background-color:rgb(121, 137, 141); color:white;'>
									<td style='font-weight:bold; padding:2px 5px; white-space:nowrap;'>TN&nbsp;&nbsp;<span style='color:orange; font-weight:normal;'>(".$numRows.")</span></td>
									<td style='font-weight:bold; padding:2px 5px; white-space:nowrap;'>Status</td>
									<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Gross</td>
									<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>LD</td>
									<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Total Tax</td>
									<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Retention</td>
									<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Adjustment</td>
									<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Net</td>
								</tr>
								";

			$curPXTN = "";
			$pxTN = "";
			$pxTotalTax = 0;
			$numRows = $this->num_rows($recordPX);
			$row = 0;

			while ($data = $this->fetch_array($recordPX)) {
				$pxTN = $data['TrackingNumber'];
				$taxAmount = $data['PercentageAmount'];
				$totalTax = $data['TotalTax'];
				$row++;

				$amount = $data['Amount'];
				$ld = $data['LiquidatedDamages'];
				$gross = $amount + $ld;
				$netAmount = $data['NetAmount'];
				$retention = $data['Retention'];

				$adjType = $data['AdjustmentType'];
				$adjAmount = $data['AdjustmentAmount'];
				$adj = "";
				if(strlen(trim($adjType)) > 0) {
					$adjT = "ADD";
					if($adjType == 'Deduct') {
						$adjT = "LESS";
					}
					$adj = "<span style='color:orange; font-weight:bold;'>".$adjT."</span> : ".number_format($adjAmount, 2);
				}

				$sheet .= "	<tr style='border:1px solid silver;'>
								<td style='border-right:1px solid silver; padding:2px 5px; white-space:nowrap;' class='hover' onclick='searchThisPartner(this)'>".$pxTN."</td>
								<td style='border-right:1px solid silver; width:0px; white-space:nowrap; padding:2px 5px;'>".$pxVCDetails[$pxTN]."</td>
								<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($gross, 2)."</td>
								<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($ld, 2)."</td>
								<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($totalTax, 2)."</td>
								<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($retention, 2)."</td>
								<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".$adj."</td>
								<td style='width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($netAmount, 2)."</td>
							</tr>";

		

				// if($curPXTN != $pxTN) {

				// 	if($curPXTN != '' || $row == $numRows) {
				// 		$amount = $data['Amount'];
				// 		$ld = $data['LiquidatedDamages'];
				// 		$gross = $amount + $ld;
				// 		$netAmount = $data['NetAmount'];
				// 		$retention = $data['Retention'];

				// 		$adjType = $data['AdjustmentType'];
				// 		$adjAmount = $data['AdjustmentAmount'];
				// 		$adj = "";
				// 		if(strlen(trim($adjType)) > 0) {
				// 			$adjT = "ADD";
				// 			if($adjType == 'Deduct') {
				// 				$adjT = "LESS";
				// 			}
				// 			$adj = "<span style='color:orange; font-weight:bold;'>".$adjT."</span> : ".number_format($adjAmount, 2);
				// 		}

				// 		$sheet .= "	<tr style='border:1px solid silver;'>
				// 						<td style='border-right:1px solid silver; padding:2px 5px; white-space:nowrap;' class='hover' onclick='searchThisPartner(this)'>".$pxTN."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; padding:2px 5px;'>".$pxVCDetails[$pxTN]."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($gross, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($ld, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($pxTotalTax, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($retention, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".$adj."</td>
				// 						<td style='width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($netAmount, 2)."</td>
				// 					</tr>";
				// 	}

				// 	$curPXTN = $pxTN;
				// 	$pxTotalTax = $taxAmount;

				// }else {
				// 	$pxTotalTax += $taxAmount;

				// 	if($row == $numRows) {
				// 		$amount = $data['Amount'];
				// 		$ld = $data['LiquidatedDamages'];
				// 		$gross = $amount + $ld;
				// 		$netAmount = $data['NetAmount'];
				// 		$retention = $data['Retention'];

				// 		$adjType = $data['AdjustmentType'];
				// 		$adjAmount = $data['AdjustmentAmount'];
				// 		$adj = "";
				// 		if(strlen(trim($adjType)) > 0) {
				// 			$adjT = "ADD";
				// 			if($adjType == 'Deduct') {
				// 				$adjT = "LESS";
				// 			}
				// 			$adj = "<span style='color:orange; font-weight:bold;'>".$adjT."</span> : ".number_format($adjAmount, 2);
				// 		}

				// 		$sheet .= "	<tr style='border:1px solid silver;'>
				// 						<td style='border-right:1px solid silver; padding:2px 5px; white-space:nowrap;' class='hover' onclick='searchThisPartner(this)'>".$pxTN."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; padding:2px 5px;'>".$pxVCDetails[$pxTN]."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($gross, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($ld, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($pxTotalTax, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($retention, 2)."</td>
				// 						<td style='border-right:1px solid silver; width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".$adj."</td>
				// 						<td style='width:0px; white-space:nowrap; text-align:right; padding:2px 5px;'>".number_format($netAmount, 2)."</td>
				// 					</tr>";
				// 	}
				// }
			}

			$sheet .= '		</table>';

		}else{
			$sheet .= "	<table border='0' cellpadding='0' style='border-spacing:0px; width:100%; border-collapse:collapse; font-family:Oswald;'>
							<tr style='border:1px solid silver; background-color:rgb(121, 137, 141); color:white;'>
								<td style='font-weight:bold; padding:2px 5px; white-space:nowrap;'>TN&nbsp;&nbsp;<span style='color:orange; font-weight:normal;'>(".$numRows.")</span></td>
								<td style='font-weight:bold; padding:2px 5px; white-space:nowrap;'>Status</td>
								<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Gross</td>
								<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>LD</td>
								<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Total Tax</td>
								<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Retention</td>
								<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Adjustment</td>
								<td style='font-weight:bold; text-align:right; padding:2px 5px; white-space:nowrap;'>Net</td>
							</tr>
							<tr style='border:1px solid silver; text-align:center;'>
								<td colspan='8' style='font-weight:bold; padding:5px; white-space:nowrap; font-size:12px; letter-spacing:1px;'>NO RECORD FOUND</td>
							</tr>
						</table>";
		}

		return $sheet;
	}

	function NewCreateDoctrackInfoPX($record) {
		$grp = '';
		$sheet = '';
		$logOffice = $_SESSION['gso'];
		$acct = $_SESSION['accountType'];
		if($_SESSION['accountType'] >= 2){
			$className = 'label19';
		}else{
			$className = 'hide';	
		}	

		$trackingType = $record['TrackingType'];
		$status = $record['Status'];
		$year = $record['Year'];
		$office = $record['Office'];

		$row = 0;

		// ------------------------------------------------------------------------------------------------- COLUMN 1 - GEN DETAILS - START
		$genDetails1 = "<table border='0' cellpadding='0' style='border-spacing:0px; font-family:Oswald;'>";

		$trackingNumber = $record['TrackingNumber'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"TN");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'TN', $trackingNumber, $trackingNumber, $className, 0);

		$claimant =  strtoupper(utf8_encode($record['Claimant']));
		$className = $this->permissionClassByField($trackingType,$status,$office,"Supplier");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Supplier', $claimant, $trackingNumber, $className, 0);

		$complex = $record['Complex'];
		if($complex == 1 ){
			$complexity = "Simple Transaction";
		}else if($complex == 2 ){
			$complexity = "Complex Transaction";
		}else{
			$complexity = "Simple Transaction";
		}

		$className = $this->permissionClassByField($trackingType,$status,$office,"Complex");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Transaction Classification', $complexity, $trackingNumber, $className, 2);
		
		$adv =  $record['ADV'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"Adv");
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'ADV Number', $adv, $trackingNumber, $className, 0);

		$obrNumber = $record['OBR_Number'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'OBR Number', $obrNumber, $trackingNumber, 'hide', 0);

		$prMonth =  $record['PR_Month'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'PR Sched', $this->numberToQuarter($prMonth), $trackingNumber, 'hide', 0);

		$genDetails1 .= "<tr>
							<td colspan='3' style='padding:10px 0px;'></td>
						</tr>";

		$fund = $record['Fund'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Fund', $fund, $trackingNumber, 'hide', 0);

		$checkNumber = $record['CheckNumber'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Check Number', $checkNumber, $trackingNumber, 'hide', 0);

		$checkDate = $record['CheckDate'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Check Dt.', $checkDate, $trackingNumber, 'hide', 0);

		$netAmount = $record['NetAmount'];
		$genDetails1 .= $this->CreateGenDetailsRow(++$row, 'Net Amount', number_format($netAmount, 2), $trackingNumber, 'hide', 3);

		$genDetails1 .= "</table>";
		// ------------------------------------------------------------------------------------------------- COLUMN 1 - GEN DETAILS - END

		// ------------------------------------------------------------------------------------------------- COLUMN 2 - GEN DETAILS - START
		$genDetails2 = "<table border='0' cellpadding='0' style='border-spacing:0px; font-family:Oswald;'>";

		$prTrackingNumber = $record['PO_PRTN'];
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'PR Tracking Number', $prTrackingNumber, $trackingNumber, 'hide', 1);
		
		$trackingPartner = $record['TrackingPartner'];
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'PO Tracking Number', $trackingPartner, $trackingNumber, 'hide', 1);

		// $poNumber = $record['PO_Number'];
		// $genDetails2 .= $this->CreateGenDetailsRow(++$row, 'PO Number', $poNumber, $trackingNumber, 'hide', 0);

		$poNumber = $record['PO_Number'];
		$className = "hide";
		if($_SESSION['accountType'] == 7) {
			$className = "label19";
		}
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'PO Number', $poNumber, $trackingNumber, $className, 0);

		$retentionTN = $record['RetentionTN'];
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Retention TN', $retentionTN, $trackingNumber, 'hide', 1);

		$poNature = $record['PO_Nature'];
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Nature of Payment', $poNature, $trackingNumber, 'hide', 0);
		
		$poSpecifics = $record['PO_Specifics'];
		if($poSpecifics == 'Combi') {
			$poSpecifics = 'Agricultural products & other Goods/Items';
		}

		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Specifics', $poSpecifics, $trackingNumber, 'hide', 0);

		$supplierType = $record['SuppType'];
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Receipt Type', $supplierType, $trackingNumber, 'hide', 0);

		$supplierClass = $record['SuppClassification'];
		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Business Type', $supplierClass, $trackingNumber, 'hide', 0);

		$poModeOfProc = $record['PO_ModeOfProc'];
		$modOfProcList = [	'','Competitive Bidding','Shopping','Shopping 52.1.b','Alternative','Agency to Agency','Negotiated','Negotiated Procurement 53.9(SVP)',
							'Negotiated Procurement 53.1(TFB)','Negotiated Procurement 53.6(MS)','Negotiated Procurement 53.7','Negotiated Procurement 53.2(E.C.)',
							'Postal Office','Direct Contracting','Repeat Order','Two Failed Biddings(TFB)','Extension of Contract Appx. 21 Sec. 3.31',
							'Renewal of Contract Based on Appendix 21 3.3.1.3','Agency to Agency (DBM)','Lease of Real Property Sec 5.10'];

		if($poModeOfProc != "") {
			$poModeOfProc = $modOfProcList[$poModeOfProc];
		}

		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Mode of Procurement', $poModeOfProc, $trackingNumber, 'hide', 0);

		$poPYTerm = $record['PO_PYTerm'];
		// if($poPYTerm == 1){
		// 	$poPYTerm = 'After full delivery';
		// }else {
		// 	$poPYTerm = 'Multiple';
		// }

		if($poPYTerm == 1) {
			$poPYTerm = 'After full delivery';
		}elseif($poPYTerm == 2) {
			// $poPYTerm = 'Multiple';
			$poPYTerm = 'Per Statement';
		}elseif($poPYTerm == 3) {
			$poPYTerm = 'Cash on Delivery';
		}elseif($poPYTerm == 4) {
			$poPYTerm = 'Complete Delivery';
		}

		$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Payment Term', $poPYTerm, $trackingNumber, 'hide', 0);

		if($office == 'ONE1' && $poSpecifics == 'Gasoline') {
			$accountNumber = $record['AccountNumber'];
			$gasAccountName = $record['GasAccountName'];
			$className = $this->permissionClassByField($trackingType,$status,$office,"PXAccountNumber");
			$genDetails2 .= $this->CreateGenDetailsRow(++$row, 'Gas Account', $gasAccountName, $trackingNumber, $className, 0);
		}

		$genDetails2 .= "</table>";
		// ------------------------------------------------------------------------------------------------- COLUMN 2 - GEN DETAILS - END

		$supplierTIN = $record['SuppTIN'];
		$supplierCode = $record['SuppCode'];

		$officeName = $record['OfficeName'];
		$prTrackingNumber = $record['PR_TrackingNumber'];
		$prNumber = $record['PR_Number'];
		$controlNo = $record['ControlNo'];
		$periodType  = $record['PeriodType'];
		$payeeNumber = $record['PayeeNumber']; 
		$total = $record['TotalAmountMultiple'];
		$amount = $record['PO_Amount'];
		$poAmount = $amount;
		$pendingNote =  $record['Remarks'];
		$remarksNote =  $record['Remarks1'];
		$claimType  = $record['ClaimType'];
		$docType  = $record['DocumentType'];
		$subCode = $record['SubCode'];
		$peorOfc = $record['PeaceOfficeId'];
		$periodType = $record['PeriodType'];
		$periodValue = $record['PeriodMonth'];
		$document  = $record['DocumentType'];
		$category =  $record['PR_CategoryCode'];
		$categoryName =  $record['CategoryName'];
		$chargeType = $record['ChargeType'];
		$prData = $record['PR_Data'];	
		
		$encodedBy = utf8_encode($record['EncodedBy']);
		$dateEncoded = $record['DateEncoded'];
		$dateUpdated = $record['DateModified'];
		$completion = $record['Completion'];
		$batchTracking = $record['BatchTracking']; 
		$grp = $record['GRP'];
		$programCode = $record['PR_ProgramCode'];
		$conformDate = $record['ConformDate'];
		$mode = $record['ModeOfProcurement'];
		$pyTerm = $record['PaymentTerm'];
		$nature = $record['NatureOfPayment'];
		$specifics = $record['Specifics'];

		$origAmount = $amount;
		if($total > 0) {
			$origAmount = $total;
		}

		$inputParms = ['ADV' => $adv];

		$edit = "";
		$className =  $this->permissionClassByField($trackingType, $status, $office, "PRdetails"); 
		if($className != 'hide') {
			$edit = "<span id='".$trackingNumber."*".$trackingPartner."' class='button1 ".$className."' style='width:75px; text-shadow:0px 0px 1px GREY; padding:5px 10px; font-weight:bold; color:white; letter-spacing:1px; font-size:14px; background-color:rgb(18, 184, 240); text-align:center; cursor:pointer;' onclick='editPX(this)'>Edit Items</span>";
		
		}

		$particulars = "";
		$className =  $this->permissionClassByField($trackingType, $status, $office, "DVGoodsParticulars"); 
		if($poPYTerm == 'Per Statement') {
			$className = 'label19';
		}

		$explanation = $record['Particulars'];
		$invoiceNumber = (strlen(trim($record['InvoiceNumber'])) > 0 ? $record['InvoiceNumber'] : '_______');
		$invoiceDate = (strlen(trim($record['InvoiceDate'])) > 0 ? $record['InvoiceDate'] : '_______');
		$poDate = (strlen(trim($record['PoDate'])) > 0 ? $record['PoDate'] : '_______');

		if(strlen(trim($explanation)) == 0) {
			$explanation = "TO PAYMENT FOR ".$categoryName." OF THE ".$officeName." UNDER P.O# <strong>".$poNumber."</strong> DATED <strong>".$poDate."</strong> WITH INV# <strong>".$invoiceNumber."</strong>&nbsp;&nbsp;DATED:&nbsp;<strong>".$invoiceDate."</strong> AS PER SUPPORTING DOCUMENTS HERETO ATTACHED.";
		}

		$formLink = "formDVgoods.php";
		$gasPYDetails = "";
		if($office == 'ONE1' && $poSpecifics == 'Gasoline') {

			$explanation = "TO PAYMENT OF FUEL CONSUMPTION FOR THE <strong>".strtoupper($record['GasName'])."</strong> COVERING THE PERIOD OF <strong>".strtoupper($record['PeriodMonth'])." ".$record['Year']."</strong>, UNDER P.O# <strong>".$poNumber."</strong> DATED <strong>".$poDate."</strong>, AS PER PERTINENT PAPERS HERETO ATTACHED AMOUNTING TO";
			
			$gasPYDetails = "<tr>
								<td colspan='2' style='padding:20px 0px 0px 0px;'>
									<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Payment Details</span>
									<table border='0' cellpadding='0' style='border-spacing:0px; border-collapse:collapse; font-family:Oswald; margin:5px 0px 5px 20px;'>";

			$invoiceNumber = $record['InvoiceNumber'];
			$className = $this->permissionClassByField($trackingType,$status,$office,"InvoiceNumber");
			$gasPYDetails .= $this->CreateGenDetailsRow(++$row, 'Invoice Number', $invoiceNumber, $trackingNumber, $className, 0);

			$invoiceDate = $record['InvoiceDate'];
			$className = $this->permissionClassByField($trackingType,$status,$office,"InvoiceDate");
			$gasPYDetails .= $this->CreateGenDetailsRow(++$row, 'Invoice Date', $invoiceDate, $trackingNumber, $className, 0);

			$periodMonth = $record['PeriodMonth'];
			$className = $this->permissionClassByField($trackingType,$status,$office,"GasPeriod");
			$gasPYDetails .= $this->CreateGenDetailsRow(++$row, 'Gas Period', $periodMonth, $trackingNumber, $className, 0);
						

			$gasPYDetails .="		</table>
								</td>
							</tr>";

			$formLink = "formDVGas.php";
		}

		$particulars = "<tr>
							<td colspan='2' style='padding:20px 0px 0px 0px;'>
								<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Particulars</span>
								<table border='0' cellpadding='0' style='border-spacing:0px; border-collapse:collapse; font-family:Oswald; width:100%;'>
									<tr>
										<td colspan='4' style='width:0px; white-space:nowrap; padding:0px 10px 0px 30px; font-size:18px;'>
											<span style='display:inline-block; width:20px; text-align:right; font-size:20px; color:rgb(41, 111, 152); font-family:NOR; padding-right:8px; display:none;'></span>
											<span class='genDtlLabel' style='display:none;'>Explanation</span>
										</td>
									</tr>
									<tr>
										<td colspan='3' style='padding:5px 0px 5px 62px;'>
											<div style='border:1px solid silver; border-right:1px solid rgba(225,225,225,.9); border-bottom:1px solid rgba(225,225,225,.9); padding:8px 10px; font-family:Oswald; text-align:justified; background-color:white; text-align:justify; font-size:14px; max-width:1000px;'>
												".$explanation."
											</div>
										</td>
										<td style='width:0px; padding:0px 10px 0px 10px;'>
											<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editParticularsForThisPX(this)'>EDIT</span>
										</td>
									</tr>
								</table>
								
							</td>
						</tr>";

		$caoOfficerId = $record['CAOOfficer'];
		$caoOfficer = $record['CAOOfficerName'];
		$className = $this->permissionClassByField($trackingType,$status,$office,"CAOOfficer");
		$manpower = "	<tr>
							<td colspan='2' style='padding:20px 0px 0px 0px;'>
								<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Audit and Compliance Officers</span>
								<table border='0' cellpadding='0' style='border-spacing:0px; border-collapse:collapse; font-family:Oswald; margin:5px 0px 5px 20px;'>
									<tr>
										<td style='width:0px; white-space:nowrap; padding:0px 10px 0px 10px; font-size:18px;'>
											<span style='display:inline-block; width:20px; text-align:right; font-size:20px; color:rgb(41, 111, 152); font-family:NOR; padding-right:8px;'>".++$row."</span>
											<span class='genDtlLabel'>Accounting Evaluator</span>
										</td>
										<td id='officer".$caoOfficerId."' style='border-bottom:1px solid silver; padding:0px 10px 0px 10px; font-weight:bold; font-size:22px; white-space:nowrap; min-width:100px;'>".utf8_encode($caoOfficer)."</td>
										<td>
											<span id='editor".$trackingNumber."' class='".$className."' style='font-size:12px;' onclick='editThis(this)'>EDIT</span>
										</td>
									</tr>
								</table>
							</td>
						</tr>";

		
		$classNameRemarks = $this->permissionClassByField($trackingType,$status,$office,"Remarks1");

		// ------------------------------------------------------------------------------------------------- MAIN SHEET - START

		$sheet = "	<table border='0' cellpadding='0' style='border-spacing:0px;'>
						<tr>
							<td colspan='2' style='background-color:rgb(23, 207, 253); padding:15px 0px;'>
								
								<span class='label7' style='color:white;padding-left:20px;'>Status</span>
								<span id='trackType' style='text-shadow:0px 0px 10px black; color:rgb(42, 122, 172); font-weight:bold; color:white; font-size:34px;' class='data1'>".$trackingType." - </span>
								<span id='labelStatus' style='text-shadow:0px 0px 10px black;color:rgb(42, 122, 172); font-weight:bold;color:white;font-size:34px;letter-spacing:1px;font-weight:bolder;' class='data1'>".$status."</span>
								
								<div style='color:black;padding-left:5px;width:110px;display:inline-block;display:none;'>".$this->ezDate1($dateUpdated)."</div>
								<div style='padding:5px;padding-left:75px;color:white;text-shadow:0px 0px 1px white;letter-spacing:1px;' class='data1'>".$officeName."</div>
							
							</td>
						</tr>
						<tr>
							<td style='vertical-align:top; padding:40px 10px 20px 20px; width:50%;'>".$genDetails1."</td>
							<td style='vertical-align:top; padding:40px 10px 20px 20px;'>".$genDetails2."</td>
						</tr>
						".$gasPYDetails."
						".$particulars."
						".$manpower."
						<tr>
							<td colspan='2' style='padding-top:30px;'>
								<span style='padding:0px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>Printables</span>
								<div style='line-height:28px;'>
									<a href='../interface/".$formLink."?trackingNumber=".$trackingNumber."' target='_blank' style='padding-left:10px;text-decoration:none;font-size:18px;letter-spacing:1px;color:black;'>
										<span class='data1 lnk'>1. DV Form</span>
									</a>
								</div>
							</td>
						</tr>
						<tr>
							<td>
								<div style='padding:30px 0px 5px 5px; font-size:16px; font-weight:bold; font-family:Oswald; color:rgb(64, 161, 202);'>
									Payment Breakdown
								</div>
							</td>
							<td style='padding:30px 0px 5px 5px; text-align:right;'>".$edit."</td>
						</tr>
						<tr>
							<td colspan='2' style=''>".$this->CreatePXItemsWithBreakdownForSearching($trackingNumber, $category)."</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:20px 0px;'></td>
						</tr>
						<tr>
							<td style=''></td>
							<td style='width:0px; text-align:right;'>".$this->CreatePXTotalWithTaxBreakdown($trackingNumber, $year, $origAmount)."</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:5px 0px;'></td>
						</tr>
						<tr>
							<td colspan='2' style=''>".$this->remarksNote($remarksNote,$trackingNumber,$classNameRemarks)."</td>
						</tr>
						<tr>
							<td colspan='2' style=''>".$this->pendingNote($pendingNote)."</td>
						</tr>
						<tr>
							<td colspan='2' style=''>".$this->logs($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber)."</td>
						</tr>
						<tr>
							<td colspan='2' style='padding:5px 0px;'></td>
						</tr>
						<tr>
							<td colspan='2' style='padding:20px 0px 10px 0px; text-align:center;'>".$this->CreateActionsUpdateNew($trackingType, $status, $trackingNumber, $inputParms)."</td>
						</tr>
					</table>";

		// ------------------------------------------------------------------------------------------------- MAIN SHEET - END
		
		$statusGuide = $this->CreateSlider($trackingType,$status,$claimType,$mode,$fund,$docType);

		unset($inputParms);

		echo $statusGuide.'*v*'.$sheet;
	}

	function CreatePXItemsWithBreakdownForSearching($trackingNumber, $category) {
		$record = $this->SearchPXrecord($trackingNumber);
		$sheet = "";
		$row = 0;
		$curProg = "";
		$curAcct = "";
		$curProgTotal = 0;
		$curProgTotalJustLD = 0;
		$curProgTotalLD = 0;
		$finTotal = 0;
		$finTotalJustLD = 0;
		$finTotalLD = 0;
		$numRows = $this->num_rows($record);

		$sheet .= "	<table border='0' cellpadding='0' style='border-spacing:0px; font-family:Oswald; border-collapse:collapse; font-size:14px; width:100%;'>
						<tr style='background-color:rgb(121, 137, 141); color:white; border:1px solid gray;'>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold;'></td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold;'>Code</td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold;'>Description <span style='font-weight:normal; color:orange;'>(".$numRows.")</span></td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold;'>Qty</td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold;'></td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold; text-align:right;'>Cost</td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold;'></td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold; text-align:right;'>Total Cost</td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold; text-align:center;'>Days Delayed</td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold; text-align:right;'>LD</td>
							<td style='white-space:nowrap; padding:3px 10px 5px 10px; font-weight:bold; text-align:right;'>Total</td>
						</tr>";

		while ($data = $this->fetch_array($record)) {

			$trackingNumber = $data['TrackingNumber'];
			$category = $data['Category'];
			$programCode = $data['ProgramCode'];
			$accountCode = $data['Code'];
			$unit = $data['Unit'];
			$itemID = $data['Item'];
			$description = $data['Description'];
			$qty = $data['Qty'];
			$cost = $data['Amount'];
			$total = $data['Total'];
			$liquidatedDamages = $data['LiquidatedDamages'];
			$totalLD = $data['TotalLD'];
			$agriChecked = $data['AgriChecked'];

			$days = $data['Days'];
			$int = floor($days);
			$decimal = $days - $int;
			if($decimal == 0){
				$days = intval($data['Days']);
			}

			// if(substr($trackingNumber, 0, 4) == 'ONE1' && $category == 'CAT 80') {
			// 	$description .= " - ".$accountCode;
			// }
			
			if($curProg != $programCode) {
				// if($curProg != "") {
				// 	$sheet .= "	<tr style='border-top:1px solid silver;'>
				// 					<td colspan='8' style='padding:8px 10px 8px 10px; text-align:right; font-size:16px; font-weight:bold; color:gray;'>".number_format($curProgTotal, 2)."</td>
				// 					<td colspan='2' style='padding:8px 10px 8px 10px; text-align:right; font-size:16px; font-weight:bold; color:red;'>".number_format($curProgTotalJustLD, 2)."</td>
				// 					<td style='padding:8px 10px 8px 10px; text-align:right; font-size:16px; font-weight:bold;'>".number_format($curProgTotalLD, 2)."</td>
				// 				</tr>";

				// 	$curProgTotal = 0;
				// 	$curProgTotalJustLD = 0;
				// 	$curProgTotalLD = 0;
				// }

				// $sheet .= "	<tr style='background-color:rgb(222, 226, 228); border:1px solid rgb(222, 226, 228); border-top:3px solid white; border-bottom:3px solid white;'>
				// 				<td colspan='11' style='padding:5px 0px 5px 10px; font-size:16px; font-weight:bold; color:rgb(26, 142, 196);'>".$programCode."</td>
				// 			</tr>";

				$curProg = $programCode;
				$curAcct = $accountCode;

			}else {
				if($curAcct == $accountCode) {
					$curAcct = "";
				}else {
					$curAcct = $accountCode;
				}
			}

			$rowBgColor = 'background-color:rgb(221, 236, 243);';
			$border = 'border:1px solid rgb(221, 236, 243);';
			if ($row%2 == 0) {
				$rowBgColor = '';
				$border = 'border:1px solid white; border-bottom:0px;';
			} 


			$sheet .= "	<tr style='".$rowBgColor.$border."'>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px;'><span class='goodsItemNum'>".++$row."</span></td>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; letter-spacing:1px;'>
								<span style='display:block; text-align:center; padding:0px 5px; font-size:14px; font-weight:bold; border-bottom:1px solid silver;'>".$curProg."</span>
								<span style='display:block; text-align:center; padding:0px 5px; font-size:14px; '>".$curAcct."</span>
							</td>
							<td style='vertical-align:top; padding:8px 10px 8px 10px; max-width:500px;'>".nl2br(stripcslashes($description))."</td>
							<td style='vertical-align:top; padding:8px 10px 8px 10px; width:0px; text-align:center;'>
								<div style='border-bottom:1px solid silver; font-weight:bold; color:rgb(45, 90, 126);'>".$qty."</div>
								<div style=''>".$unit."</div>
							</td>
							<td style='vertical-align:top; padding:12px 10px 0px 10px; width:0px; font-size:26px; line-height:12px; font-weight:bold; font-family:mainFont;'>&times;</td>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold; color:rgb(45, 90, 126);'>".number_format($cost, 2)."</td>
							<td style='vertical-align:top; padding:10px 10px 0px 10px; width:0px; font-weight:bold; font-family:NOR;'>=</td>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold;'>".number_format($total, 2)."</td>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:center; font-weight:bold; color:rgb(45, 90, 126);'>".$days."</td>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold;'>".number_format($liquidatedDamages, 2)."</td>
							<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold;'>".number_format($totalLD, 2)."</td>
						</tr>";

			// $sheet .= "	<tr style='".$rowBgColor.$border."'>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 20px; width:0px; letter-spacing:1px;'>".$curAcct."</td>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px;'><span class='goodsItemNum'>".++$row."</span></td>
			// 				<td style='vertical-align:top; padding:8px 10px 8px 10px; max-width:500px;'>".nl2br($description)."</td>
			// 				<td style='vertical-align:top; padding:8px 10px 8px 10px; width:0px; text-align:center;'>
			// 					<div style='border-bottom:1px solid silver; font-weight:bold; color:rgb(45, 90, 126);'>".$qty."</div>
			// 					<div style=''>".$unit."</div>
			// 				</td>
			// 				<td style='vertical-align:top; padding:12px 10px 0px 10px; width:0px; font-size:26px; line-height:12px; font-weight:bold; font-family:mainFont;'>&times;</td>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold; color:rgb(45, 90, 126);'>".number_format($cost, 2)."</td>
			// 				<td style='vertical-align:top; padding:10px 10px 0px 10px; width:0px; font-weight:bold; font-family:NOR;'>=</td>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold;'>".number_format($total, 2)."</td>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:center; font-weight:bold; color:rgb(45, 90, 126);'>".$days."</td>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold;'>".number_format($liquidatedDamages, 2)."</td>
			// 				<td style='vertical-align:top; padding:8px 10px 0px 10px; width:0px; text-align:right; font-weight:bold;'>".number_format($totalLD, 2)."</td>
			// 			</tr>";

			$curProgTotal += $total;
			$curProgTotalJustLD += $liquidatedDamages;
			$curProgTotalLD += $totalLD;

			$finTotal += $total;
			$finTotalJustLD += $liquidatedDamages;
			$finTotalLD += $totalLD;

		}

		// $sheet .= "	<tr style='border-top:1px solid silver;'>
		// 				<td colspan='8' style='padding:8px 10px 8px 10px; text-align:right; font-size:16px; font-weight:bold; color:gray;'>".number_format($curProgTotal, 2)."</td>
		// 				<td colspan='2' style='padding:8px 10px 8px 10px; text-align:right; font-size:16px; font-weight:bold; color:red;'>".number_format($curProgTotalJustLD, 2)."</td>
		// 				<td style='padding:8px 10px 8px 10px; text-align:right; font-size:16px; font-weight:bold;'>".number_format($curProgTotalLD, 2)."</td>
		// 			</tr>";

		$sheet .= "	<tr style='border-top:1px solid black;'>
						<td colspan='8' style='padding:8px 10px 0px 10px; text-align:right; font-size:18px; font-weight:bold;'>
							<span style='margin-right:10px; font-size:14px; font-weight:normal; color:gray;'>Total</span>".number_format($finTotal, 2)."
						</td>
						<td colspan='2' style='padding:8px 10px 0px 10px; text-align:right; font-size:18px; font-weight:bold; color:red;'>".number_format($finTotalJustLD, 2)."</td>
						<td style='padding:8px 10px 0px 10px; text-align:right; font-size:18px; font-weight:bold;'>".number_format($finTotalLD, 2)."</td>
					</tr>";

		$sheet .= "</table>";

		return $sheet;
	}

	function CreatePXTotalWithTaxBreakdown($trackingNumber, $year, $origGross) {
		// $sql = "SELECT * FROM pxvouchertax WHERE TrackingNumber = '".$trackingNumber."' ORDER BY Id ASC";
		// $record = $this->query($sql);

		$sql = "SELECT * FROM supplier.vouchers WHERE Year = '".$year."' AND TrackingNumber = '".$trackingNumber."' ORDER BY Id ASC";
		$record = $this->query($sql);

		if($this->num_rows($record) == 0) {
			$sql = "SELECT * FROM pxvouchertax WHERE TrackingNumber = '".$trackingNumber."' ORDER BY Id ASC";
			$record = $this->query($sql);
		}

		$sheet = "";

		$poGross = 0;
		$grossWLD = 0;
		$net = 0;
		$liquidateDamages = 0;
		$adjLabel = '';
		$adjType = '';
		$adjAmount = 0;
		$totalTax = 0;
		$curSpecs = "";
		$ld = 0;
		$retention = 0;
		$taxes = "<table border='0' cellpadding='0' style='border-spacing:0px; margin:0px 0px 0px auto; font-size:20px;'>";
		while ($data = $this->fetch_array($record)) {
			$nature = $data['NatureOfPayment'];
			$specifics = $data['Specifics'];
			$gross = $data['Amount'];
			$baseAmount = $data['BaseAmount'];
			$taxPercent = $data['Percentage'];
			$taxAmount = $data['PercentageAmount'];
			$ld = $data['LiquidatedDamages'];
			$net = $data['NetAmount'];
			$adjLabel = $data['AdjustmentLabel'];
			$adjType = $data['AdjustmentType'];
			$adjAmount = $data['AdjustmentAmount'];

			$recType = $data['CodeType'];
			if($recType == 'Expanded') {
				$recType = 'EXP';
			}

			if($curSpecs != $specifics) {
				$grossWLD += $gross;
				$curSpecs = $specifics;
			}

			$retention = $data['Retention'];

			$receiptType = $data['ReceiptType'];


			$int = floor($taxPercent);
			$decimal = $taxPercent - $int;
			if($decimal == 0){
				$taxPercent = intval($data['Percentage']);
			}

			$compBase = number_format( ($gross / 1.12) , 2 );
			$taxDetails = number_format($gross, 2)." / 1.12 (<strong>".$compBase."</strong>) &#10006; ".$taxPercent."%";

			if($specifics == 'Agricultural Products') {
				$taxDetails = "AGRI (<strong>".number_format($baseAmount, 2)."</strong>) &#10006; ".$taxPercent."%";
			}

			if($receiptType == 'NON-VAT') {
				$taxDetails = "(<strong>".number_format($baseAmount, 2)."</strong>) &#10006; ".$taxPercent."%";
			}

			$totalTax += $taxAmount;

			$taxes .= "	<tr>
							<td style='font-size:16px; color:gray; padding-right:5px;'>".$recType."</td>
							<td style='font-size:16px; padding-right:8px; white-space:nowrap;'>".$taxDetails."</td>
							<td style='padding-left:5px; text-align:right; font-weight:bold;'>".number_format($taxAmount, 2)."</td>
						</tr>";
		}
		$taxes .= "</table>";

		$poGross = $grossWLD + $ld;

		$retentionLabel = "";
		if($retention > 0) {
			// $retentionLabel = "<span style='color:gray; padding-right:5px;'>(".number_format($poGross, 2)." &times; 1%)</span>"; // 2023-08-16 changed to $grossWLD to correct display in tracker of change from (javascript) totalPO to totalLD
			$retentionLabel = "<span style='color:gray; padding-right:5px;'>(".number_format($grossWLD, 2)." &times; 1%)</span>";
		}

		$notax = "";
		if($recType == 'NAN') {
			$taxes = "";
			$notax = "<span style='margin-left:5px; color:black;'>(TAX EXEMPT)</span>";
		}

		$adjDetails = "";
		if(strlen(trim($adjType)) > 0) {

			$adjDispType = "ADD";
			if($adjType == 'Deduct') {
				$adjDispType = "LESS";
			}

			$adjDetails = "	<tr>
								<td style='text-align:right; padding-right:10px; font-size:16px;'>
									<span style='color:orange; font-size:14px; letter-spacing:1px; font-weight:bold;'>".$adjDispType."</span> : ".$adjLabel."
								</td>
								<td style='text-align:right; font-weight:bold; color:red;'>".number_format($adjAmount, 2)."</td>
							</tr>";
		}

		$sheet .= "	<div style='display:inline-block; min-width:0px; white-space:nowrap; text-align:right;'>
						<div style='padding:5px 0px 3px 5px; font-family:NOR; font-size:18px; font-weight:bold; color:rgb(64, 161, 202); text-align:left;'>Computation Breakdown</div>
						<table border='0' cellpadding='0' style='border-spacing:0px; margin:0px 0px 0px auto; font-family:NOR; border:1px dashed silver; padding:10px 15px; font-size:20px; background-color:rgba(248, 249, 248, 1);'>
							<tr>
								<td style='text-align:right; padding-right:10px; font-size:16px;'>Gross</td>
								<td style='text-align:right; font-weight:bold; padding-left:20px;'>".number_format($origGross, 2)."</td>
							</tr>
							<tr>
								<td style='text-align:right; padding-right:10px; font-size:16px;'>
									<span style='color:orange; font-size:14px; letter-spacing:1px; font-weight:bold;'>LESS</span> : Liquidated Damages
								</td>
								<td style='text-align:right; font-weight:bold; color:red;'>".number_format($ld, 2)."</td>
							</tr>
							<tr>
								<td style='text-align:right; padding-right:10px; font-size:16px;'>Total</td>
								<td style='text-align:right; font-weight:bold; border-top:1px dashed black;'>".number_format($grossWLD, 2)."</td>
							</tr>
							<tr>
								<td colspan='2' style='padding:10px 0px;'></td>
							</tr>
							<tr>
								<td style='font-size:16px; letter-spacing:1px; color:rgb(64, 161, 202);'>Tax Breakdown".$notax."</td>
								<td></td>
							</tr>
							<tr>
								<td style='padding-right:10px;'>".$taxes."</td>
								<td></td>
							</tr>
							<tr>
								<td style='text-align:right; padding-right:10px; font-size:16px;'>
									<span style='color:orange; font-size:14px; letter-spacing:1px; font-weight:bold;'>LESS</span> : Total Tax
								</td>
								<td style='text-align:right; border-top:1px dashed black; font-weight:bold; color:red;'>".number_format($totalTax, 2)."</td>
							</tr>
							<tr>
								<td colspan='2' style='padding:10px 0px;'></td>
							</tr>
							<tr>
								<td style='text-align:right; padding-right:10px; font-size:16px;'>
									".$retentionLabel."Retention
								</td>
								<td style='text-align:right; font-weight:bold; color:red;'>".number_format($retention, 2)."</td>
							</tr>
							".$adjDetails."
						</table>
						<div style='text-align:right; padding:10px 15px 20px 0px; font-family:NOR; font-size:24px; font-weight:bold;'>
							<span style='margin-right:15px; font-size:16px; color:gray; font-weight:normal;'>Net Amount</span>".number_format($net, 2)."
						</div>
					</div>";

		return $sheet;
	}

	function CreateActionsUpdateNew($trackingType, $status, $trackingNumber, $inputParms) {
		$perm = $_SESSION['perm'];
		$office = $_SESSION['gso'];
	
		$sheet = '';
		if($trackingType == 'PX') {

			if($_SESSION['accountType'] == 2 and $_SESSION['gso'] == '1061' or $_SESSION['accountType'] == 7){

				if($status == "Encoded"){
					
					if($perm == 10){
						$sheet .= '	<div id = "prEncodedUpdater">
										<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:230px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Received for Inspection</div>
									</div>';
					}
				
				}elseif($status == 'For Inspection') {

					if($perm == 10){
						$sheet .= '	<div id = "prEncodedUpdater">
										<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											
										<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block; width:165px; padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Mark as Inspected</div>
									</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber);
					}

				}elseif($status == 'Inspected') {
	
					// if($perm == 10){
					// 	$sheet .= '	<div id = "prEncodedUpdater">
					// 					<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 					<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:105px;padding:5px 10px;font-size:22px; white-space:nowrap;" onclick="updateTracking(this)">For Payment</div>
					// 				</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber);
					// }

					if($perm == 11){
						$sheet .= '	<div id = "prEncodedUpdater">
										<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</div> ';
					}

				}elseif($status == 'Inventory') {
	
					// if($perm == 11){
					// 	$sheet .= '	<div id = "prEncodedUpdater">
					// 						<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:105px;padding:5px 10px;font-size:22px; white-space:nowrap;" onclick="updateTracking(this)">For Payment</div>
					// 				</div> '.  $this->CreatePendingNote("inventoryPending",$trackingNumber);
					// }

					if($perm == 11){
						$sheet .= '	<div id = "prEncodedUpdater">
										<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									</div> '.  $this->CreatePendingNote("inventoryPending",$trackingNumber);
					}
								
				}elseif($status == "Pending at GSO - Inspection"){
					
					if($perm == 10){
						$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px 10px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
					}	

				}elseif($status == "Pending Released - Inspection"){

					if($perm == 10){
						$sheet .= '	<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
					}

				}elseif($status == "Pending at GSO - Inventory"){ 

					if($perm == 11){
						$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px 10px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
					}
				
				}elseif($status == "Pending Released - Inventory"){

					if($perm == 11){
						$sheet .= '	<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
					}	
			
				}

			
			}
			
			if($_SESSION['accountType'] == 4 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) {
				// if($status == "Encoded"){
				// 	$sheet .= '	<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
				// 				<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$inputParms['ADV'].'"  style = ""/>
				// 				<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
				// }

				if($status == "Inspected" || $status == "Inventory"){
					$sheet .= '	<div id = "prEncodedUpdater">
									<span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;ADV&nbsp;#</span>
									<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$inputParms['ADV'].'"  style = ""/>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
								</div>';
				}elseif($status == "Pending Released - CAO"){
					$sheet .= '	<div id = "prEncodedUpdater">
								<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
				}elseif($status == "CAO Received" ){
	
					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:135px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">On Evaluation</div>
								</div>'.$this->CreatePendingNote("caoPending",$trackingNumber);

					// $sheet .= '	<div id = "prEncodedUpdater">
					// 				<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 				<div class = "button1" id="toTaxify'.$trackingNumber.'" style = "display:inline-block;width:170px;padding:5px;font-size:22px;margin-left:10px;" onclick = \'transferToTaxifier(this)\'>Transfer to Taxifier</div>
					// 			</div>'.$this->CreatePendingNote("caoPending",$trackingNumber);

				}elseif($status == "On Evaluation - Accounting"){
	
					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Evaluated</div>
								</div>'.$this->CreatePendingNote("caoPending",$trackingNumber);
	
				}elseif($status == "Evaluated - Accounting"){
					// if($status == "CAO Received"){

					// $sheet .= '	<div id = "prEncodedUpdater">
					// 				<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 				<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
					// 				<div class = "button1" id="toTaxify'.$trackingNumber.'" style = "display:inline-block;width:170px;padding:5px;font-size:22px;margin-left:10px;" onclick = \'transferToTaxifier(this)\'>Transfer to Taxifier</div>
					// 			</div>'.$this->CreatePendingNote("caoPending",$trackingNumber);

					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px 10px;font-size:22px;"  onclick="updateFundCorrection(this)">Fund Correction</div>
								</div>'.$this->CreatePendingNote("caoPending",$trackingNumber);

				}elseif($status == "Fund Correction"){
					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="updateFundCorrected(this)">Fund Corrected</div>
								</div>';
				}
				
			}

			if($_SESSION['accountType'] == 6 and $_SESSION['officeCode'] == '1081' or $_SESSION['accountType'] == 7) {
				if($status == "CAO Received"){
					
					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" style = "display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
								</div>'.$this->CreatePendingNote("caoPending",$trackingNumber);
				
				}elseif($status == "Pending at CAO"){
					
					$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
				
				}
			}
	
			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == 7) {
				if(strtoupper($status) == "FORWARDING TRANSMITTAL"){
					$sheet .= '	<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
				}elseif($status == "Check Preparation - CTO"){
					$sheet .= '	<div class = "button1" id = "c~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To SP - Admin</div>
								<div class = "button1" id = "a~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Operation</div>
								<div class = "button1" id = "b~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Administration</div>';
				}elseif($status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin"){
					$sheet .= '	<div class = "button1" id = "x~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">Revert</div>';
				}elseif($status == "Check Advised"){
					$sheet .= '	<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="ctoClaim(this)">Release&nbsp;Check</div>';
				}elseif($status == "Check Released"){
					$sheet .= '	<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimRevert(this)">Revert</div>
								<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimReProcess(this)">Reprocess</div>';
				}elseif($status == "Check Preparation - CTO" || $status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin" || $status == "Check Advised"){
					$sheet .= '	<div class = "button1" id = "' . $trackingNumber . '" style = "background-color:rgb(249, 227, 238); margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="cancelCheck(this)">Cancel Cheque</div>';
				}elseif($status == "Cancelled Check"){
					$sheet .= '<div class = "button1" id = "' . $trackingNumber . '" style = " margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="reissueCheck(this)">Reissue Check</div>';
				}
			}

		}

		if($trackingType == 'PO') {

			if($_SESSION['accountType'] == 2 and $_SESSION['gso'] == '1061' or $_SESSION['accountType'] == 7){

				if($status == 'Encoded'){

					// $sheet .= "	<div id='prEncodedUpdater'>
					// 				<span style='color:rgb(248, 68, 92); font-weight:bold; white-space:nowrap;' class='label7'>Type PO #</span>
					// 				<input id='inputNumber' maxlength='10' class ='text3' value='".$inputParms['PO_Number']."'/>
					// 				<div class='button1' id='button".$trackingNumber."' style='margin-left:10px; display:inline-block; width:80px; padding:5px; font-size:22px; width:130px;'  onclick='updateTracking(this)'>
					// 					Receive<span style='font-size:14px; color:#1A8EC4;'>(New)
					// 				</div>
					// 				<div class='button1' id='button*".$trackingNumber."' style='margin-left:10px; display:inline-block; width:80px; padding:5px; font-size:22px; width:130px;'  onclick='updateTracking(this)'>
					// 					Receive<span style='font-size:14px;color:#1A8EC4;'>(Payment)</span>
					// 				</div>
					// 			</div>";

					$sheet .= "	<div id='prEncodedUpdater'>
									<span style='color:rgb(248, 68, 92); font-weight:bold; white-space:nowrap;' class='label7'>Type PO #</span>
									<input id='inputNumber' maxlength='10' class ='text3' value='".$inputParms['PO_Number']."'/>
									<div class='button1' id='button".$trackingNumber."' style='margin-left:10px; display:inline-block; width:80px; padding:5px; font-size:22px; width:130px;'  onclick='updateTracking(this)'>
										Receive<span style='font-size:14px; color:#1A8EC4;'>(New)
									</div>
								</div>";
	
				}elseif($status == 'GSO Received'){

					// $sheet .= '	<div id = "prEncodedUpdater">
					// 				<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 				<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Forward</div>
					// 			</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
					// 			';

					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
								</div>' .  $this->CreatePendingNote("gsoPending",$trackingNumber)  . '
								';

				}elseif($status == 'Forwarded to CMO') {
	
					// $sheet .= '	<div id = "prEncodedUpdater">
					// 				<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 				<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:85px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Approved</div>
					// 			</div>'.$this->CreatePendingNote("gsoPending", $trackingNumber);
	
				}elseif($status == 'CMO Approved') {
	
					// $sheet .= '	<div id = "prEncodedUpdater">
					// 				<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Served</div>
					// 			</div>';
	
				}elseif($status == 'Served to Supplier') {
	
					$sheet .= '	<div id = "prEncodedUpdater">
									<span style ="color:rgb(248, 68, 92);font-weight:bold; white-space:nowrap;" class  = "label7">Date Conformed</span>
									<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$inputParms['ConformDate'].'"  style = ""/>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Conformed</div>
								</div>';
		
				}elseif($status == 'Serve to Supplier') {
	
					$sheet .= '	<div id = "prEncodedUpdater">
									<span style ="color:rgb(248, 68, 92);font-weight:bold; white-space:nowrap;" class  = "label7">Date Conformed</span>
									<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$inputParms['ConformDate'].'"  style = ""/>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Conformed</div>
								</div>';
		
				}elseif($status == 'Supplier Conformed' || $status == "GSO Conformed") {
				}elseif($status == 'Waiting for Delivery' || $status == "GSO Released For Delivery") {

					// if($perm == 10){
					// 	$sheet .= '	<div id = "prEncodedUpdater">
					// 					<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:230px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Received for Inspection</div>
					// 				</div>';
					// }
						
				}elseif($status == 'For Inspection' || $status == "Voucher Encoded") {

					// if($perm == 10){
					// 	$sheet .= '	<div id = "prEncodedUpdater">
					// 					<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
											
					// 					<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block; width:165px; padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Mark as Inspected</div>
					// 				</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber);
					// }

				}elseif($status == 'Inspected' || $status == "GSO Received - Voucher(Inspection)") {
	
					// if($perm == 10){
					// 	$sheet .= '	<div id = "prEncodedUpdater">
					// 					<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
					// 					<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:105px;padding:5px 10px;font-size:22px; white-space:nowrap;" onclick="updateTracking(this)">For Payment</div>
					// 				</div>'.  $this->CreatePendingNote("inspectionPending",$trackingNumber);
					// }

					// if($perm == 11){
					// 	$sheet .= '	<div id = "prEncodedUpdater">
					// 					<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
					// 				</div> '.  $this->CreatePendingNote("inspectionPending",$trackingNumber);
					// }

				}elseif($status == 'Inventory' || $status == "GSO Received - Voucher(Inventory)") {
	
						// if($perm == 11){
						// 	$sheet .= '	<div id = "prEncodedUpdater">
						// 						<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
						// 						<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:105px;padding:5px 10px;font-size:22px; white-space:nowrap;" onclick="updateTracking(this)">For Payment</div>
						// 				</div> '.  $this->CreatePendingNote("inventoryPending",$trackingNumber);
						// }
								
				}elseif($status == "Pending at GSO - Inspection" || $status == "Pending at GSO - Voucher(Inspection)"){
					
					// if($perm == 10){
					// 	$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px 10px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
					// }	

				}elseif($status == "Pending Released - Inspection" || $status == "Pending Released - GSO Voucher(Inspection)"){

					// if($perm == 10){
					// 	$sheet .= '	<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
					// }

				}elseif($status == "Pending at GSO - Inventory" || $status == "Pending at GSO - Voucher(Inventory)"){ 

					// if($perm == 11){
					// 	$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px 10px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
					// }
				
				}elseif($status == "Pending Released - Inventory" || $status == "Pending Released - GSO Voucher(Inventory)"){

					// if($perm == 11){
					// 	$sheet .= '	<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
					// }	
			
				}elseif($status == "Pending at GSO"){

					$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
				
				}elseif($status == "Pending Released - GSO"){

					if($inputParms['PO_Number'] != ''){
						$sheet .= '	<input id = "inputNumber" type = "hidden" maxlength = "10" class ="text3" value = "'.$inputParms['PO_Number'].'"  style = ""/>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
					}else{
						$sheet .= '	<div id = "prEncodedUpdater"><span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;PO&nbsp;#</span>
									<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$inputParms['PO_Number'].'"  style = ""/>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									</div>'.$this->CreatePendingNote("gsoPending",$trackingNumber);
					}

				}elseif($status == "Pending Released - Admin") {
					$sheet .= '	<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
								<tr>';
				}

			}

			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1071' or $_SESSION['accountType'] == 7) {

				if ($status == 'Supplier Conformed' || $status == "GSO Conformed") {

					$sheet .= '	<div id = "prEncodedUpdater">
									<span style ="color:rgb(248, 68, 92);font-weight:bold;" class  = "label7">Type&nbsp;OBR&nbsp;#</span>
									<input id = "inputNumber" maxlength = "10" class ="text3" value = "'.$inputParms['OBR_Number'].'"  style = ""/>
									<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
								</div>';

				}elseif($status == "Fund Control"){

					$sheet .= '	<div id = "prEncodedUpdater">
									<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
									<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
									</div>' .  $this->CreatePendingNote("cboPending",$trackingNumber)  . '
								</div>';

				}elseif($status == "Pending at CBO"){

					$sheet .= '	<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>';
				
				}elseif($status == "Pending Released - CBO"){
					
					$sheet .= '	<div class = "button1" id = "'  . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:90px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
				
				}

			}

			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1091' or $_SESSION['accountType'] == 7) { //cbo matters
				
				if($status == "Check Preparation - CTO"){
					$sheet .= ' <div class = "button1" id = "c~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To SP - Admin</div>
								<div class = "button1" id = "a~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Operation</div>
								<div class = "button1" id = "b~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">To Administration</div>';
				}elseif($status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin"){
					$sheet .= ' <div class = "button1" id = "x~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoForward(this)">Revert</div>';
				}elseif($status == "Check Advised"){
					$sheet .= '<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:150px;padding:5px;font-size:22px;"  onclick="ctoClaim(this)">Release&nbsp;Check</div>';
				}elseif($status == "Check Released"){
					$sheet .= ' <div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimRevert(this)">Revert</div>
								<div class = "button1" id = "' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="ctoClaimReProcess(this)">Reprocess</div>';
				}elseif(strtoupper($status) == "FORWARDING TRANSMITTAL"){
					$sheet .= '<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>';
				}elseif($status == "Draft"){
					if($docType == "CASH ADVANCE TO PAYMASTER"){
						$sheet .= ' <div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Encode</div>';
					}
				}elseif($status == "Check Preparation - CTO" || $status == "Forwarded to Admin - Operation"  || $status == "Forwarded to Admin - Administration" || $status == "Forwarded to SP - Admin" || $status == "Check Advised"){
					$sheet .= '<div class = "button1" id = "' . $trackingNumber . '" style = "background-color:rgb(249, 227, 238); margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="cancelCheck(this)">Cancel Cheque</div>';
				}elseif($status == "Cancelled Check"){
					$sheet .= ' <div class = "button1" id = "' . $trackingNumber . '" style = " margin-left:10px;display:inline-block;width:160px;padding:5px;font-size:22px;"  onclick="reissueCheck(this)">Reissue Check</div>';
				}

			}

			if($_SESSION['accountType'] == 2 and $_SESSION['cbo'] == '1031' or $_SESSION['accountType'] == 7) { //admin matters

				if($status == "GSO Received"){
					$sheet .= '	<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
								<tr>';
				}else if($status == "Admin Received"){
					$sheet .= '	<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div id = "prEncodedUpdater">
											<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Sign</div>
											<div class = "button1" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;" onclick = \'pendingThis(this,"pendingContainer")\'>Pending</div>
										</div>' .  $this->CreatePendingNote("admPending",$trackingNumber)  . '
									</td>
								<tr>';
				}else if($status == "Pending at Admin"){
					$sheet .= '	<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "' .  $status . '~' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:180px;padding:5px;font-size:22px;"  onclick="updateTracking1(this)">Released&nbsp;Pending</div>
									</td>
								<tr>';
				}else if($status == "PO Signed"){
					$sheet .= '	<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
										<div class = "button1" id = "button' . $trackingNumber . '"  style = "margin-left:10px;display:inline-block;width:80px;padding:5px 10px;font-size:22px;"  onclick="updateTracking(this)">Release</div>
									</td>
								<tr>';
				}elseif($status == "Pending Released - Admin") {
					$sheet .= '	<tr style = "">
									<td colspan= "3"  style = "padding-bottom:40px;text-align:center;">
											<div class = "button1" id = "button' . $trackingNumber . '" style = "margin-left:10px;display:inline-block;width:80px;padding:5px;font-size:22px;"  onclick="updateTracking(this)">Receive</div>
									</td>
								<tr>';
				}
					
			}

		}

		if($_SESSION['privy'] == 1 || $_SESSION['accountType'] == 7){
			if($status != "Cancelled - Fund Reverted") {
				$sheet .= '	<div id = "prEncodedUpdater" style="padding-top:10px;">
								<div class = "button1" id = "' . $trackingNumber . '" style="background-color:rgb(249, 227, 238); margin-left:10px;display:inline-block;width:100px;padding:5px;font-size:22px;"  onclick="cancelFundReverted(this)">Cancel</div>
							</div>';
			}

		}

		unset($inputParms);

		// $sheet .= '</table>' ;
		return $sheet;
	}

	//---------------------------------------------------------------------------------------------------NEW PO PX SEARCHING SHEETS - END
		function createVouchersTime($record){
			$sql = "select * from defaults";
			$record1 = $this->query($sql);
			
			$data = $this->fetch_array($record1);
			$year = $data['DashboardYear'];
			
			$docFlag = '';
			$dateFlag = 0;
			$averageFlag = 0;
			
			$diffDay =0;
			$totalTime = 0;
			$totalTransaction = 0;
			$countTime =0;
			$start = 0;
			
			$empty='';
			$empty1='';
			$x = 1;
			
			$body = '';
			$sheet = '<table id ="tableSummary" border ="0">
						<tr>
							<td colspan ="100%" style ="border-bottom:10px solid rgb(101, 134, 165);border-top:2px solid grey;font-size:32px;padding-left:50px;padding:10px;">
								<div style ="line-height:24px;"><span style ="font-family:impact;color:rgb(5, 99, 131);font-weight:bold;">' . $year . '</span><span style ="font-size:34px;"> DOCUMENT TRACKING SYSTEM</span></div>
								<div style ="line-height:24px;font-size:20px;padding-left:80px;color:grey;">Davao City Transactions Summary Report <span style = "font-family:arial;font-size:16px;">(January - December)</span>
									<span style = "float:right;font-family:anton;font-size:16px;font-weight:normal;letter-spacing:1px;" > ' . date('Y-m-d') . '</span>
								</div>
							</td>
						</tr>
						
						<tr>';
			while($data = $this->fetch_array($record)){
				$doc = $data['DocumentType'];
				$month = $data['PeriodMonth'];
				$time =  round($data['Total'],2);
				$transaction = $data['Transaction'];
				$date = date_parse($month);
 				$day = $date['month'];
 				if($start > 0){
					if($doc != $docFlag){
						$diffMonth = 12 - $dateFlag;
						for($j = 0;$j < $diffMonth ; $j++ ){
							$empty1 .= '<td style ="border-bottom:1px solid grey;">&nbsp;</td>';
						}
						$averageFlag = round($totalTime / $countTime,2);
						
						$average = '<table class = "tableDetails" border ="0" style ="margin-bottom:10px;">
										<tr style ="background-color:transparent;">
											<td colspan ="2" style ="text-align:left;font-size:22px;font-family:Anton;color:rgb(72, 81, 72);line-height:22px;padding:5px;">' . $docFlag . '</td>
										</tr>
										<tr style ="background-color:rgb(58, 106, 137); ">
											<td style ="text-align:right;vertical-align:bottom;font-family:oswald;font-size:14px;color:white;border-bottom:1px solid black;">Average Processing Days</td>
											<td style = "font-size:22px;width:20px;padding:5px;padding-right:10px;color:white;font-family:anton;border-bottom:1px solid black;text-shadow:0px 0px 2px black;">' . $averageFlag . '</td></tr>
										<tr style ="background-color:rgba(14, 76, 18,.8);">
											<td style ="text-align:right;vertical-align:top;font-family:oswald;font-size:14px;color:white;">Total Transactions</td>
											<td style = "font-size:22px;color:white;padding:5px;font-family:anton;text-shadow:0px 0px 2px black;">' . $totalTransaction . '</td>
										</tr>
										
									</table>';
						$document  = '<td style ="width:50px;text-align:center;background-color:rgb(101, 134, 165);font-size:22px;border-bottom:1px solid rgb(54, 72, 87);color:white;">' . $x++ . '</td>
									<td style = "width:220px;border-bottom:1px solid grey;border-right:1px solid rgba(125, 139, 151,.5);padding-right:10px;">'. $average . '</td>'; 
						$body = '<tr>' . $document . '<td style ="border-bottom:1px solid grey;padding:5px;">&nbsp;</td>'. $body  . $empty1 . '<td style ="border-bottom:1px solid grey;padding:5px;">&nbsp;</td></tr>';
						$sheet .= $body;
						$body ='';
						$empty ='';
						$empty1 ='';
						$dateFlag = 0;
						$countTime = 0;
						$totalTime = 0;
						$totalTransaction = 0;
					}
				}
				
				$diffDay = $day - $dateFlag;
				if($diffDay > 1){
					for($j = 0;$j < $diffDay-1 ; $j++ ){
						$empty .= '<td style ="border-bottom:1px solid grey;">&nbsp;</td>';
					}
				}
				$body .= $empty .'<td style = "vertical-align:bottom;padding:10px  0px;border-bottom:1px solid grey;">
									<table class = "tableDetails" style ="font-size:8px;text-align:center;margin:0 auto;border-spacing:0;" border = "0">
										<tr style ="background-color:transparent;">
											<td colspan ="3" style ="vertical-align:bottom;"  border ="1">
												<table border = "0" style ="border-spacing:0;margin:0 auto;font-family:oswald;text-align:center;">
													<tr>
														<td style = "vertical-align:bottom;font-size:12px;">
															<div style ="line-height:10px;font-size:10px;font-weight:bold;color:rgb(17, 87, 156);font-family:arial;">' . $time . '</div>
															<div style ="line-height:12px;font-size:10px;">Days</div>
															<div class ="bar" style = "display:inline-block;height:' . ($time * 2).  '"></div></td>
														</td>
														<td style ="vertical-align:bottom;">
															<div style ="line-height:10px;font-size:10px;font-weight:bold;color:rgb(25, 150, 11);font-family:arial;">' . $transaction . '</div>
															<div style ="line-height:12px;font-size:10px;">Trans</div>';
															if($transaction > 200){
																$percent = ($transaction / 1000) * 100;	
																$body .= '<div class ="bar" style ="vertical-align:bottom;padding:0;text-align:left;font-family:Arial;letter-spacing:-1px;color:white;display:inline-block;background-color:rgb(35, 112, 26);height:' . 200 .  'px; ">
																		  	<span style ="color:grey;font-size:12px;margin-left:25px;">200+</span>	
																		  	<table style ="height:92.8%;width:100%;border-spacing:0;" border = "0">
																		  		<tr>
																		  			<td style ="vertical-align:bottom;">
																		  				<div style ="width:100%;height:' . $percent .'%;background-color:rgb(28, 42, 4);">&nbsp;</div>
																		  			</td>
																		  		</tr>
																		  	</table>
																		  </div>';
															}else{
																$body .= '<div class ="bar" style ="display:inline-block;background-color:rgb(101, 186, 55);height:' . ($transaction ).  'px"></div>';
															}
														
															$body .= '</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr style = ""><td colspan ="2" style = "border-top:1px solid grey;background-color:rgb(226, 229, 209);">
										<div class ="month" style ="margin:0 auto;cursor:pointer;" id = "' . $doc . '" onclick ="showTransactionsEngagements(this)">' . strtoupper($month) . '</div></td></tr>
									</table>	
								  </td>';
				$start = 1;
				$docFlag = $doc;
				$dateFlag = $day;
				$countTime++;
				$totalTime += $time;
				$totalTransaction += $transaction;
				$empty = '';
			}
			$sheet .= '</tr></table>';	
			echo $sheet;
		}
		function createTopList($record){
				
				$dateFlag = 0;
				$averageFlag = 0;
				
				$diffDay =0;
				$totalTime = 0;
				$totalTransaction = 0;
				$countTime =0;
				$start = 0;
				
				$empty='';
				$empty1='';
				$x = 1;
				
				$body = '';
				$sheet = '<table id ="tableSummary" border ="0" style ="border-spacing:0;">
							<tr>
								<td colspan ="100%" style ="border-bottom:10px solid rgb(101, 134, 165);border-top:2px solid grey;font-size:32px;padding-left:50px;padding:10px;">
									<div style ="line-height:24px;"><span style ="font-family:impact;color:rgb(5, 99, 131);font-weight:bold;">2022</span><span style ="padding-left:10px;font-size:34px;">Davao City Transactions - Benchmarking Analysis of Office Transactions Processing Speed</div>
									<div style ="line-height:24px;font-size:18px;padding-left:80px;color:grey;">DOCUMENT TRACKING SYSTEM</span> <span style = "font-family:arial;font-size:16px;">(January - December)</span>
									</div>
									<div style ="line-height:10px;font-size:20px;padding-left:80px;font-size:10px;width:500px;">
										This data lists offices ranked by their average transaction processing time during government working days (Monday through Friday), alongside the total number of transactions processed by each office.
									</div><span style = "float:right;font-family:anton;font-size:16px;font-weight:normal;letter-spacing:1px;" >' . date("Y-M-d") .'</span><span style = "color:grey;float:right;font-size:12px;line-height:30px;padding-right:5px;">as of </span>
								</td>
							</tr>
							';
							
				$start = 0;	
				$body = '';	
				$bodyMonth = '';
				$list = '';	
				$dateFlag = 0;
				$monthFlag = '';
				$emptyBefore = '';
				$emptyAfter = '';
				$k = 1;
				$n = 1;
				$num = 1;
				while($data = $this->fetch_array($record)){
					
					$office = $data['Office'];
					$doc = $data['DocumentType'];
					$month = $data['PeriodMonth'];
					$time =  round($data['AverageTime'],2);
					$transaction = $data['Transaction'];
	 				$numMonth = $data['NumMonth'];
	 				
	 				if($start > 0){
						if($doc != $docFlag){
							$diffDay = $numMonth - $dateFlag;
							if(abs($diffDay) > 1){
								for($j = 0;$j < $dateFlag ; $j++ ){
									$empty1 .= '<td style ="">' .$numMonth .' -x-' . $dateFlag . '</td>';
								}
							}
							
							if($n == 0){
								$n =  2;
							}
							if($n == 3){
								if($dateFlag > 1){
									for($j = 0;$j < $dateFlag-1 ; $j++ ){
										$emptyBefore .= '<td style =""></td>';
									}
								}
							}
							if($n >= 2){
								for($j = 0;$j < 12-$dateFlag ; $j++ ){
									$emptyAfter .= '<td style =""></td>';
								}
							}
							$sheet .= ' <tr style ="">
											<td colspan = "100%" style ="text-align:left;font-size:22px;font-family:Anton;color:rgb(72, 81, 72);line-height:22px;padding:5px;border-bottom:1px solid rgb(45, 74, 50);">
											<div style ="text-align:center;color:white;display:inline-block;width:30px;margin:2px;margin-right:10px; background-color:rgb(4, 102, 22);padding:5px;">' . $num++ . '</div>'. $docFlag . '</td>
										</tr>
										<tr>' . $body . $emptyBefore .'
													<td style ="vertical-align:top;padding:0px 5px;">
															<table border ="0" id ="topTable" >
																<tr><td colspan ="100%" style = "background-color:rgb(218, 226, 212);border:1px solid silver;"><div  class ="month">' .$monthFlag . '</div></td></tr>
																<tr style ="background-color:rgb(172, 183, 175);">
																	<td></td>
																	<td style ="padding:2px 5px;">Office</td>
																	<td  style = "padding:2px 5px;">Trans</td>
																	<td style = "padding:2px 5px;">Time</td>
																</tr>
																
																' .$list .' 
															</table>
													</td> ' . $emptyAfter . '
										</tr>'  ; 
							$list ='';
							$body = '';
							$empty1 = '';
							$emptyBefore = '';
							$emptyAfter = '';
							$k = 1;
							$n = 3;
						}else{
							if($month != $monthFlag){
								$diffDay = $numMonth - $dateFlag;
								if($diffDay > 1){
									for($j = 0;$j < $diffDay-1 ; $j++ ){
										$empty .= '<td style =""></td>';
									}
								}
								if($n == 3){
									if($dateFlag > 1){
										for($j = 0;$j < $dateFlag-1 ; $j++ ){
											$emptyBefore .= '<td style =""></td>';
										}
									}
								}
								$body .= $emptyBefore . '<td style ="vertical-align:top;padding:0px 5px;">
												<table id ="topTable" border ="0">
												<tr> <td colspan ="100%" style ="background-color:rgb(218, 226, 212);border:1px solid silver;"><div class = "month">' .  $monthFlag .   '</div></td>
												</tr>
												<tr style ="background-color:rgb(172, 183, 175);">
													<td></td>
													<td style ="padding:2px 5px;">Office</td>
													<td  style = "padding:2px 5px;">Trans</td>
													<td style = "padding:2px 5px;">Time</td>
												</tr>
												' . $list   .'</table>
											</td>'  . $empty;
								$list ='';
								$k = 1;
								$empty = '';
								$emptyBefore ='';
								$n = 0;
							}else{
								
							}
							
						}
						
					}
					$list  .=  '<tr><td style ="border-bottom:1px solid white;color:white;text-align:center;padding:2px 3px;">' . $k++ . '</td>
									<td style = "padding-left:5px;">' .  substr($office,0,15) . '</td>
									<td style = "text-align:center;padding:0px 5px;">' . $transaction . '</td>
									<td style = "text-align:right;padding:0px 5px;">' . $time . '</td></tr>';
					$docFlag = $doc;
					$monthFlag = $month;
					$dateFlag = $numMonth;
					$start = 1;
					
				}	
			
				
				$sheet .= '</table>';
				echo $sheet;
			}
	}

	$sheet = new Sheets();
	class Sheet1 extends MySQLDatabase {
//		------------------------------------------------------------------------------------- new		PPMP
		function CreateHistory2018($record){
			$i = 1;
			$count =  $this->num_rows($record);
			$col = "white";
			$sheet = '<table class = "data1" style = "padding:0;width:500px;margin:20px 0px;border-spacing:0;border:1px solid silver;" border = "0">';
			$sheet .= '<tr class = "dataHeader1">';
			$sheet .= '	<td  style = "background-color:grey;"></td>';
			$sheet .= '	<td  style = "padding:3px 10px;color:white;">Date</td>';
			$sheet .= '	<td  style = "padding:3px 10px;color:white;">Status <span class = "countTotal"> (' . $count . ')</span></td>';
			$sheet .= '	<td  style = "padding:3px 10px;color:white;">Completion</td>';
			$sheet .= '</tr>';
			$sheet .= '</tr>';
			while($data = $this->fetch_array($record)){
				if($i % 2 == 0){
					$sheet .= '<tr>';
					$col = "rgb(199, 212, 217)";
				}else{
					$col = "white";
				}
				
				$sheet .= '	<td style = "font-size:12px;padding:0 5px;">' . $i++ . '</td>';
				$sheet .= '	<td   style = "font-size:14px;padding:4px 15px;background-color:' . $col . '">' . $data['DateModified'] . '</td>';
				$sheet .= '	<td   style = "font-size:12px;font-weight:bold; letter-spacing:1px;padding:4px 15px;background-color:' . $col . '">' . $data['Status'] . '</td>';
				$sheet .= '	<td  style = "font-size:12px;font-weight:bold;padding:4px 15px;background-color:' . $col . '">' . $data['Completion'] . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet;
		}
		function logs2018($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber){
			$sheet = '<table style= "margin-left:16px;"><tr>
					   	       <td colspan = "3" style = "padding-left:10px;"  ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Encoded By</div><span  style = "font-size:13px;padding-left:5px;font-weight:bold;" class = "data1">' . $encodedBy . '</span></td>
					   <tr>
					   <tr>
					   		<td colspan = "3"  style = "padding-left:10px;"  ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Date Encoded</div><span id = "trackingEncoded"  style = "padding-left:5px;font-size:12px;letter-spacing:1px;" class = "data1">' . $dateEncoded . '</span></td>
					   <tr>
					   
					   <tr>
					   		<td colspan = "3"   style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Date Updated</div><span id = "trackingModified"  style = "padding-left:5px;font-size:12px;font-weight:bo1d;letter-spacing:1px;" class = "data1">' . $dateUpdated . '</span></td>
					   <tr>
					   
					   ';
					   if(strlen($completion)> 0){
						   $sheet .= '<tr>
						   			<td colspan = "3" style = "padding-left:10px;" ><div class = "data1" style = "font-size:12px;width:80px;text-align:right;display:inline-block;">Processed Time</div>
						   				<span style = "font-size:13px;margin-left:5px;font-weight:bold;color:red;" class = "data1">' . $completion . '</span>';
						   if($completion > 3){
						 	$sheet .= '<span style = "font-size:11px; color:grey;font-family:oswald;"> (includes non working days)</span>';		
						   }			
						   $sheet .= '	</td><tr>';
					   }
			$sheet .= '<tr>
					   		<td colspan = "3"   style = "padding-left:100px;" >
					   			<span id = "history' . $trackingNumber .'"  style = "font-size:13px;cursor:pointer;font-weight:bold;" class = "data1" onclick = "viewHistory(this)">
					   				<span id = "historyArrow"style = "color:rgb(249, 65, 105);">&#9658;</span> View History
					   			</span>
					   			<div id = "historyContainer"  style = "padding:0px 20px;"></div>
					   		</td>
					   <tr></table>';
			return $sheet;
		}	
			
		function CreatePPMPprevious($record){
			$i =1;
			$total  = 0;
			$sheetHeader = '
							<tr style = "text-align:center;background-color:grey;color:white;">
								<td>#</td>
								<td style = "text-align:left;">Fund</td>
								
								<td style = "text-align:left;">Description</td>
								<td colspan = "2"  style = "text-align:left;">Cost per Unit</td>
								
								<td colspan = "12" >Quantity</td>
								<td></td>
								<td>Action</td>
							</tr>
							';
			$sheet = '<table id = "tablePPMPprevious" style = "border-spacing:0px;" border ="0">';
			$sheet .= $sheetHeader;
			
			while($data = $this->fetch_array($record)){
				$programCode = $data['program_code'];
				$accountCode = $data['account_code'];
				$category = $data['item_category'];
				if( substr($category,0,2) == "NC"){
					$category = 'NO CAT';
				}
				$itemType = $data['item_type'];
				$description = $data['item_description']; 
				$unit = $data['quantity_unit']; 
				
				$jan = $data['jan'];
				$feb = $data['feb'];
				$mar = $data['mar'];
				$apr = $data['apr'];
				$may = $data['may'];
				$jun = $data['jun'];
				$jul = $data['jul'];
				$aug = $data['aug'];
				$sep = $data['sep'];
				$oct = $data['oct'];
				$nov = $data['nov'];
				$dec = $data['decx'];
				
				$estTotalCost =  $data['est_budget']; 
				$quantity = $jan + $feb +$mar + $apr + $may + $jun + $jul + $aug + $sep + $oct + $nov+ $dec;
				$unitCost =  number_format(intval($estTotalCost / $quantity),2);
				
				$fixedTotal = number_format($quantity * $unitCost,2);
				
				if($jan < 1){
					$jan = '';
				}
				if($feb < 1){
					$feb = '';
				}
				if($mar < 1){
					$mar = '';
				}
				if($apr < 1){
					$apr = '';
				}
				if($may < 1){
					$may = '';
				}
				if($jun < 1){
					$jun = '';
				}
				if($jul < 1){
					$jul = '';
				}
				if($aug < 1){
					$aug = '';
				}
				if($sep < 1){
					$sep = '';
				}
				if($oct < 1){
					$oct = '';
				}
				if($nov < 1){
					$nov = '';
				}
				if($dec < 1){
					$dec = '';
				}
				
				
				if($i % 2 == 0){
					$sheet .= '<tr style = "background-color:rgb(252, 251, 238)">';
				}else{
					$sheet .= '<tr style = "background-color:rgb(223, 223, 220);">';
				}
				
				
				$sheet .= '<td class = "tdData" style = "padding:10px;font-size:16px;font-style:italic;font-weight:bold;"><div style = "color:white;padding:2px;width:20px;height:20px;text-align:center; background-color:rgb(190, 189, 186);border-right:1px solid grey;">' . $i .  '</div></td>';
				$sheet .= '<td class = "tdData" style = "height:10px;">
							<input  style = "width:105px;border:0;border-bottom:1px solid silver;text-align:left;background-color:transparent;" value = "' . $programCode .  '"/>
							<input style = "width:105px;border:0;text-align:left;background-color:transparent;" value = "' . $accountCode .  '"/>
						</td>';
				
				$sheet .= '<td class = "tdData" style = "padding-right:5px;">
							<input  style = "width:105px;border:0;border-bottom:1px solid silver;text-align:left;background-color:transparent;" value = "' . $category .  '"/><br/>
							<input   style = "width:220px;border:0;text-align:left;background-color:transparent;" value = "' . $itemType .  '"/>
							<textarea class = "select2" style = "width:220px;border:0;border-left:1px solid silver;border-top:1px solid silver;resize:vertical;font-size:14px;">' . $description .  '</textarea>
						</td>';
				
				$sheet .= '<td class = "tdData" style = "padding-top:60px;" >
							<input  class = "monthInput"  style = "width:75px;border-bottom:0;"  value = "' . $unitCost .  '"/>
							<input  class = "monthInput"  style = "width:75px;"  value = "' . $unit .  '"/>
						</td>';
				
				$sheet .= '<td  class = "tdData" style = "padding:0px 8px;padding-top:60px;font-weight:bold;" >x</td>';
				$sheet .= '<td  class = "tdData" style = "padding-top:45px;text-align:center;" ><span style = "font-size:12px;">Jan</span><input  class = "monthInput" value = "' . $jan .  '"/></td>';
				$sheet .= '<td  class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Feb</span><input class = "monthInput" value = "' . $feb .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Mar</span><input class = "monthInput" value = "' . $mar .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Apr</span><input class = "monthInput" value = "' . $apr .  '"/></td>';
				$sheet .= '<td  class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">May</span><input class = "monthInput" value = "' . $may .  '"/></td>';
				$sheet .= '<td  class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Jun</span><input class = "monthInput" value = "' . $jun .  '"/></td>';
				$sheet .= '<td  class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Jul</span><input class = "monthInput" value = "' . $jul .  '"/></td>';
				$sheet .= '<td  class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Aug</span><input class = "monthInput" value = "' . $aug .  '"/></td>';
				$sheet .= '<td  class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Sep</span><input class = "monthInput" value = "' . $sep .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Oct</span><input class = "monthInput" value = "' . $oct .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Nov</span><input class = "monthInput" value = "' . $nov .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Dec</span><input class = "monthInput" value = "' . $dec .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding-top:45px;text-align:center;"><span style = "font-size:12px;">Total</span><input class = "monthInput" style = "width:70px;" value = "' . $fixedTotal .  '"/></td>';
				$sheet .= '<td class = "tdData"  style = "padding: 0 5px;padding-right:10px; padding-top:58px;">
							<div class = "button2" style = "width:35px;background-color:rgb(249, 204, 107);color:white;">Copy </div>
						</td>';
				$sheet .= '</tr>';
				
				
				$i++;
			}
			$sheet .= '<table>';
			echo $sheet;
		}
		function CreateProgramCodeOnly($record){
			$sheet = '<select id = "" class = "select2" onchange = "fetchPPMPbyProgram(this)">';
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '" style = "color:black;">';
				$sheet .=  $data['Code'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			
			return $sheet;
		}
		function CreateAccountCodes($record){
			$sheet = '<select id = "ppmpAcctCodeSelect"  class = "select2" onclick= "restoreValueAccountCode(this)"  onchange = "changeValue(this)" >';
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){
				$code = $data['Code'];
				$title = $data['Title'];
				$sheet .= '<option value = "' . $code . '" style = "color:black;">';
				$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $title ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreatePPMPcategory($record){
			$sheet = '<select  id = "ppmpCatSelect"  class = "select2" onclick= "restoreValueCatCode(this)"  onchange = "changeValue(this)" >';
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){
				$code = $data['Code'];
				$codeX = $data['Code'];
				
				if(strlen($code)==5){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==6){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==7){
					$code .= "&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==8){
					$code .= " "; 
				}
				$description = $data['Description'];
				$sheet .= '<option value = "' . $codeX . '" style = "color:black;">';
				$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $description ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreatePPMPItems($record){
			$sheet = '<select id = "ppmpSelectItem"  class = "select2"  onchange = "selectItem(this)">';
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$desc =   htmlspecialchars($data['Description']);
				$price =$data['EstimatedPrice'];
				$unit = $data['PurchasedUnit'];
				$sheet .= '<option value = "' . $id . '~' . $desc . '~' . $price . '~' . $unit .  '" style = "color:black;">';
				$sheet .=    $desc ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreatePPMPunits($record){
			$sheet = '<select id = "ppmpSelectUnit"  class = "select2"  onchange = "selectUnitManagement(this)">';
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){
				$unit = $data['Unit'];
				$sheet .= '<option style = "color:black;" value = "' . $unit . '" >';
				$sheet .=  $unit ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreatePPMPunits1($record){
			$sheet = '<select id = "ppmpSelectUnit"  class = "select2"  onchange = "selectUnitManagement(this)" disabled>';
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){
				$unit = $data['Unit'];
				$sheet .= '<option style = "color:black;" value = "' . $unit . '" >';
				$sheet .=  $unit ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
	
		function CreateSavedPPMPbyProgram($record){
			$officeCode = $_SESSION['officeCode'];
			$sql1 = "select * from office where code = '" . $officeCode . "'";
			$record1 = $this->query($sql1);
			$data1 = $this->fetch_array($record1);
			$lock = $data1['PPMP'];
			
			$acctName = '';
			$i =$this->num_rows($record);
			$sheet = '<table id  = "savedPPMPtable" class = "savedPPMP" style = "width:100%;border-spacing:0;">';
			$sheet .= '<tr>';
				$sheet .= '<td class = "tdHeader" style = "width:10px;">&nbsp</td>';
				$sheet .= '<td class = "tdHeader" style = "text-align:left;">Fund</td>';
			
				$sheet .= '<td class = "tdHeader" style = "text-align:left;">Item</td>';
				$sheet .= '<td class = "tdHeader">Unit</td>';
				$sheet .= '<td class = "tdHeader">Cost</td>';				
						
				$sheet .= '<td class = "tdHeader">Jan</td>';
				$sheet .= '<td class = "tdHeader">Feb</td>';
				$sheet .= '<td class = "tdHeader">Mar</td>';
				$sheet .= '<td class = "tdHeader">Apr</td>';
				$sheet .= '<td class = "tdHeader">May</td>';
				$sheet .= '<td class = "tdHeader">Jun</td>';
				$sheet .= '<td class = "tdHeader">Jul</td>';
				$sheet .= '<td class = "tdHeader">Aug</td>';
				$sheet .= '<td class = "tdHeader">Sep</td>';
				$sheet .= '<td class = "tdHeader">Oct</td>';
				$sheet .= '<td class = "tdHeader">Nov</td>';
				$sheet .= '<td class = "tdHeader">Dec</td>';
				$sheet .= '<td class = "tdHeader">Total</td>';		
				$sheet .= '<td colspan = "2" class = "tdHeader"></td>';		
			$sheet .= '</tr>';
			while($data = $this->fetch_array($record)){
				$id = $data['Id'];
				$type = $data['Type'];
				$category = $data['Category'];
				$program = $data['ProgramCode'];
				$item = $data['Item'];
				$cost = $data['Cost'];
				$total = $data['Total'];
				$unit = $data['Unit'];
				$desc = $data['Description'];
				$fund = $data['Fund'];
				
				$acctName = $data['Title'];
				$lock  = 0;
				if(isset($data['Locker'])){
					$lock  = $data['Locker'];
				}
				
				
				$program = $data['ProgramCode'];
				$programName = $data['Name'];
				if($type == "Infrastructure"){
					$item = $programName;
					$desc = '';
				}
				
				$code = $data['AccountCode'];
				
				$jan = $this->zeroToNothing($data['Jan']);
				$feb = $this->zeroToNothing($data['Feb']);
				$mar = $this->zeroToNothing($data['Mar']);
				$apr = $this->zeroToNothing($data['Apr']);
				$may = $this->zeroToNothing($data['May']);
				$jun = $this->zeroToNothing($data['Jun']);
				$jul = $this->zeroToNothing($data['Jul']);
				$aug = $this->zeroToNothing($data['Aug']);
				$sep = $this->zeroToNothing($data['Sep']);
				$oct = $this->zeroToNothing($data['Oct']);
				$nov = $this->zeroToNothing($data['Nov']);
				$dec = $this->zeroToNothing($data['Dex']);
				 
				if($i % 2 == 0){
					$sheet .= '<tr id = "tr' . $id . '" class = "trData" style = "background-color:white;" onmouseover = "trHover(this)" onmouseout = "trHoverOut(this)">';
				}else{
					$sheet .= '<tr  id = "tr' . $id . '"  class = "trData" style = "background-color:rgb(249, 246, 241);" onmouseover = "trHover(this)" onmouseout = "trHoverOut(this)">';
				}
				
					$sheet .= '<td style = "text-align:center; vertical-align:top;"><div style = "height:20px;width:15px;display:inline-block;padding:2px; color:gray;">' . $i-- . '</div></td>';
					$sheet .= '<td style = "vertical-align:top;"><div style = "font-weight:bold;">' . $program .  '</div><div style = "color:red;cursor:pointer;" onmouseover = "viewName(this)" onmouseout = "viewName(this)">' .  $code . '<span id = "' . $acctName . '" class = "accountNameHide"></span></div>
							   <div>' .   $type . '</div>
							   <div style = "text-overflow:nowrap;white-space: nowrap;">' .   $fund .  '</div>
							   </td>';
					
					if($item == $desc){
						$sheet .= '<td style = "vertical-align:top;"><div style = "font-weight:bold;">'  . $category  . "</div><div>"  . $item .  '</div></td>';
					}else{
						$sheet .= '<td style = "vertical-align:top;"><div style = "font-weight:bold;">'  . $category  . "</div><span style = 'border-bottom:1px solid silver;color:rgb(74, 143, 162)'>"  . $item . "</span><div >"   . $desc . '</div></td>';
					}
					
					$sheet .= '<td style = "border-left:1px solid rgb(208, 207, 207);">' . $unit . '</td>';
					$sheet .= '<td style = "text-align:right;padding-right:5px;">' . number_format($cost,2) . '</td>';
					
					$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);border-left:1px solid silver; ">' . $jan . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $feb . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $mar . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $apr . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $may . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $jun . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $jul . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $aug . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $sep . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $oct . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $nov . '</td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $dec . '</td>';
					
					$sheet .= '<td style = "text-align:right;padding-right:5px; background-color:rgb(252, 221, 188);border-left:1px solid silver; ">' .  number_format($total,2) . '</td>';
					if($lock == 0){
						$sheet .= '<td style = "text-align:center;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;" onclick = "deletePPMP(this)">Dump</span></td>';
					}else{
						$sheet .= '<td style = "text-align:center;padding:2px 20px;background-color:rgb(203, 202, 196);color:white;">lock</td>';
					}
					//$sheet .= '<td style = "text-align:center;"></td>';
					//$sheet .= '<td style = "text-align:center;"><span id  = "' . $id . '-' . $lock . '" class = "button2" style = "font-size:10px;padding:2px 5px;" onclick = "updatePPMP(this)">Edit</span></td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table>';
			return $sheet;
		}
		function CreateTRitem($record){
			$officeCode = $_SESSION['officeCode'];
			/*$sql1 = "select * from office where code = '" . $officeCode . "'";
			$record1 = $this->query($sql1);
			$data1 = $this->fetch_array($record1);
			$lock = $data1['PPMP'];*/
			
			$count = $this->num_rows($record); 
			if($count >0){
				
				$sheet = '';
				$data = $this->fetch_array($record);
				$id = $data['Id'];
				$type = $data['Type'];
				$category = $data['Category'];
				$item = $data['Item'];
				$cost = $data['Cost'];
				$total = $data['Total'];
				$unit = $data['Unit'];
				$desc = $data['Description'];
				$program = $data['ProgramCode'];
				$code = $data['AccountCode'];
				
				$jan =$this->zeroToNothing($data['Jan']);
				$feb = $this->zeroToNothing($data['Feb']);
				$mar = $this->zeroToNothing($data['Mar']);
				$apr = $this->zeroToNothing($data['Apr']);
				$may = $this->zeroToNothing($data['May']);
				$jun = $this->zeroToNothing($data['Jun']);
				$jul = $this->zeroToNothing($data['Jul']);
				$aug = $this->zeroToNothing($data['Aug']);
				$sep = $this->zeroToNothing($data['Sep']);
				$oct = $this->zeroToNothing($data['Oct']);
				$nov = $this->zeroToNothing($data['Nov']);
				$dec = $this->zeroToNothing($data['Dex']);
				
				$sheet .= '<td id="first' . $id . '" style = "text-align:center; vertical-align:top;border-left:0;"><div style = "height:20px;width:15px;display:inline-block;padding:2px;color:gray;"></div></td>';
				$sheet .= '<td style = "vertical-align:top;"><div style = "font-weight:bold;">' . $program . '</div><div style = "color:red;">' .  $code . '</div><div>' .   $type .  '</div></td>';
				if($item == $desc){
					$sheet .= '<td style = "vertical-align:top;"><div style = "font-weight:bold;">'  . $category  . "</div><span>"  . $item .  '</span></td>';
				}else{
					$sheet .= '<td style = "vertical-align:top;"><div style = "font-weight:bold;">'  . $category  . "</div><span style = 'border-bottom:1px solid silver;color:rgb(74, 143, 162)'>"  . $item . "</span><div>"   . $desc . '</div></td>';
				}
				
				$sheet .= '<td style = "border-left:1px solid rgb(208, 207, 207);">' . $unit . '</td>';
				$sheet .= '<td style = "text-align:right;padding-right:5px;">' . number_format($cost,2) . '</td>';
				
				$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);border-left:1px solid silver; ">' . $jan . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $feb . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $mar . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $apr . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $may . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $jun . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $jul . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $aug . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(240, 227, 198);">' . $sep . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $oct . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $nov . '</td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(224, 225, 225);">' . $dec . '</td>';
				
				$sheet .= '<td style = "text-align:right;padding-right:5px;background-color:rgb(252, 221, 188);border-left:1px solid silver; ">' .  number_format($total,2) . '</td>';
				//$sheet .= '<td style = "text-align:center;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;" onclick = "deletePPMP(this)">Dump</span></td>';
				
				$sheet .= '<td style = "text-align:center;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;" onclick = "deletePPMP(this)">Dump</span></td>';
				
				
				//$sheet .= '<td style = "text-align:center;"><span id  = "' . $id . '-' . $lock . '" class = "button2" style = "font-size:10px;padding:2px 5px;" onclick = "updatePPMP(this)">Edit</span></td>';
				return $sheet;
				
			}else{
				return false;	
			}
			
		}



		
		function ListOutCategories1($record){ // Item Management
			$sheet = '<select  class="select2" id = "itemCategorySelectonView"  onclick= "revertBackValue(this)" onchange = "reAlterValue(this)"   style="font-family:Oswald;">'; 
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){

				$code = $data['Code'];
				$codeX = $data['Code'];
				
				if(strlen($code)==5){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==6){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==7){
					$code .= "&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==8){
					$code .= " "; 
				}

				$description = $data['Description'];
				$sheet .= '<option value = "' . $codeX . '" style = "color:black;">';
				$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $description ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function ListOutCategories2($record){ // Item Management
			$sheet = '<select  class="select2" id = "itemEntryCategory" onclick= "retraceValue(this)"    onchange="rechangeVal(this)" style="font-family:Oswald;">';
			//onchange = "rechangeVal(this)"
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){

				$code = $data['Code'];
				$codeX = $data['Code'];
				
				if(strlen($code)==5){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==6){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==7){
					$code .= "&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==8){
					$code .= " "; 
				}

				$description = $data['Description'];
				$sheet .= '<option value = "' . $codeX . '" style = "color:black;">';
				$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $description ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}

		function ListOutCategories3($record){ // Item Management
			$sheet = '<select  class="select2" id = "itemOnPdf" onclick= "retraceValue3(this)"    onchange="rechangeThisValue(this)" style="font-family:Oswald;">';
			//onchange = "rechangeVal(this)"
			$sheet .= '<option></option>';
			while($data = $this->fetch_array($record)){

				$code = $data['Code'];
				$codeX = $data['Code'];
				
				if(strlen($code)==5){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==6){
					$code .= "&nbsp;&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==7){
					$code .= "&nbsp;&nbsp;&nbsp;"; 
				}
				if(strlen($code)==8){
					$code .= " "; 
				}

				$description = $data['Description'];
				$sheet .= '<option value = "' . $codeX . '" style = "color:black;">';
				$sheet .= $code . '&nbsp;&nbsp;&nbsp;' .  $description ;
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}

		function ListOutEntryonView($record){ // Item Management
			$i = $this->num_rows($record);
			$sheet = '';
			$sheet0 = '';

			$sheet2 = '<table id  = "ItemEncodeEntry" class = "ItemEncodeEntry" style = "font-family: Oswald;font-size: 12px;width:100%;border-spacing:0;">';

			$sheet0 .=  '<tr >';
			$sheet0 .=  '<td class = "tdHeader" style = "width:10px;">&nbsp</td>';
			
			$sheet0 .=  '<td class = "tdHeader" style = "text-align:center;">Item&nbsp;No.</td>';		
			$sheet0 .=  '<td class = "tdHeader" style = "text-align:left;">Description</td>';		
			$sheet0 .=  '<td class = "tdHeader">Classification</td>';				
			/*$sheet .=  '<td class = "tdHeader">Economic Life</td>';*/
			$sheet0 .=  '<td class = "tdHeader">Unit</td>';
			/*$sheet .=  '<td class = "tdHeader">Unit of Release</td>';*/
			/*$sheet .=  '<td class = "tdHeader">Quantity</td>';
			$sheet .=  '<td class = "tdHeader">Reorder Unit</td>';	*/
			$sheet0 .=  '<td class = "tdHeader">Estimated&nbsp;Price</td>';
			/*$sheet .=  '<td class = "tdHeader">Reorder Point</td>';*/		
			$sheet0 .=  '<td class = "tdHeader" style = "width:70px;text-align:center;">Canvassed</td>';		
			$sheet0 .=  '<td colspan = "2" class = "tdHeader" style = "font-weight:normal;background-color:rgb(158, 154, 128);font-weight:bold;letter-spacing:1px;color:white;"> Controls</td>';	
			$sheet0 .=  '</tr>';	
			
			$catMark = "";
			$marker = 0;
			$counter = 0;
			while($data = $this->fetch_array($record)) {
	
				$id = $data['Id'];
				$category = $data['CategoryCode'];
				
				if($catMark != $category ){
					$counter++;
				}
				$catMark = $category;
				
				
				$description = $data['Description'];

				$catergorydescription = $data['CatergoryDescription'];
				$sheet1 = '<tr><td colspan = "2" style ="text-align:right;vertical-align:bottom;padding-bottom:4px;"> <span style = "font-size:14px;" id = "itemCategoryMan">' . $category . '</span> </td><td colspan = "10"  style = "padding-left:5px;	vertical-align:bottom;">  <span style = "font-size:22px;">' . $catergorydescription . '</span></td></tr>';
		
				$classification = $data['Classification'];
				$economiclife = $data['EconomicLife'];
				$purchasedunit = $data['PurchasedUnit'];
				$releasedunit = $data['ReleasedUnit'];
				$order = $data['OrderQuantity'];
				$reorderunit = $data['ReorderUnit'];
				$estimatedprice = $this->zeroToNothing(number_format($data['EstimatedPrice'],2));
				$reorderpoint = $data['ReorderPoint'];
				$dateCanvassed = $data['DateCanvassed'];

				
				
				
				if($i % 2 == 0){
					$sheet .= '<tr id = "tr' . $id . '" class = "trData" style = "background-color:white;" onmouseover = "trHover(this)" onmouseout = "trHoverOut(this)">';
				}else{
					$sheet .= '<tr  id = "tr' . $id . '"  class = "trData" style = "background-color:rgb(249, 246, 241);" onmouseover = "trHover(this)" onmouseout = "trHoverOut(this)">';
				}

					$sheet .= '<td id="first' . $id . '" style = "text-align:center; vertical-align:top;border-left:0;"><div style = "height:20px;width:15px;display:inline-block;padding:2px;color:gray;">'. $i-- .'</div></td>';
					
					/*$sheet .= '<td style = "vertical-align:top;"><div style = "">Category</div><span style = "color:rgb(74, 143, 162)">' .  $catergorydescription.'</span></div></td>';*/
					$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);text-align:center;font-weight:bold;vertical-align:top;">' . $id . '</td>';	
					$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);vertical-align:top;">' . $description . '</td>';	
					$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $classification . '</td>';
					/*$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $economiclife . '</td>';*/
					$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $purchasedunit . '</td>';
				/*	$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $releasedunit . '</td>';*/
				/*	$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $order . '</td>';*/
					/*$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $reorderunit . '</td>';*/
					$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);text-align:right;font-weight:bold;">' . $estimatedprice . '</td>';
					/*$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);">' . $reorderpoint . '</td>';*/
					$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);text-align:center;">' . $dateCanvassed . '</td>';

					$sheet .= '<td style = "text-align:center;background-color:rgb(223, 219, 218);width:40px;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;font-weight:normal; letter-spacing:1px;" onclick = "deleteThisSelectedRow(this)">Dump</span></td>';
					$sheet .= '<td style = "text-align:center;background-color:rgb(229, 227, 220);width:40px;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;font-weight:normal; letter-spacing:1px;" onclick = "updateThisSelectedRow(this)">Edit</span><input type = "hidden" value = "' . $category . '"></td>';
					$sheet .= '</tr>';

			}
			$sheet .= '</table>';
			
			if($counter > 1){
				$sheet1 = '<tr><td colspan = "2" style ="text-align:right;vertical-align:bottom;padding-bottom:4px;"> <span style = "font-size:14px;" id = "itemCategoryMan"></span> </td><td colspan = "10"  style = "padding-left:5px;	vertical-align:bottom;">  <span style = "font-size:22px;">Multiple categories</span></td></tr>';
		
			}
			return $sheet2 .  $sheet1 . $sheet0 . $sheet;
		}
			

		/*function CreateItemEntryList($record){ // Item Management
			$countRow = $this->num_rows($record);
			if ($countRow > 0) {
				$sheet = ''; 
				$data = $this->fetch_array($record);

				$id = $data['Id'];
				$category = $data['CategoryCode'];
				$description = $data['Description'];
				$catergorydescription = $data['CatergoryDescription'];
				$classification = $data['Classification'];
				$economiclife = $data['EconomicLife'];
				$purchasedunit = $data['PurchasedUnit'];
				$releasedunit = $data['ReleasedUnit'];
				$order = $data['OrderQuantity'];
				$reorderunit = $data['ReorderUnit'];
				$estimatedprice = $data['EstimatedPrice'];
				$reorderpoint = $data['ReorderPoint'];
				$dateCanvassed =  $data['DateCanvassed'];

				$sheet .= '<tr>';
				$sheet .= '<td id="first' . $id . '" style = "text-align:center; vertical-align:top;border-left:0;"><div style = "height:20px;width:15px;display:inline-block;padding:2px;color:gray;"></div></td>';
				$sheet .= '<td style = "vertical-align:top;padding-left:5px;"><div style = "font-weight:bold;padding-left:5px;">'  . $category  . '</div><span style = "color:rgb(74, 143, 162)">'  . $catergorydescription . '</span></div></td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $description . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $classification . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $economiclife . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $purchasedunit . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $releasedunit . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $order . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $reorderunit . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $estimatedprice . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $reorderpoint . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $dateCanvassed . '</td>';

				//$sheet .= '<td style = "text-align:center;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px; font-weight:normal;" onclick = "deleteThisSelectedRow(this)">Dump</span></td>';
				//$sheet .= '<td style = "text-align:center;border-left:1px solid rgb(239, 237, 234);"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px; font-weight:normal;" onclick = "updateThisSelectedRow(this)">Edit</span></td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(251, 224, 232);width:40px;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;font-weight:normal; letter-spacing:1px;" onclick = "deleteThisSelectedRow(this)">Dump</span></td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(249, 247, 216);width:40px;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;font-weight:normal; letter-spacing:1px;" onclick = "updateThisSelectedRow(this)">Edit</span></td>';
					
				$sheet .= '</tr>';

				return $sheet;

				} else {
						return false;	
				}	
		}*/
		function CreateItemEntryList($record){ // Item Management
			$countRow = $this->num_rows($record);
			if ($countRow > 0) {
				$sheet = ''; 
				$data = $this->fetch_array($record);

				$id = $data['Id'];
				$category = $data['CategoryCode'];
				$description = $data['Description'];
				$catergorydescription = $data['CatergoryDescription'];
				$classification = $data['Classification'];
				$economiclife = $data['EconomicLife'];
				$purchasedunit = $data['PurchasedUnit'];
				$releasedunit = $data['ReleasedUnit'];
				$order = $data['OrderQuantity'];
				$reorderunit = $data['ReorderUnit'];
				$estimatedprice = $this->zeroToNothing(number_format($data['EstimatedPrice'],2));
				$reorderpoint = $data['ReorderPoint'];
				$dateCanvassed =  $data['DateCanvassed'];

				$sheet .= '<tr>';
				$sheet .= '<td id="first' . $id . '" style = "text-align:center; vertical-align:top;border-left:0;"><div style = "height:20px;width:15px;display:inline-block;padding:2px;color:gray;"></div></td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);text-align:center;font-weight:bold;">' . $id . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $description . '</td>';
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $classification . '</td>';
			
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);padding-left:5px;">' . $purchasedunit . '</td>';
				
				
				
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);text-align:right;">' . $estimatedprice . '</td>';
			
				$sheet .= '<td style = "border-left:1px solid rgb(239, 237, 234);text-align:center;">' . $dateCanvassed . '</td>';


				$sheet .= '<td style = "text-align:center;background-color:rgb(223, 219, 218);width:40px;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;font-weight:normal; letter-spacing:1px;" onclick = "deleteThisSelectedRow(this)">Dump</span></td>';
				$sheet .= '<td style = "text-align:center;background-color:rgb(229, 227, 220);width:40px;"><span id  = "' . $id . '" class = "button2" style = "font-size:10px;padding:2px 5px;font-weight:normal; letter-spacing:1px;" onclick = "updateThisSelectedRow(this)">Edit</span></td>';
					
				$sheet .= '</tr>';

				return $sheet;

				} else {
						return false;	
				}	
		}

//		------------------------------------------------------------------------------------- view
		function CreatePPMPviewOffice($record){
			$sheet = '<select id = "ppmpViewSelectOffice" class = "select2" onchange = "fetchPPMPprogramPerOffice(this)">';
			$sheet .= '<option style = "color:black;"></option>';
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Code'] . '" style = "color:black;">';
				$sheet .=  $data['Name'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreatePPMPselectEmpty(){
			$sheet = '<select id = "" class = "select2" onchange = "">';
			$sheet .= '<option style = "color:black;"></option>';
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateProgramInView($record){
			$count = $this->num_rows($record);
			$sheet = '<select id = "ppmpViewSelectProgram" class = "select2" onchange = "fetchSavePPMP(this)">';
			if($count > 1){
				$sheet .= '<option style = "color:black;"></option>';
			}
			
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['ProgramCode'] . '" style = "color:black;">';
				$sheet .=  $data['ProgramCode'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateTypeInView($record){
			$count = $this->num_rows($record);
			$sheet = '<select id = "ppmpViewSelectType" class = "select2" onchange = "selectProgramPerType(this)" >';
			if($count > 1 ){
				$sheet .= '<option style = "color:black;"></option>';
			}
			while($data = $this->fetch_array($record)){
				$sheet .= '<option value = "' . $data['Type'] . '" style = "color:black;">';
				$sheet .=  $data['Type'];
				$sheet .= '</option>';
			}
			$sheet .= '</select>';
			return $sheet;
		}
		function CreateProgramInViewFixed($value){
			$sheet = '<select id = "ppmpViewSelectProgram"  class = "select2" onchange = "fetchSavePPMP(this)">';
			$sheet .= '<option value = "' . $value . '" style = "color:black;">' . $value . '</option>';
			$sheet .= '</select>';
			
			return $sheet;
		}
		function CreateSavedPPMPTotals($record,$office,$type){
			
			$count = $this->num_rows($record);
			$sum = 0;
			$i =1;
			$sheet = '<table   style = "width:100%;border-spacing:0;background-color:white;border:1px solid silver;">';
			$sheet .= '<tr style = "background-color:rgb(174, 170, 166);background-color:rgb(227, 140, 69);">';
		
			$sheet .= '<td colspan = "2" class = "tdData" style = "text-align:center;border-right:1px solid silver;padding:5px;color:white;font-size:13px;">Program</td>';
			
			$sheet .= '<td class = "tdData" style = "padding:5px;color:white;text-align:center;font-size:13px;">Total</td></tr>';
			while($data = $this->fetch_array($record)){
				
				$program = $data['ProgramCode'];
				$total = $data['GrandTotal'];
				if($type == 1){
					$type = $data['Type'];	
				}
				$sheet .= '<tr>';
				if($count > 1){
					$sheet .= '<td class = "tdData" style = "border-bottom:1px solid silver;padding:5px;color:grey;text-align:center;vertical-align:top;background-color:rgb(251, 250, 218);">' . $i++  . '</td>
							<td  class = "tdData" style = "text-align:right;border-right:1px solid silver;border-bottom:1px solid silver;padding:5px;vertical-align:top;">' . $program .  '</td>	';
				}else{
					$sheet .= '
							<td colspan = "2" class = "tdData" style = "text-align:right;border-right:1px solid silver;border-bottom:1px solid silver;padding:5px;vertical-align:top;">' . $program .  '</td>	';
				}
				
				$sheet .= '<td class = "tdData" style = "border-bottom:1px solid silver;padding:5px;text-align:right;color:black;">' . number_format($total,2) . '</td>';
				$sheet .= '</tr>';
				$sum += $total;
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan = "3" class = "tdData" style = "text-align:right; padding:5px;text-align:right;color:red;">' . number_format($sum,2) . '</td>';
			$sheet .= '</tr>';
			
			$sheet .= '</table>';
			
			if($count == 1){
				if($sum > 0){
					$sheet .= $this->CreatePrintPreview($office,$program,$type); 
				}
			}
			return $sheet;
		}
		function CreateSavedPPMPexpenseTotals($record){
			$count = $this->num_rows($record);
			$sum = 0;
			$i =1;
			$sheet = '<table   style = "width:100%;border-spacing:0;background-color:white;border:1px solid silver;margin-bottom:10px;margin-right:2px;">';
			$sheet .= '<tr style = "background-color:rgb(174, 170, 166);background-color:rgb(227, 140, 69);">';
			$sheet .= '<td colspan = "2" class = "tdData" style = "text-align:center;border-right:1px solid silver;padding:5px;color:white;font-size:13px;">Account Code</td>';
			$sheet .= '<td class = "tdData" style = "padding:5px;color:white;text-align:center;font-size:13px;">Total</td></tr>';
			while($data = $this->fetch_array($record)){
				$accountCode = $data['AccountCode'];
				$total = $data['GrandTotal'];
				$sheet .= '<tr>';
				if($count > 1){
					$sheet .= '<td class = "tdData" style = "border-bottom:1px solid silver;padding:5px;color:grey;text-align:center;vertical-align:top;background-color:rgb(251, 250, 218);">' . $i++  . '</td>
							<td  class = "tdData accountCode" style = "text-align:right;border-right:1px solid silver;border-bottom:1px solid silver;padding:5px;vertical-align:top;" onclick = "viewPerCode(this)">' . $accountCode .  '</td>	';
				}else{
					$sheet .= '
							<td colspan = "2" class = "tdData accountCode" style = "text-align:right;border-right:1px solid silver;border-bottom:1px solid silver;padding:5px;vertical-align:top;" onclick = "viewPerCode(this)">' . $accountCode .  '</td>	';
				}	
				$sheet .= '<td class = "tdData" style = "border-bottom:1px solid silver;padding:5px;text-align:right;color:black;">' . number_format($total,2) . '</td>';
				$sheet .= '</tr>';
				$sum += $total;
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan = "3" class = "tdData" style = "text-align:right; padding:5px;text-align:right;color:red;">' . number_format($sum,2) . '</td>';
			$sheet .= '</tr>';
			$sheet .= '</table>';
			return $sheet;
		}
		function CreatePrintPreview($office,$program,$type){
			$id = $office. '~' . $program . '~' . $type;
			/*$sheet = '<div id = "' . $id .  '"  style = "cursor:pointer; border-top:1px dashed silver;border-bottom:1px dashed silver;text-align:center;padding:5px;background-color:rgb1(224, 212, 177);width:90px;margin:20px auto;">
					<a href = "../interface/formPPMP.php?val=' . $id .  '" target="_blank" style = "text-decoration:none;"><span style = "color:black;font-family:arial;font-size:10px;font-weight:bold;" onclick = "viewPPMPPreview()" >PRINT PREVIEW</span></a>	
					</div>';*/
			$sheet = '<div id = "' . $id .  '"  style = "cursor:pointer; border-top:1px dashed silver;border-bottom:1px dashed silver;text-align:center;padding:5px;background-color:rgb1(224, 212, 177);width:90px;margin:20px auto;">
					<span style = "color:black;font-family:arial;font-size:10px;font-weight:bold;" onclick = "viewPPMPPreview()" >PRINT PREVIEW</span>
					</div>';
			return $sheet;
		}
	
		function CreateOfficeName($result){
			$data = $this->fetch_array($result);
			 $name =  $data['Name'];
			$sheet = '<div style = "color:red">'  . $name . '</div>';
			return $sheet;
		}
		function CreateSummaryPPMP($record){
			$sheet = '<table id = "tableSummary" style = "width:100%;margin-top:10px;">';
			$sheet .= '<tr>';
			$sheet .= '<td class= "tdHeader">Code</td><td class= "tdHeader">Title</td><td class= "tdHeader" style = "text-align:center;">Total Estimated</td>';
			$sheet .= '</tr>';
			$gTotal = 0;
			while($data = $this->fetch_array($record)){
				
				$code = $data['AccountCode'];
				$title = $data['Title'];
				$total = $data['Total'];
				$gTotal +=$total;
				$sheet .= '<tr>';
				$sheet .= '<td class= "tdData">' . $code . '</td><td class= "tdData">' . $title . '</td><td class= "tdData" style = "text-align:right;">' . number_format($total,2) . '</td>';
				$sheet .= '</tr>';
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan = "3" class= "tdData" style = "text-align:right;padding:10px 5px;"><span style = "margin-right:10px;">Total</span><span style = "font-weight:bold;font-size:15px;">' . number_format($gTotal,2) . '</span></td>';
			$sheet .= '</tr>';
			$sheet .= '<table>';
			return $sheet;
			
			
		}
//		------------------------------------------------------------------------------------- add Doctrack		
		function CreateCategoryList($record){
			$count = $this->num_rows($record);
			$sheet = '<div id  = "containerHeader" style = "width:800px;margin:0 auto;overflow-y:hidden;background-color:rgb(121, 137, 141);"></div>';
			$sheet .= '<div style = "width:800px;height:200px;margin:0 auto;overflow-y:auto;border:1px solid rgb(219, 229, 235); "><table id ="tableSelectCategory" style = "border-spacing:0;width:100%;  " border ="0">';
			$sheet .= '<tr id = "trCategoryListHeader">';
			$sheet .= '	<td class = "dataHeader1" style = "padding:5px 10px;width:10px;background-color:grey"></td>
						<td class = "dataHeader1" style = "padding:5px 10px;width:125px;background-color:rgb(121, 137, 141);">Category<span style = "padding-left:2px;font-size:16px;font-weight:normal;color:orange;">(' . $count . ')</span></td>
						<td class = "dataHeader1" style = "padding:5px 10px;background-color:rgb(121, 137, 141);">Description</td>
						<td class = "dataHeader1" style = "padding:5px 10px;background-color:rgb(121, 137, 141);text-align:center;">Items</td>';
			$sheet .= '</tr>';
			if($count == 0){
					$sheet .= '<tr><td style = "padding:20px 50px;font-size:22px;font-family:oswald;" colspan = "5" >No record found.</td></tr>';
			}
			while($data = $this->fetch_array($record)){
				$count = $data['Count'];
				$category = $data['Category'];
				$description = $data['Description'];
				$sheet .= '<tr>';
				$sheet .= '<td style = "width:10px;padding:10px;border-bottom:1px solid rgb(225, 229, 231);"><input type = "checkbox"  onclick = "getCategoryItems(this)"/></td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:1px solid rgb(225, 229, 231);"><span class = "data1">' . $category . '</span></td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:1px solid rgb(225, 229, 231);"><span class = "data1">' . $description . '</span></td>';
				
				$sheet .= '<td style = "width:100px;padding:0 10px;border-bottom:1px solid rgb(225, 229, 231);text-align:center;"><span class = "data1">' . $count . '</span></td>';
				$sheet .= '</tr>';
			}
			$sheet .= '</table></div>';			
			return  $sheet;	
		}
		function CreateCategoryItems2018($record){		
			$count = $this->num_rows($record);
			$sheet = '<table id = "prItemsTable" style = "border-spacing:0;border:1px solid rgb(219, 229, 235);width:800px;margin:0 auto;" border ="0">';
			$sheet .= '<tr class = "dataHeader1">';
			$sheet .= '<td style = "padding:5px 10px;font-size:18px; background-color:grey;">&nbsp;</td>
						<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Code</td>
						<td  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Description<span style = "padding-left:2px;font-size:16px;font-weight:normal;color:orange;">(' . $count . ')</span></td>
						<td style = "padding:5px 10px;font-size:18px;background-color:rgb(119, 122, 122);border:1px solid silver;"><input onclick ="selectAll(this)" type = "checkbox" checked/></td>
						<td colspan = "5"  style = "padding:5px 10px;font-size:18px;background-color:rgb(121, 137, 141);">Qty x Price</td>';
			$sheet .= '</tr>';
			
			
				
			$i = 1;
			$totalAmount = 0;
			$fund = '';
			while($data = $this->fetch_array($record)){
				
				$fund =  $data['Fund'];
				$amount =  $data['Amount'];
				$item = $data['Item'];
				$itemNo = $data['ItemNo'];
				
				$fund = $data['Fund'];
				
				$qtyX =  $data['Qty'];
				
				$qty =  $data['Qty'];
				$desc = $data['Description'];
				
				$category = $data['Category'];
				$unit = $data['Unit'];
				
				$accountCode = $data['AccountCode'];
				$programCode =  $data['ProgramCode'];
				
				//$price = $amount / $qtyX;
				$price = $data['Cost'];
				$price = round($price,2);
				
				$amountX =  $qty * $price;
				$totalAmount += $amountX;
				$sheet .= '<tr style = "background-color:rgb(206, 215, 218);">';
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
							<span class = "number" 
								style ="padding:2px;font-size:15px;color:black;text-align:center;background-color:rgb(225, 229, 232);width:20px;height:20px;display:block;border-radius:20px;">' . $i++ . '</span><input type = "hidden"  value = "' . $itemNo . '"></td>';
				
				$sheet .= '<td style = "padding:10px 10px;border-bottom:2px solid white;vertical-align:top;">
							<input onclick = "clickInput(this)" style = "font-weight:bold;font-size:16px;width:80px;border:0;border-bottom:1px solid silver;background-color:transparent;" value ="' . $programCode . '" class = "data1"/>
							<input onclick = "clickInput(this)" style = "font-size:14px;width:80px;border:0;background-color:transparent;color:black;" value = "' . $accountCode . '" class = "data1"/></td>';
				
				$sheet .= '<td style = "width:450px;padding:10px 2px;border-bottom:2px solid white;">
						 <textarea onclick = "clickInput(this)"  style = "width:100%;font-size:16px; resize:vertical;color:rgb(45, 90, 118);padding-bottom:5px;padding-left:5px;color:black; " class = "data1">' .  $desc . '</textarea>' . '</td>';
				$sheet .= '<td style = "padding:0 10px;border:1px solid white;border-top:0px solid white;border-bottom:2px solid white;background-color:rgb(222, 228, 231);">
							<input onclick ="selectCalculateAddPR(this)" type = "checkbox" checked/>
						   </td>';
				$sheet .= '<td style = "border-bottom:2px solid white;width:10px;">
								<input onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" onkeyup ="calculateAddPR(this)" class = "data1" value = "' . $qty . '" maxlength = "8" 
										style = "color:rgb(45, 90, 118);text-align:center;font-weight:bold;width:85px;border:0;font-size:16px;border-bottom:1px solid silver;background-color:transparent;padding:2px;"/>
						   		<br/>
								<input onclick = "clickInput(this)" value = "' . $unit . '" style = "color:grey; font-size:15px;border:0;background-color:transparent; text-align:center;width:85px;color:black;"class = "data1"/>
						   </td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
				                x
						   </td>';
				$sheet .= '<td style = "padding:0 2px;border-bottom:2px solid white;">
							<input onclick = "clickInput(this)" onkeydown="return isAmount(this,event)" class = "data1" onkeyup ="calculateAddPR(this)" value  = ' . number_format($price,2) . '  
							style = "color:rgb(45, 90, 118);font-weight:bold;width:90px;border:0;font-size:16px;
									background-color:transparent;padding:2px;border-bottom:1px dashed silver;text-align:left;"/></td>';
				$sheet .= '<td style = "width:20px;border-bottom:2px solid white;text-align:center;">=</td>';
				$sheet .= '<td style = "padding:0 10px;border-bottom:2px solid white;">
							<input value = ' . number_format($amountX,2) . ' disabled 
							  style = "background-color:rgb(220, 228, 232);  width:100px;text-align:left;color:black;border:0;font-size:14px;;padding:5px; 2px;font-weight:bold;" class = "data1"/></td>';
				$sheet .= '</tr>';	
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan ="9"  style = "padding:0px  2px;">
					  
					   <input id ="totalAmountItems" value = ' . number_format($totalAmount,2) . ' disabled  class = "data1"  style = "width:170px;font-size:21px;border:0;background-color:transparent;text-align:right;font-weight:bold;letter-spacing:1px;color:red;padding-right:20px;float:right;" />	
					    <span id  = "angFund" style = "float:right;font-family:Oswald;font-size:22px;color:rgb(64, 161, 202);">'  . $fund .  '</span>
					   </td>';
			$sheet .= '</tr>';
			
			$sheet .= '</table>';
			$sheet0 = '<div style = " ">';
			$sheet2 = '</div>';
			return   $sheet0  . $sheet .$sheet2 ;	
		}
		
		function CreateDoctrackInfoPR2018($record,$db){
			
			$data = $this->fetch_array($record);
				
			$desc = '';
			$checknumber = $data['checknumber'];
			$checkdate = $data['checkdate'];
			$status = strtoupper($data['Status']);
			$claimType =  $data['ClaimType'];
			if(isset($data['xxx'])){
				$advDate = $data['xxx'];
			}else{
				$advDate = 'N/A';
			}
			
			/*if(strtoupper($status) == "CAO RELEASED"){
				if($claimType == "Check"){
					$desc = "CTO Check Preparation";
					if($checknumber >0){
						$desc = "Claim Check";
					}
				}else if($claimType == "Window"){
					$desc = "Forwarded to CTO";
				}else{
					$desc =  $status;
				}
			}else{
				$desc = $status;
			}*/
			$trackingNumber = $data['TrackingNumber'];
			$trackingType = $data['TrackingType'];
			$adv = $data['ADV1'];
			$adv2 = $data['ADV2'];
			if($adv2 > 0){
				$adv = $adv2;
			}
			$obr = $data['OBR_Number'];
			$ctr = $data['ControlNo'];
			if($ctr < 1){
				$ctr = '';
			}
			
			$fund= $data['Fund'];
			
			if($db == "citydoc."){
				$documentType =  $data['ClaimType'];
				$claimType = $data['TransactionType'];
			}else{
				$documentType =  $data['DocumentType'];
			}
			
			
			$claimant =  strtoupper($data['Claimant']);
			$netAmount = '';
			if(isset($data['NetAmount'])){
				$netAmount = $data['NetAmount'];
			}else{
				$netAmount = -1;
			}
			
			// 11-04-2021 Added due wrong display of Gross Amount
			// $totalAmountMultiple = $data['TotalAmountMultiple'];
			// if(floatval($totalAmountMultiple) != 0 && $trackingType == "PY"){
			// 	$amount = $totalAmountMultiple;
			// }else{
			// 	$amount = $data['Amount'];
			// }
			// if($trackingType == "PO"){
			// 	$amount = $data['PO_Amount'];
			// }

			// 06-06-2022 Changed => reason: wrong amount display
			$totalAmountMultiple = $data['TotalAmountMultiple'];
			if(floatval($totalAmountMultiple) != 0){
				$amount = $totalAmountMultiple;
			}else{
				$amount = $data['Amount'];
				if($trackingType == "PO"){
					$amount = $data['PO_Amount'];
				}
			}
			
			$dateEncoded = $data['DateEncoded'];
			$dateUpdated = $data['DateModified'];
			$completion = $data['Completion'];
			$encodedBy = $data['EncodedBy'];
			
			$sql = "select * from citydoc.employees where EmployeeNumber = '" . $encodedBy . "'";
			$record = $this->query($sql);
			$data = $this->fetch_array($record);
			$encodedBy = utf8_encode($data['FirstName'] . ' ' . $data['MiddleName'] . ' ' . $data['LastName']);
			
			
			
			
		
			$sheet = '<table style = "margin:0 auto;width:100%;border-top:1px solid #84BF7E;margin-top:25px;border-spacing:0;" border = "0">
						<tr style = "background-color:#F3F9F4;">
							<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:7px;border-bottom:1px solid #84BF7E;"><span class = "data1">Status</span></td>
							<td colspan = "2" style = "border-bottom:1px solid #84BF7E;color:#228A16; font-weight:bold;font-size:30px;vertical-align:bottom;" class = "data1"><span id  = "trackingType" style = "color:orange;">' . $trackingType . '</span> - <span >' . $status  .  '</span>
								<span style = "font-size:16px;color:black;font-weight:normal;margin-left:5px;">' .  $this->ezDate1($dateUpdated) . '</span><span style = "float:right;font-size:18px;"><span style = "color:silver;font-weight:normal;font-size:14px;">ADV Date : </span>' .  $advDate . '</span></td>
							
						</tr>
						<tr>
							<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Claimant</span></td>
							<td colspan = "2" style = "font-weight:bold;font-size:30px;" class = "data1"><span>' . $claimant  . '</span>
							<span class = "edit" id = "' . $trackingNumber . '*Claimant" onclick = "editThis(this)">EDIT</span></td>
						</tr>';
						
			$sheet .= '	<tr>
							<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Control</span></td><td style = " font-size:30px;vertical-align:bottom;" class = "data1"><span>' . $ctr . '</span></td>
							<td rowspan = "8" style = "width:100px;vertical-align:top;padding-bottom:5px;">
								<div style = "width:250px;background-color:rgba(210, 234, 213,.2);padding:10px;margin-top:20px;">'
									. $this->logs2018($encodedBy,$dateEncoded,$dateUpdated,$completion,$trackingNumber) . 
								'</div>
							</td>
						</tr>';	

			if($adv > 0){		
				$sheet .= '	<tr>
								<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Adv</span></td><td style = " font-size:30px;vertical-align:bottom;" class = "data1"><span id = "adv">' . $adv . '</span>
								<span class = "edit" id = "' . $trackingNumber . '*Adv" onclick = "editThis(this)">EDIT</span></td>
							</tr>';		
			}
			if($obr >0){				
				$sheet .= '	<tr>
								<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Obr</span></td><td style = " font-size:30px;vertical-align:bottom;" class = "data1"><span>' . $obr . '</span></td>
							</tr>';	
			}			
			$sheet .=	'	
						<tr>
						<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Fund</span></td><td style = "font-weight:bold;font-size:24px;vertical-align:bottom;" class = "data1"><span id = "fund">' . $fund  . '</span>
						<span class = "edit" id = "' . $trackingNumber . '*Fund" onclick = "editThis(this)">EDIT</span></td>
					</tr>
						<tr>
						<td  style = "width:100px;text-align:right;vertical-align:top;padding-top:5px;"><span class = "data1">Document Type</span></td>
						<td   style = "font-weight:bold;font-size:24px;;" class = "data1"><span id = "docTypeTrans">' . $documentType  . '</span>
						<span class = "edit" id = "' . $trackingNumber . '*Document" onclick = "editThis(this)">EDIT</span></td></td>
					</tr>
					<tr>
						<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Claim Type</span></td>
						<td  style = "font-weight:bold;font-size:24px;vertical-align:bottom;" class = "data1"><span id = "claimTypeTrans">' . $claimType  . '</span>
						<span class = "edit" id = "' . $trackingNumber . '*Type" onclick = "editThis(this)">EDIT</span></td>
					</tr>
					
					<tr>
						<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Gross Amount</span></td>
						<td  style = "color:#065C8D; font-weight:bold;font-size:24px;vertical-align:bottom;" class = "data1"><span>' . number_format($amount,2)  . '</span></td>
					</tr>';
						
			$sheet .=	'<tr>
							<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Check Number</span></td>
							<td  style = "font-weight:bold;font-size:20px;vertical-align:bottom;" class = "data1"><span>' . $checknumber  . '</span></td>
						</tr>';			
			$sheet .=	'<tr>
							<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Check Date</span></td>
							<td  style = "font-weight:bold;font-size:20px;vertical-align:bottom;" class = "data1"><span>' . $checkdate  . '</span></td>
						</tr>';			
			
			if($netAmount != -1){
				if($netAmount >0 ){
							$sheet .=	'<tr>
								<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Net Amount</span></td>
								<td  style = "color:#065C8D; font-weight:bold;font-size:24px;vertical-align:bottom;" class = "data1"><span id="forReleaseNet">' . number_format($netAmount,2)  . '</span>
								<span class = "edit" id = "' . $trackingNumber . '*NetAmount" onclick = "editThis(this)">EDIT</span></td></td></td>
							</tr>';
			        }
					// else{
					// 		$sheet .=	'<tr>
					// 			<td style = "width:100px;text-align:right;vertical-align:bottom;padding-bottom:5px;"><span class = "data1">Net Amount</span></td>
					// 			<td  style = "color:#065C8D; font-weight:bold;font-size:24px;vertical-align:bottom;" class = "data1"><input type = "text" class = "text3"/></td>
					// 		</tr>';
					// }
			}
			
			
			
			
			if($_SESSION['accountType'] == 5){
				// if(strtoupper($status) == "CAO RECEIVED" || strtoupper($status) == "CAO ON PROCESS" || strtoupper($status) == "ON EVALUATION - CAO" || strtoupper($status) == "EVALUATED - CAO"){
				if(strtoupper($status) == "CAO RECEIVED" || strtoupper($status) == "CAO ON PROCESS" || strtoupper($status) == "ON EVALUATION - ACCOUNTING" || strtoupper($status) == "EVALUATED - ACCOUNTING" || strtoupper($status) == "CARDED - ACCOUNTING" || strtoupper($status) == "SALARY LIST PAYROLL - ACCOUNTING" || strtoupper($status) == "SLP CREATED - ACCOUNTING"){
					$dt1 = time();
					$today = date('Y-m-d', $dt1);
					if(strtoupper($fund) == "GENERAL FUND"){
						
						if($db == "citydoc."){
							$sql = "SELECT count(distinct controlno) as ctrl FROM " . $db . "vouchercurrent WHERE  Fund = '" . $fund . "' and TransactionType = '" . $claimType . "'  and status = 'CAO Released' and substring(DateModified,1,10) = '" . $today . "' AND  ControlNo > 0";
						}else{
							$sql = "SELECT count(distinct controlno) as ctrl FROM " . $db . "vouchercurrent WHERE  Fund = '" . $fund . "' and ClaimType = '" . $claimType . "'  and substring(DateReleased,1,10) = '" . $today . "' AND  ControlNo > 0";
						}
						
					}else{
						if($db == "citydoc."){
							$sql = "SELECT count(distinct controlno) as ctrl FROM " . $db . "vouchercurrent 
								    WHERE  Fund = '" . $fund . "' and status = 'CAO Released' and substring(DateModified,1,10) = '" . $today . "' AND  ControlNo > 0";
						}else{
							$sql = "SELECT count(distinct controlno) as ctrl FROM " . $db . "vouchercurrent 
								    WHERE  Fund = '" . $fund . "' and substring(DateReleased,1,10) = '" . $today . "' AND  ControlNo > 0";
						}
					}
					$record = $this->query($sql);
					$data1 = $this->fetch_array($record);
					$ctrlCounter = $data1['ctrl'] + 1;


					// diri na save control ang para sa releaser's list - 11-02-2021
					$sheet .=	'	<tr>
									<td colspan = "3"style = "padding-bottom:5px;">
											 	<table style = "background-color:#F3F8F12;width:380px;margin:0 auto;margin-top:30px; border-top:1px solid #84BF7E1;padding:5px 10px;" border ="0">
													<tr >
														<td> 
														 	<div id = "control' . $trackingNumber .'" class = "button1" style = "font-size:26px;" onclick = "saveControl(this)">Save Control<div id ="divCtrl" >' . $ctrlCounter . '</div></div>
														</td>
														<td style = "text-align:right;">
															 <span id = "skipAndSave' . $trackingNumber .'" style = "font-size:26px;" class = "button1" onclick = "skipAndSave(this)">Skip & Save</span>
														</td>
													</tr>
											 	</table>
											
									</td>
								</tr>';
				}
			}else if($_SESSION['accountType'] == 4){
				
				if($trackingType == "PY"){
					if(strtoupper($status) == "CBO RECEIVED" || strtoupper($status) == "CBO RELEASED" ||  strtoupper($status) == "ENCODED" || strtoupper($status) == "GSO RECEIVED"  ||  strtoupper($status) == "VOUCHER-GSO-RECEIVED(INSPECTION)"  ){
						$sheet .=	'<tr>
										<td colspan = "3"style = "padding-bottom:5px;">
												 	<table style = "background-color:#F3F8F12;width:380px;margin:0 auto;margin-top:30px; border-top:1px solid #84BF7E1;padding:8px 12px;background-color:rgba(0, 0, 0,.1);p" border ="0">
														<tr >
															<td>
															
															 	<span class = "data1" style = "font-size:22px;font-weight:bold;">Type Adv&nbsp;</span><input id = "receiveAdv" type = "text" class = "text3" style = "font-size:18px;padding:5px;border-top:1px solid grey;border-left:1px solid grey;font-family:oswald;">
															</td>
															<td >
																 <span id = "' . $status . '*' . $trackingNumber .'" style = "font-size:22px;" class = "button1" onclick = "receiveThis(this)">Receive</span>
															</td>
														</tr>
												 	</table>
												
										</td>
									</tr>';
					}
					
					if(strtoupper($status) == "PENDING RELEASED - CAO"  || strtoupper($status) == "PENDING RETURNED"){
						$sheet .=	'<tr>
										<td colspan = "3"style = "padding-bottom:5px;">
												 	<table style = "background-color:#F3F8F12;width:380px;margin:0 auto;margin-top:30px; border-top:1px solid #84BF7E1;padding:8px 12px;background-color:rgba(0, 0, 0,.1);p" border ="0">
														<tr >
															<td style = "display:none;"> 
															 	<span class = "data1" style = "font-size:22px;font-weight:bold;">Type Adv&nbsp;</span><input id = "receiveAdv" type = "text" value = ' .  $adv . ' class = "text3" style = "font-size:18px;padding:5px;border-top:1px solid grey;border-left:1px solid grey;font-family:oswald;">
															</td>
															<td  style = "text-align:center;">
																 <span id = "' . $status . '*' . $trackingNumber .'" style = "font-size:22px;" class = "button1" onclick = "receiveThis(this)">Receive</span>
															</td>
														</tr>
												 	</table>
												
										</td>
									</tr>';
					}
				}
				if($trackingType == "PO"){
					if(strtoupper($status)  == "GSO RECEIVED" || strtoupper($status)  == "VOUCHER-GSO-RECEIVED(INSPECTION)" || strtoupper($status)  == "VOUCHER-GSO-RECEIVED(INVENTORY)" ){
						$sheet .=	'<tr>
										<td colspan = "3"style = "padding-bottom:5px;">
												 	<table style = "background-color:#F3F8F12;width:380px;margin:0 auto;margin-top:30px; border-top:1px solid #84BF7E1;padding:8px 12px;background-color:rgba(0, 0, 0,.1);p" border ="0">
														<tr >
															<td> 
															 	<span class = "data1" style = "font-size:22px;font-weight:bold;">Type Adv&nbsp;</span><input id = "receiveAdv" type = "text" class = "text3" style = "font-size:18px;padding:5px;border-top:1px solid grey;border-left:1px solid grey;font-family:oswald;">
															</td>
															<td >
																 <span id = "' . $status . '*' . $trackingNumber .'" style = "font-size:22px;" class = "button1" onclick = "receiveThis(this)">Receive</span>
															</td>
														</tr>
												 	</table>
												
										</td>
									</tr>';
					}
					if(strtoupper($status) == "PENDING RELEASED - CAO"  || strtoupper($status) == "PENDING RETURNED"){
						$sheet .=	'<tr>
										<td colspan = "3"style = "padding-bottom:5px;">
												 	<table style = "background-color:#F3F8F12;width:380px;margin:0 auto;margin-top:30px; border-top:1px solid #84BF7E1;padding:8px 12px;background-color:rgba(0, 0, 0,.1);p" border ="0">
														<tr >
															<td style = "display:none;"> 
															 	<span class = "data1" style = "font-size:22px;font-weight:bold;">Type Adv&nbsp;</span><input id = "receiveAdv" type = "text" value = ' .  $adv . ' class = "text3" style = "font-size:18px;padding:5px;border-top:1px solid grey;border-left:1px solid grey;font-family:oswald;">
															</td>
															<td  style = "text-align:center;">
																 <span id = "' . $status . '*' . $trackingNumber .'" style = "font-size:22px;" class = "button1" onclick = "receiveThis(this)">Receive</span>
															</td>
														</tr>
												 	</table>
												
										</td>
									</tr>';
					}
				}
			}
			$sheet .=	'</table>';
			
			$count = $this->num_rows($record);
			if($count > 0){
				return $sheet;				
			}else{
				return "<div class = 'norecord' style = 'font-size:62px;text-align:center;color:rgb(86, 145, 94);'>No record found.</div>";				
			}
		
			
		
		}
		
		function CreateListResultPrivate2018($record,$office,$status,$key,$count,$i,$id,$prime){
			if(strlen($status) > 1){
				$searchValue = 'Status*!*' . $status;
			}else{
				$searchValue = 'Claimant*!*' . $key;
			}
			if($prime == 0){
				$sheet = '<table style = "background-color:white;border-spacing:0; margin:0 auto;min-width:1200px;max-width:1200px;border-bottom:1px solid rgb(204, 209, 212);font-family:helvetica;font-size:12px;">';
				$sheet .= '<tr >';
			}else{
				$sheet = '<tr >';
			}
			$sheet .= '<td class = "td4"></td>
					<td class = "td4" ><span class = "label7tracker" style = "">TN#</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker" >OBR</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">ADV</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">PR</span></td>
					<td class = "td4"  style = "text-align:center;padding:0px 5px;"><span class = "label7tracker">PO</span></td>
					
					<td class = "td4"><span class = "label7tracker" style = "">Claimant</span></td>
					
					<td colspan = "2" class = "td4"  style = "text-align:center;"><span class = "label7tracker">Month</span></td>
					<td class = "td4"><span class = "label7tracker" style = "">Document</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Amount</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Check</span></td>
					
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Status</span></td>
					<td class = "td4" style = "text-align:center;" ><span class = "label7tracker" >Updated</span></td>
					<td class = "td4" style = "text-align:center;"><span class = "label7tracker" >Completed</span></td>
					</tr>';
			
			$periodMonth = '';
			$periodType = '';
							
			while($data = $this->fetch_array($record)){
				$color = '';
				$period = '';
				$id  = $data['Id'];
				$office = $data['Name'];
				$type = $data['TrackingType'];
				$status = $data['Status'];
				$claimant = strtoupper($data['Claimant']);
				$check = $data['checknumber'];
				
				$docType = $data['DocumentType'];
				$doc = explode("-",$docType);
				if(sizeof($doc) == 1 ){
					$doc[1] = $docType;
				}
				$category = $data['PR_CategoryCode'];
				if($type == 'PR'){
					$docType = 'Purchase Request';
					$doc[1] = $category;
				}
				$fund = $data['Fund'];
				$claimType =  $data['ClaimType'];
				
				$amount  = $data['Amount'];
				if($data['PO_Amount']> 0){
					$amount = $data['PO_Amount'];
				}
				if($data['TotalAmountMultiple'] > 0){
					$amount = $data['TotalAmountMultiple'];
				}
				
				
				$tn = $data['TrackingNumber'];
				$obr = $data['OBR_Number'];
				$po = $data['PO_Number'];
				$pr = $data['PR_Number'];
				$adv = $data['ADV1'];
				if($adv == 0){
					$adv = $data['ADV2'];
					if($adv == 0){
						$adv = '';
					 }
				}
				
				
				$dateEncoded = $data['DateEncoded'];
				$dateModified = $data['DateModified'];
				$completion = $data['Completion'];
				//$encodedBy = utf8_encode($data['LastName'] . ', ' . $data['FirstName'] . ' ' . $data['MiddleName']);
				$encodedBy = '';
				if($type == 'PY'){
					$periodType = $data['PeriodType']; 
					$periodMonth= $data['PeriodMonth']; 
					if($periodType == 1){
						$period =  '1 -15';
					}else if ($periodType == 2){
						if(strtoupper($periodMonth) == "FEBRUARY"){
							$period =  ' (16 - 28)';
						}else{
							$period =  ' (16 - 31)';
						}
					}else if($periodType == 4){
						$period =  '1 -15';
					}else if ($periodType == 5){
						if(strtoupper($periodMonth) == "FEBRUARY"){
							$period =  ' (16 - 28)';
						}else{
							$period =  ' (16 - 31)';
						}
					}else{
						$period = "";
					}
				}else {
					$period =  $this->numberToQuarter($data['PR_Month']);
					$period  =  "";
					
				}
				if($i % 2 == 0){
					$sheet .= '<tr  style = "background-color:rgb(217, 228, 232); " class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}else{
					$sheet .= '<tr class = "trHover" onmouseover ="highlight(this)" onmouseout = "highlight(this)" onclick = "clickToSearch(this)">';
				}
				
					$sheet .= '<td style = "padding:0px 5px;background-color:white;border-left:1px solid rgb(204, 209, 212);">
								<div class = "numberPrivate" style = "text-align:center;">' . $i++ . '</div>
							</td>
							<td class = "td3"  style = "padding:2px 5px;border-left:1px solid rgb(165, 184, 193);border-right:1px solid rgb(165, 184, 193);">
								<span class = "label5tracker" style = "font-style:italic;color:rgb(7, 146, 185);font-size:13px;">' . $tn . '</span>
							</td>
							<td  class = "td3" style = "text-align:center;background-color:rga(2, 2, 2,.3); border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(225, 74, 127);">' . $obr . '</span>
							</td>
							<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(9, 147, 18);">' . $adv . '</span>
							</td>
							<td  class = "td3" style = "padding:2px 5px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(219, 118, 10);">' . $pr . '</span>
							</td>
							<td  class = "td3" style = "padding:2px 6px;text-align:center;background-color:rga(2, 2, 2,.3);  border-right:1px solid rgb(165, 184, 193);">
								<span class= "label5tracker" style = "color:rgb(107, 109, 14);">' . $po . '</span>
							</td>
							<td  class = "td3" style = "background-color:rga(2, 2, 2,.3); padding:2px 5px; ">
								<span class= "label5tracker" >' . $claimant . '</span>
							</td>
							<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
								<span class = "label5tracker"  >' . $periodMonth  . '</span>
							</td>
							<td  class = "td3" style = "text-align:left;padding-right:10px;">
								<span  class = "label5tracker"  >' . $period. '</span>
							</td>
							<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);">
								<span class = "label5tracker"  >' . $doc[1]  . '</span>
							</td>
							<td  class = "td3" style ="text-align:right;border-left:1px solid rgb(204, 209, 212); padding:0px 5px;color:rgb(212, 15, 35);">
								<span class = "label5tracker"  >' . number_format($amount,2) . '</span>
							</td>
							<td  class = "td3" style = "border-left:1px solid rgb(204, 209, 212);text-align:center;">
								<span class = "label5tracker"  style = "font-style:italic;letter-spacing:1px;font-size:14px;padding:0px 5px;">' . $check . '</span>
							</td>
							<td  class = "td3"  style ="text-align:center;border-left:1px solid rgb(165, 184, 193); border-right:1px solid rgb(204, 209, 212);padding:0px 5px;">';
							
							if($status == "CAO Released"){
								$color = "orange;";
							}else{
								$pos = strpos($status,"Pending");
								if ($pos === false) {
									$color = "rgb(7, 146, 185);";
								}else{
									$color = "rgb(250, 64, 85);";
								}	
							}
							$sheet .= '<span  class = "label5tracker" style = "color: '  . $color . '">' . $status. '</span>';
							$sheet .= '</td>';
							$sheet .= '<td  class = "td3" style = "padding:0px 5px;"  ><span class= "label5tracker" style = "font-size:12px;" >' . $this->ezDate($dateModified). '</span></td>';
							
					$sheet .= '<td class = "td3" style = "border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212); padding-left:10px;"><span class= "label5tracker" style = "font-size:12px;color:rgb(50, 51, 52)" >' . $completion . '</span></td>
						</tr>';
			}
			if($count == 40){
				$sheet .= '<tr><td  style = "border-left:1px solid rgb(204, 209, 212); border-right:1px solid rgb(204, 209, 212);text-align:center;padding:8px;"  colspan = "50" >
								<div id ="' . $id . '~' . $i . '~' . $searchValue .  '"  class = "loadMore" onclick = "loadMore(this)">Load more </div>
							</td></tr>';
			}
			if($prime == 0){
				return $sheet .= '</table>';
			}else{
				return $sheet .= '</tr>';
			}
		}
		
		function CreateRetentionList($record){
			$rows = $this->num_rows($record);

			if($rows > 0){
				$c = "rgb(186, 196, 194)";
				$sheet = "<table border='0' style='text-align:center;border-spacing:0;background-color:white;padding:8px;width:100%;margin:0px auto;' border= '0'>";
				$sheet .=" <thead>
								<tr>
									<th></th>
									<th colspan='9' style='text-align:left;color:green;letter-spacing:1px;'>
									<span class = 'hoverPrint'  style = 'position:absolute;margin-top:-12px;margin-left:-1px;color:black;' onclick = 'previewRetTrans()'>&#8471;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retention Transactions
									</th>
								</tr>
								<tr>
									<th class=''></th>
									<th class='trHead' style='background-color:rgb(160, 165, 164); width:10px;'>Retention&nbsp;TN</th>
									<th class='trHead' style='background-color:".$c.";'>ADV</th>
									<th class='trHead' style='background-color:".$c.";'>Claimant</th>
									<th class='trHead' style='background-color:".$c."; text-align: right;'>Amount</th>
									<th class='trHead' style='background-color:".$c."; text-align: left;'>Status</th>
									<th class='trHead' style='background-color:".$c."; text-align: left;'>Month</th>
									<th class='trHead' style='background-color:".$c.";'>Check&nbsp;No.</th>
									<th class='trHead' style='background-color:".$c.";'>Check&nbsp;Date</th>
									<th class='trHead' style='background-color:rgb(244, 246, 218); text-align: left; width:0px; border-right:1px solid ".$c.";'>PO&nbsp;TN</th>
								</tr>
							</thead>";
				$sheet .="<tbody>";

				while($data = $this->fetch_array($record)){
					$tn = $data['TrackingNumber']; 
					$tnPartner = $data['tnPartner'];
					$claimant = $data['Claimant']; 
					$month = $data['PeriodMonth']; 
					$adv = $this->zeroToNothing($data['ADV1']); 
					$status = $data['Status']; 
					$amount = $this->toNumberFormat($data['Amount']); 
					$netAmount = $this->toNumberFormat($data['NetAmount']); 
					$checkNum = $data['checknumber']; 
					$checkDate = $data['checkdate']; 
					$searchTNPartner = "searchThisRetention(this)";
					$clr = "green";

					if($tnPartner == ""){
						$tnPartner = "Multiple";
						$searchTNPartner = "searchRetentionTNPartners(\"".$tn."\")";
						$clr = "gray";
					}
					$sheet.="<tr  class='trData'>
								<td style='width:10px;border:0;text-align:center;background-color:white;'>".$rows--."</td>
								<td class='tdDataBalance' style='border-left: 1px dashed grey;border-right: 1px dashed grey;font-weight:bold;font-size:12px;text-align:left;width:45px;' onclick='searchThisRetention(this)'>".$tn."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:center;'>".$adv."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:left;'>".$claimant."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:right;'>".$amount."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:left;font-weight:bold;'>".$status."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:left;'>".$month."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:center;'>".$checkNum."</td>
								<td class='tdDataBalance' style='cursor:default;text-align:center;'>".$checkDate."</td>
								<td class='tdDataBalance' style='text-align:left;font-weight:bold;letter-spacing:1px;font-size:13px;width:0px;color:".$clr.";' onclick='".$searchTNPartner."';>".$tnPartner."</td>
							</tr>
							";
				}

				$sheet .="</tbody>";
				$sheet .= "</table>";

				return $sheet;
			}else{
				return '<div style = "padding: 25px; font-weight: bold; letter-spacing: 1px; text-align: center;">No record found. </div>';
			}
		}

		function CreateRetTransPrinting($record){
			$rows = $this->num_rows($record);

			if($rows > 0){
				$c = "rgb(186, 196, 194)";
				$sheet = "<table border='0' class='retTransTable' style='' border= '0'>";
				$sheet .=" <thead>
								<tr>
									<th style='border:0;'></th>
									<th colspan='7' style='text-align:left;font-size:20px;font-weight:bold;'>
										Retentions
									</th>
									<th style='font-weight:normal;'>Rows<span style='margin-left:5px;font-weight:bold;'>".$rows."</span></th>
								</tr>
								<tr>
									<th class='' style='border:0;'></th>
									<th class='' style='width:10px;'>Retention</th>
									<th class='' style='text-align: left;'>Period</th>
									<th class='' style=''>Claimant</th>
									<th class='' style='text-align: right;'>Amount</th>
									<th class='' style='text-align: left;'>Status</th>
									<th class='' style=''>Check&nbsp;No.</th>
									<th class='' style=''>Check&nbsp;Date</th>
									<th class='' style='text-align: left; width:0px;'>PO</th>
								</tr>
							</thead>";
				$sheet .="<tbody>";

				$rowCtr = 0;
				while($data = $this->fetch_array($record)){
					$tn = $data['TrackingNumber']; 
					$tnPartner = $data['tnPartner'];
					$claimant = $data['Claimant']; 
					$month = $data['PeriodMonth']; 
					$adv = $this->zeroToNothing($data['ADV1']); 
					$status = $data['Status']; 
					$amount = $this->toNumberFormat($data['Amount']); 
					$netAmount = $this->toNumberFormat($data['NetAmount']); 
					$checkNum = $data['checknumber']; 
					$checkDate = $data['checkdate']; 
					$searchTNPartner = "searchThisRetention(this)";
					$clr = "green";

					if($tnPartner == ""){
						$tnPartner = "Multiple";
						$searchTNPartner = "searchRetentionTNPartners(\"".$tn."\")";
						$clr = "gray";
					}
					$sheet.="<tr>
								<td style='width:10px;border:0;text-align:center;background-color:white;font-size:12px;'>".++$rowCtr."</td>
								<td class='tdDataBalance' style='text-align:left;width:45px;'>".$tn."</td>
								<td class='tdDataBalance' style='text-align:left;'>".$month."</td>
								<td class='tdDataBalance' style='text-align:left;font-size:13px;'>".$claimant."</td>
								<td class='tdDataBalance' style='text-align:right;font-size:13px;'>".$amount."</td>
								<td class='tdDataBalance' style='text-align:left;'>".$status."</td>
								<td class='tdDataBalance' style='text-align:center;'>".$checkNum."</td>
								<td class='tdDataBalance' style='text-align:center;'>".$checkDate."</td>
								<td class='tdDataBalance' style='text-align:left;width:0px;'>".$tnPartner."</td>
							</tr>
							";
				}
				$sheet .= " <tr>
								<td style='border:0;'></td>
								<td colspan='4' style='border:0;'>www.davaocityportal.com</td>
								<td colspan='4' style='border:0;text-align:right;'>".date('D d, M Y h:m a')."</td>
							</tr>";
				$sheet .="</tbody>";
				$sheet .= "</table>";

				return $sheet;
			}else{
				return '<div style = "padding: 25px; font-weight: bold; letter-spacing: 1px; text-align: center;">No record found. </div>';
			}
		}

		function genPrSumTransTotalTable($record){
			$sheet = "";
			$gtotal = 0;

			
			$sheet .= "<table border='0' class='prSumViewTable' style='margin: 0px 10px 0px auto;border:1px solid silver;'>
						<thead style = 'color:white;'>
							<th style = 'background-color: rgb(12, 71, 123);'>Fund</th>
							<th style = 'background-color: rgb(12, 71, 123);background-color: rgb(12, 71, 123);'>PR Count</th>
							<th style='text-align:right; padding:2px; padding-right:8px;background-color: rgb(12, 71, 123);'>Total</th>
							<th colspan='2' style = 'background-color:rgb(43, 50, 56);border:0px;'>View</th>
						</thead>";

			while($data = $this->fetch_array($record)){
				$sheet .= "	<tr>
								<td>".$data['Fund']."</td>
								<td style='text-align:center;'>".$data['TNTotal']."</td>
								<td style='text-align:right; padding:0px 8px;'>".$this->toNumberFormat($data['Total'])."</td>
								<td style='text-align:center; width:35px;'>
									<span class='prSumDetBtn' onclick='getPrSumDet(this)'>DESC</span>
								</td>
								<td style='text-align:center; width:35px;'>
									<span class='prSumDetBtn' onclick='getPrSumDet(this)'>TRANS</span>
								</td>
							</tr>";
				$gtotal += $data['Total'];
			}

			$sheet .= "	<tr style = 'background-color:rgb(245, 249, 249);'>
							<td colspan='3' style='border:0px; text-align:right; padding-right:8px; color:red;'><span style='font-weight:normal; margin-right:10px;color:black;'>Total</span>".$this->toNumberFormat($gtotal)."</td>
							<td style='border:0px;'></td>
							<td style='border:0px;'></td>
						</tr>";

			$sheet .= "</table>";

			echo $sheet;
		}

		function genPrTransTable($record, $fund, $loadMore, $year){
			$sheet = "";

			if($this->num_rows($record) > 0){
				$sheet .= " <div id='prSumFundHeader' style='padding-left:15px; font-weight:bold; text-align:left; font-size:18px; margin-bottom:5px;'>
								<span>".$fund."</span> <span style='font-size:10px; font-weight:normal; letter-spacing:1px;'>VIEWED BY ALL PR TRANSACTIONS</span><span id='prSumNumof'></span>
							</div>";

				$sheet .= "<table border='0' id='prSumDetTable' class='prSumDetTable'>
						<thead>
							<tr>
								<th></th>
								<th style='text-align:left; width:250px;'>Office</th>
								<th style='text-align:left; width:100px;'>Category</th>
								<th style='text-align:left; padding-left:2px; width:250px;'>Description</th>
								<th style='text-align:left; width:70px;'>TN</th>
								<th style='text-align:left; width:70px; padding-left:3px;'>PR</th>
								<th style='text-align:left; width:70px; padding-left:3px;'>OBR</th>
								<th style='text-align:left;padding-left:2px;'>Status</th>
								<th style='text-align:right;'>Amount</th>
							</tr>
						</thead>
						";

				$row = 0;
				$curCnt = 0;
				while($data = $this->fetch_array($record)){

					$amnt = floatval($data['TotalAmountMultiple']);
					if($amnt == 0){
						$amnt = floatval($data['Amount']);
					}
					
					$display = "";	
					if($curCnt >= $loadMore){
						$display = "prSumHide";
					}

					$sheet .= "	<tr class='".$display."'>
									<td><span>".++$row."</span><input type='hidden' value='".$data['Id']."'></td>
									<td>".$data['OfficeName']."</td>
									<td>".$data['PR_CategoryCode']."</td>
									<td>".$data['CatTitle']."</td>
									<td class='searchThisPrSumDet'><span onclick='searchThisPrSumDet(this)'>".$data['TrackingNumber']."</span></td>
									<td>".$data['PR_Number']."</td>
									<td>".$data['OBR_Number']."</td>
									<td>".$data['Status']."</td>
									<td style='text-align:right;'>".$this->toNumberFormat($amnt)."</td>
								</tr>";
					$curCnt++;
				}
				$sheet .= "</table>";

				if($this->num_rows($record) >= $loadMore){
					$sheet .= "	<div id='prSumDetLoadMore' style='padding-top: 10px; font-size:14px;'>
									<span class='prSumLoadAddtl' onclick='prSummaryLoadMore1(this)'>10</span><span class='prSumLoadAddtl' onclick='prSummaryLoadMore1(this)'>20</span><span class='prSumLoadAddtl' onclick='prSummaryLoadMore1(this)'>50</span><span class='prSumLoadAddtl' onclick='prSummaryLoadMore1(this)'>100</span><span class='prSumLoadAddtl' onclick='prSummaryLoadMore1(this)'>All</span>
									<div style='font-size:12px; margin-top:5px;'>Load More</div>
								</div>";
				}
				$sheet .= "	<div style='padding:5px 8px; background-color: rgb(245, 249, 249); text-align: right; font-size: 10px; margin-top:10px;'>
								Source : PR Transactions from Doctrack ".$year." system. 
								<br/>
								Covered statuses : GSO Released, CTO Received, Admin Received, Pending at Admin, 
								<br/>
								Pending Released - Admin, BAC Received, Pending at BAC, Pending Released - BAC, and For P.O.
							</div>
							";
				
				echo $sheet;
			}else{
				echo '<div style = "padding: 25px; font-weight: bold; letter-spacing: 1px; text-align: center;">No record found. </div>';
			}
			
		}

		function genPrTransTableByCat($record, $fund, $loadMore, $year){
			$sheet = "";
			if($this->num_rows($record) > 0){
				$sheet .= " <div style='padding-left:15px; font-weight:bold; text-align:left; font-size:18px; margin-bottom:10px;'>
								<span>".$fund."</span> <span style='font-size:10px; font-weight:normal; letter-spacing:1px;'>VIEWED BY ALL PR CATEGORIES</span>
							</div>";

				$sheet .= "<table border='0' id='prSumDetTable' class='prSumDetTable'>
						<thead>
							<tr>
								<th></th>
								<th style='text-align:left; width:100px;'>Category</th>
								<th style='text-align:left; width:400px;'>Description</th>
								<th style=''>PR Count</th>
								<th style='text-align:right;'>Total</th>
							</tr>
						</thead>
						"; 
			
				$row = 0;
				while($data = $this->fetch_array($record)){

					$sheet .= "	<tr>
									<td>".++$row."</td>
									<td>".$data['PR_CategoryCode']."</td>
									<td>".$data['Description']."</td>
									<td style='text-align:center;'>".$data['TNTotal']."</td>
									<td style='text-align:right;'>".$this->toNumberFormat($data['Total'])."</td>
								</tr>";

				}

				$sheet .= "</table>";
				$sheet .= "	<div style='padding:5px 8px; background-color: rgb(245, 249, 249); text-align: right; font-size: 10px; margin-top:10px;'>
								Source : PR Transactions from Doctrack ".$year." system. 
								<br/>
								Covered statuses : GSO Released, CTO Received, Admin Received, Pending at Admin, 
								<br/>
								Pending Released - Admin, BAC Received, Pending at BAC, Pending Released - BAC, and For P.O.
							</div>
							";
				echo $sheet;
			}else{
				echo '<div style = "padding: 25px; font-weight: bold; letter-spacing: 1px; text-align: center;">No record found. </div>';
			}
			
		}

		function genPrTransTableAddtl($record){
			$sheet = "";

			if($this->num_rows($record) > 0){
				$row = 0;
				$curCnt = 0;
				while($data = $this->fetch_array($record)){

					$amnt = floatval($data['TotalAmountMultiple']);
					if($amnt == 0){
						$amnt = floatval($data['Amount']);
					}
					$sheet .= "	<tr>
									<td><span>".++$row."</span><input type='hidden' value='".$data['Id']."'></td>
									<td>".$data['OfficeName']."</td>
									<td>".$data['PR_CategoryCode']."</td>
									<td>".$data['CatTitle']."</td>
									<td class='searchThisPrSumDet'><span onclick='searchThisPrSumDet(this)'>".$data['TrackingNumber']."</span></td>
									<td>".$data['PR_Number']."</td>
									<td>".$data['OBR_Number']."</td>
									<td>".$data['Status']."</td>
									<td style='text-align:right;'>".$this->toNumberFormat($amnt)."</td>
								</tr>";
					$curCnt++;
				}
				echo $sheet;
			}else{
				echo 1;
			}
			
		}
		function showTableSB($j,$sb,$record,$fund,$year){
			$sheet = "<table id ='mainTable' style = 'border-spacing:0px;margin:0 auto;font-family:Oswald;font-size:12px;width:1000px;' >";
			
			if($j == 0){
				$sheet .= '<tr><td colspan ="14" style ="text-align:center;">
							<div style  = "letter-spacing:1px;font-size:22px;font-weigth:bold;font-weight:bold;">Republic of the Philippines</div>
							<div style = "font-weight:bold;">City Government of Davao</div>
							<div style = "font-weight:bold;">Budget Year ' . $year . '</div>
							 <div style = "text-align:left;">Printed : ' . date('Y-m-d') . '</div>
							<div style  = "letter-spacing:2px;font-size:13px;padding-bottom:10px;font-weight:bold;text-align:left;"><br/>Supplemental Budget '. $sb . ' - <span>' . $fund . '</span></div>
							
						</td></tr>';
			}else{
				$sheet .= '<tr><td colspan ="14" style ="text-align:center;">
							<div style  = "letter-spacing:2px;font-size:13px;padding-bottom:10px;font-weight:bold;text-align:left;"><br/>Supplemental Budget '. $sb . ' - <span>' . $fund . '</span></div>
						</td></tr>';
			}
				
			
			$sheet .= '<tr style = "font-weight:bold;">';
			$sheet .= '<td rowspan ="2" style = "border-top:1px solid black;border-left:1px solid black;" >Category</td>';
			$sheet .= '<td rowspan ="2" style = "border-top:1px solid black;border-left:1px solid black;">Procurement Description</td>';
			$sheet .= '<td rowspan ="2" style = "border-top:1px solid black;border-left:1px solid black;">Office</td>';
			$sheet .= '<td rowspan ="2" style = "border-top:1px solid black;border-left:1px solid black;">Mode of Procurement</td>';
			$sheet .= '<td colspan ="4" style = "text-align:center;border-top:1px solid black;border-left:1px solid black;">Schedule for each procurement activity</td>';
			$sheet .= '<td rowspan ="2" style = "border-top:1px solid black;border-left:1px solid black;">Source of Funds</td>';
			$sheet .= '<td style ="text-align:center;border-top:1px solid black;border-left:1px solid black;" colspan ="3">Estimated Budget(Php)</td>';
			$sheet .= '<td rowspan ="2" style = "border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">Remarks</td>';
			$sheet .= '</tr>';	
			
			$sheet .= '<tr>';
			$sheet .= '<td style ="border-left:1px solid black;border-top:1px solid black;">Ads/Open of Bids/REI</td>';
			$sheet .= '<td style ="border-left:1px solid black;border-top:1px solid black;">Sub/Open of Bids</td>';
			$sheet .= '<td style ="border-left:1px solid black;border-top:1px solid black;">Notice of Award</td>';
			$sheet .= '<td style ="border-left:1px solid black;border-top:1px solid black;">Contract Signing</td>';
			$sheet .= '<td style ="text-align:center;border-left:1px solid black;border-top:1px solid black;">Total</td>';
			$sheet .= '<td style ="border-left:1px solid black;border-top:1px solid black;width:50px;text-align:center;">MOOE</td>';
			$sheet .= '<td style ="border-left:1px solid black;border-top:1px solid black;width:50px;text-align:center;">CO</td>';
			$sheet .= '</tr>';	
			$grand = 0;
			while($data = $this->fetch_array($record)){
				$category = $data['Category'];
				$desc = $data['Description'];
				$total = $data['Total'];
				$co =   $data['CO'];
				$mooe = $data['MOOE'];
				
				
				$grand = ($grand + $total);
				$sheet .= '<tr>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">' . $category . '</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">' . $desc . '</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">&nbsp;</td>';
				$sheet .= '<td style = "text-align:right;border-top:1px solid black;border-left:1px solid black;">' . number_format($total,2) . '</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;">' . number_format($mooe,2) . '</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;">' . number_format($co,2) . '</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black; border-right:1px solid black;">&nbsp;</td>';
				$sheet .= '</tr>';	
			}
			$sheet .= '<tr>';
			$sheet .= '<td colspan = "9" style = "border-top:1px solid black;font-size:10px;letter-spacing:1px;"></td>';
			$sheet .= '<td style = "border-top:1px solid black;font-weight:bold;">' .  number_format($grand,2) . '</td>';	
			$sheet .= '<td colspan = "5" style = "border-top:1px solid black;"></td>';
			$sheet .= '</tr>';	
			$sheet .= "</table><br/>";
			return $sheet;
		}
		
		function showTableSBbreakdown($j,$sb,$record,$fund,$year){
				$sheet = "<table id ='mainTable' style = 'border-spacing:0px;margin:0 auto;font-family:Oswald;font-size:12px;width:1500px;' >";
				
				if($j == 0){
					$sheet .= '<tr><td colspan ="24" style ="text-align:center;">
								<div style  = "letter-spacing:1px;font-size:22px;font-weigth:bold;font-weight:bold;">Republic of the Philippines</div>
								<div style = "font-weight:bold;">City Government of Davao</div>
								<div style  = "font-size:13px;padding-bottom:10px;font-weight:bold;">Supplemental Budget Breakdown  ' . $year . '</div><br/>
								
								<div style = "text-align:left;font-weight:normal;font-size:10px;"> <span>Printed : ' . date('Y-m-d') . '</span></div><br/>
								<div style  = "letter-spacing:2px;font-size:13px;padding-bottom:10px;font-weight:bold;text-align:left;">Supplemental Budget ' . $sb . ' - ' . $fund .  '<br/>
								</div>
							</td></tr>';	
				}else{
					$sheet .= '<tr><td colspan ="24" style ="text-align:center;">
								
								
								<div style  = "letter-spacing:2px;font-size:13px;padding-bottom:10px;font-weight:bold;text-align:left;">Supplemental Budget ' . $sb . ' - ' . $fund .  '<br/>
								</div>
							</td></tr>';	
				}
				
				$sheet .= '<tr style = "font-weight:bold;">';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;" ></td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;" >Office</td>';
				$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;" >Category</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;width:400px;">Item</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Description</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Unit</td>';
				$sheet .= '<td  style = "text-align:center;border-top:1px solid black;border-left:1px solid black;">Cost</td>';

				
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Jan</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Feb</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Mar</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">1st&nbsp;Quarter</td>';
				
				
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Apr</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">May</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Jun</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">2nd&nbsp;Quarter</td>';
				
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Jul</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Aug</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Sep</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">3rd&nbsp;Quarter</td>';
				
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Oct</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Nov</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">Dec</td>';
				$sheet .= '<td  style = "border-top:1px solid black;border-left:1px solid black;">4th&nbsp;Quarter</td>';
				
				
				$sheet .= '<td  style = "text-align:center;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;">Total</td>';
				$sheet .= '</tr>';	
				
				
				$grand = 0;
				
				$tFirst = 0;
				$tSecond = 0;
				$tThird = 0;
				$tFourth = 0;
				$i = 0;
				while($data = $this->fetch_array($record)){
					$i++;
					$name = $data['Name'];
					$category = $data['Category'];
					$desc = $data['CatDesc'];
					$item = $data['Item'];
					if(strlen($item) > 70){
						$item = substr($item,0,70) . '...';
					}else{
						$item = $data['Item'];
					}
					$cost = $data['Cost'];
					$total = $data['Total'];
					$unit = $data['Unit'];
					$jan = $data['Jan'];
					$feb = $data['Feb'];
					$mar = $data['Mar'];
					$apr = $data['Apr'];
					$may = $data['May'];
					$jun = $data['Jun'];
					$jul = $data['Jul'];
					$aug = $data['Aug'];
					$sep = $data['Sep'];
					$oct = $data['Oct'];
					$nov = $data['Nov'];
					$dec = $data['Dex'];
					
					$first = ($jan + $feb + $mar) * $cost;
					$tFirst = $tFirst + $first;
					$second = ($apr + $may + $jun) * $cost;
					$tSecond = $tSecond + $second;
					$third = ($jul + $aug + $sep) * $cost;
					$tThird = $tThird + $third;
					$fourth = ($oct + $nov+ $dec) * $cost;
					$tFourth = $tFourth + $fourth;
					
					$grand = ($grand + $total);
					
					$sheet .= '<tr>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $i . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;width:200px;">' . $name . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">' . $category . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">' . $item . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;">' . $desc . '</td>';
					
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;">' . $unit . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;font-weight:bold;">' . number_format($cost,2) . '</td>';
					
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($jan) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($feb) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($mar) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;font-weight:bold;">' . $this->zeroToNothing(number_format($first,2)) . '</td>';
						
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($apr) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($may) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($jun) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;font-weight:bold;">' . $this->zeroToNothing(number_format($second,2)) . '</td>';
					
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($jul) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($aug) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($sep) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;font-weight:bold;">' . $this->zeroToNothing(number_format($third,2)) . '</td>';
					
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($oct) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($nov) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:center;">' . $this->zeroToNothing($dec) . '</td>';
					$sheet .= '<td style = "border-top:1px solid black;border-left:1px solid black;text-align:right;font-weight:bold;">' . $this->zeroToNothing(number_format($fourth,2)) . '</td>';
				
					
					$sheet .= '<td style = "text-align:right;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;font-weight:bold;">' . number_format($total,2) . '</td>';		
					$sheet .= '</tr>';	
				}
				$sheet .= '<tr>';
				$sheet .= '<td colspan = "10" style = "border-top:1px solid black;font-size:10px;letter-spacing:1px;"></td>';
				$sheet .= '<td style = "border-top:1px solid black;font-weight:bold;text-align:right;">' .  number_format($tFirst,2) . '</td>';
				$sheet .= '<td colspan = "3" style = "border-top:1px solid black;"></td>';
				$sheet .= '<td style = "border-top:1px solid black;font-weight:bold;text-align:right;">' .  number_format($tSecond,2) . '</td>';
				$sheet .= '<td colspan = "3" style = "border-top:1px solid black;"></td>';
				$sheet .= '<td style = "border-top:1px solid black;font-weight:bold;text-align:right;">' .  number_format($tThird,2) . '</td>';
				$sheet .= '<td colspan = "3" style = "border-top:1px solid black;"></td>';	
				$sheet .= '<td style = "border-top:1px solid black;font-weight:bold;text-align:right;">' .  number_format($tFourth,2) . '</td>';
			
				$sheet .= '<td style = "border-top:1px solid black;font-weight:bold;">' .  number_format($grand,2) . '</td>';
				$sheet .= '</tr>';	
				$sheet .= "</table><br/>";
				echo $sheet;
		}
		
	
	}
	$sheet1 = new Sheet1();

